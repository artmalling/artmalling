<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 최재형
 * 회 사 명 : 
 * 작 성 일 : 2011.06.23
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  월별조직별매출계획조회
 -->
<service name="/meis044.me">

    <!-- 매출계획조회 헤더  -->
    <gauce name="H_SEL_SALES_PLAN">
		<column colName="ORG_CD"					colType="TB_STRING" 	size="10"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="ORG_NAME"					colType="TB_STRING" 	size="60"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="GROUP_ID"					colType="TB_STRING" 	size="1"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_01"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_02"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_03"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_04"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_05"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_06"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_07"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_08"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_09"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_10"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_11"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_12"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_01"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_02"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_03"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_04"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_05"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_06"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_07"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_08"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_09"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_10"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_11"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_12"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_01"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_02"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_03"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_04"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_05"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_06"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_07"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_08"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_09"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_10"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_11"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_PROFIT_RATE_12"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_01"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_02"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_03"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_04"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_05"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_06"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_07"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_08"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_09"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_10"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_11"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_AMT_12"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_01"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_02"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_03"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_04"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_05"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_06"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_07"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_08"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_09"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_10"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_11"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_SALES_PROFIT_AMT_12"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_01"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_02"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_03"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_04"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_05"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_06"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_07"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_08"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_09"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_10"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_11"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_PROFIT_RATE_12"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />

        <column colName="STR_CD"							colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="DEPT_CD"							colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="TEAM_CD"							colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="PC_CD"								colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />      

    </gauce>
    
    <!-- 점별 매출계획조회 -->
    <query name="SEL_SALES_PLAN_STR">
    <![CDATA[
    	/*******
    	* 점별 매출계획조회
    	*******/
		SELECT MMA.ORG_CD
		      ,DECODE(MMA.GROUP_ID, '1', '합계', (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD )) AS ORG_NAME
		      ,DECODE(MMA.GROUP_ID, '1', '2', '0')                                                                            AS GROUP_ID
		      /* 계획매출액금 */
		      ,MMA.PLAN_SALES_AMT                                                                                     AS PLAN_SALES_AMT
		      ,MMA.PLAN_SALES_AMT_01                                                                                  AS PLAN_SALES_AMT_01
		      ,MMA.PLAN_SALES_AMT_02                                                                                  AS PLAN_SALES_AMT_02
		      ,MMA.PLAN_SALES_AMT_03                                                                                  AS PLAN_SALES_AMT_03
		      ,MMA.PLAN_SALES_AMT_04                                                                                  AS PLAN_SALES_AMT_04
		      ,MMA.PLAN_SALES_AMT_05                                                                                  AS PLAN_SALES_AMT_05
		      ,MMA.PLAN_SALES_AMT_06                                                                                  AS PLAN_SALES_AMT_06
		      ,MMA.PLAN_SALES_AMT_07                                                                                  AS PLAN_SALES_AMT_07
		      ,MMA.PLAN_SALES_AMT_08                                                                                  AS PLAN_SALES_AMT_08
		      ,MMA.PLAN_SALES_AMT_09                                                                                  AS PLAN_SALES_AMT_09
		      ,MMA.PLAN_SALES_AMT_10                                                                                  AS PLAN_SALES_AMT_10
		      ,MMA.PLAN_SALES_AMT_11                                                                                  AS PLAN_SALES_AMT_11
		      ,MMA.PLAN_SALES_AMT_12                                                                                  AS PLAN_SALES_AMT_12
		      /* 계획매출이익액 */
		      ,MMA.PLAN_SALES_PROFIT_AMT                                                                              AS PLAN_SALES_PROFIT_AMT                                                                              
		      ,MMA.PLAN_SALES_PROFIT_AMT_01                                                                           AS PLAN_SALES_PROFIT_AMT_01
		      ,MMA.PLAN_SALES_PROFIT_AMT_02                                                                           AS PLAN_SALES_PROFIT_AMT_02
		      ,MMA.PLAN_SALES_PROFIT_AMT_03                                                                           AS PLAN_SALES_PROFIT_AMT_03
		      ,MMA.PLAN_SALES_PROFIT_AMT_04                                                                           AS PLAN_SALES_PROFIT_AMT_04
		      ,MMA.PLAN_SALES_PROFIT_AMT_05                                                                           AS PLAN_SALES_PROFIT_AMT_05
		      ,MMA.PLAN_SALES_PROFIT_AMT_06                                                                           AS PLAN_SALES_PROFIT_AMT_06
		      ,MMA.PLAN_SALES_PROFIT_AMT_07                                                                           AS PLAN_SALES_PROFIT_AMT_07
		      ,MMA.PLAN_SALES_PROFIT_AMT_08                                                                           AS PLAN_SALES_PROFIT_AMT_08
		      ,MMA.PLAN_SALES_PROFIT_AMT_09                                                                           AS PLAN_SALES_PROFIT_AMT_09
		      ,MMA.PLAN_SALES_PROFIT_AMT_10                                                                           AS PLAN_SALES_PROFIT_AMT_10
		      ,MMA.PLAN_SALES_PROFIT_AMT_11                                                                           AS PLAN_SALES_PROFIT_AMT_11
		      ,MMA.PLAN_SALES_PROFIT_AMT_12                                                                           AS PLAN_SALES_PROFIT_AMT_12
		      /* 계획이익율 */
		      ,DECODE(MMA.PLAN_SALES_AMT, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_AMT*100,2))                    AS PLAN_PROFIT_RATE
		      ,DECODE(MMA.PLAN_SALES_AMT_01, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_01/MMA.PLAN_SALES_AMT_01*100,2))                    AS PLAN_PROFIT_RATE_01 
		      ,DECODE(MMA.PLAN_SALES_AMT_02, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_02/MMA.PLAN_SALES_AMT_02*100,2))                    AS PLAN_PROFIT_RATE_02
		      ,DECODE(MMA.PLAN_SALES_AMT_03, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_03/MMA.PLAN_SALES_AMT_03*100,2))                    AS PLAN_PROFIT_RATE_03 
		      ,DECODE(MMA.PLAN_SALES_AMT_04, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_04/MMA.PLAN_SALES_AMT_04*100,2))                    AS PLAN_PROFIT_RATE_04  
		      ,DECODE(MMA.PLAN_SALES_AMT_05, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_05/MMA.PLAN_SALES_AMT_05*100,2))                    AS PLAN_PROFIT_RATE_05 
		      ,DECODE(MMA.PLAN_SALES_AMT_06, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_06/MMA.PLAN_SALES_AMT_06*100,2))                    AS PLAN_PROFIT_RATE_06 
		      ,DECODE(MMA.PLAN_SALES_AMT_07, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_07/MMA.PLAN_SALES_AMT_07*100,2))                    AS PLAN_PROFIT_RATE_07 
		      ,DECODE(MMA.PLAN_SALES_AMT_08, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_08/MMA.PLAN_SALES_AMT_08*100,2))                    AS PLAN_PROFIT_RATE_08 
		      ,DECODE(MMA.PLAN_SALES_AMT_09, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_09/MMA.PLAN_SALES_AMT_09*100,2))                    AS PLAN_PROFIT_RATE_09 
		      ,DECODE(MMA.PLAN_SALES_AMT_10, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_10/MMA.PLAN_SALES_AMT_10*100,2))                    AS PLAN_PROFIT_RATE_10 
		      ,DECODE(MMA.PLAN_SALES_AMT_11, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_11/MMA.PLAN_SALES_AMT_11*100,2))                    AS PLAN_PROFIT_RATE_11 
		      ,DECODE(MMA.PLAN_SALES_AMT_12, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_12/MMA.PLAN_SALES_AMT_12*100,2))                    AS PLAN_PROFIT_RATE_12  
		      /* 전년매출액 */      
		      ,MMA.PRE_SALES_AMT                                                                                      AS PRE_SALES_AMT
		      ,MMA.PRE_SALES_AMT_01                                                                                   AS PRE_SALES_AMT_01
		      ,MMA.PRE_SALES_AMT_02                                                                                   AS PRE_SALES_AMT_02
		      ,MMA.PRE_SALES_AMT_03                                                                                   AS PRE_SALES_AMT_03
		      ,MMA.PRE_SALES_AMT_04                                                                                   AS PRE_SALES_AMT_04
		      ,MMA.PRE_SALES_AMT_05                                                                                   AS PRE_SALES_AMT_05
		      ,MMA.PRE_SALES_AMT_06                                                                                   AS PRE_SALES_AMT_06
		      ,MMA.PRE_SALES_AMT_07                                                                                   AS PRE_SALES_AMT_07
		      ,MMA.PRE_SALES_AMT_08                                                                                   AS PRE_SALES_AMT_08
		      ,MMA.PRE_SALES_AMT_09                                                                                   AS PRE_SALES_AMT_09
		      ,MMA.PRE_SALES_AMT_10                                                                                   AS PRE_SALES_AMT_10
		      ,MMA.PRE_SALES_AMT_11                                                                                   AS PRE_SALES_AMT_11
		      ,MMA.PRE_SALES_AMT_12                                                                                   AS PRE_SALES_AMT_12
		      /* 전년매출이익액 */
		      ,MMA.PRE_SALES_PROFIT_AMT                                                                               AS PRE_SALES_PROFIT_AMT
		      ,MMA.PRE_SALES_PROFIT_AMT_01                                                                            AS PRE_SALES_PROFIT_AMT_01
		      ,MMA.PRE_SALES_PROFIT_AMT_02                                                                            AS PRE_SALES_PROFIT_AMT_02
		      ,MMA.PRE_SALES_PROFIT_AMT_03                                                                            AS PRE_SALES_PROFIT_AMT_03
		      ,MMA.PRE_SALES_PROFIT_AMT_04                                                                            AS PRE_SALES_PROFIT_AMT_04
		      ,MMA.PRE_SALES_PROFIT_AMT_05                                                                            AS PRE_SALES_PROFIT_AMT_05
		      ,MMA.PRE_SALES_PROFIT_AMT_06                                                                            AS PRE_SALES_PROFIT_AMT_06
		      ,MMA.PRE_SALES_PROFIT_AMT_07                                                                            AS PRE_SALES_PROFIT_AMT_07
		      ,MMA.PRE_SALES_PROFIT_AMT_08                                                                            AS PRE_SALES_PROFIT_AMT_08
		      ,MMA.PRE_SALES_PROFIT_AMT_09                                                                            AS PRE_SALES_PROFIT_AMT_09
		      ,MMA.PRE_SALES_PROFIT_AMT_10                                                                            AS PRE_SALES_PROFIT_AMT_10
		      ,MMA.PRE_SALES_PROFIT_AMT_11                                                                            AS PRE_SALES_PROFIT_AMT_11
		      ,MMA.PRE_SALES_PROFIT_AMT_12                                                                            AS PRE_SALES_PROFIT_AMT_12
		      /* 전년이익율 */
		      ,DECODE(MMA.PRE_SALES_AMT, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT/MMA.PRE_SALES_AMT*100,2))                    AS PRE_PROFIT_RATE
		      ,DECODE(MMA.PRE_SALES_AMT_01, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_01/MMA.PRE_SALES_AMT_01*100,2))                    AS PRE_PROFIT_RATE_01 
		      ,DECODE(MMA.PRE_SALES_AMT_02, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_02/MMA.PRE_SALES_AMT_02*100,2))                    AS PRE_PROFIT_RATE_02
		      ,DECODE(MMA.PRE_SALES_AMT_03, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_03/MMA.PRE_SALES_AMT_03*100,2))                    AS PRE_PROFIT_RATE_03 
		      ,DECODE(MMA.PRE_SALES_AMT_04, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_04/MMA.PRE_SALES_AMT_04*100,2))                    AS PRE_PROFIT_RATE_04  
		      ,DECODE(MMA.PRE_SALES_AMT_05, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_05/MMA.PRE_SALES_AMT_05*100,2))                    AS PRE_PROFIT_RATE_05 
		      ,DECODE(MMA.PRE_SALES_AMT_06, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_06/MMA.PRE_SALES_AMT_06*100,2))                    AS PRE_PROFIT_RATE_06 
		      ,DECODE(MMA.PRE_SALES_AMT_07, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_07/MMA.PRE_SALES_AMT_07*100,2))                    AS PRE_PROFIT_RATE_07 
		      ,DECODE(MMA.PRE_SALES_AMT_08, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_08/MMA.PRE_SALES_AMT_08*100,2))                    AS PRE_PROFIT_RATE_08 
		      ,DECODE(MMA.PRE_SALES_AMT_09, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_09/MMA.PRE_SALES_AMT_09*100,2))                    AS PRE_PROFIT_RATE_09 
		      ,DECODE(MMA.PRE_SALES_AMT_10, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_10/MMA.PRE_SALES_AMT_10*100,2))                    AS PRE_PROFIT_RATE_10 
		      ,DECODE(MMA.PRE_SALES_AMT_11, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_11/MMA.PRE_SALES_AMT_11*100,2))                    AS PRE_PROFIT_RATE_11 
		      ,DECODE(MMA.PRE_SALES_AMT_12, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_12/MMA.PRE_SALES_AMT_12*100,2))                    AS PRE_PROFIT_RATE_12  

          	  ,SUBSTR(MMA.ORG_CD, 1, 2)                                                 AS STR_CD
              ,SUBSTR(MMA.ORG_CD, 3, 2)                                                 AS DEPT_CD
              ,SUBSTR(MMA.ORG_CD, 5, 2)                                                 AS TEAM_CD
              ,SUBSTR(MMA.ORG_CD, 7, 2)                                                 AS PC_CD	
		      
		FROM (
		      SELECT RPAD(XA.STR_CD, 10, '00')           AS ORG_CD
		            ,GROUPING(XA.STR_CD)                  AS GROUP_ID
		            ,SUM(XA.PLAN_SALES_AMT)								AS PLAN_SALES_AMT
		            ,SUM(XA.PLAN_SALES_AMT_01)								AS PLAN_SALES_AMT_01
		            ,SUM(XA.PLAN_SALES_AMT_02)								AS PLAN_SALES_AMT_02
		            ,SUM(XA.PLAN_SALES_AMT_03)								AS PLAN_SALES_AMT_03
		            ,SUM(XA.PLAN_SALES_AMT_04)								AS PLAN_SALES_AMT_04
		            ,SUM(XA.PLAN_SALES_AMT_05)								AS PLAN_SALES_AMT_05
		            ,SUM(XA.PLAN_SALES_AMT_06)								AS PLAN_SALES_AMT_06
		            ,SUM(XA.PLAN_SALES_AMT_07)								AS PLAN_SALES_AMT_07
		            ,SUM(XA.PLAN_SALES_AMT_08)								AS PLAN_SALES_AMT_08
		            ,SUM(XA.PLAN_SALES_AMT_09)								AS PLAN_SALES_AMT_09
		            ,SUM(XA.PLAN_SALES_AMT_10)								AS PLAN_SALES_AMT_10
		            ,SUM(XA.PLAN_SALES_AMT_11)								AS PLAN_SALES_AMT_11
		            ,SUM(XA.PLAN_SALES_AMT_12)								AS PLAN_SALES_AMT_12
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT)								AS PLAN_SALES_PROFIT_AMT
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_01)								AS PLAN_SALES_PROFIT_AMT_01
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_02)								AS PLAN_SALES_PROFIT_AMT_02
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_03)								AS PLAN_SALES_PROFIT_AMT_03
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_04)								AS PLAN_SALES_PROFIT_AMT_04
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_05)								AS PLAN_SALES_PROFIT_AMT_05
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_06)								AS PLAN_SALES_PROFIT_AMT_06
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_07)								AS PLAN_SALES_PROFIT_AMT_07
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_08)								AS PLAN_SALES_PROFIT_AMT_08
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_09)								AS PLAN_SALES_PROFIT_AMT_09
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_10)								AS PLAN_SALES_PROFIT_AMT_10
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_11)								AS PLAN_SALES_PROFIT_AMT_11
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_12)								AS PLAN_SALES_PROFIT_AMT_12
		            ,SUM(XA.PRE_SALES_AMT)								AS PRE_SALES_AMT
		            ,SUM(XA.PRE_SALES_AMT_01)								AS PRE_SALES_AMT_01
		            ,SUM(XA.PRE_SALES_AMT_02)								AS PRE_SALES_AMT_02
		            ,SUM(XA.PRE_SALES_AMT_03)								AS PRE_SALES_AMT_03
		            ,SUM(XA.PRE_SALES_AMT_04)								AS PRE_SALES_AMT_04
		            ,SUM(XA.PRE_SALES_AMT_05)								AS PRE_SALES_AMT_05
		            ,SUM(XA.PRE_SALES_AMT_06)								AS PRE_SALES_AMT_06
		            ,SUM(XA.PRE_SALES_AMT_07)								AS PRE_SALES_AMT_07
		            ,SUM(XA.PRE_SALES_AMT_08)								AS PRE_SALES_AMT_08
		            ,SUM(XA.PRE_SALES_AMT_09)								AS PRE_SALES_AMT_09
		            ,SUM(XA.PRE_SALES_AMT_10)								AS PRE_SALES_AMT_10
		            ,SUM(XA.PRE_SALES_AMT_11)								AS PRE_SALES_AMT_11
		            ,SUM(XA.PRE_SALES_AMT_12)								AS PRE_SALES_AMT_12
		            ,SUM(XA.PRE_SALES_PROFIT_AMT)								AS PRE_SALES_PROFIT_AMT
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_01)								AS PRE_SALES_PROFIT_AMT_01
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_02)								AS PRE_SALES_PROFIT_AMT_02
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_03)								AS PRE_SALES_PROFIT_AMT_03
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_04)								AS PRE_SALES_PROFIT_AMT_04
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_05)								AS PRE_SALES_PROFIT_AMT_05
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_06)								AS PRE_SALES_PROFIT_AMT_06
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_07)								AS PRE_SALES_PROFIT_AMT_07
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_08)								AS PRE_SALES_PROFIT_AMT_08
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_09)								AS PRE_SALES_PROFIT_AMT_09
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_10)								AS PRE_SALES_PROFIT_AMT_10
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_11)								AS PRE_SALES_PROFIT_AMT_11
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_12)								AS PRE_SALES_PROFIT_AMT_12
		      FROM (
		            /* 계획 */
		            SELECT MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		                   /* 매출액 */
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '1'), MA.PLAN_AMT,0))                          AS PLAN_SALES_AMT
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_12                                         
		                   /* 매출액 */
		                                                             
		                   /* 매출이익액 */                                                 
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '3'), MA.PLAN_AMT,0))                          AS PLAN_SALES_PROFIT_AMT
		                                          
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_12
		                   /* 매출이익액 */
		                   
		                   ,0											AS PRE_SALES_AMT
		                   ,0											AS PRE_SALES_AMT_01
		                   ,0											AS PRE_SALES_AMT_02                                                 
		                   ,0											AS PRE_SALES_AMT_03                                                 
		                   ,0											AS PRE_SALES_AMT_04                                                 
		                   ,0											AS PRE_SALES_AMT_05                                                 
		                   ,0											AS PRE_SALES_AMT_06                                                 
		                   ,0											AS PRE_SALES_AMT_07                                                 
		                   ,0											AS PRE_SALES_AMT_08                                                 
		                   ,0											AS PRE_SALES_AMT_09                                                 
		                   ,0											AS PRE_SALES_AMT_10                                                 
		                   ,0											AS PRE_SALES_AMT_11                                                 
		                   ,0											AS PRE_SALES_AMT_12                                         
		                   ,0											AS PRE_SALES_PROFIT_AMT
		                   ,0											AS PRE_SALES_PROFIT_AMT_01
		                   ,0											AS PRE_SALES_PROFIT_AMT_02                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_03                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_04                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_05                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_06                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_07                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_08                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_09                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_10                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_11                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_12                                                   
		                                                                                                     
		            FROM (
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.BIZ_CD
		                         ,NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)   AS PLAN_AMT
		                         ,SUBSTR(RPT.BIZ_PLAN_YM, 5, 2)                   AS MONTH
		                  FROM MSS.ME_BIZPLANRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE IN ('1', '3')   /* 1:총매출, 3:매출이익 */
		                                AND A.REFER_CODE = RPT.BIZ_CD
		                               )
		                  AND RPT.BIZ_PLAN_YEAR = ?
		                  AND NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0) > 0
		                 ) MA
		            GROUP BY MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		            /* 계획 */
		                   
		            UNION ALL
		            
		            /* 전년실적 */
		            SELECT MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		                         
		                   ,0											AS PLAN_SALES_AMT
		                   ,0											AS PLAN_SALES_AMT_01
		                   ,0											AS PLAN_SALES_AMT_02                                                 
		                   ,0											AS PLAN_SALES_AMT_03                                                 
		                   ,0											AS PLAN_SALES_AMT_04                                                 
		                   ,0											AS PLAN_SALES_AMT_05                                                 
		                   ,0											AS PLAN_SALES_AMT_06                                                 
		                   ,0											AS PLAN_SALES_AMT_07                                                 
		                   ,0											AS PLAN_SALES_AMT_08                                                 
		                   ,0											AS PLAN_SALES_AMT_09                                                 
		                   ,0											AS PLAN_SALES_AMT_10                                                 
		                   ,0											AS PLAN_SALES_AMT_11                                                 
		                   ,0											AS PLAN_SALES_AMT_12                                         
		                   ,0											AS PLAN_SALES_PROFIT_AMT
		                   ,0											AS PLAN_SALES_PROFIT_AMT_01
		                   ,0											AS PLAN_SALES_PROFIT_AMT_02                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_03                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_04                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_05                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_06                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_07                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_08                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_09                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_10                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_11                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_12       
		                   
		                   /* 매출액 */
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '1'), MA.RSLT_AMT,0))                          AS PRE_SALES_AMT
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_12                                         
		                   /* 매출액 */
		                                                             
		                   /* 매출이익액 */                                                 
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '3'), MA.RSLT_AMT,0))                          AS PRE_SALES_PROFIT_AMT
		                                          
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_12
		                   /* 매출이익액 */                                                   
		                                                                                                      
		            FROM (
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.BIZ_CD
		                         ,NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0)   AS RSLT_AMT
		                         ,SUBSTR(RPT.BIZ_RSLT_YM, 5, 2)                   AS MONTH
		                  FROM MSS.ME_BIZRSLTRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE IN ('1', '3')   /* 1:총매출, 3:매출이익 */
		                                AND A.REFER_CODE = RPT.BIZ_CD
		                               )
		                  AND SUBSTR(RPT.BIZ_RSLT_YM,1,4) = TO_CHAR(TO_DATE(?, 'YYYY') + NUMTOYMINTERVAL (-1, 'year'), 'YYYY')
		                  AND NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0) > 0
		                 ) MA
		            GROUP BY MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		            /* 전년실적 */
		           ) XA
		      GROUP BY ROLLUP(XA.STR_CD)
		     ) MMA
		WHERE MMA.GROUP_ID NOT LIKE '%1%'    
    ]]>
    </query>    
    
    <!-- 팀별 매출계획조회 -->
    <query name="SEL_SALES_PLAN_TEAM">
    <![CDATA[
    	/*******
    	* 팀별 매출계획조회
    	*******/
		SELECT DECODE(GROUP_ID,'11', '',MMA.ORG_CD)                                                                            AS ORG_CD
		      ,DECODE(MMA.GROUP_ID, '11', '합계', (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD) ) AS ORG_NAME
		      ,DECODE(MMA.GROUP_ID, '11', '2', '0')                                                                            AS GROUP_ID
		      /* 계획매출액금 */
		      ,MMA.PLAN_SALES_AMT                                                                                     AS PLAN_SALES_AMT
		      ,MMA.PLAN_SALES_AMT_01                                                                                  AS PLAN_SALES_AMT_01
		      ,MMA.PLAN_SALES_AMT_02                                                                                  AS PLAN_SALES_AMT_02
		      ,MMA.PLAN_SALES_AMT_03                                                                                  AS PLAN_SALES_AMT_03
		      ,MMA.PLAN_SALES_AMT_04                                                                                  AS PLAN_SALES_AMT_04
		      ,MMA.PLAN_SALES_AMT_05                                                                                  AS PLAN_SALES_AMT_05
		      ,MMA.PLAN_SALES_AMT_06                                                                                  AS PLAN_SALES_AMT_06
		      ,MMA.PLAN_SALES_AMT_07                                                                                  AS PLAN_SALES_AMT_07
		      ,MMA.PLAN_SALES_AMT_08                                                                                  AS PLAN_SALES_AMT_08
		      ,MMA.PLAN_SALES_AMT_09                                                                                  AS PLAN_SALES_AMT_09
		      ,MMA.PLAN_SALES_AMT_10                                                                                  AS PLAN_SALES_AMT_10
		      ,MMA.PLAN_SALES_AMT_11                                                                                  AS PLAN_SALES_AMT_11
		      ,MMA.PLAN_SALES_AMT_12                                                                                  AS PLAN_SALES_AMT_12
		      /* 계획매출이익액 */
		      ,MMA.PLAN_SALES_PROFIT_AMT                                                                              AS PLAN_SALES_PROFIT_AMT                                                                              
		      ,MMA.PLAN_SALES_PROFIT_AMT_01                                                                           AS PLAN_SALES_PROFIT_AMT_01
		      ,MMA.PLAN_SALES_PROFIT_AMT_02                                                                           AS PLAN_SALES_PROFIT_AMT_02
		      ,MMA.PLAN_SALES_PROFIT_AMT_03                                                                           AS PLAN_SALES_PROFIT_AMT_03
		      ,MMA.PLAN_SALES_PROFIT_AMT_04                                                                           AS PLAN_SALES_PROFIT_AMT_04
		      ,MMA.PLAN_SALES_PROFIT_AMT_05                                                                           AS PLAN_SALES_PROFIT_AMT_05
		      ,MMA.PLAN_SALES_PROFIT_AMT_06                                                                           AS PLAN_SALES_PROFIT_AMT_06
		      ,MMA.PLAN_SALES_PROFIT_AMT_07                                                                           AS PLAN_SALES_PROFIT_AMT_07
		      ,MMA.PLAN_SALES_PROFIT_AMT_08                                                                           AS PLAN_SALES_PROFIT_AMT_08
		      ,MMA.PLAN_SALES_PROFIT_AMT_09                                                                           AS PLAN_SALES_PROFIT_AMT_09
		      ,MMA.PLAN_SALES_PROFIT_AMT_10                                                                           AS PLAN_SALES_PROFIT_AMT_10
		      ,MMA.PLAN_SALES_PROFIT_AMT_11                                                                           AS PLAN_SALES_PROFIT_AMT_11
		      ,MMA.PLAN_SALES_PROFIT_AMT_12                                                                           AS PLAN_SALES_PROFIT_AMT_12
		      /* 계획이익율 */
		      ,DECODE(MMA.PLAN_SALES_AMT, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_AMT*100,2))                    AS PLAN_PROFIT_RATE
		      ,DECODE(MMA.PLAN_SALES_AMT_01, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_01/MMA.PLAN_SALES_AMT_01*100,2))                    AS PLAN_PROFIT_RATE_01 
		      ,DECODE(MMA.PLAN_SALES_AMT_02, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_02/MMA.PLAN_SALES_AMT_02*100,2))                    AS PLAN_PROFIT_RATE_02
		      ,DECODE(MMA.PLAN_SALES_AMT_03, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_03/MMA.PLAN_SALES_AMT_03*100,2))                    AS PLAN_PROFIT_RATE_03 
		      ,DECODE(MMA.PLAN_SALES_AMT_04, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_04/MMA.PLAN_SALES_AMT_04*100,2))                    AS PLAN_PROFIT_RATE_04  
		      ,DECODE(MMA.PLAN_SALES_AMT_05, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_05/MMA.PLAN_SALES_AMT_05*100,2))                    AS PLAN_PROFIT_RATE_05 
		      ,DECODE(MMA.PLAN_SALES_AMT_06, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_06/MMA.PLAN_SALES_AMT_06*100,2))                    AS PLAN_PROFIT_RATE_06 
		      ,DECODE(MMA.PLAN_SALES_AMT_07, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_07/MMA.PLAN_SALES_AMT_07*100,2))                    AS PLAN_PROFIT_RATE_07 
		      ,DECODE(MMA.PLAN_SALES_AMT_08, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_08/MMA.PLAN_SALES_AMT_08*100,2))                    AS PLAN_PROFIT_RATE_08 
		      ,DECODE(MMA.PLAN_SALES_AMT_09, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_09/MMA.PLAN_SALES_AMT_09*100,2))                    AS PLAN_PROFIT_RATE_09 
		      ,DECODE(MMA.PLAN_SALES_AMT_10, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_10/MMA.PLAN_SALES_AMT_10*100,2))                    AS PLAN_PROFIT_RATE_10 
		      ,DECODE(MMA.PLAN_SALES_AMT_11, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_11/MMA.PLAN_SALES_AMT_11*100,2))                    AS PLAN_PROFIT_RATE_11 
		      ,DECODE(MMA.PLAN_SALES_AMT_12, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_12/MMA.PLAN_SALES_AMT_12*100,2))                    AS PLAN_PROFIT_RATE_12  
		      /* 전년매출액 */      
		      ,MMA.PRE_SALES_AMT                                                                                      AS PRE_SALES_AMT
		      ,MMA.PRE_SALES_AMT_01                                                                                   AS PRE_SALES_AMT_01
		      ,MMA.PRE_SALES_AMT_02                                                                                   AS PRE_SALES_AMT_02
		      ,MMA.PRE_SALES_AMT_03                                                                                   AS PRE_SALES_AMT_03
		      ,MMA.PRE_SALES_AMT_04                                                                                   AS PRE_SALES_AMT_04
		      ,MMA.PRE_SALES_AMT_05                                                                                   AS PRE_SALES_AMT_05
		      ,MMA.PRE_SALES_AMT_06                                                                                   AS PRE_SALES_AMT_06
		      ,MMA.PRE_SALES_AMT_07                                                                                   AS PRE_SALES_AMT_07
		      ,MMA.PRE_SALES_AMT_08                                                                                   AS PRE_SALES_AMT_08
		      ,MMA.PRE_SALES_AMT_09                                                                                   AS PRE_SALES_AMT_09
		      ,MMA.PRE_SALES_AMT_10                                                                                   AS PRE_SALES_AMT_10
		      ,MMA.PRE_SALES_AMT_11                                                                                   AS PRE_SALES_AMT_11
		      ,MMA.PRE_SALES_AMT_12                                                                                   AS PRE_SALES_AMT_12
		      /* 전년매출이익액 */
		      ,MMA.PRE_SALES_PROFIT_AMT                                                                               AS PRE_SALES_PROFIT_AMT
		      ,MMA.PRE_SALES_PROFIT_AMT_01                                                                            AS PRE_SALES_PROFIT_AMT_01
		      ,MMA.PRE_SALES_PROFIT_AMT_02                                                                            AS PRE_SALES_PROFIT_AMT_02
		      ,MMA.PRE_SALES_PROFIT_AMT_03                                                                            AS PRE_SALES_PROFIT_AMT_03
		      ,MMA.PRE_SALES_PROFIT_AMT_04                                                                            AS PRE_SALES_PROFIT_AMT_04
		      ,MMA.PRE_SALES_PROFIT_AMT_05                                                                            AS PRE_SALES_PROFIT_AMT_05
		      ,MMA.PRE_SALES_PROFIT_AMT_06                                                                            AS PRE_SALES_PROFIT_AMT_06
		      ,MMA.PRE_SALES_PROFIT_AMT_07                                                                            AS PRE_SALES_PROFIT_AMT_07
		      ,MMA.PRE_SALES_PROFIT_AMT_08                                                                            AS PRE_SALES_PROFIT_AMT_08
		      ,MMA.PRE_SALES_PROFIT_AMT_09                                                                            AS PRE_SALES_PROFIT_AMT_09
		      ,MMA.PRE_SALES_PROFIT_AMT_10                                                                            AS PRE_SALES_PROFIT_AMT_10
		      ,MMA.PRE_SALES_PROFIT_AMT_11                                                                            AS PRE_SALES_PROFIT_AMT_11
		      ,MMA.PRE_SALES_PROFIT_AMT_12                                                                            AS PRE_SALES_PROFIT_AMT_12
		      /* 전년이익율 */
		      ,DECODE(MMA.PRE_SALES_AMT, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT/MMA.PRE_SALES_AMT*100,2))                    AS PRE_PROFIT_RATE
		      ,DECODE(MMA.PRE_SALES_AMT_01, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_01/MMA.PRE_SALES_AMT_01*100,2))                    AS PRE_PROFIT_RATE_01 
		      ,DECODE(MMA.PRE_SALES_AMT_02, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_02/MMA.PRE_SALES_AMT_02*100,2))                    AS PRE_PROFIT_RATE_02
		      ,DECODE(MMA.PRE_SALES_AMT_03, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_03/MMA.PRE_SALES_AMT_03*100,2))                    AS PRE_PROFIT_RATE_03 
		      ,DECODE(MMA.PRE_SALES_AMT_04, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_04/MMA.PRE_SALES_AMT_04*100,2))                    AS PRE_PROFIT_RATE_04  
		      ,DECODE(MMA.PRE_SALES_AMT_05, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_05/MMA.PRE_SALES_AMT_05*100,2))                    AS PRE_PROFIT_RATE_05 
		      ,DECODE(MMA.PRE_SALES_AMT_06, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_06/MMA.PRE_SALES_AMT_06*100,2))                    AS PRE_PROFIT_RATE_06 
		      ,DECODE(MMA.PRE_SALES_AMT_07, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_07/MMA.PRE_SALES_AMT_07*100,2))                    AS PRE_PROFIT_RATE_07 
		      ,DECODE(MMA.PRE_SALES_AMT_08, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_08/MMA.PRE_SALES_AMT_08*100,2))                    AS PRE_PROFIT_RATE_08 
		      ,DECODE(MMA.PRE_SALES_AMT_09, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_09/MMA.PRE_SALES_AMT_09*100,2))                    AS PRE_PROFIT_RATE_09 
		      ,DECODE(MMA.PRE_SALES_AMT_10, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_10/MMA.PRE_SALES_AMT_10*100,2))                    AS PRE_PROFIT_RATE_10 
		      ,DECODE(MMA.PRE_SALES_AMT_11, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_11/MMA.PRE_SALES_AMT_11*100,2))                    AS PRE_PROFIT_RATE_11 
		      ,DECODE(MMA.PRE_SALES_AMT_12, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_12/MMA.PRE_SALES_AMT_12*100,2))                    AS PRE_PROFIT_RATE_12  

          	  ,SUBSTR(MMA.ORG_CD, 1, 2)                                                 AS STR_CD
              ,SUBSTR(MMA.ORG_CD, 3, 2)                                                 AS DEPT_CD
              ,SUBSTR(MMA.ORG_CD, 5, 2)                                                 AS TEAM_CD
              ,SUBSTR(MMA.ORG_CD, 7, 2)                                                 AS PC_CD	
		      
		FROM (
		      SELECT RPAD(XA.STR_CD||XA.DEPT_CD||XA.TEAM_CD, 10, '00')           AS ORG_CD
		            ,GROUPING(XA.DEPT_CD)||GROUPING(XA.TEAM_CD)                  AS GROUP_ID
		            ,SUM(XA.PLAN_SALES_AMT)								AS PLAN_SALES_AMT
		            ,SUM(XA.PLAN_SALES_AMT_01)								AS PLAN_SALES_AMT_01
		            ,SUM(XA.PLAN_SALES_AMT_02)								AS PLAN_SALES_AMT_02
		            ,SUM(XA.PLAN_SALES_AMT_03)								AS PLAN_SALES_AMT_03
		            ,SUM(XA.PLAN_SALES_AMT_04)								AS PLAN_SALES_AMT_04
		            ,SUM(XA.PLAN_SALES_AMT_05)								AS PLAN_SALES_AMT_05
		            ,SUM(XA.PLAN_SALES_AMT_06)								AS PLAN_SALES_AMT_06
		            ,SUM(XA.PLAN_SALES_AMT_07)								AS PLAN_SALES_AMT_07
		            ,SUM(XA.PLAN_SALES_AMT_08)								AS PLAN_SALES_AMT_08
		            ,SUM(XA.PLAN_SALES_AMT_09)								AS PLAN_SALES_AMT_09
		            ,SUM(XA.PLAN_SALES_AMT_10)								AS PLAN_SALES_AMT_10
		            ,SUM(XA.PLAN_SALES_AMT_11)								AS PLAN_SALES_AMT_11
		            ,SUM(XA.PLAN_SALES_AMT_12)								AS PLAN_SALES_AMT_12
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT)								AS PLAN_SALES_PROFIT_AMT
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_01)								AS PLAN_SALES_PROFIT_AMT_01
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_02)								AS PLAN_SALES_PROFIT_AMT_02
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_03)								AS PLAN_SALES_PROFIT_AMT_03
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_04)								AS PLAN_SALES_PROFIT_AMT_04
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_05)								AS PLAN_SALES_PROFIT_AMT_05
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_06)								AS PLAN_SALES_PROFIT_AMT_06
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_07)								AS PLAN_SALES_PROFIT_AMT_07
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_08)								AS PLAN_SALES_PROFIT_AMT_08
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_09)								AS PLAN_SALES_PROFIT_AMT_09
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_10)								AS PLAN_SALES_PROFIT_AMT_10
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_11)								AS PLAN_SALES_PROFIT_AMT_11
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_12)								AS PLAN_SALES_PROFIT_AMT_12
		            ,SUM(XA.PRE_SALES_AMT)								AS PRE_SALES_AMT
		            ,SUM(XA.PRE_SALES_AMT_01)								AS PRE_SALES_AMT_01
		            ,SUM(XA.PRE_SALES_AMT_02)								AS PRE_SALES_AMT_02
		            ,SUM(XA.PRE_SALES_AMT_03)								AS PRE_SALES_AMT_03
		            ,SUM(XA.PRE_SALES_AMT_04)								AS PRE_SALES_AMT_04
		            ,SUM(XA.PRE_SALES_AMT_05)								AS PRE_SALES_AMT_05
		            ,SUM(XA.PRE_SALES_AMT_06)								AS PRE_SALES_AMT_06
		            ,SUM(XA.PRE_SALES_AMT_07)								AS PRE_SALES_AMT_07
		            ,SUM(XA.PRE_SALES_AMT_08)								AS PRE_SALES_AMT_08
		            ,SUM(XA.PRE_SALES_AMT_09)								AS PRE_SALES_AMT_09
		            ,SUM(XA.PRE_SALES_AMT_10)								AS PRE_SALES_AMT_10
		            ,SUM(XA.PRE_SALES_AMT_11)								AS PRE_SALES_AMT_11
		            ,SUM(XA.PRE_SALES_AMT_12)								AS PRE_SALES_AMT_12
		            ,SUM(XA.PRE_SALES_PROFIT_AMT)								AS PRE_SALES_PROFIT_AMT
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_01)								AS PRE_SALES_PROFIT_AMT_01
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_02)								AS PRE_SALES_PROFIT_AMT_02
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_03)								AS PRE_SALES_PROFIT_AMT_03
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_04)								AS PRE_SALES_PROFIT_AMT_04
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_05)								AS PRE_SALES_PROFIT_AMT_05
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_06)								AS PRE_SALES_PROFIT_AMT_06
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_07)								AS PRE_SALES_PROFIT_AMT_07
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_08)								AS PRE_SALES_PROFIT_AMT_08
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_09)								AS PRE_SALES_PROFIT_AMT_09
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_10)								AS PRE_SALES_PROFIT_AMT_10
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_11)								AS PRE_SALES_PROFIT_AMT_11
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_12)								AS PRE_SALES_PROFIT_AMT_12
		      FROM (
		            /* 계획 */
		            SELECT MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		                   /* 매출액 */
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '1'), MA.PLAN_AMT,0))                          AS PLAN_SALES_AMT
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_12                                         
		                   /* 매출액 */
		                                                             
		                   /* 매출이익액 */                                                 
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '3'), MA.PLAN_AMT,0))                          AS PLAN_SALES_PROFIT_AMT
		                                          
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_12
		                   /* 매출이익액 */
		                   
		                   ,0											AS PRE_SALES_AMT
		                   ,0											AS PRE_SALES_AMT_01
		                   ,0											AS PRE_SALES_AMT_02                                                 
		                   ,0											AS PRE_SALES_AMT_03                                                 
		                   ,0											AS PRE_SALES_AMT_04                                                 
		                   ,0											AS PRE_SALES_AMT_05                                                 
		                   ,0											AS PRE_SALES_AMT_06                                                 
		                   ,0											AS PRE_SALES_AMT_07                                                 
		                   ,0											AS PRE_SALES_AMT_08                                                 
		                   ,0											AS PRE_SALES_AMT_09                                                 
		                   ,0											AS PRE_SALES_AMT_10                                                 
		                   ,0											AS PRE_SALES_AMT_11                                                 
		                   ,0											AS PRE_SALES_AMT_12                                         
		                   ,0											AS PRE_SALES_PROFIT_AMT
		                   ,0											AS PRE_SALES_PROFIT_AMT_01
		                   ,0											AS PRE_SALES_PROFIT_AMT_02                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_03                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_04                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_05                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_06                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_07                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_08                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_09                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_10                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_11                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_12                                                   
		                                                                                                     
		            FROM (
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.BIZ_CD
		                         ,NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)   AS PLAN_AMT
		                         ,SUBSTR(RPT.BIZ_PLAN_YM, 5, 2)                   AS MONTH
		                  FROM MSS.ME_BIZPLANRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE IN ('1', '3')   /* 1:총매출, 3:매출이익 */
		                                AND A.REFER_CODE = RPT.BIZ_CD
		                               )
		                  AND RPT.BIZ_PLAN_YEAR = ?
		                  AND NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0) > 0
		                 ) MA
		            GROUP BY MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		            /* 계획 */
		                   
		            UNION ALL
		            
		            /* 전년실적 */
		            SELECT MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		                         
		                   ,0											AS PLAN_SALES_AMT
		                   ,0											AS PLAN_SALES_AMT_01
		                   ,0											AS PLAN_SALES_AMT_02                                                 
		                   ,0											AS PLAN_SALES_AMT_03                                                 
		                   ,0											AS PLAN_SALES_AMT_04                                                 
		                   ,0											AS PLAN_SALES_AMT_05                                                 
		                   ,0											AS PLAN_SALES_AMT_06                                                 
		                   ,0											AS PLAN_SALES_AMT_07                                                 
		                   ,0											AS PLAN_SALES_AMT_08                                                 
		                   ,0											AS PLAN_SALES_AMT_09                                                 
		                   ,0											AS PLAN_SALES_AMT_10                                                 
		                   ,0											AS PLAN_SALES_AMT_11                                                 
		                   ,0											AS PLAN_SALES_AMT_12                                         
		                   ,0											AS PLAN_SALES_PROFIT_AMT
		                   ,0											AS PLAN_SALES_PROFIT_AMT_01
		                   ,0											AS PLAN_SALES_PROFIT_AMT_02                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_03                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_04                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_05                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_06                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_07                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_08                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_09                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_10                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_11                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_12       
		                   
		                   /* 매출액 */
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '1'), MA.RSLT_AMT,0))                          AS PRE_SALES_AMT
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_12                                         
		                   /* 매출액 */
		                                                             
		                   /* 매출이익액 */                                                 
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '3'), MA.RSLT_AMT,0))                          AS PRE_SALES_PROFIT_AMT
		                                          
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_12
		                   /* 매출이익액 */                                                   
		                                                                                                      
		            FROM (
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.BIZ_CD
		                         ,NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0)   AS RSLT_AMT
		                         ,SUBSTR(RPT.BIZ_RSLT_YM, 5, 2)                   AS MONTH
		                  FROM MSS.ME_BIZRSLTRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE IN ('1', '3')   /* 1:총매출, 3:매출이익 */
		                                AND A.REFER_CODE = RPT.BIZ_CD
		                               )
		                  AND SUBSTR(RPT.BIZ_RSLT_YM,1,4) = TO_CHAR(TO_DATE(?, 'YYYY') + NUMTOYMINTERVAL (-1, 'year'), 'YYYY')
		                  AND NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0) > 0
		                 ) MA
		            GROUP BY MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		            /* 전년실적 */
		           ) XA
		      WHERE XA.STR_CD = ?
		      GROUP BY XA.STR_CD, ROLLUP(XA.DEPT_CD, XA.TEAM_CD)
		     ) MMA
		--WHERE MMA.GROUP_ID != '01'  
		WHERE MMA.GROUP_ID NOT LIKE '%1%'		  
    ]]>
    </query> 
    
    <!-- PC별 매출계획조회 -->
    <query name="SEL_SALES_PLAN_PC">
    <![CDATA[
    	/*******
    	* PC별 매출계획조회
    	*******/
		SELECT DECODE(GROUP_ID,'000', MMA.ORG_CD, '')                                                                           AS ORG_CD
		      ,DECODE(MMA.GROUP_ID, '111', '합계'
		                          ,'001', (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD)|| ' 소계' 
		                          ,(SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD))                 AS ORG_NAME
		      ,DECODE(MMA.GROUP_ID, '111', '2', '000', '0', '1')                                                                             AS GROUP_ID
		      /* 계획매출액금 */
		      ,MMA.PLAN_SALES_AMT                                                                                     AS PLAN_SALES_AMT
		      ,MMA.PLAN_SALES_AMT_01                                                                                  AS PLAN_SALES_AMT_01
		      ,MMA.PLAN_SALES_AMT_02                                                                                  AS PLAN_SALES_AMT_02
		      ,MMA.PLAN_SALES_AMT_03                                                                                  AS PLAN_SALES_AMT_03
		      ,MMA.PLAN_SALES_AMT_04                                                                                  AS PLAN_SALES_AMT_04
		      ,MMA.PLAN_SALES_AMT_05                                                                                  AS PLAN_SALES_AMT_05
		      ,MMA.PLAN_SALES_AMT_06                                                                                  AS PLAN_SALES_AMT_06
		      ,MMA.PLAN_SALES_AMT_07                                                                                  AS PLAN_SALES_AMT_07
		      ,MMA.PLAN_SALES_AMT_08                                                                                  AS PLAN_SALES_AMT_08
		      ,MMA.PLAN_SALES_AMT_09                                                                                  AS PLAN_SALES_AMT_09
		      ,MMA.PLAN_SALES_AMT_10                                                                                  AS PLAN_SALES_AMT_10
		      ,MMA.PLAN_SALES_AMT_11                                                                                  AS PLAN_SALES_AMT_11
		      ,MMA.PLAN_SALES_AMT_12                                                                                  AS PLAN_SALES_AMT_12
		      /* 계획매출이익액 */
		      ,MMA.PLAN_SALES_PROFIT_AMT                                                                              AS PLAN_SALES_PROFIT_AMT                                                                              
		      ,MMA.PLAN_SALES_PROFIT_AMT_01                                                                           AS PLAN_SALES_PROFIT_AMT_01
		      ,MMA.PLAN_SALES_PROFIT_AMT_02                                                                           AS PLAN_SALES_PROFIT_AMT_02
		      ,MMA.PLAN_SALES_PROFIT_AMT_03                                                                           AS PLAN_SALES_PROFIT_AMT_03
		      ,MMA.PLAN_SALES_PROFIT_AMT_04                                                                           AS PLAN_SALES_PROFIT_AMT_04
		      ,MMA.PLAN_SALES_PROFIT_AMT_05                                                                           AS PLAN_SALES_PROFIT_AMT_05
		      ,MMA.PLAN_SALES_PROFIT_AMT_06                                                                           AS PLAN_SALES_PROFIT_AMT_06
		      ,MMA.PLAN_SALES_PROFIT_AMT_07                                                                           AS PLAN_SALES_PROFIT_AMT_07
		      ,MMA.PLAN_SALES_PROFIT_AMT_08                                                                           AS PLAN_SALES_PROFIT_AMT_08
		      ,MMA.PLAN_SALES_PROFIT_AMT_09                                                                           AS PLAN_SALES_PROFIT_AMT_09
		      ,MMA.PLAN_SALES_PROFIT_AMT_10                                                                           AS PLAN_SALES_PROFIT_AMT_10
		      ,MMA.PLAN_SALES_PROFIT_AMT_11                                                                           AS PLAN_SALES_PROFIT_AMT_11
		      ,MMA.PLAN_SALES_PROFIT_AMT_12                                                                           AS PLAN_SALES_PROFIT_AMT_12
		      /* 계획이익율 */
		      ,DECODE(MMA.PLAN_SALES_AMT, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_AMT*100,2))                    AS PLAN_PROFIT_RATE
		      ,DECODE(MMA.PLAN_SALES_AMT_01, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_01/MMA.PLAN_SALES_AMT_01*100,2))                    AS PLAN_PROFIT_RATE_01 
		      ,DECODE(MMA.PLAN_SALES_AMT_02, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_02/MMA.PLAN_SALES_AMT_02*100,2))                    AS PLAN_PROFIT_RATE_02
		      ,DECODE(MMA.PLAN_SALES_AMT_03, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_03/MMA.PLAN_SALES_AMT_03*100,2))                    AS PLAN_PROFIT_RATE_03 
		      ,DECODE(MMA.PLAN_SALES_AMT_04, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_04/MMA.PLAN_SALES_AMT_04*100,2))                    AS PLAN_PROFIT_RATE_04  
		      ,DECODE(MMA.PLAN_SALES_AMT_05, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_05/MMA.PLAN_SALES_AMT_05*100,2))                    AS PLAN_PROFIT_RATE_05 
		      ,DECODE(MMA.PLAN_SALES_AMT_06, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_06/MMA.PLAN_SALES_AMT_06*100,2))                    AS PLAN_PROFIT_RATE_06 
		      ,DECODE(MMA.PLAN_SALES_AMT_07, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_07/MMA.PLAN_SALES_AMT_07*100,2))                    AS PLAN_PROFIT_RATE_07 
		      ,DECODE(MMA.PLAN_SALES_AMT_08, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_08/MMA.PLAN_SALES_AMT_08*100,2))                    AS PLAN_PROFIT_RATE_08 
		      ,DECODE(MMA.PLAN_SALES_AMT_09, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_09/MMA.PLAN_SALES_AMT_09*100,2))                    AS PLAN_PROFIT_RATE_09 
		      ,DECODE(MMA.PLAN_SALES_AMT_10, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_10/MMA.PLAN_SALES_AMT_10*100,2))                    AS PLAN_PROFIT_RATE_10 
		      ,DECODE(MMA.PLAN_SALES_AMT_11, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_11/MMA.PLAN_SALES_AMT_11*100,2))                    AS PLAN_PROFIT_RATE_11 
		      ,DECODE(MMA.PLAN_SALES_AMT_12, 0, 0, ROUND(MMA.PLAN_SALES_PROFIT_AMT_12/MMA.PLAN_SALES_AMT_12*100,2))                    AS PLAN_PROFIT_RATE_12  
		      /* 전년매출액 */      
		      ,MMA.PRE_SALES_AMT                                                                                      AS PRE_SALES_AMT
		      ,MMA.PRE_SALES_AMT_01                                                                                   AS PRE_SALES_AMT_01
		      ,MMA.PRE_SALES_AMT_02                                                                                   AS PRE_SALES_AMT_02
		      ,MMA.PRE_SALES_AMT_03                                                                                   AS PRE_SALES_AMT_03
		      ,MMA.PRE_SALES_AMT_04                                                                                   AS PRE_SALES_AMT_04
		      ,MMA.PRE_SALES_AMT_05                                                                                   AS PRE_SALES_AMT_05
		      ,MMA.PRE_SALES_AMT_06                                                                                   AS PRE_SALES_AMT_06
		      ,MMA.PRE_SALES_AMT_07                                                                                   AS PRE_SALES_AMT_07
		      ,MMA.PRE_SALES_AMT_08                                                                                   AS PRE_SALES_AMT_08
		      ,MMA.PRE_SALES_AMT_09                                                                                   AS PRE_SALES_AMT_09
		      ,MMA.PRE_SALES_AMT_10                                                                                   AS PRE_SALES_AMT_10
		      ,MMA.PRE_SALES_AMT_11                                                                                   AS PRE_SALES_AMT_11
		      ,MMA.PRE_SALES_AMT_12                                                                                   AS PRE_SALES_AMT_12
		      /* 전년매출이익액 */
		      ,MMA.PRE_SALES_PROFIT_AMT                                                                               AS PRE_SALES_PROFIT_AMT
		      ,MMA.PRE_SALES_PROFIT_AMT_01                                                                            AS PRE_SALES_PROFIT_AMT_01
		      ,MMA.PRE_SALES_PROFIT_AMT_02                                                                            AS PRE_SALES_PROFIT_AMT_02
		      ,MMA.PRE_SALES_PROFIT_AMT_03                                                                            AS PRE_SALES_PROFIT_AMT_03
		      ,MMA.PRE_SALES_PROFIT_AMT_04                                                                            AS PRE_SALES_PROFIT_AMT_04
		      ,MMA.PRE_SALES_PROFIT_AMT_05                                                                            AS PRE_SALES_PROFIT_AMT_05
		      ,MMA.PRE_SALES_PROFIT_AMT_06                                                                            AS PRE_SALES_PROFIT_AMT_06
		      ,MMA.PRE_SALES_PROFIT_AMT_07                                                                            AS PRE_SALES_PROFIT_AMT_07
		      ,MMA.PRE_SALES_PROFIT_AMT_08                                                                            AS PRE_SALES_PROFIT_AMT_08
		      ,MMA.PRE_SALES_PROFIT_AMT_09                                                                            AS PRE_SALES_PROFIT_AMT_09
		      ,MMA.PRE_SALES_PROFIT_AMT_10                                                                            AS PRE_SALES_PROFIT_AMT_10
		      ,MMA.PRE_SALES_PROFIT_AMT_11                                                                            AS PRE_SALES_PROFIT_AMT_11
		      ,MMA.PRE_SALES_PROFIT_AMT_12                                                                            AS PRE_SALES_PROFIT_AMT_12
		      /* 전년이익율 */
		      ,DECODE(MMA.PRE_SALES_AMT, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT/MMA.PRE_SALES_AMT*100,2))                    AS PRE_PROFIT_RATE
		      ,DECODE(MMA.PRE_SALES_AMT_01, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_01/MMA.PRE_SALES_AMT_01*100,2))                    AS PRE_PROFIT_RATE_01 
		      ,DECODE(MMA.PRE_SALES_AMT_02, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_02/MMA.PRE_SALES_AMT_02*100,2))                    AS PRE_PROFIT_RATE_02
		      ,DECODE(MMA.PRE_SALES_AMT_03, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_03/MMA.PRE_SALES_AMT_03*100,2))                    AS PRE_PROFIT_RATE_03 
		      ,DECODE(MMA.PRE_SALES_AMT_04, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_04/MMA.PRE_SALES_AMT_04*100,2))                    AS PRE_PROFIT_RATE_04  
		      ,DECODE(MMA.PRE_SALES_AMT_05, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_05/MMA.PRE_SALES_AMT_05*100,2))                    AS PRE_PROFIT_RATE_05 
		      ,DECODE(MMA.PRE_SALES_AMT_06, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_06/MMA.PRE_SALES_AMT_06*100,2))                    AS PRE_PROFIT_RATE_06 
		      ,DECODE(MMA.PRE_SALES_AMT_07, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_07/MMA.PRE_SALES_AMT_07*100,2))                    AS PRE_PROFIT_RATE_07 
		      ,DECODE(MMA.PRE_SALES_AMT_08, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_08/MMA.PRE_SALES_AMT_08*100,2))                    AS PRE_PROFIT_RATE_08 
		      ,DECODE(MMA.PRE_SALES_AMT_09, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_09/MMA.PRE_SALES_AMT_09*100,2))                    AS PRE_PROFIT_RATE_09 
		      ,DECODE(MMA.PRE_SALES_AMT_10, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_10/MMA.PRE_SALES_AMT_10*100,2))                    AS PRE_PROFIT_RATE_10 
		      ,DECODE(MMA.PRE_SALES_AMT_11, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_11/MMA.PRE_SALES_AMT_11*100,2))                    AS PRE_PROFIT_RATE_11 
		      ,DECODE(MMA.PRE_SALES_AMT_12, 0, 0, ROUND(MMA.PRE_SALES_PROFIT_AMT_12/MMA.PRE_SALES_AMT_12*100,2))                    AS PRE_PROFIT_RATE_12  

          	  ,SUBSTR(MMA.ORG_CD, 1, 2)                                                 AS STR_CD
              ,SUBSTR(MMA.ORG_CD, 3, 2)                                                 AS DEPT_CD
              ,SUBSTR(MMA.ORG_CD, 5, 2)                                                 AS TEAM_CD
              ,SUBSTR(MMA.ORG_CD, 7, 2)                                                 AS PC_CD	
		      
		FROM (
		      SELECT RPAD(XA.STR_CD||XA.DEPT_CD||XA.TEAM_CD||XA.PC_CD, 10, '00')           AS ORG_CD
		            ,GROUPING(XA.DEPT_CD)||GROUPING(XA.TEAM_CD)||GROUPING(XA.PC_CD)                  AS GROUP_ID
		            ,SUM(XA.PLAN_SALES_AMT)								AS PLAN_SALES_AMT
		            ,SUM(XA.PLAN_SALES_AMT_01)								AS PLAN_SALES_AMT_01
		            ,SUM(XA.PLAN_SALES_AMT_02)								AS PLAN_SALES_AMT_02
		            ,SUM(XA.PLAN_SALES_AMT_03)								AS PLAN_SALES_AMT_03
		            ,SUM(XA.PLAN_SALES_AMT_04)								AS PLAN_SALES_AMT_04
		            ,SUM(XA.PLAN_SALES_AMT_05)								AS PLAN_SALES_AMT_05
		            ,SUM(XA.PLAN_SALES_AMT_06)								AS PLAN_SALES_AMT_06
		            ,SUM(XA.PLAN_SALES_AMT_07)								AS PLAN_SALES_AMT_07
		            ,SUM(XA.PLAN_SALES_AMT_08)								AS PLAN_SALES_AMT_08
		            ,SUM(XA.PLAN_SALES_AMT_09)								AS PLAN_SALES_AMT_09
		            ,SUM(XA.PLAN_SALES_AMT_10)								AS PLAN_SALES_AMT_10
		            ,SUM(XA.PLAN_SALES_AMT_11)								AS PLAN_SALES_AMT_11
		            ,SUM(XA.PLAN_SALES_AMT_12)								AS PLAN_SALES_AMT_12
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT)								AS PLAN_SALES_PROFIT_AMT
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_01)								AS PLAN_SALES_PROFIT_AMT_01
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_02)								AS PLAN_SALES_PROFIT_AMT_02
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_03)								AS PLAN_SALES_PROFIT_AMT_03
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_04)								AS PLAN_SALES_PROFIT_AMT_04
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_05)								AS PLAN_SALES_PROFIT_AMT_05
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_06)								AS PLAN_SALES_PROFIT_AMT_06
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_07)								AS PLAN_SALES_PROFIT_AMT_07
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_08)								AS PLAN_SALES_PROFIT_AMT_08
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_09)								AS PLAN_SALES_PROFIT_AMT_09
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_10)								AS PLAN_SALES_PROFIT_AMT_10
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_11)								AS PLAN_SALES_PROFIT_AMT_11
		            ,SUM(XA.PLAN_SALES_PROFIT_AMT_12)								AS PLAN_SALES_PROFIT_AMT_12
		            ,SUM(XA.PRE_SALES_AMT)								AS PRE_SALES_AMT
		            ,SUM(XA.PRE_SALES_AMT_01)								AS PRE_SALES_AMT_01
		            ,SUM(XA.PRE_SALES_AMT_02)								AS PRE_SALES_AMT_02
		            ,SUM(XA.PRE_SALES_AMT_03)								AS PRE_SALES_AMT_03
		            ,SUM(XA.PRE_SALES_AMT_04)								AS PRE_SALES_AMT_04
		            ,SUM(XA.PRE_SALES_AMT_05)								AS PRE_SALES_AMT_05
		            ,SUM(XA.PRE_SALES_AMT_06)								AS PRE_SALES_AMT_06
		            ,SUM(XA.PRE_SALES_AMT_07)								AS PRE_SALES_AMT_07
		            ,SUM(XA.PRE_SALES_AMT_08)								AS PRE_SALES_AMT_08
		            ,SUM(XA.PRE_SALES_AMT_09)								AS PRE_SALES_AMT_09
		            ,SUM(XA.PRE_SALES_AMT_10)								AS PRE_SALES_AMT_10
		            ,SUM(XA.PRE_SALES_AMT_11)								AS PRE_SALES_AMT_11
		            ,SUM(XA.PRE_SALES_AMT_12)								AS PRE_SALES_AMT_12
		            ,SUM(XA.PRE_SALES_PROFIT_AMT)								AS PRE_SALES_PROFIT_AMT
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_01)								AS PRE_SALES_PROFIT_AMT_01
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_02)								AS PRE_SALES_PROFIT_AMT_02
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_03)								AS PRE_SALES_PROFIT_AMT_03
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_04)								AS PRE_SALES_PROFIT_AMT_04
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_05)								AS PRE_SALES_PROFIT_AMT_05
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_06)								AS PRE_SALES_PROFIT_AMT_06
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_07)								AS PRE_SALES_PROFIT_AMT_07
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_08)								AS PRE_SALES_PROFIT_AMT_08
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_09)								AS PRE_SALES_PROFIT_AMT_09
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_10)								AS PRE_SALES_PROFIT_AMT_10
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_11)								AS PRE_SALES_PROFIT_AMT_11
		            ,SUM(XA.PRE_SALES_PROFIT_AMT_12)								AS PRE_SALES_PROFIT_AMT_12
		      FROM (
		            /* 계획 */
		            SELECT MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		                   /* 매출액 */
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '1'), MA.PLAN_AMT,0))                          AS PLAN_SALES_AMT
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_AMT_12                                         
		                   /* 매출액 */
		                                                             
		                   /* 매출이익액 */                                                 
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '3'), MA.PLAN_AMT,0))                          AS PLAN_SALES_PROFIT_AMT
		                                          
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.PLAN_AMT,0),0))    AS PLAN_SALES_PROFIT_AMT_12
		                   /* 매출이익액 */
		                   
		                   ,0											AS PRE_SALES_AMT
		                   ,0											AS PRE_SALES_AMT_01
		                   ,0											AS PRE_SALES_AMT_02                                                 
		                   ,0											AS PRE_SALES_AMT_03                                                 
		                   ,0											AS PRE_SALES_AMT_04                                                 
		                   ,0											AS PRE_SALES_AMT_05                                                 
		                   ,0											AS PRE_SALES_AMT_06                                                 
		                   ,0											AS PRE_SALES_AMT_07                                                 
		                   ,0											AS PRE_SALES_AMT_08                                                 
		                   ,0											AS PRE_SALES_AMT_09                                                 
		                   ,0											AS PRE_SALES_AMT_10                                                 
		                   ,0											AS PRE_SALES_AMT_11                                                 
		                   ,0											AS PRE_SALES_AMT_12                                         
		                   ,0											AS PRE_SALES_PROFIT_AMT
		                   ,0											AS PRE_SALES_PROFIT_AMT_01
		                   ,0											AS PRE_SALES_PROFIT_AMT_02                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_03                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_04                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_05                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_06                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_07                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_08                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_09                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_10                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_11                                                 
		                   ,0											AS PRE_SALES_PROFIT_AMT_12                                                   
		                                                                                                     
		            FROM (
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.BIZ_CD
		                         ,NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)   AS PLAN_AMT
		                         ,SUBSTR(RPT.BIZ_PLAN_YM, 5, 2)                   AS MONTH
		                  FROM MSS.ME_BIZPLANRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE IN ('1', '3')   /* 1:총매출, 3:매출이익 */
		                                AND A.REFER_CODE = RPT.BIZ_CD
		                               )
		                  AND RPT.BIZ_PLAN_YEAR = ?
		                  AND NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0) > 0
		                 ) MA
		            GROUP BY MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		            /* 계획 */
		                   
		            UNION ALL
		            
		            /* 전년실적 */
		            SELECT MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		                         
		                   ,0											AS PLAN_SALES_AMT
		                   ,0											AS PLAN_SALES_AMT_01
		                   ,0											AS PLAN_SALES_AMT_02                                                 
		                   ,0											AS PLAN_SALES_AMT_03                                                 
		                   ,0											AS PLAN_SALES_AMT_04                                                 
		                   ,0											AS PLAN_SALES_AMT_05                                                 
		                   ,0											AS PLAN_SALES_AMT_06                                                 
		                   ,0											AS PLAN_SALES_AMT_07                                                 
		                   ,0											AS PLAN_SALES_AMT_08                                                 
		                   ,0											AS PLAN_SALES_AMT_09                                                 
		                   ,0											AS PLAN_SALES_AMT_10                                                 
		                   ,0											AS PLAN_SALES_AMT_11                                                 
		                   ,0											AS PLAN_SALES_AMT_12                                         
		                   ,0											AS PLAN_SALES_PROFIT_AMT
		                   ,0											AS PLAN_SALES_PROFIT_AMT_01
		                   ,0											AS PLAN_SALES_PROFIT_AMT_02                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_03                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_04                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_05                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_06                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_07                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_08                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_09                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_10                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_11                                                 
		                   ,0											AS PLAN_SALES_PROFIT_AMT_12       
		                   
		                   /* 매출액 */
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '1'), MA.RSLT_AMT,0))                          AS PRE_SALES_AMT
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '1'), MA.RSLT_AMT,0),0))    AS PRE_SALES_AMT_12                                         
		                   /* 매출액 */
		                                                             
		                   /* 매출이익액 */                                                 
		                   ,SUM(DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                          FROM COM.TC_COMMCODE A 
		                                          WHERE A.SYS_PART = 'D' 
		                                          AND A.COMM_PART = 'M104' 
		                                          AND A.COMM_CODE = '3'), MA.RSLT_AMT,0))                          AS PRE_SALES_PROFIT_AMT
		                                          
		                   ,SUM(DECODE(MA.MONTH, '01', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_01
		                   ,SUM(DECODE(MA.MONTH, '02', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_02                                                 
		                   ,SUM(DECODE(MA.MONTH, '03', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_03                                                 
		                   ,SUM(DECODE(MA.MONTH, '04', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_04                                                 
		                   ,SUM(DECODE(MA.MONTH, '05', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_05                                                 
		                   ,SUM(DECODE(MA.MONTH, '06', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_06                                                 
		                   ,SUM(DECODE(MA.MONTH, '07', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_07                                                 
		                   ,SUM(DECODE(MA.MONTH, '08', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_08                                                 
		                   ,SUM(DECODE(MA.MONTH, '09', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_09                                                 
		                   ,SUM(DECODE(MA.MONTH, '10', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_10                                                 
		                   ,SUM(DECODE(MA.MONTH, '11', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_11                                                 
		                   ,SUM(DECODE(MA.MONTH, '12', DECODE(MA.BIZ_CD,(SELECT A.REFER_CODE 
		                                                             FROM COM.TC_COMMCODE A 
		                                                             WHERE A.SYS_PART = 'D' 
		                                                             AND A.COMM_PART = 'M104' 
		                                                             AND A.COMM_CODE = '3'), MA.RSLT_AMT,0),0))    AS PRE_SALES_PROFIT_AMT_12
		                   /* 매출이익액 */                                                   
		                                                                                                      
		            FROM (
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.BIZ_CD
		                         ,NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0)   AS RSLT_AMT
		                         ,SUBSTR(RPT.BIZ_RSLT_YM, 5, 2)                   AS MONTH
		                  FROM MSS.ME_BIZRSLTRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE IN ('1', '3')   /* 1:총매출, 3:매출이익 */
		                                AND A.REFER_CODE = RPT.BIZ_CD
		                               )
		                  AND SUBSTR(RPT.BIZ_RSLT_YM,1,4) = TO_CHAR(TO_DATE(?, 'YYYY') + NUMTOYMINTERVAL (-1, 'year'), 'YYYY')
		                  AND NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0) > 0
		                 ) MA
		            GROUP BY MA.STR_CD
		                   ,MA.DEPT_CD
		                   ,MA.TEAM_CD
		                   ,MA.PC_CD
		            /* 전년실적 */
		           ) XA
		      WHERE XA.STR_CD = ?
		      GROUP BY XA.STR_CD, ROLLUP(XA.DEPT_CD, XA.TEAM_CD, XA.PC_CD)
		     ) MMA
		--WHERE MMA.GROUP_ID != '011'
		WHERE MMA.GROUP_ID NOT LIKE '%1%'		    
    ]]>
    </query>         

</service>