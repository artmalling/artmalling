<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 최재형
 * 회 사 명 : 
 * 작 성 일 : 2011.07.08
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  경영실적보고서조회
 -->
<service name="/meis072.me">

    <!-- 매출실적분석항목 헤더  -->
    <gauce name="H_SEL_TAB1">
		<column colName="ORG_CD"							colType="TB_STRING" 	size="10"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="ORG_NAME"							colType="TB_STRING" 	size="60"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SUM_GUBUN"							colType="TB_STRING" 	size="1"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		
		<column colName="PLAN_SALES_AMT"					colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_SALES_AMT"					colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_AMT_ACHIEVE_RATE"			colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_SALES_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_AMT_GROWTH_RATE"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		
		<column colName="PLAN_SALES_PROFIT_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_SALES_PROFIT_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_PROFIT_AMT_ACHIEVE_RATE"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_SALES_PROFIT_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_PROFIT_AMT_GROWTH_RATE"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		
		<column colName="PLAN_PROFIT_RATE"					colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_PROFIT_RATE"					colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PROFIT_RATE_ACHIEVE_RATE"			colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_PROFIT_RATE"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PROFIT_RATE_DIFFERENT"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />  

        <column colName="STR_CD"					colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="DEPT_CD"					colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="TEAM_CD"					colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="PC_CD"						colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />      
    </gauce> 

    <!-- 점별 매출실적분석 조회 -->
    <query name="SEL_TAB1_STR">
        <![CDATA[
        	/*******
        	* 점별 매출실적분석 조회
        	*******/
			SELECT XA.ORG_CD
			       ,XA.ORG_NAME
			       ,XA.SUM_GUBUN
			       /* 매출액 */
			       ,XA.PLAN_SALES_AMT             AS PLAN_SALES_AMT
			       ,XA.RSLT_SALES_AMT             AS RSLT_SALES_AMT
			       ,XA.SALES_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_AMT         AS PRE_RSLT_SALES_AMT
			       ,XA.SALES_AMT_GROWTH_RATE
			       /* 매출이익액 */
			       ,XA.PLAN_SALES_PROFIT_AMT      AS PLAN_SALES_PROFIT_AMT
			       ,XA.RSLT_SALES_PROFIT_AMT      AS RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_PROFIT_AMT  AS PRE_RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_GROWTH_RATE
			       /* 이익율 */
			       ,XA.PLAN_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE
			       ,DECODE(XA.PLAN_PROFIT_RATE, 0, 0
			                                     , ROUND(XA.RSLT_PROFIT_RATE/XA.PLAN_PROFIT_RATE*100,2))                               AS PROFIT_RATE_ACHIEVE_RATE 
			       ,XA.PRE_RSLT_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE - XA.PRE_RSLT_PROFIT_RATE                                                                      AS PROFIT_RATE_DIFFERENT                                                                                          

             	   ,SUBSTR(XA.ORG_CD, 1, 2)                                                 AS STR_CD
             	   ,SUBSTR(XA.ORG_CD, 3, 2)                                                 AS DEPT_CD
             	   ,SUBSTR(XA.ORG_CD, 5, 2)                                                 AS TEAM_CD
             	   ,SUBSTR(XA.ORG_CD, 7, 2)                                                 AS PC_CD	
			
			FROM (
			      SELECT MMA.ORG_CD
			             ,NVL((SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD), '합계')                       AS ORG_NAME
			      			 ,DECODE(GROUP_GUBUN, '1', '0', '2')                                                                            AS SUM_GUBUN
			             /* 매출액 */
			             ,MMA.PLAN_SALES_AMT                                                                                    AS PLAN_SALES_AMT
			             ,MMA.RSLT_SALES_AMT                                                                                    AS RSLT_SALES_AMT
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_AMT/MMA.PLAN_SALES_AMT*100,2))                              AS SALES_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_AMT                                                                                        AS PRE_RSLT_SALES_AMT
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_AMT - MMA.PRE_RSLT_SALES_AMT)/MMA.RSLT_SALES_AMT*100,2))  AS SALES_AMT_GROWTH_RATE
			             /* 매출이익액 */
			             ,MMA.PLAN_SALES_PROFIT_AMT                                                                             AS PLAN_SALES_PROFIT_AMT
			             ,MMA.RSLT_SALES_PROFIT_AMT                                                                             AS RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.PLAN_SALES_PROFIT_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.PLAN_SALES_PROFIT_AMT*100,2))                AS SALES_PROFIT_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_PROFIT_AMT																			AS PRE_RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.RSLT_SALES_PROFIT_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_PROFIT_AMT - MMA.PRE_RSLT_SALES_PROFIT_AMT)/MMA.RSLT_SALES_PROFIT_AMT*100,2))  AS SALES_PROFIT_AMT_GROWTH_RATE
			                                                                                      
			             /* 이익율 */
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_AMT*100,2))                      AS PLAN_PROFIT_RATE
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.RSLT_SALES_AMT*100,2))                      AS RSLT_PROFIT_RATE
			             ,DECODE(MMA.PRE_RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PRE_RSLT_SALES_PROFIT_AMT/MMA.PRE_RSLT_SALES_AMT*100,2))              AS PRE_RSLT_PROFIT_RATE
			      FROM (
			            SELECT RPAD(MA.STR_CD, 10, '00')            AS ORG_CD
			                   ,SUM(MA.PLAN_SALES_AMT)              AS PLAN_SALES_AMT
			            			 ,SUM(MA.RSLT_SALES_AMT)              AS RSLT_SALES_AMT
			            			 ,SUM(MA.PRE_RSLT_SALES_AMT)          AS PRE_RSLT_SALES_AMT    
			            			 ,SUM(MA.PLAN_SALES_PROFIT_AMT)       AS PLAN_SALES_PROFIT_AMT
			                   ,SUM(MA.RSLT_SALES_PROFIT_AMT)       AS RSLT_SALES_PROFIT_AMT
			                   ,SUM(MA.PRE_RSLT_SALES_PROFIT_AMT)   AS PRE_RSLT_SALES_PROFIT_AMT
			                   ,GROUPING(MA.STR_CD)                 AS GROUP_GUBUN
			            FROM (
			                  /* 계획 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)) AS PLAN_SALES_AMT
			                         ,0                                               AS RSLT_SALES_AMT
			                         ,0                                               AS PRE_RSLT_SALES_AMT
			                         ,0                                               AS PLAN_SALES_PROFIT_AMT
			                         ,0                                               AS RSLT_SALES_PROFIT_AMT
			                         ,0                                               AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                  
			                  UNION ALL
			                  
			                  /* 계획 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0))    AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                 ) MA
			            WHERE 1 = 1 
			            GROUP BY  ROLLUP(MA.STR_CD)     
			           ) MMA
					WHERE MMA.GROUP_GUBUN NOT LIKE '%1%'			           
			     ) XA
			             
        ]]>
    </query>
    
    <!-- 팀별 매출실적분석 조회 -->
    <query name="SEL_TAB1_TEAM">
        <![CDATA[
        	/*******
        	* 팀별 매출실적분석 조회
        	*******/
			SELECT XA.ORG_CD
			       ,XA.ORG_NAME
			       ,XA.SUM_GUBUN
			       /* 매출액 */
			       ,XA.PLAN_SALES_AMT
			       ,XA.RSLT_SALES_AMT
			       ,XA.SALES_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_AMT
			       ,XA.SALES_AMT_GROWTH_RATE
			       /* 매출이익액 */
			       ,XA.PLAN_SALES_PROFIT_AMT
			       ,XA.RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_GROWTH_RATE
			       /* 이익율 */
			       ,XA.PLAN_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE
			       ,DECODE(XA.PLAN_PROFIT_RATE, 0, 0
			                                     , ROUND(XA.RSLT_PROFIT_RATE/XA.PLAN_PROFIT_RATE*100,2))                               AS PROFIT_RATE_ACHIEVE_RATE 
			       ,XA.PRE_RSLT_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE - XA.PRE_RSLT_PROFIT_RATE                                                                      AS PROFIT_RATE_DIFFERENT                                                                                          

             	   ,SUBSTR(XA.ORG_CD, 1, 2)                                                 AS STR_CD
             	   ,SUBSTR(XA.ORG_CD, 3, 2)                                                 AS DEPT_CD
             	   ,SUBSTR(XA.ORG_CD, 5, 2)                                                 AS TEAM_CD
             	   ,SUBSTR(XA.ORG_CD, 7, 2)                                                 AS PC_CD	
			
			FROM (
			      SELECT DECODE(GROUP_GUBUN, '11', '', MMA.ORG_CD)   AS ORG_CD
						       ,DECODE(GROUP_GUBUN, '11', '합계', (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD)) AS ORG_NAME                                        
						       ,DECODE(GROUP_GUBUN, '11', '0', '2')          AS SUM_GUBUN
			             /* 매출액 */
			             ,MMA.PLAN_SALES_AMT                                                                                    AS PLAN_SALES_AMT
			             ,MMA.RSLT_SALES_AMT                                                                                  AS RSLT_SALES_AMT
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_AMT/MMA.PLAN_SALES_AMT*100,2))                              AS SALES_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_AMT                                                                                       AS PRE_RSLT_SALES_AMT
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_AMT - MMA.PRE_RSLT_SALES_AMT)/MMA.RSLT_SALES_AMT*100,2))  AS SALES_AMT_GROWTH_RATE
			             /* 매출이익액 */
			             ,MMA.PLAN_SALES_PROFIT_AMT                                                                             AS PLAN_SALES_PROFIT_AMT
			             ,MMA.RSLT_SALES_PROFIT_AMT                                                                             AS RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.PLAN_SALES_PROFIT_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.PLAN_SALES_PROFIT_AMT*100,2))                AS SALES_PROFIT_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_PROFIT_AMT                                                                         AS PRE_RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.RSLT_SALES_PROFIT_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_PROFIT_AMT - MMA.PRE_RSLT_SALES_PROFIT_AMT)/MMA.RSLT_SALES_PROFIT_AMT*100,2))  AS SALES_PROFIT_AMT_GROWTH_RATE
			             
			             /* 이익율 */
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_AMT*100,2))                      AS PLAN_PROFIT_RATE
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.RSLT_SALES_AMT*100,2))                      AS RSLT_PROFIT_RATE
			             ,DECODE(MMA.PRE_RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PRE_RSLT_SALES_PROFIT_AMT/MMA.PRE_RSLT_SALES_AMT*100,2))              AS PRE_RSLT_PROFIT_RATE
			      FROM (
			            SELECT RPAD(MA.STR_CD || MA.DEPT_CD || MA.TEAM_CD, 10, '00') AS ORG_CD
			                   ,SUM(MA.PLAN_SALES_AMT)              AS PLAN_SALES_AMT
			            			 ,SUM(MA.RSLT_SALES_AMT)              AS RSLT_SALES_AMT
			            			 ,SUM(MA.PRE_RSLT_SALES_AMT)          AS PRE_RSLT_SALES_AMT    
			            			 ,SUM(MA.PLAN_SALES_PROFIT_AMT)       AS PLAN_SALES_PROFIT_AMT
			                   ,SUM(MA.RSLT_SALES_PROFIT_AMT)       AS RSLT_SALES_PROFIT_AMT
			                   ,SUM(MA.PRE_RSLT_SALES_PROFIT_AMT)   AS PRE_RSLT_SALES_PROFIT_AMT
			                   ,GROUPING(MA.DEPT_CD)||GROUPING(MA.TEAM_CD)             AS GROUP_GUBUN
			            FROM (
			                  /* 계획 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)) AS PLAN_SALES_AMT
			                         ,0                                               AS RSLT_SALES_AMT
			                         ,0                                               AS PRE_RSLT_SALES_AMT
			                         ,0                                               AS PLAN_SALES_PROFIT_AMT
			                         ,0                                               AS RSLT_SALES_PROFIT_AMT
			                         ,0                                               AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                  
			                  UNION ALL
			                  
			                  /* 계획 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0))    AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                  AND RPT.ORG_LEVEL >= 3
			                 ) MA
			            WHERE 1 = 1 
			            AND MA.STR_CD = ?
			            GROUP BY  MA.STR_CD,ROLLUP(MA.DEPT_CD,MA.TEAM_CD)
			           ) MMA
			           --WHERE MMA.GROUP_GUBUN != '01'
					   WHERE MMA.GROUP_GUBUN NOT LIKE '%1%'			           
			     ) XA        
        ]]>
    </query>    

    <!-- PC별 매출실적분석 조회 -->
    <query name="SEL_TAB1_PC">
        <![CDATA[
        	/*******
        	* PC별 매출실적분석 조회
        	*******/
			SELECT XA.ORG_CD
			       ,XA.ORG_NAME
			       ,XA.SUM_GUBUN
			       /* 매출액 */
			       ,XA.PLAN_SALES_AMT
			       ,XA.RSLT_SALES_AMT
			       ,XA.SALES_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_AMT
			       ,XA.SALES_AMT_GROWTH_RATE
			       /* 매출이익액 */
			       ,XA.PLAN_SALES_PROFIT_AMT
			       ,XA.RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_GROWTH_RATE
			       /* 이익율 */
			       ,XA.PLAN_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE
			       ,DECODE(XA.PLAN_PROFIT_RATE, 0, 0
			                                     , ROUND(XA.RSLT_PROFIT_RATE/XA.PLAN_PROFIT_RATE*100,2))                               AS PROFIT_RATE_ACHIEVE_RATE 
			       ,XA.PRE_RSLT_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE - XA.PRE_RSLT_PROFIT_RATE                                                                      AS PROFIT_RATE_DIFFERENT                                                                                          

             	   ,SUBSTR(XA.ORG_CD, 1, 2)                                                 AS STR_CD
             	   ,SUBSTR(XA.ORG_CD, 3, 2)                                                 AS DEPT_CD
             	   ,SUBSTR(XA.ORG_CD, 5, 2)                                                 AS TEAM_CD
             	   ,SUBSTR(XA.ORG_CD, 7, 2)                                                 AS PC_CD	
			
			FROM (
			      SELECT DECODE(GROUP_GUBUN, '000',MMA.ORG_CD, '')      AS ORG_CD
									 ,DECODE(GROUP_GUBUN, '111', '합계'
						                          , '001', (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD)||' 소계'
						                                 , (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD))        AS ORG_NAME                                        
									 ,DECODE(GROUP_GUBUN, '111', '0','001', '1', '2')          AS SUM_GUBUN
			             /* 매출액 */
			             ,MMA.PLAN_SALES_AMT                                                                                    AS PLAN_SALES_AMT
			             ,MMA.RSLT_SALES_AMT                                                                                    AS RSLT_SALES_AMT
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_AMT/MMA.PLAN_SALES_AMT*100,2))                              AS SALES_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_AMT                                                                                        AS PRE_RSLT_SALES_AMT
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_AMT - MMA.PRE_RSLT_SALES_AMT)/MMA.RSLT_SALES_AMT*100,2))  AS SALES_AMT_GROWTH_RATE
			             /* 매출이익액 */
			             ,MMA.PLAN_SALES_PROFIT_AMT                                                                             AS PLAN_SALES_PROFIT_AMT
			             ,MMA.RSLT_SALES_PROFIT_AMT                                                                            AS RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.PLAN_SALES_PROFIT_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.PLAN_SALES_PROFIT_AMT*100,2))                AS SALES_PROFIT_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_PROFIT_AMT                                                                         AS PRE_RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.RSLT_SALES_PROFIT_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_PROFIT_AMT - MMA.PRE_RSLT_SALES_PROFIT_AMT)/MMA.RSLT_SALES_PROFIT_AMT*100,2))  AS SALES_PROFIT_AMT_GROWTH_RATE
			             
			             /* 이익율 */
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_AMT*100,2))                      AS PLAN_PROFIT_RATE
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.RSLT_SALES_AMT*100,2))                      AS RSLT_PROFIT_RATE
			             ,DECODE(MMA.PRE_RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PRE_RSLT_SALES_PROFIT_AMT/MMA.PRE_RSLT_SALES_AMT*100,2))              AS PRE_RSLT_PROFIT_RATE
			      FROM (
			            SELECT RPAD(MA.STR_CD || MA.DEPT_CD || MA.TEAM_CD || MA.PC_CD, 10, '00') AS ORG_CD
			                   ,SUM(MA.PLAN_SALES_AMT)              AS PLAN_SALES_AMT
			            			 ,SUM(MA.RSLT_SALES_AMT)              AS RSLT_SALES_AMT
			            			 ,SUM(MA.PRE_RSLT_SALES_AMT)          AS PRE_RSLT_SALES_AMT    
			            			 ,SUM(MA.PLAN_SALES_PROFIT_AMT)       AS PLAN_SALES_PROFIT_AMT
			                   ,SUM(MA.RSLT_SALES_PROFIT_AMT)       AS RSLT_SALES_PROFIT_AMT
			                   ,SUM(MA.PRE_RSLT_SALES_PROFIT_AMT)   AS PRE_RSLT_SALES_PROFIT_AMT
			                   ,GROUPING(MA.DEPT_CD)||GROUPING(MA.TEAM_CD)||GROUPING(MA.PC_CD)             AS GROUP_GUBUN
			            FROM (
			                  /* 계획 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)) AS PLAN_SALES_AMT
			                         ,0                                               AS RSLT_SALES_AMT
			                         ,0                                               AS PRE_RSLT_SALES_AMT
			                         ,0                                               AS PLAN_SALES_PROFIT_AMT
			                         ,0                                               AS RSLT_SALES_PROFIT_AMT
			                         ,0                                               AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                  
			                  UNION ALL
			                  
			                  /* 계획 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0))    AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                  AND RPT.ORG_LEVEL >= 3
			                 ) MA
			            WHERE 1 = 1 
			            AND MA.STR_CD = ?
			            GROUP BY  MA.STR_CD,ROLLUP(MA.DEPT_CD,MA.TEAM_CD,MA.PC_CD)
			           ) MMA
			           --WHERE MMA.GROUP_GUBUN != '011'
					   WHERE MMA.GROUP_GUBUN NOT LIKE '%1%'			           			            
			     ) XA        
        ]]>
    </query>
    
    <!--  매출실적분석(엑셀용)  -->
    <gauce name="H_SEL_TAB1_EXCEL">
		<column colName="ORG_CD"							colType="TB_STRING" 	size="10"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="ORG_NAME"							colType="TB_STRING" 	size="60"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SUM_GUBUN"							colType="TB_STRING" 	size="1"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		
		<column colName="PLAN_SALES_AMT"					colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_SALES_AMT"					colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_AMT_ACHIEVE_RATE"			colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_SALES_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_AMT_GROWTH_RATE"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		
		<column colName="PLAN_SALES_PROFIT_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_SALES_PROFIT_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_PROFIT_AMT_ACHIEVE_RATE"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_SALES_PROFIT_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_PROFIT_AMT_GROWTH_RATE"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		
		<column colName="PLAN_PROFIT_RATE"					colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_PROFIT_RATE"					colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PROFIT_RATE_ACHIEVE_RATE"			colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_PROFIT_RATE"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PROFIT_RATE_DIFFERENT"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />  

        <column colName="STR_CD"					colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="DEPT_CD"					colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="TEAM_CD"					colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="PC_CD"						colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />      
    </gauce>

    <!--  매출실적분석(엑셀용) -->
    <query name="SEL_TAB1_EXCEL">
    <![CDATA[
        	/*******
        	* 매출실적분석(엑셀용)
        	*******/
			SELECT XA.ORG_CD
			       ,XA.ORG_NAME
			       ,XA.SUM_GUBUN
			       /* 매출액 */
			       ,XA.PLAN_SALES_AMT
			       ,XA.RSLT_SALES_AMT
			       ,XA.SALES_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_AMT
			       ,XA.SALES_AMT_GROWTH_RATE
			       /* 매출이익액 */
			       ,XA.PLAN_SALES_PROFIT_AMT
			       ,XA.RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_GROWTH_RATE
			       /* 이익율 */
			       ,XA.PLAN_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE
			       ,DECODE(XA.PLAN_PROFIT_RATE, 0, 0
			                                     , ROUND(XA.RSLT_PROFIT_RATE/XA.PLAN_PROFIT_RATE*100,2))                               AS PROFIT_RATE_ACHIEVE_RATE 
			       ,XA.PRE_RSLT_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE - XA.PRE_RSLT_PROFIT_RATE                                                                      AS PROFIT_RATE_DIFFERENT                                                                                          

               	   ,SUBSTR(XA.ORG_CD, 1, 2)                                                 AS STR_CD
                   ,SUBSTR(XA.ORG_CD, 3, 2)                                                 AS DEPT_CD
                   ,SUBSTR(XA.ORG_CD, 5, 2)                                                 AS TEAM_CD
                   ,SUBSTR(XA.ORG_CD, 7, 2)                                                 AS PC_CD	
			
			FROM (
			      SELECT DECODE(GROUP_GUBUN, '000',MMA.ORG_CD, '')      AS ORG_CD
									 ,DECODE(GROUP_GUBUN, '111', '합계'
						                          , '001', '소계'
						                                 , (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD))        AS ORG_NAME                                        
									 ,DECODE(GROUP_GUBUN, '111', '0','001', '1', '2')          AS SUM_GUBUN
			             /* 매출액 */
			             ,MMA.PLAN_SALES_AMT                                                                                    AS PLAN_SALES_AMT
			             ,MMA.RSLT_SALES_AMT                                                                                    AS RSLT_SALES_AMT
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_AMT/MMA.PLAN_SALES_AMT*100,2))                              AS SALES_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_AMT                                                                                        AS PRE_RSLT_SALES_AMT
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_AMT - MMA.PRE_RSLT_SALES_AMT)/MMA.RSLT_SALES_AMT*100,2))  AS SALES_AMT_GROWTH_RATE
			             /* 매출이익액 */
			             ,MMA.PLAN_SALES_PROFIT_AMT                                                                            AS PLAN_SALES_PROFIT_AMT
			             ,MMA.RSLT_SALES_PROFIT_AMT                                                                           AS RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.PLAN_SALES_PROFIT_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.PLAN_SALES_PROFIT_AMT*100,2))                AS SALES_PROFIT_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_PROFIT_AMT                                                                        AS PRE_RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.RSLT_SALES_PROFIT_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_PROFIT_AMT - MMA.PRE_RSLT_SALES_PROFIT_AMT)/MMA.RSLT_SALES_PROFIT_AMT*100,2))  AS SALES_PROFIT_AMT_GROWTH_RATE
			             
			             /* 이익율 */
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_AMT*100,2))                      AS PLAN_PROFIT_RATE
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.RSLT_SALES_AMT*100,2))                      AS RSLT_PROFIT_RATE
			             ,DECODE(MMA.PRE_RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PRE_RSLT_SALES_PROFIT_AMT/MMA.PRE_RSLT_SALES_AMT*100,2))              AS PRE_RSLT_PROFIT_RATE
			      FROM (
			            SELECT RPAD(MA.STR_CD || MA.DEPT_CD || MA.TEAM_CD || MA.PC_CD, 10, '00') AS ORG_CD
			                   ,SUM(MA.PLAN_SALES_AMT)              AS PLAN_SALES_AMT
			            			 ,SUM(MA.RSLT_SALES_AMT)              AS RSLT_SALES_AMT
			            			 ,SUM(MA.PRE_RSLT_SALES_AMT)          AS PRE_RSLT_SALES_AMT    
			            			 ,SUM(MA.PLAN_SALES_PROFIT_AMT)       AS PLAN_SALES_PROFIT_AMT
			                   ,SUM(MA.RSLT_SALES_PROFIT_AMT)       AS RSLT_SALES_PROFIT_AMT
			                   ,SUM(MA.PRE_RSLT_SALES_PROFIT_AMT)   AS PRE_RSLT_SALES_PROFIT_AMT
			                   ,GROUPING(MA.DEPT_CD)||GROUPING(MA.TEAM_CD)||GROUPING(MA.PC_CD)             AS GROUP_GUBUN
			            FROM (
			                  /* 계획 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)) AS PLAN_SALES_AMT
			                         ,0                                               AS RSLT_SALES_AMT
			                         ,0                                               AS PRE_RSLT_SALES_AMT
			                         ,0                                               AS PLAN_SALES_PROFIT_AMT
			                         ,0                                               AS RSLT_SALES_PROFIT_AMT
			                         ,0                                               AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                  
			                  UNION ALL
			                  
			                  /* 계획 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0))    AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                 ) MA
			            WHERE 1 = 1 
			            AND MA.STR_CD = ?
			            GROUP BY  MA.STR_CD,ROLLUP(MA.DEPT_CD,MA.TEAM_CD,MA.PC_CD)
			           ) MMA
			           --WHERE MMA.GROUP_GUBUN != '011'
			           WHERE MMA.GROUP_GUBUN NOT LIKE '%1%' 
			     ) XA    
    ]]>
    </query>    	

     <!-- 매출구성실적분석항목 헤더  -->
    <gauce name="H_SEL_TAB2">
		<column colName="ORG_CD"						colType="TB_STRING" 	size="10"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="ORG_NAME"						colType="TB_STRING" 	size="60"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SUM_GUBUN"						colType="TB_STRING" 	size="1"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		
		<column colName="PLAN_SALES_RATE"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_SALES_RATE"				colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_ACHIEVE_DIFF"			colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_SALES_RATE"			colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_INC_DEC_DIFF"			colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		
		<column colName="PLAN_SALES_PROFIT_RATE"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_SALES_PROFIT_RATE"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_PROFIT_ACHIEVE_DIFF"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_SALES_PROFIT_RATE"	colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SALES_PROFIT_INC_DEC_DIFF"	colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		
		<column colName="GROUP_GUBUN"					colType="TB_STRING" 	size="4"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="HD_ORG_CD"						colType="TB_STRING" 	size="10"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="STR_CD"						colType="TB_STRING" 	size="10"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="BIZ_RSLT_YM"					colType="TB_STRING" 	size="10"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="ORG_LEVEL"						colType="TB_STRING" 	size="10"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SUM_GB"						colType="TB_STRING" 	size="1"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="DEPT_CD"						colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="TEAM_CD"						colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="PC_CD"							colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />      
        
		<column colName="PLAN_SALES_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_AMT_TOT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_SALES_AMT"				colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_SALES_AMT_TOT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_SALES_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_SALES_AMT_TOT"		colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />

		<column colName="PLAN_SALES_PROFIT_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PLAN_SALES_PROFIT_AMT_TOT"		colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_SALES_PROFIT_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="RSLT_SALES_PROFIT_AMT_TOT"		colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_SALES_PROFIT_AMT"		colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="PRE_RSLT_SALES_PROFIT_AMT_TOT"	colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />        
    </gauce>	
    
    
    <!-- 점별 매출구성실적분석 조회 -->
    <query name="SEL_TAB2_STR">
    <![CDATA[
		/*******
		* 점별 매출구성실적분석 조회
		*******/
		SELECT XA.ORG_CD
		       ,XA.ORG_NAME
		       ,XA.SUM_GUBUN
		       /* 매출구성비 */
		       ,XA.PLAN_SALES_RATE
		       ,XA.RSLT_SALES_RATE
		       ,XA.RSLT_SALES_RATE - XA.PLAN_SALES_RATE                   AS SALES_ACHIEVE_DIFF
		       ,XA.PRE_RSLT_SALES_RATE
		       ,XA.RSLT_SALES_RATE - XA.PRE_RSLT_SALES_RATE               AS SALES_INC_DEC_DIFF
		       /* 매출이익구성비 */
		       ,XA.PLAN_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE - XA.PLAN_SALES_PROFIT_RATE     AS SALES_PROFIT_ACHIEVE_DIFF
		       ,XA.PRE_RSLT_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE - XA.PRE_RSLT_SALES_PROFIT_RATE AS SALES_PROFIT_INC_DEC_DIFF
		       
		       ,XA.GROUP_GUBUN
		       ,XA.HD_ORG_CD
		       ,?	AS STR_CD
		       ,?	AS BIZ_RSLT_YM
		       ,?	AS ORG_LEVEL
		       ,?	AS SUM_GB  
		       
               --,SUBSTR(XA.ORG_CD, 1, 2)                                                 AS STR_CD
               ,SUBSTR(XA.ORG_CD, 3, 2)                                                 AS DEPT_CD
               ,SUBSTR(XA.ORG_CD, 5, 2)                                                 AS TEAM_CD
               ,SUBSTR(XA.ORG_CD, 7, 2)                                                 AS PC_CD

               ,XA.PLAN_SALES_AMT
               ,XA.PLAN_SALES_AMT_TOT
               ,XA.RSLT_SALES_AMT
               ,XA.RSLT_SALES_AMT_TOT
               ,XA.PRE_RSLT_SALES_AMT
               ,XA.PRE_RSLT_SALES_AMT_TOT
             
               ,XA.PLAN_SALES_PROFIT_AMT
               ,XA.PLAN_SALES_PROFIT_AMT_TOT
               ,XA.RSLT_SALES_PROFIT_AMT
               ,XA.RSLT_SALES_PROFIT_AMT_TOT
               ,XA.PRE_RSLT_SALES_PROFIT_AMT
               ,XA.PRE_RSLT_SALES_PROFIT_AMT_TOT               		       
		            
		FROM (
		      SELECT MMA.ORG_CD
		             ,NVL((SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD), '합계')                         AS ORG_NAME
		             ,DECODE(GROUP_GUBUN, '1', '0', '2')                                                                              AS SUM_GUBUN
		             /* 매출구성비 */
		             ,DECODE(MMA.PLAN_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PLAN_SALES_AMT/MMA.PLAN_SALES_AMT_TOT*100,2))                           AS PLAN_SALES_RATE
		             ,DECODE(MMA.RSLT_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.RSLT_SALES_AMT/MMA.RSLT_SALES_AMT_TOT*100,2))                           AS RSLT_SALES_RATE
		             ,DECODE(MMA.PRE_RSLT_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PRE_RSLT_SALES_AMT/MMA.PRE_RSLT_SALES_AMT_TOT*100,2))                   AS PRE_RSLT_SALES_RATE
		             /* 매출이익구성비 */
		             ,DECODE(MMA.PLAN_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_PROFIT_AMT_TOT*100,2))             AS PLAN_SALES_PROFIT_RATE
		             ,DECODE(MMA.RSLT_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.RSLT_SALES_PROFIT_AMT_TOT*100,2))             AS RSLT_SALES_PROFIT_RATE
		             ,DECODE(MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PRE_RSLT_SALES_PROFIT_AMT/MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT*100,2))     AS PRE_RSLT_SALES_PROFIT_RATE
		                                           
		             ,MMA.GROUP_GUBUN
		             ,MMA.HD_ORG_CD
		             
		             ,MMA.PLAN_SALES_AMT
		             ,MMA.PLAN_SALES_AMT_TOT
		             ,MMA.RSLT_SALES_AMT
		             ,MMA.RSLT_SALES_AMT_TOT
		             ,MMA.PRE_RSLT_SALES_AMT
		             ,MMA.PRE_RSLT_SALES_AMT_TOT
		             
		             ,MMA.PLAN_SALES_PROFIT_AMT
		             ,MMA.PLAN_SALES_PROFIT_AMT_TOT
		             ,MMA.RSLT_SALES_PROFIT_AMT
		             ,MMA.RSLT_SALES_PROFIT_AMT_TOT
		             ,MMA.PRE_RSLT_SALES_PROFIT_AMT
		             ,MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT
		             
		      FROM (
		            SELECT RPAD(XXA.STR_CD, 10, '00')                                     AS ORG_CD
		            
		                   ,SUM(XXA.PLAN_SALES_AMT)                                       AS PLAN_SALES_AMT
		                   ,AVG(XXA.PLAN_SALES_AMT_TOT)                                   AS PLAN_SALES_AMT_TOT
		                   ,SUM(XXA.RSLT_SALES_AMT)                                       AS RSLT_SALES_AMT
		                   ,AVG(XXA.RSLT_SALES_AMT_TOT)                                   AS RSLT_SALES_AMT_TOT
		                   ,SUM(XXA.PRE_RSLT_SALES_AMT)                                   AS PRE_RSLT_SALES_AMT
		                   ,AVG(XXA.PRE_RSLT_SALES_AMT_TOT)                               AS PRE_RSLT_SALES_AMT_TOT
		                   
		                   ,SUM(XXA.PLAN_SALES_PROFIT_AMT)                                AS PLAN_SALES_PROFIT_AMT
		                   ,AVG(XXA.PLAN_SALES_PROFIT_AMT_TOT)                            AS PLAN_SALES_PROFIT_AMT_TOT
		                   ,SUM(XXA.RSLT_SALES_PROFIT_AMT)                                AS RSLT_SALES_PROFIT_AMT
		                   ,AVG(XXA.RSLT_SALES_PROFIT_AMT_TOT)                            AS RSLT_SALES_PROFIT_AMT_TOT
		                   ,SUM(XXA.PRE_RSLT_SALES_PROFIT_AMT)                            AS PRE_RSLT_SALES_PROFIT_AMT
		                   ,AVG(XXA.PRE_RSLT_SALES_PROFIT_AMT_TOT)                        AS PRE_RSLT_SALES_PROFIT_AMT_TOT
		            
		                   ,GROUPING(XXA.STR_CD)                                          AS GROUP_GUBUN
		                   ,RPAD(NVL(XXA.STR_CD, '00'), 10, '00')                         AS HD_ORG_CD
		            FROM (
		                  SELECT XA.STR_CD
		                         ,XA.PLAN_SALES_AMT
		                         ,SUM(XA.PLAN_SALES_AMT) OVER()           AS PLAN_SALES_AMT_TOT
		                         ,XA.RSLT_SALES_AMT
		                         ,SUM(XA.RSLT_SALES_AMT) OVER()          AS RSLT_SALES_AMT_TOT
		                         ,XA.PRE_RSLT_SALES_AMT
		                         ,SUM(XA.PRE_RSLT_SALES_AMT) OVER()    AS PRE_RSLT_SALES_AMT_TOT
		                         ,XA.PLAN_SALES_PROFIT_AMT
		                         ,SUM(XA.PLAN_SALES_PROFIT_AMT) OVER()   AS PLAN_SALES_PROFIT_AMT_TOT
		                         ,XA.RSLT_SALES_PROFIT_AMT
		                         ,SUM(XA.RSLT_SALES_PROFIT_AMT) OVER()   AS RSLT_SALES_PROFIT_AMT_TOT
		                         ,XA.PRE_RSLT_SALES_PROFIT_AMT
		                         ,SUM(XA.PRE_RSLT_SALES_PROFIT_AMT) OVER()   AS PRE_RSLT_SALES_PROFIT_AMT_TOT
		                  FROM (
		                        SELECT MA.STR_CD
		                               ,SUM(MA.PLAN_SALES_AMT)                                       AS PLAN_SALES_AMT
		                               ,SUM(MA.RSLT_SALES_AMT)                                       AS RSLT_SALES_AMT
		                               ,SUM(MA.PRE_RSLT_SALES_AMT)                                   AS PRE_RSLT_SALES_AMT
		                               ,SUM(MA.PLAN_SALES_PROFIT_AMT)                                AS PLAN_SALES_PROFIT_AMT                   
		                               ,SUM(MA.RSLT_SALES_PROFIT_AMT)                                AS RSLT_SALES_PROFIT_AMT
		                               ,SUM(MA.PRE_RSLT_SALES_PROFIT_AMT)                            AS PRE_RSLT_SALES_PROFIT_AMT                   
		                        FROM (
		                             /* 계획 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                             
		                                    ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)) AS PLAN_SALES_AMT
		                                    ,0                                               AS RSLT_SALES_AMT
		                                    ,0                                               AS PRE_RSLT_SALES_AMT
		                                    ,0                                               AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                               AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                               AS PRE_RSLT_SALES_PROFIT_AMT
		                                    
		                             FROM MSS.ME_BIZPLANRPT RPT 
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 실적 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                           
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             
		                             AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 전년실적 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT       
		                                    
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
		                                                 AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		                             
		                             UNION ALL
		                             
		                             /* 계획 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                             
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0))    AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                    
		                             FROM MSS.ME_BIZPLANRPT RPT 
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 실적 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                           
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             
		                             AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 전년실적 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_PROFIT_AMT       
		                                    
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
		                                                 AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		            
		                             ) MA
		                        GROUP BY MA.STR_CD
		                       ) XA
		                  ) XXA
		            GROUP BY ROLLUP(XXA.STR_CD)
		      ) MMA
		WHERE MMA.GROUP_GUBUN NOT LIKE '%1%'		      
		) XA    
    ]]>
    </query>

    <!-- 팀별 매출구성실적분석 조회 -->
    <query name="SEL_TAB2_TEAM">
    <![CDATA[
		/*******
		* 팀별 매출구성실적분석 조회
		*******/
		SELECT XA.ORG_CD
		       ,XA.ORG_NAME
		       ,XA.SUM_GUBUN
		       /* 매출구성비 */
		       ,XA.PLAN_SALES_RATE
		       ,XA.RSLT_SALES_RATE
		       ,XA.RSLT_SALES_RATE - XA.PLAN_SALES_RATE                   AS SALES_ACHIEVE_DIFF
		       ,XA.PRE_RSLT_SALES_RATE
		       ,XA.RSLT_SALES_RATE - XA.PRE_RSLT_SALES_RATE               AS SALES_INC_DEC_DIFF
		       /* 매출이익구성비 */
		       ,XA.PLAN_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE - XA.PLAN_SALES_PROFIT_RATE     AS SALES_PROFIT_ACHIEVE_DIFF
		       ,XA.PRE_RSLT_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE - XA.PRE_RSLT_SALES_PROFIT_RATE AS SALES_PROFIT_INC_DEC_DIFF
		       
		       ,XA.GROUP_GUBUN
		       ,XA.HD_ORG_CD
		       ,?	AS STR_CD
		       ,?	AS BIZ_RSLT_YM
		       ,?	AS ORG_LEVEL 
		       ,?	AS SUM_GB     
		       
               --,SUBSTR(XA.ORG_CD, 1, 2)                                                 AS STR_CD
               ,SUBSTR(XA.ORG_CD, 3, 2)                                                 AS DEPT_CD
               ,SUBSTR(XA.ORG_CD, 5, 2)                                                 AS TEAM_CD
               ,SUBSTR(XA.ORG_CD, 7, 2)                                                 AS PC_CD

               ,XA.PLAN_SALES_AMT
               ,XA.PLAN_SALES_AMT_TOT
               ,XA.RSLT_SALES_AMT
               ,XA.RSLT_SALES_AMT_TOT
               ,XA.PRE_RSLT_SALES_AMT
               ,XA.PRE_RSLT_SALES_AMT_TOT
             
               ,XA.PLAN_SALES_PROFIT_AMT
               ,XA.PLAN_SALES_PROFIT_AMT_TOT
               ,XA.RSLT_SALES_PROFIT_AMT
               ,XA.RSLT_SALES_PROFIT_AMT_TOT
               ,XA.PRE_RSLT_SALES_PROFIT_AMT
               ,XA.PRE_RSLT_SALES_PROFIT_AMT_TOT  		       
		        
		FROM (
		      SELECT DECODE(GROUP_GUBUN, '11', '', MMA.ORG_CD)   AS ORG_CD
		       	     ,DECODE(GROUP_GUBUN, '11', '합계', (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD)) AS ORG_NAME                                        
					 ,DECODE(GROUP_GUBUN, '11', '0', '2')          AS SUM_GUBUN
		             /* 매출구성비 */
		             ,DECODE(MMA.PLAN_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PLAN_SALES_AMT/MMA.PLAN_SALES_AMT_TOT*100,2))                           AS PLAN_SALES_RATE
		             ,DECODE(MMA.RSLT_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.RSLT_SALES_AMT/MMA.RSLT_SALES_AMT_TOT*100,2))                           AS RSLT_SALES_RATE
		             ,DECODE(MMA.PRE_RSLT_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PRE_RSLT_SALES_AMT/MMA.PRE_RSLT_SALES_AMT_TOT*100,2))                   AS PRE_RSLT_SALES_RATE
		             /* 매출이익구성비 */
		             ,DECODE(MMA.PLAN_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_PROFIT_AMT_TOT*100,2))             AS PLAN_SALES_PROFIT_RATE
		             ,DECODE(MMA.RSLT_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.RSLT_SALES_PROFIT_AMT_TOT*100,2))             AS RSLT_SALES_PROFIT_RATE
		             ,DECODE(MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PRE_RSLT_SALES_PROFIT_AMT/MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT*100,2))     AS PRE_RSLT_SALES_PROFIT_RATE
		                                           
		             ,MMA.GROUP_GUBUN
		             ,MMA.HD_ORG_CD
		             
		             ,MMA.PLAN_SALES_AMT
		             ,MMA.PLAN_SALES_AMT_TOT
		             ,MMA.RSLT_SALES_AMT
		             ,MMA.RSLT_SALES_AMT_TOT
		             ,MMA.PRE_RSLT_SALES_AMT
		             ,MMA.PRE_RSLT_SALES_AMT_TOT
		             
		             ,MMA.PLAN_SALES_PROFIT_AMT
		             ,MMA.PLAN_SALES_PROFIT_AMT_TOT
		             ,MMA.RSLT_SALES_PROFIT_AMT
		             ,MMA.RSLT_SALES_PROFIT_AMT_TOT
		             ,MMA.PRE_RSLT_SALES_PROFIT_AMT
		             ,MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT		             
		             
		      FROM (
		            SELECT RPAD(XXA.STR_CD || XXA.DEPT_CD || XXA.TEAM_CD, 10, '00') AS ORG_CD
		            
		                   ,SUM(XXA.PLAN_SALES_AMT)                                       AS PLAN_SALES_AMT
		                   ,AVG(XXA.PLAN_SALES_AMT_TOT)                                   AS PLAN_SALES_AMT_TOT
		                   ,SUM(XXA.RSLT_SALES_AMT)                                       AS RSLT_SALES_AMT
		                   ,AVG(XXA.RSLT_SALES_AMT_TOT)                                   AS RSLT_SALES_AMT_TOT
		                   ,SUM(XXA.PRE_RSLT_SALES_AMT)                                   AS PRE_RSLT_SALES_AMT
		                   ,AVG(XXA.PRE_RSLT_SALES_AMT_TOT)                               AS PRE_RSLT_SALES_AMT_TOT
		                   
		                   ,SUM(XXA.PLAN_SALES_PROFIT_AMT)                                AS PLAN_SALES_PROFIT_AMT
		                   ,AVG(XXA.PLAN_SALES_PROFIT_AMT_TOT)                            AS PLAN_SALES_PROFIT_AMT_TOT
		                   ,SUM(XXA.RSLT_SALES_PROFIT_AMT)                                AS RSLT_SALES_PROFIT_AMT
		                   ,AVG(XXA.RSLT_SALES_PROFIT_AMT_TOT)                            AS RSLT_SALES_PROFIT_AMT_TOT
		                   ,SUM(XXA.PRE_RSLT_SALES_PROFIT_AMT)                            AS PRE_RSLT_SALES_PROFIT_AMT
		                   ,AVG(XXA.PRE_RSLT_SALES_PROFIT_AMT_TOT)                        AS PRE_RSLT_SALES_PROFIT_AMT_TOT
		            
		                   ,GROUPING(XXA.DEPT_CD)||GROUPING(XXA.TEAM_CD)             		AS GROUP_GUBUN
		             	   ,RPAD(NVL(XXA.STR_CD,'00') || XXA.DEPT_CD || XXA.TEAM_CD, 10, '00')    AS HD_ORG_CD
		            FROM (
		                  SELECT XA.STR_CD
		                   		 ,XA.DEPT_CD
		                   		 ,XA.TEAM_CD		                  
		                         ,XA.PLAN_SALES_AMT
		                         ,SUM(XA.PLAN_SALES_AMT) OVER()           AS PLAN_SALES_AMT_TOT
		                         ,XA.RSLT_SALES_AMT
		                         ,SUM(XA.RSLT_SALES_AMT) OVER()          AS RSLT_SALES_AMT_TOT
		                         ,XA.PRE_RSLT_SALES_AMT
		                         ,SUM(XA.PRE_RSLT_SALES_AMT) OVER()    AS PRE_RSLT_SALES_AMT_TOT
		                         ,XA.PLAN_SALES_PROFIT_AMT
		                         ,SUM(XA.PLAN_SALES_PROFIT_AMT) OVER()   AS PLAN_SALES_PROFIT_AMT_TOT
		                         ,XA.RSLT_SALES_PROFIT_AMT
		                         ,SUM(XA.RSLT_SALES_PROFIT_AMT) OVER()   AS RSLT_SALES_PROFIT_AMT_TOT
		                         ,XA.PRE_RSLT_SALES_PROFIT_AMT
		                         ,SUM(XA.PRE_RSLT_SALES_PROFIT_AMT) OVER()   AS PRE_RSLT_SALES_PROFIT_AMT_TOT
		                  FROM (
		                        SELECT MA.STR_CD
		                         	   ,MA.DEPT_CD
		                         	   ,MA.TEAM_CD		                        
		                               ,SUM(MA.PLAN_SALES_AMT)                                       AS PLAN_SALES_AMT
		                               ,SUM(MA.RSLT_SALES_AMT)                                       AS RSLT_SALES_AMT
		                               ,SUM(MA.PRE_RSLT_SALES_AMT)                                   AS PRE_RSLT_SALES_AMT
		                               ,SUM(MA.PLAN_SALES_PROFIT_AMT)                                AS PLAN_SALES_PROFIT_AMT                   
		                               ,SUM(MA.RSLT_SALES_PROFIT_AMT)                                AS RSLT_SALES_PROFIT_AMT
		                               ,SUM(MA.PRE_RSLT_SALES_PROFIT_AMT)                            AS PRE_RSLT_SALES_PROFIT_AMT                   
		                        FROM (
		                             /* 계획 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                             
		                                    ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)) AS PLAN_SALES_AMT
		                                    ,0                                               AS RSLT_SALES_AMT
		                                    ,0                                               AS PRE_RSLT_SALES_AMT
		                                    ,0                                               AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                               AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                               AS PRE_RSLT_SALES_PROFIT_AMT
		                                    
		                             FROM MSS.ME_BIZPLANRPT RPT 
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 실적 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                           
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             
		                             AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 전년실적 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT       
		                                    
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
		                                                 AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		                             
		                             UNION ALL
		                             
		                             /* 계획 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                             
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0))    AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                    
		                             FROM MSS.ME_BIZPLANRPT RPT 
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 실적 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                           
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             
		                             AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 전년실적 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_PROFIT_AMT       
		                                    
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
		                                                 AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		            				 AND RPT.ORG_LEVEL >= 3
		                             ) MA
		                  		WHERE 1 = 1
		                  		AND MA.STR_CD = ?     
		                  		GROUP BY MA.STR_CD,MA.DEPT_CD,MA.TEAM_CD
		                       ) XA
		                  ) XXA
		            GROUP BY XXA.STR_CD,ROLLUP(XXA.DEPT_CD,XXA.TEAM_CD)
		      ) MMA
		--WHERE MMA.GROUP_GUBUN != '01'    
		WHERE MMA.GROUP_GUBUN NOT LIKE '%1%'		  
		) XA    
    ]]>
    </query>
    
    <!-- PC별 매출구성계획분석 조회 -->
    <query name="SEL_TAB2_PC">
    <![CDATA[
		/*******
		* PC별 매출구성계획분석 조회
		*******/
		SELECT XA.ORG_CD
		       ,XA.ORG_NAME
		       ,XA.SUM_GUBUN
		       /* 매출구성비 */
		       ,XA.PLAN_SALES_RATE
		       ,XA.RSLT_SALES_RATE
		       ,XA.RSLT_SALES_RATE - XA.PLAN_SALES_RATE                   AS SALES_ACHIEVE_DIFF
		       ,XA.PRE_RSLT_SALES_RATE
		       ,XA.RSLT_SALES_RATE - XA.PRE_RSLT_SALES_RATE               AS SALES_INC_DEC_DIFF
		       /* 매출이익구성비 */
		       ,XA.PLAN_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE - XA.PLAN_SALES_PROFIT_RATE     AS SALES_PROFIT_ACHIEVE_DIFF
		       ,XA.PRE_RSLT_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE - XA.PRE_RSLT_SALES_PROFIT_RATE AS SALES_PROFIT_INC_DEC_DIFF
		       
		       ,XA.GROUP_GUBUN
		       ,XA.HD_ORG_CD
		       ,?	AS STR_CD
		       ,?	AS BIZ_RSLT_YM
		       ,?	AS ORG_LEVEL
		       ,?	AS SUM_GB      
		       
               --,SUBSTR(XA.ORG_CD, 1, 2)                                                 AS STR_CD
               ,SUBSTR(XA.ORG_CD, 3, 2)                                                 AS DEPT_CD
               ,SUBSTR(XA.ORG_CD, 5, 2)                                                 AS TEAM_CD
               ,SUBSTR(XA.ORG_CD, 7, 2)                                                 AS PC_CD

               ,XA.PLAN_SALES_AMT
               ,XA.PLAN_SALES_AMT_TOT
               ,XA.RSLT_SALES_AMT
               ,XA.RSLT_SALES_AMT_TOT
               ,XA.PRE_RSLT_SALES_AMT
               ,XA.PRE_RSLT_SALES_AMT_TOT
             
               ,XA.PLAN_SALES_PROFIT_AMT
               ,XA.PLAN_SALES_PROFIT_AMT_TOT
               ,XA.RSLT_SALES_PROFIT_AMT
               ,XA.RSLT_SALES_PROFIT_AMT_TOT
               ,XA.PRE_RSLT_SALES_PROFIT_AMT
               ,XA.PRE_RSLT_SALES_PROFIT_AMT_TOT  		       
		        
		FROM (
		      SELECT DECODE(GROUP_GUBUN, '000',MMA.ORG_CD, '')      AS ORG_CD
					 ,DECODE(GROUP_GUBUN, '111', '합계'
					                    , '001', '소계'
					                           , (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD))        AS ORG_NAME                                        
					 ,DECODE(GROUP_GUBUN, '111', '0','001', '1', '2')          AS SUM_GUBUN
		             /* 매출구성비 */
		             ,DECODE(MMA.PLAN_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PLAN_SALES_AMT/MMA.PLAN_SALES_AMT_TOT*100,2))                           AS PLAN_SALES_RATE
		             ,DECODE(MMA.RSLT_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.RSLT_SALES_AMT/MMA.RSLT_SALES_AMT_TOT*100,2))                           AS RSLT_SALES_RATE
		             ,DECODE(MMA.PRE_RSLT_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PRE_RSLT_SALES_AMT/MMA.PRE_RSLT_SALES_AMT_TOT*100,2))                   AS PRE_RSLT_SALES_RATE
		             /* 매출이익구성비 */
		             ,DECODE(MMA.PLAN_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_PROFIT_AMT_TOT*100,2))             AS PLAN_SALES_PROFIT_RATE
		             ,DECODE(MMA.RSLT_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.RSLT_SALES_PROFIT_AMT_TOT*100,2))             AS RSLT_SALES_PROFIT_RATE
		             ,DECODE(MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PRE_RSLT_SALES_PROFIT_AMT/MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT*100,2))     AS PRE_RSLT_SALES_PROFIT_RATE
		                                           
		             ,MMA.GROUP_GUBUN
		             ,MMA.HD_ORG_CD
		             
		             ,MMA.PLAN_SALES_AMT
		             ,MMA.PLAN_SALES_AMT_TOT
		             ,MMA.RSLT_SALES_AMT
		             ,MMA.RSLT_SALES_AMT_TOT
		             ,MMA.PRE_RSLT_SALES_AMT
		             ,MMA.PRE_RSLT_SALES_AMT_TOT
		             
		             ,MMA.PLAN_SALES_PROFIT_AMT
		             ,MMA.PLAN_SALES_PROFIT_AMT_TOT
		             ,MMA.RSLT_SALES_PROFIT_AMT
		             ,MMA.RSLT_SALES_PROFIT_AMT_TOT
		             ,MMA.PRE_RSLT_SALES_PROFIT_AMT
		             ,MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT		             
		             
		      FROM (
		            SELECT RPAD(XXA.STR_CD || XXA.DEPT_CD || XXA.TEAM_CD || XXA.PC_CD, 10, '00') AS ORG_CD
		            
		                   ,SUM(XXA.PLAN_SALES_AMT)                                       AS PLAN_SALES_AMT
		                   ,AVG(XXA.PLAN_SALES_AMT_TOT)                                   AS PLAN_SALES_AMT_TOT
		                   ,SUM(XXA.RSLT_SALES_AMT)                                       AS RSLT_SALES_AMT
		                   ,AVG(XXA.RSLT_SALES_AMT_TOT)                                   AS RSLT_SALES_AMT_TOT
		                   ,SUM(XXA.PRE_RSLT_SALES_AMT)                                   AS PRE_RSLT_SALES_AMT
		                   ,AVG(XXA.PRE_RSLT_SALES_AMT_TOT)                               AS PRE_RSLT_SALES_AMT_TOT
		                   
		                   ,SUM(XXA.PLAN_SALES_PROFIT_AMT)                                AS PLAN_SALES_PROFIT_AMT
		                   ,AVG(XXA.PLAN_SALES_PROFIT_AMT_TOT)                            AS PLAN_SALES_PROFIT_AMT_TOT
		                   ,SUM(XXA.RSLT_SALES_PROFIT_AMT)                                AS RSLT_SALES_PROFIT_AMT
		                   ,AVG(XXA.RSLT_SALES_PROFIT_AMT_TOT)                            AS RSLT_SALES_PROFIT_AMT_TOT
		                   ,SUM(XXA.PRE_RSLT_SALES_PROFIT_AMT)                            AS PRE_RSLT_SALES_PROFIT_AMT
		                   ,AVG(XXA.PRE_RSLT_SALES_PROFIT_AMT_TOT)                        AS PRE_RSLT_SALES_PROFIT_AMT_TOT
		            
		                   ,GROUPING(XXA.DEPT_CD)||GROUPING(XXA.TEAM_CD)||GROUPING(XXA.PC_CD)             AS GROUP_GUBUN
		             	   ,RPAD(NVL(XXA.STR_CD,'00') || XXA.DEPT_CD || XXA.TEAM_CD || XXA.PC_CD, 10, '00')    AS HD_ORG_CD
		            FROM (
		                  SELECT XA.STR_CD
		                   		 ,XA.DEPT_CD
		                   		 ,XA.TEAM_CD
		                   		 ,XA.PC_CD		                  
		                         ,XA.PLAN_SALES_AMT
		                         ,SUM(XA.PLAN_SALES_AMT) OVER()           AS PLAN_SALES_AMT_TOT
		                         ,XA.RSLT_SALES_AMT
		                         ,SUM(XA.RSLT_SALES_AMT) OVER()          AS RSLT_SALES_AMT_TOT
		                         ,XA.PRE_RSLT_SALES_AMT
		                         ,SUM(XA.PRE_RSLT_SALES_AMT) OVER()    AS PRE_RSLT_SALES_AMT_TOT
		                         ,XA.PLAN_SALES_PROFIT_AMT
		                         ,SUM(XA.PLAN_SALES_PROFIT_AMT) OVER()   AS PLAN_SALES_PROFIT_AMT_TOT
		                         ,XA.RSLT_SALES_PROFIT_AMT
		                         ,SUM(XA.RSLT_SALES_PROFIT_AMT) OVER()   AS RSLT_SALES_PROFIT_AMT_TOT
		                         ,XA.PRE_RSLT_SALES_PROFIT_AMT
		                         ,SUM(XA.PRE_RSLT_SALES_PROFIT_AMT) OVER()   AS PRE_RSLT_SALES_PROFIT_AMT_TOT
		                  FROM (
		                        SELECT MA.STR_CD
		                         	   ,MA.DEPT_CD
		                         	   ,MA.TEAM_CD
		                         	   ,MA.PC_CD		                        
		                               ,SUM(MA.PLAN_SALES_AMT)                                       AS PLAN_SALES_AMT
		                               ,SUM(MA.RSLT_SALES_AMT)                                       AS RSLT_SALES_AMT
		                               ,SUM(MA.PRE_RSLT_SALES_AMT)                                   AS PRE_RSLT_SALES_AMT
		                               ,SUM(MA.PLAN_SALES_PROFIT_AMT)                                AS PLAN_SALES_PROFIT_AMT                   
		                               ,SUM(MA.RSLT_SALES_PROFIT_AMT)                                AS RSLT_SALES_PROFIT_AMT
		                               ,SUM(MA.PRE_RSLT_SALES_PROFIT_AMT)                            AS PRE_RSLT_SALES_PROFIT_AMT                   
		                        FROM (
		                             /* 계획 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                             
		                                    ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)) AS PLAN_SALES_AMT
		                                    ,0                                               AS RSLT_SALES_AMT
		                                    ,0                                               AS PRE_RSLT_SALES_AMT
		                                    ,0                                               AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                               AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                               AS PRE_RSLT_SALES_PROFIT_AMT
		                                    
		                             FROM MSS.ME_BIZPLANRPT RPT 
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 실적 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                           
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             
		                             AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 전년실적 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT       
		                                    
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
		                                                 AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		                             
		                             UNION ALL
		                             
		                             /* 계획 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                             
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0))    AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                    
		                             FROM MSS.ME_BIZPLANRPT RPT 
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 실적 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                           
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             
		                             AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 전년실적 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_PROFIT_AMT       
		                                    
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
		                                                 AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		            				 AND RPT.ORG_LEVEL >= 3
		                             ) MA
				                WHERE 1 = 1
				                AND MA.STR_CD = ?     
				                GROUP BY MA.STR_CD,MA.DEPT_CD,MA.TEAM_CD,MA.PC_CD
		                       ) XA
		                  ) XXA
		            GROUP BY XXA.STR_CD,ROLLUP(XXA.DEPT_CD,XXA.TEAM_CD,XXA.PC_CD)
		      ) MMA
		--WHERE MMA.GROUP_GUBUN != '011'
		WHERE MMA.GROUP_GUBUN NOT LIKE '%1%'		
		) XA        
    ]]>
    </query> 
    
    <!-- 매출구성비실적분석 엑셀조회 -->
    <query name="SEL_TAB2_EXCEL">
    <![CDATA[
		/*******
		* 매출구성비실적분석 엑셀조회
		*******/
		SELECT XA.ORG_CD
		       ,XA.ORG_NAME
		       ,XA.SUM_GUBUN
		       /* 매출구성비 */
		       ,XA.PLAN_SALES_RATE
		       ,XA.RSLT_SALES_RATE
		       ,XA.RSLT_SALES_RATE - XA.PLAN_SALES_RATE                   AS SALES_ACHIEVE_DIFF
		       ,XA.PRE_RSLT_SALES_RATE
		       ,XA.RSLT_SALES_RATE - XA.PRE_RSLT_SALES_RATE               AS SALES_INC_DEC_DIFF
		       /* 매출이익구성비 */
		       ,XA.PLAN_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE - XA.PLAN_SALES_PROFIT_RATE     AS SALES_PROFIT_ACHIEVE_DIFF
		       ,XA.PRE_RSLT_SALES_PROFIT_RATE
		       ,XA.RSLT_SALES_PROFIT_RATE - XA.PRE_RSLT_SALES_PROFIT_RATE AS SALES_PROFIT_INC_DEC_DIFF
		       
		       ,XA.GROUP_GUBUN
		       ,XA.HD_ORG_CD
		       ,?	AS STR_CD
		       ,?	AS BIZ_RSLT_YM
		       ,?	AS ORG_LEVEL
		       ,?	AS SUM_GB 
		       
               --,SUBSTR(XA.ORG_CD, 1, 2)                                                 AS STR_CD
               ,SUBSTR(XA.ORG_CD, 3, 2)                                                 AS DEPT_CD
               ,SUBSTR(XA.ORG_CD, 5, 2)                                                 AS TEAM_CD
               ,SUBSTR(XA.ORG_CD, 7, 2)                                                 AS PC_CD

               ,XA.PLAN_SALES_AMT
               ,XA.PLAN_SALES_AMT_TOT
               ,XA.RSLT_SALES_AMT
               ,XA.RSLT_SALES_AMT_TOT
               ,XA.PRE_RSLT_SALES_AMT
               ,XA.PRE_RSLT_SALES_AMT_TOT
             
               ,XA.PLAN_SALES_PROFIT_AMT
               ,XA.PLAN_SALES_PROFIT_AMT_TOT
               ,XA.RSLT_SALES_PROFIT_AMT
               ,XA.RSLT_SALES_PROFIT_AMT_TOT
               ,XA.PRE_RSLT_SALES_PROFIT_AMT
               ,XA.PRE_RSLT_SALES_PROFIT_AMT_TOT  		       
		             
		FROM (
		      SELECT DECODE(GROUP_GUBUN, '000',MMA.ORG_CD, '')      AS ORG_CD
					 ,DECODE(GROUP_GUBUN, '111', '합계'
					                    , '001', '소계'
					                           , (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD))        AS ORG_NAME                                        
					 ,DECODE(GROUP_GUBUN, '111', '0','001', '1', '2')          AS SUM_GUBUN
		             /* 매출구성비 */
		             ,DECODE(MMA.PLAN_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PLAN_SALES_AMT/MMA.PLAN_SALES_AMT_TOT*100,2))                           AS PLAN_SALES_RATE
		             ,DECODE(MMA.RSLT_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.RSLT_SALES_AMT/MMA.RSLT_SALES_AMT_TOT*100,2))                           AS RSLT_SALES_RATE
		             ,DECODE(MMA.PRE_RSLT_SALES_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PRE_RSLT_SALES_AMT/MMA.PRE_RSLT_SALES_AMT_TOT*100,2))                   AS PRE_RSLT_SALES_RATE
		             /* 매출이익구성비 */
		             ,DECODE(MMA.PLAN_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_PROFIT_AMT_TOT*100,2))             AS PLAN_SALES_PROFIT_RATE
		             ,DECODE(MMA.RSLT_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.RSLT_SALES_PROFIT_AMT_TOT*100,2))             AS RSLT_SALES_PROFIT_RATE
		             ,DECODE(MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT, 0, 0
		                                           ,ROUND(MMA.PRE_RSLT_SALES_PROFIT_AMT/MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT*100,2))     AS PRE_RSLT_SALES_PROFIT_RATE
		                                           
		             ,MMA.GROUP_GUBUN
		             ,MMA.HD_ORG_CD
		             
		             ,MMA.PLAN_SALES_AMT
		             ,MMA.PLAN_SALES_AMT_TOT
		             ,MMA.RSLT_SALES_AMT
		             ,MMA.RSLT_SALES_AMT_TOT
		             ,MMA.PRE_RSLT_SALES_AMT
		             ,MMA.PRE_RSLT_SALES_AMT_TOT
		             
		             ,MMA.PLAN_SALES_PROFIT_AMT
		             ,MMA.PLAN_SALES_PROFIT_AMT_TOT
		             ,MMA.RSLT_SALES_PROFIT_AMT
		             ,MMA.RSLT_SALES_PROFIT_AMT_TOT
		             ,MMA.PRE_RSLT_SALES_PROFIT_AMT
		             ,MMA.PRE_RSLT_SALES_PROFIT_AMT_TOT			             
		             
		      FROM (
		            SELECT RPAD(XXA.STR_CD || XXA.DEPT_CD || XXA.TEAM_CD || XXA.PC_CD, 10, '00') AS ORG_CD
		            
		                   ,SUM(XXA.PLAN_SALES_AMT)                                       AS PLAN_SALES_AMT
		                   ,AVG(XXA.PLAN_SALES_AMT_TOT)                                   AS PLAN_SALES_AMT_TOT
		                   ,SUM(XXA.RSLT_SALES_AMT)                                       AS RSLT_SALES_AMT
		                   ,AVG(XXA.RSLT_SALES_AMT_TOT)                                   AS RSLT_SALES_AMT_TOT
		                   ,SUM(XXA.PRE_RSLT_SALES_AMT)                                   AS PRE_RSLT_SALES_AMT
		                   ,AVG(XXA.PRE_RSLT_SALES_AMT_TOT)                               AS PRE_RSLT_SALES_AMT_TOT
		                   
		                   ,SUM(XXA.PLAN_SALES_PROFIT_AMT)                                AS PLAN_SALES_PROFIT_AMT
		                   ,AVG(XXA.PLAN_SALES_PROFIT_AMT_TOT)                            AS PLAN_SALES_PROFIT_AMT_TOT
		                   ,SUM(XXA.RSLT_SALES_PROFIT_AMT)                                AS RSLT_SALES_PROFIT_AMT
		                   ,AVG(XXA.RSLT_SALES_PROFIT_AMT_TOT)                            AS RSLT_SALES_PROFIT_AMT_TOT
		                   ,SUM(XXA.PRE_RSLT_SALES_PROFIT_AMT)                            AS PRE_RSLT_SALES_PROFIT_AMT
		                   ,AVG(XXA.PRE_RSLT_SALES_PROFIT_AMT_TOT)                        AS PRE_RSLT_SALES_PROFIT_AMT_TOT
		            
		                   ,GROUPING(XXA.DEPT_CD)||GROUPING(XXA.TEAM_CD)||GROUPING(XXA.PC_CD)             AS GROUP_GUBUN
		             	   ,RPAD(NVL(XXA.STR_CD,'00') || XXA.DEPT_CD || XXA.TEAM_CD || XXA.PC_CD, 10, '00')    AS HD_ORG_CD
		            FROM (
		                  SELECT XA.STR_CD
		                   		 ,XA.DEPT_CD
		                   		 ,XA.TEAM_CD
		                   		 ,XA.PC_CD		                  
		                         ,XA.PLAN_SALES_AMT
		                         ,SUM(XA.PLAN_SALES_AMT) OVER()           AS PLAN_SALES_AMT_TOT
		                         ,XA.RSLT_SALES_AMT
		                         ,SUM(XA.RSLT_SALES_AMT) OVER()          AS RSLT_SALES_AMT_TOT
		                         ,XA.PRE_RSLT_SALES_AMT
		                         ,SUM(XA.PRE_RSLT_SALES_AMT) OVER()    AS PRE_RSLT_SALES_AMT_TOT
		                         ,XA.PLAN_SALES_PROFIT_AMT
		                         ,SUM(XA.PLAN_SALES_PROFIT_AMT) OVER()   AS PLAN_SALES_PROFIT_AMT_TOT
		                         ,XA.RSLT_SALES_PROFIT_AMT
		                         ,SUM(XA.RSLT_SALES_PROFIT_AMT) OVER()   AS RSLT_SALES_PROFIT_AMT_TOT
		                         ,XA.PRE_RSLT_SALES_PROFIT_AMT
		                         ,SUM(XA.PRE_RSLT_SALES_PROFIT_AMT) OVER()   AS PRE_RSLT_SALES_PROFIT_AMT_TOT
		                  FROM (
		                        SELECT MA.STR_CD
		                         	   ,MA.DEPT_CD
		                         	   ,MA.TEAM_CD
		                         	   ,MA.PC_CD		                        
		                               ,SUM(MA.PLAN_SALES_AMT)                                       AS PLAN_SALES_AMT
		                               ,SUM(MA.RSLT_SALES_AMT)                                       AS RSLT_SALES_AMT
		                               ,SUM(MA.PRE_RSLT_SALES_AMT)                                   AS PRE_RSLT_SALES_AMT
		                               ,SUM(MA.PLAN_SALES_PROFIT_AMT)                                AS PLAN_SALES_PROFIT_AMT                   
		                               ,SUM(MA.RSLT_SALES_PROFIT_AMT)                                AS RSLT_SALES_PROFIT_AMT
		                               ,SUM(MA.PRE_RSLT_SALES_PROFIT_AMT)                            AS PRE_RSLT_SALES_PROFIT_AMT                   
		                        FROM (
		                             /* 계획 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                             
		                                    ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)) AS PLAN_SALES_AMT
		                                    ,0                                               AS RSLT_SALES_AMT
		                                    ,0                                               AS PRE_RSLT_SALES_AMT
		                                    ,0                                               AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                               AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                               AS PRE_RSLT_SALES_PROFIT_AMT
		                                    
		                             FROM MSS.ME_BIZPLANRPT RPT 
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 실적 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                           
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             
		                             AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 전년실적 매출액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT       
		                                    
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '1'   /* 총매출 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
		                                                 AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		                             
		                             UNION ALL
		                             
		                             /* 계획 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                             
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0))    AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                    
		                             FROM MSS.ME_BIZPLANRPT RPT 
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 실적 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_PROFIT_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
		                                           
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             
		                             AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
		                             
		                             UNION ALL
		                             
		                             /* 전년실적 매출이익액 */
		                             SELECT RPT.STR_CD
		                                    ,RPT.DEPT_CD
		                                    ,RPT.TEAM_CD
		                                    ,RPT.PC_CD
		                                    ,RPT.ORG_CD
		                                    ,RPT.ORG_FLAG
		                                    ,RPT.ORG_LEVEL
		                                    
		                                    ,0                                                  AS PLAN_SALES_AMT
		                                    ,0                                                  AS RSLT_SALES_AMT
		                                    ,0                                                  AS PRE_RSLT_SALES_AMT
		                                    ,0                                                  AS PLAN_SALES_PROFIT_AMT
		                                    ,0                                                  AS RSLT_SALES_PROFIT_AMT
		                                    ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_PROFIT_AMT       
		                                    
		                             FROM MSS.ME_BIZRSLTRPT RPT
		                             WHERE EXISTS (
		                                           SELECT 1
		                                           FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                           AND A.SYS_PART = 'D'
		                                           AND A.COMM_PART = 'M104'
		                                           AND A.COMM_CODE = '3'   /* 매출이익 */
		                                           AND A.REFER_CODE = RPT.BIZ_CD
		                                          )
		                             AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
		                                                 AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		            
		                             ) MA
				                WHERE 1 = 1
				                AND MA.STR_CD = ?     
				                GROUP BY MA.STR_CD,MA.DEPT_CD,MA.TEAM_CD,MA.PC_CD
		                       ) XA
		                  ) XXA
		            GROUP BY XXA.STR_CD,ROLLUP(XXA.DEPT_CD,XXA.TEAM_CD,XXA.PC_CD)
		      ) MMA
		--WHERE MMA.GROUP_GUBUN != '011'
		WHERE MMA.GROUP_GUBUN NOT LIKE '%1%'		
		) XA    
    ]]>
    </query>      

    <!-- 점별 매출구성실적분석 차트 조회 -->
    <query name="SEL_TAB2_CHART_STR">
    <![CDATA[
    	/*******
    	* 점별 매출구성실적분석 차트 조회
    	*******/
		SELECT MMA.BIZ_CD
		       ,(SELECT A.BIZ_CD_NM FROM MSS.ME_BIZCDMST A WHERE A.BIZ_CD = MMA.BIZ_CD) AS BIZ_CD_NM
           ,DECODE(MMA.PLAN_SALES_AMT_TOT, 0, 0, ROUND(MMA.PLAN_SALES_AMT/MMA.PLAN_SALES_AMT_TOT*100,2))         AS PLAN_SALES_RATIO
           ,DECODE(MMA.RSLT_SALES_AMT_TOT, 0, 0, ROUND(MMA.RSLT_SALES_AMT/MMA.RSLT_SALES_AMT_TOT*100,2))         AS RSLT_SALES_RATIO
		       ,DECODE(MMA.PRE_RSLT_SALES_AMT_TOT, 0, 0, ROUND(MMA.PRE_RSLT_SALES_AMT/MMA.PRE_RSLT_SALES_AMT_TOT*100,2))         AS PRE_RSLT_SALES_RATIO
		FROM (
		      SELECT MA.BIZ_CD
		             ,MA.PLAN_SALES_AMT
                 ,MA.RSLT_SALES_AMT
                 ,MA.PRE_RSLT_SALES_AMT
                 ,SUM(MA.PLAN_SALES_AMT) OVER()  AS PLAN_SALES_AMT_TOT
                 ,SUM(MA.RSLT_SALES_AMT) OVER()  AS RSLT_SALES_AMT_TOT
		             ,SUM(MA.PRE_RSLT_SALES_AMT) OVER()  AS PRE_RSLT_SALES_AMT_TOT
		      FROM (
		            SELECT AA.BIZ_CD
                       ,SUM(AA.PLAN_SALES_AMT)                AS PLAN_SALES_AMT
		                   ,SUM(AA.RSLT_SALES_AMT)                AS RSLT_SALES_AMT
                       ,SUM(AA.PRE_RSLT_SALES_AMT)            AS PRE_RSLT_SALES_AMT
		            FROM (

		                  /* 계획 매출액 */
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.ORG_FLAG
		                         ,RPT.ORG_LEVEL
		                         ,RPT.BIZ_CD
                             
                             ,(NVL(RPT.PLAN_AMT,0))              AS PLAN_SALES_AMT
                             ,0                                  AS RSLT_SALES_AMT
		                         ,0                                  AS PRE_RSLT_SALES_AMT
		                         
		                  FROM MSS.ME_BIZPLANRPT RPT 
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE = ?   /* 총매출 or 총매출이익*/
		                                AND SUBSTR(A.REFER_CODE, 1, 2) = SUBSTR(RPT.BIZ_CD, 1, 2)
		                               )
                      AND RPT.BIZ_PLAN_YM BETWEEN ? AND ?
                      
		                  AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
		                  AND NVL(RPT.PLAN_AMT,0) != 0
                      
                      UNION ALL

                      /* 실적 매출액 */
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.ORG_FLAG
		                         ,RPT.ORG_LEVEL
		                         ,RPT.BIZ_CD
                             
                             ,0                                               AS PLAN_SALES_AMT
                             ,(NVL(RPT.RSLT_AMT,0))                           AS RSLT_SALES_AMT
		                         ,0                                               AS PRE_RSLT_SALES_AMT
		                         
		                  FROM MSS.ME_BIZRSLTRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE = ?   /* 총매출 or 총매출이익*/
		                                AND SUBSTR(A.REFER_CODE, 1, 2) = SUBSTR(RPT.BIZ_CD, 1, 2)
		                               )
                      
                      AND RPT.BIZ_RSLT_YM BETWEEN ? AND ?
                      
                      AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
		                  AND NVL(RPT.RSLT_AMT,0) != 0

 		                  UNION ALL
                      
		                  /* 전년실적 매출액 */
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.ORG_FLAG
		                         ,RPT.ORG_LEVEL
		                         ,RPT.BIZ_CD
                             
                             ,0                                               AS PLAN_SALES_AMT
                             ,0                                               AS RSLT_SALES_AMT
		                         ,(NVL(RPT.RSLT_AMT,0))                           AS PRE_RSLT_SALES_AMT
		                         
		                  FROM MSS.ME_BIZRSLTRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE = ?   /* 총매출 or 총매출이익*/
		                                AND SUBSTR(A.REFER_CODE, 1, 2) = SUBSTR(RPT.BIZ_CD, 1, 2)
		                               )
                      AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
                                              AND TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                      
                      AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
		                  AND NVL(RPT.RSLT_AMT,0) != 0
		                  
		                 ) AA
		            WHERE 1 = 1
		            AND AA.STR_CD LIKE ?
		            GROUP BY AA.BIZ_CD
		           ) MA
		     ) MMA    
    ]]>
    </query>
    
    <!-- 팀별 매출구성실적분석 차트 조회 -->
    <query name="SEL_TAB2_CHART_TEAM">
    <![CDATA[
    	/*******
    	* 팀별 매출구성실적분석 차트 조회
    	*******/
		SELECT MMA.BIZ_CD
		       ,(SELECT A.BIZ_CD_NM FROM MSS.ME_BIZCDMST A WHERE A.BIZ_CD = MMA.BIZ_CD) AS BIZ_CD_NM
           ,DECODE(MMA.PLAN_SALES_AMT_TOT, 0, 0, ROUND(MMA.PLAN_SALES_AMT/MMA.PLAN_SALES_AMT_TOT*100,2))         AS PLAN_SALES_RATIO
           ,DECODE(MMA.RSLT_SALES_AMT_TOT, 0, 0, ROUND(MMA.RSLT_SALES_AMT/MMA.RSLT_SALES_AMT_TOT*100,2))         AS RSLT_SALES_RATIO
		       ,DECODE(MMA.PRE_RSLT_SALES_AMT_TOT, 0, 0, ROUND(MMA.PRE_RSLT_SALES_AMT/MMA.PRE_RSLT_SALES_AMT_TOT*100,2))         AS PRE_RSLT_SALES_RATIO
		FROM (
		      SELECT MA.BIZ_CD
		             ,MA.PLAN_SALES_AMT
                 ,MA.RSLT_SALES_AMT
                 ,MA.PRE_RSLT_SALES_AMT
                 ,SUM(MA.PLAN_SALES_AMT) OVER()  AS PLAN_SALES_AMT_TOT
                 ,SUM(MA.RSLT_SALES_AMT) OVER()  AS RSLT_SALES_AMT_TOT
		             ,SUM(MA.PRE_RSLT_SALES_AMT) OVER()  AS PRE_RSLT_SALES_AMT_TOT
		      FROM (
		            SELECT AA.BIZ_CD
                       ,SUM(AA.PLAN_SALES_AMT)                AS PLAN_SALES_AMT
		                   ,SUM(AA.RSLT_SALES_AMT)                AS RSLT_SALES_AMT
                       ,SUM(AA.PRE_RSLT_SALES_AMT)            AS PRE_RSLT_SALES_AMT
		            FROM (

		                  /* 계획 매출액 */
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.ORG_FLAG
		                         ,RPT.ORG_LEVEL
		                         ,RPT.BIZ_CD
                             
                             ,(NVL(RPT.PLAN_AMT,0))              AS PLAN_SALES_AMT
                             ,0                                  AS RSLT_SALES_AMT
		                         ,0                                  AS PRE_RSLT_SALES_AMT
		                         
		                  FROM MSS.ME_BIZPLANRPT RPT 
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE = ?   /* 총매출 or 총매출이익*/
		                                AND SUBSTR(A.REFER_CODE, 1, 2) = SUBSTR(RPT.BIZ_CD, 1, 2)
		                               )
                      AND RPT.BIZ_PLAN_YM BETWEEN ? AND ?
                      
		                  AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
		                  AND NVL(RPT.PLAN_AMT,0) != 0
                      
                      UNION ALL

                      /* 실적 매출액 */
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.ORG_FLAG
		                         ,RPT.ORG_LEVEL
		                         ,RPT.BIZ_CD
                             
                             ,0                                               AS PLAN_SALES_AMT
                             ,(NVL(RPT.RSLT_AMT,0))                           AS RSLT_SALES_AMT
		                         ,0                                               AS PRE_RSLT_SALES_AMT
		                         
		                  FROM MSS.ME_BIZRSLTRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE = ?   /* 총매출 or 총매출이익*/
		                                AND SUBSTR(A.REFER_CODE, 1, 2) = SUBSTR(RPT.BIZ_CD, 1, 2)
		                               )
                      
                      AND RPT.BIZ_RSLT_YM BETWEEN ? AND ?
                      
                      AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
		                  AND NVL(RPT.RSLT_AMT,0) != 0

 		                  UNION ALL
                      
		                  /* 전년실적 매출액 */
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.ORG_FLAG
		                         ,RPT.ORG_LEVEL
		                         ,RPT.BIZ_CD
                             
                             ,0                                               AS PLAN_SALES_AMT
                             ,0                                               AS RSLT_SALES_AMT
		                         ,(NVL(RPT.RSLT_AMT,0))                           AS PRE_RSLT_SALES_AMT
		                         
		                  FROM MSS.ME_BIZRSLTRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE = ?   /* 총매출 or 총매출이익*/
		                                AND SUBSTR(A.REFER_CODE, 1, 2) = SUBSTR(RPT.BIZ_CD, 1, 2)
		                               )
                      AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
                                              AND TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                      
                      AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
		                  AND NVL(RPT.RSLT_AMT,0) != 0
		                  
		                 ) AA
		            WHERE 1 = 1
		            AND AA.STR_CD || AA.DEPT_CD || AA.TEAM_CD LIKE ?
		            GROUP BY AA.BIZ_CD
		           ) MA
		     ) MMA    
    ]]>
    </query>    
    
    <!-- PC별 매출구성실적분석 차트 조회 -->
    <query name="SEL_TAB2_CHART_PC">
    <![CDATA[
    	/*******
    	* PC별 매출구성실적분석 차트 조회
    	*******/
		SELECT MMA.BIZ_CD
		       ,(SELECT A.BIZ_CD_NM FROM MSS.ME_BIZCDMST A WHERE A.BIZ_CD = MMA.BIZ_CD) AS BIZ_CD_NM
           ,DECODE(MMA.PLAN_SALES_AMT_TOT, 0, 0, ROUND(MMA.PLAN_SALES_AMT/MMA.PLAN_SALES_AMT_TOT*100,2))         AS PLAN_SALES_RATIO
           ,DECODE(MMA.RSLT_SALES_AMT_TOT, 0, 0, ROUND(MMA.RSLT_SALES_AMT/MMA.RSLT_SALES_AMT_TOT*100,2))         AS RSLT_SALES_RATIO
		       ,DECODE(MMA.PRE_RSLT_SALES_AMT_TOT, 0, 0, ROUND(MMA.PRE_RSLT_SALES_AMT/MMA.PRE_RSLT_SALES_AMT_TOT*100,2))         AS PRE_RSLT_SALES_RATIO
		FROM (
		      SELECT MA.BIZ_CD
		             ,MA.PLAN_SALES_AMT
                 ,MA.RSLT_SALES_AMT
                 ,MA.PRE_RSLT_SALES_AMT
                 ,SUM(MA.PLAN_SALES_AMT) OVER()  AS PLAN_SALES_AMT_TOT
                 ,SUM(MA.RSLT_SALES_AMT) OVER()  AS RSLT_SALES_AMT_TOT
		             ,SUM(MA.PRE_RSLT_SALES_AMT) OVER()  AS PRE_RSLT_SALES_AMT_TOT
		      FROM (
		            SELECT AA.BIZ_CD
                       ,SUM(AA.PLAN_SALES_AMT)                AS PLAN_SALES_AMT
		                   ,SUM(AA.RSLT_SALES_AMT)                AS RSLT_SALES_AMT
                       ,SUM(AA.PRE_RSLT_SALES_AMT)            AS PRE_RSLT_SALES_AMT
		            FROM (

		                  /* 계획 매출액 */
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.ORG_FLAG
		                         ,RPT.ORG_LEVEL
		                         ,RPT.BIZ_CD
                             
                             ,(NVL(RPT.PLAN_AMT,0))              AS PLAN_SALES_AMT
                             ,0                                  AS RSLT_SALES_AMT
		                         ,0                                  AS PRE_RSLT_SALES_AMT
		                         
		                  FROM MSS.ME_BIZPLANRPT RPT 
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE = ?   /* 총매출 or 총매출이익*/
		                                AND SUBSTR(A.REFER_CODE, 1, 2) = SUBSTR(RPT.BIZ_CD, 1, 2)
		                               )
                      AND RPT.BIZ_PLAN_YM BETWEEN ? AND ?
                      
		                  AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
		                  AND NVL(RPT.PLAN_AMT,0) != 0
                      
                      UNION ALL

                      /* 실적 매출액 */
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.ORG_FLAG
		                         ,RPT.ORG_LEVEL
		                         ,RPT.BIZ_CD
                             
                             ,0                                               AS PLAN_SALES_AMT
                             ,(NVL(RPT.RSLT_AMT,0))                           AS RSLT_SALES_AMT
		                         ,0                                               AS PRE_RSLT_SALES_AMT
		                         
		                  FROM MSS.ME_BIZRSLTRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE = ?   /* 총매출 or 총매출이익*/
		                                AND SUBSTR(A.REFER_CODE, 1, 2) = SUBSTR(RPT.BIZ_CD, 1, 2)
		                               )
                      
                      AND RPT.BIZ_RSLT_YM BETWEEN ? AND ?
                      
                      AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
		                  AND NVL(RPT.RSLT_AMT,0) != 0

 		                  UNION ALL
                      
		                  /* 전년실적 매출액 */
		                  SELECT RPT.STR_CD
		                         ,RPT.DEPT_CD
		                         ,RPT.TEAM_CD
		                         ,RPT.PC_CD
		                         ,RPT.ORG_CD
		                         ,RPT.ORG_FLAG
		                         ,RPT.ORG_LEVEL
		                         ,RPT.BIZ_CD
                             
                             ,0                                               AS PLAN_SALES_AMT
                             ,0                                               AS RSLT_SALES_AMT
		                         ,(NVL(RPT.RSLT_AMT,0))                           AS PRE_RSLT_SALES_AMT
		                         
		                  FROM MSS.ME_BIZRSLTRPT RPT
		                  WHERE EXISTS (
		                                SELECT 1
		                                FROM COM.TC_COMMCODE A WHERE 1 = 1
		                                AND A.SYS_PART = 'D'
		                                AND A.COMM_PART = 'M104'
		                                AND A.COMM_CODE = ?   /* 총매출 or 총매출이익*/
		                                AND SUBSTR(A.REFER_CODE, 1, 2) = SUBSTR(RPT.BIZ_CD, 1, 2)
		                               )
                      AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
                                              AND TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                      
                      AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
		                  AND NVL(RPT.RSLT_AMT,0) != 0
		                  
		                 ) AA
		            WHERE 1 = 1
		            AND AA.STR_CD || AA.DEPT_CD || AA.TEAM_CD || AA.PC_CD LIKE ?
		            GROUP BY AA.BIZ_CD
		           ) MA
		     ) MMA    
    ]]>
    </query>    

    <!-- 손익계획분석 헤더  -->
    <gauce name="H_SEL_TAB3">
    	<column colName="BIZ_CD"			colType="TB_STRING" 	size="6"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="BIZ_CD_NM"			colType="TB_STRING" 	size="60"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="PLAN_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="RSLT_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="ACHIEVE_RATE"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="PRE_RSLT_AMT"		colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="INC_DEC_RATIO"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="GROUP_ID"			colType="TB_STRING" 	size="6"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
    </gauce>

    <!-- 손익계획분석 조회 -->
    <query name="SEL_TAB3">
    <![CDATA[
    	/*******
    	* 손익실적분석 조회
    	*******/
		SELECT MMA.BIZ_CD
		       ,DECODE(MMA.GROUP_ID, '1', '합계',(SELECT A.BIZ_CD_NM FROM MSS.ME_BIZCDMST A WHERE A.BIZ_CD = MMA.BIZ_CD)) AS BIZ_CD_NM
		       ,MMA.PLAN_AMT			                                                                                AS PLAN_AMT
           	   ,MMA.RSLT_AMT                                                                                  AS RSLT_AMT
           	   ,DECODE(MMA.PLAN_AMT,0,0,ROUND(MMA.RSLT_AMT/MMA.PLAN_AMT*100,2))                                           AS ACHIEVE_RATE
           	   ,MMA.PRE_RSLT_AMT	                                                                              AS PRE_RSLT_AMT
		       ,ROUND(DECODE(MMA.PRE_RSLT_AMT, 0, 0, (MMA.RSLT_AMT - MMA.PRE_RSLT_AMT)/MMA.PRE_RSLT_AMT*100),2)           AS INC_DEC_RATIO
		       ,MMA.GROUP_ID
		FROM (
		      SELECT MA.BIZ_CD
		             ,SUM(MA.PLAN_AMT)      AS PLAN_AMT
		             ,SUM(MA.RSLT_AMT)      AS RSLT_AMT
                 	 ,SUM(MA.PRE_RSLT_AMT)  AS PRE_RSLT_AMT
		             ,GROUPING(MA.BIZ_CD)   AS GROUP_ID
		      FROM (
                	/* 계획 */
		            SELECT RPT.BIZ_CD
                           ,NVL(RPT.PLAN_AMT, 0) + NVL(RPT.SUB_PLAN_AMT, 0)                            AS PLAN_AMT
                           ,0                                                                          AS RSLT_AMT
		                   ,0                                                                          AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZPLANRPT RPT WHERE 1 = 1
                	AND RPT.BIZ_PLAN_YM BETWEEN ? AND ?
		            AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 3, 4) = '0000'
          
		            UNION ALL
                	
                	/* 실적 */
		            SELECT RPT.BIZ_CD
                       	   ,0                                                                          AS PLAN_AMT
                       	   ,NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0)                            AS RSLT_AMT
		                   ,0                                                                          AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_RSLT_YM BETWEEN ? AND ?
                	AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 3, 4) = '0000'
                
                	UNION ALL          
                	
                	/* 전년실적 */
		            SELECT RPT.BIZ_CD
		                   ,0                                                                          AS PLAN_AMT
                       	   ,0                                                                          AS RSLT_AMT
                       	   ,NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0)                            AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                                            AND TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                	AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 3, 4) = '0000'

		           ) MA
		      GROUP BY ROLLUP(MA.BIZ_CD)
		     ) MMA
		WHERE MMA.GROUP_ID NOT LIKE '%1%'		         
    ]]>
    </query>


    <!-- 손익계획분석 조회 -->
    <query name="SEL_TAB3_CHART">
    <![CDATA[
    	/*******
    	* 손익실적분석 조회
    	*******/
		SELECT MMA.BIZ_CD
		       ,DECODE(MMA.GROUP_ID, '1', '합계',(SELECT A.BIZ_CD_NM FROM MSS.ME_BIZCDMST A WHERE A.BIZ_CD = MMA.BIZ_CD)) AS BIZ_CD_NM
		       ,MMA.PLAN_AMT			                                                                                AS PLAN_AMT
           	   ,MMA.RSLT_AMT                                                                                  AS RSLT_AMT
           	   ,DECODE(MMA.PLAN_AMT,0,0,ROUND(MMA.RSLT_AMT/MMA.PLAN_AMT*100,2))                                           AS ACHIEVE_RATE
           	   ,MMA.PRE_RSLT_AMT	                                                                              AS PRE_RSLT_AMT
		       ,ROUND(DECODE(MMA.PRE_RSLT_AMT, 0, 0, (MMA.RSLT_AMT - MMA.PRE_RSLT_AMT)/MMA.PRE_RSLT_AMT*100),2)           AS INC_DEC_RATIO
		       ,MMA.GROUP_ID
		FROM (
		      SELECT MA.BIZ_CD
		             ,ROUND(SUM(MA.PLAN_AMT)/1000000)      AS PLAN_AMT
		             ,ROUND(SUM(MA.RSLT_AMT)/1000000)      AS RSLT_AMT
                 	 ,ROUND(SUM(MA.PRE_RSLT_AMT)/1000000)  AS PRE_RSLT_AMT
		             ,GROUPING(MA.BIZ_CD)   AS GROUP_ID
		      FROM (
                	/* 계획 */
		            SELECT RPT.BIZ_CD
                           ,NVL(RPT.PLAN_AMT, 0) + NVL(RPT.SUB_PLAN_AMT, 0)                            AS PLAN_AMT
                           ,0                                                                          AS RSLT_AMT
		                   ,0                                                                          AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZPLANRPT RPT WHERE 1 = 1
                	AND RPT.BIZ_PLAN_YM BETWEEN ? AND ?
		            AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 3, 4) = '0000'
          
		            UNION ALL
                	
                	/* 실적 */
		            SELECT RPT.BIZ_CD
                       	   ,0                                                                          AS PLAN_AMT
                       	   ,NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0)                            AS RSLT_AMT
		                   ,0                                                                          AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_RSLT_YM BETWEEN ? AND ?
                	AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 3, 4) = '0000'
                
                	UNION ALL          
                	
                	/* 전년실적 */
		            SELECT RPT.BIZ_CD
		                   ,0                                                                          AS PLAN_AMT
                       	   ,0                                                                          AS RSLT_AMT
                       	   ,NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0)                            AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                                            AND TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                	AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 3, 4) = '0000'

		           ) MA
		      GROUP BY ROLLUP(MA.BIZ_CD)
		     ) MMA
		WHERE MMA.GROUP_ID NOT LIKE '%1%'		         
    ]]>
    </query>

    <!-- 손익실적분석 헤더  -->
    <gauce name="H_SEL_TAB3_EXCEL">
    	<column colName="ORG_CD"			colType="TB_STRING" 	size="10"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="ORG_NAME"			colType="TB_STRING" 	size="60"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
    	<column colName="BIZ_CD"			colType="TB_STRING" 	size="6"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="BIZ_CD_NM"			colType="TB_STRING" 	size="60"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="PLAN_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="RSLT_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />        
		<column colName="ACHIEVE_RATE"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="PRE_RSLT_AMT"		colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="INC_DEC_RATIO"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="GROUP_ID"			colType="TB_STRING" 	size="6"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
    </gauce>

    <!-- 손익실적분석 엑셀조회 -->
    <query name="SEL_TAB3_EXCEL">
    <![CDATA[
		/*******
		* 손익실적분석 엑셀조회
		*******/
		SELECT MMA.ORG_CD
		     ,(SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD)  AS ORG_NAME
		     ,MMA.BIZ_CD
		     ,DECODE(MMA.GROUP_ID, '1', '소계',(SELECT A.BIZ_CD_NM FROM MSS.ME_BIZCDMST A WHERE A.BIZ_CD = MMA.BIZ_CD)) AS BIZ_CD_NM
		     ,MMA.PLAN_AMT
		     ,MMA.RSLT_AMT
         	 ,DECODE(MMA.PLAN_AMT,0,0,ROUND(MMA.RSLT_AMT/MMA.PLAN_AMT*100,2))                                           AS ACHIEVE_RATE
		     ,MMA.PRE_RSLT_AMT
		     ,ROUND(DECODE(MMA.PRE_RSLT_AMT, 0, 0, (MMA.RSLT_AMT - MMA.PRE_RSLT_AMT)/MMA.PRE_RSLT_AMT*100),2)           AS INC_DEC_RATIO
		     ,MMA.GROUP_ID
		FROM (
		      SELECT XA.ORG_CD
		             ,XA.BIZ_CD
		             ,SUM(XA.PLAN_AMT)       AS PLAN_AMT
		             ,SUM(XA.RSLT_AMT)       AS RSLT_AMT
		             ,SUM(XA.PRE_RSLT_AMT)   AS PRE_RSLT_AMT
		             ,GROUPING(XA.BIZ_CD) AS GROUP_ID
		      FROM (
		      		      SELECT RPAD(MA.STR_CD || MA.DEPT_CD || MA.TEAM_CD || MA.PC_CD, 10, '00') AS ORG_CD
		                       ,MA.BIZ_CD
		      		             ,ROUND(SUM(MA.PLAN_AMT)/1000000)      AS PLAN_AMT
		      		             ,ROUND(SUM(MA.RSLT_AMT)/1000000)      AS RSLT_AMT
		      		             ,ROUND(SUM(MA.PRE_RSLT_AMT)/1000000)  AS PRE_RSLT_AMT
		      		      FROM (
                          /* 계획 */
		      		            SELECT RPT.STR_CD
		                             ,RPT.DEPT_CD
		                             ,RPT.TEAM_CD
		                             ,RPT.PC_CD
		                             ,RPT.BIZ_CD
		      		                   , NVL(RPT.PLAN_AMT, 0) + NVL(RPT.SUB_PLAN_AMT, 0)     AS PLAN_AMT
		      		                   , 0                                                   AS RSLT_AMT
		      		                   , 0                                                   AS PRE_RSLT_AMT
		      		            FROM MSS.ME_BIZPLANRPT RPT WHERE 1 = 1
		      		            AND RPT.BIZ_PLAN_YM BETWEEN ? AND ?
		      		            AND RPT.STR_CD  LIKE ?
		      		            AND SUBSTR(RPT.BIZ_CD, 3, 4) = '0000'

 		      		            UNION ALL

                          /* 실적 */
		      		            SELECT RPT.STR_CD
		                             ,RPT.DEPT_CD
		                             ,RPT.TEAM_CD
		                             ,RPT.PC_CD
		                             ,RPT.BIZ_CD
		      		                   ,0                                                    AS PLAN_AMT
		      		                   ,NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0)      AS RSLT_AMT
		      		                   ,0                                                    AS PRE_RSLT_AMT
		      		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		      		            AND RPT.BIZ_RSLT_YM BETWEEN ? AND ?
                          AND RPT.STR_CD  LIKE ?
		      		            AND SUBSTR(RPT.BIZ_CD, 3, 4) = '0000'

		      		            UNION ALL

                          /* 전년실적 */
		      		            SELECT RPT.STR_CD
		                             ,RPT.DEPT_CD
		                             ,RPT.TEAM_CD
		                             ,RPT.PC_CD
		                             ,RPT.BIZ_CD
		      		                   ,0                                                AS PLAN_AMT
		      		                   ,0                                                AS RSLT_AMT
		      		                   ,NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0)  AS PRE_RSLT_AMT
		      		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		      		            AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                                                  		AND TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                          AND RPT.STR_CD  LIKE ?
		      		            AND SUBSTR(RPT.BIZ_CD, 3, 4) = '0000'

		      		           ) MA
		              GROUP BY MA.STR_CD, MA.DEPT_CD, MA.TEAM_CD, MA.PC_CD, MA.BIZ_CD
		         ) XA
		      GROUP BY XA.ORG_CD, ROLLUP(XA.BIZ_CD)
		      ORDER BY XA.ORG_CD, XA.BIZ_CD
		     ) MMA    
    ]]>
    </query>
    
    <!-- 판관비실적분석 헤더  -->
    <gauce name="H_SEL_TAB4">
    	<column colName="BIZ_CD"			colType="TB_STRING" 	size="6"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="BIZ_CD_NM"			colType="TB_STRING" 	size="60"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        
        <column colName="PLAN_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="RSLT_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="DEC_RATIO"			colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="PRE_RSLT_AMT"		colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="INC_DEC_RATIO"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="GROUP_ID"			colType="TB_STRING" 	size="6"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
    	
    	<column colName="BIZ_RSLT_YM"		colType="TB_STRING" 	size="6"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
    	<column colName="STR_CD"			colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="SUM_GB"			colType="TB_STRING" 	size="1"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
    	<column colName="DEPT_CD"			colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
    	<column colName="TEAM_CD"			colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
    	<column colName="PC_CD"				colType="TB_STRING" 	size="2"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
    </gauce>  

    <!-- 판관비중분류실적분석 조회 -->
    <query name="SEL_TAB4_M">
    <![CDATA[
    	/*******
    	* 판관비중분류실적분석 조회
    	*******/
		SELECT MMA.BIZ_CD
		       ,DECODE(MMA.GROUP_ID, '1', '합계',(SELECT A.BIZ_CD_NM FROM MSS.ME_BIZCDMST A WHERE A.BIZ_CD = MMA.BIZ_CD)) AS BIZ_CD_NM
		       ,MMA.PLAN_AMT			                                                                                AS PLAN_AMT
           	   ,MMA.RSLT_AMT			                                                                                AS RSLT_AMT
           	   ,DECODE(MMA.RSLT_AMT,0,0,ROUND((MMA.RSLT_AMT - MMA.PLAN_AMT)/MMA.RSLT_AMT*100,2))                          AS DEC_RATIO 
           	   ,MMA.PRE_RSLT_AMT		                                                                              AS PRE_RSLT_AMT
           	   ,DECODE(MMA.RSLT_AMT,0,0,ROUND((MMA.RSLT_AMT - MMA.PRE_RSLT_AMT)/MMA.RSLT_AMT*100,2))                      AS INC_DEC_RATIO
		       ,MMA.GROUP_ID
		       ,?	AS BIZ_RSLT_YM
		       ,?	AS STR_CD
           	   ,? 	AS SUM_GB
		       ,?	AS DEPT_CD
		       ,?	AS TEAM_CD
		       ,?	AS PC_CD
		FROM (
		      SELECT MA.BIZ_CD
                 ,SUM(MA.PLAN_AMT)      AS PLAN_AMT
                 ,SUM(MA.RSLT_AMT)      AS RSLT_AMT
		             ,SUM(MA.PRE_RSLT_AMT)  AS PRE_RSLT_AMT
		             ,GROUPING(MA.BIZ_CD)   AS GROUP_ID
		      FROM (

                	/* 계획 */
		            SELECT RPT.BIZ_CD
		                   , DECODE(SUBSTR(RPT.BIZ_CD, 3, 2),'00', NVL(RPT.PLAN_AMT, 0)
		                                                         , NVL(RPT.PLAN_AMT, 0) + NVL(RPT.SUB_PLAN_AMT, 0))   AS PLAN_AMT
                           ,0                                                                                         AS RSLT_AMT                                      
		                   ,0                                                                                         AS PRE_RSLT_AMT
		            FROM MSS.ME_BIZPLANRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_PLAN_YM BETWEEN ? AND ?
		            AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD  LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 1, 2) = (
		                                            SELECT SUBSTR(A.REFER_CODE, 1, 2)
		                                            FROM COM.TC_COMMCODE A 
		                                            WHERE 1 = 1
		                                            AND A.SYS_PART = 'D'
		                                            AND A.COMM_PART = 'M104'
		                                            AND A.COMM_CODE = '5'
		                                           )
		            AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'

                	UNION ALL

                	/* 실적 */
		            SELECT RPT.BIZ_CD
		                   ,0                                                                                         AS PLAN_AMT
                           ,DECODE(SUBSTR(RPT.BIZ_CD, 3, 2),'00', NVL(RPT.RSLT_AMT, 0)
		                                                        , NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0))   AS RSLT_AMT
                           ,0                                                                                         AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_RSLT_YM BETWEEN ? AND ?
		            AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD  LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 1, 2) = (
		                                            SELECT SUBSTR(A.REFER_CODE, 1, 2)
		                                            FROM COM.TC_COMMCODE A 
		                                            WHERE 1 = 1
		                                            AND A.SYS_PART = 'D'
		                                            AND A.COMM_PART = 'M104'
		                                            AND A.COMM_CODE = '5'
		                                           )
		            AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
                
                	UNION ALL
                
                	/* 전년실적 */
		            SELECT RPT.BIZ_CD
		                   ,0                                                                                         AS PLAN_AMT
                       	   ,0                                                                                         AS RSLT_AMT
                       	   ,DECODE(SUBSTR(RPT.BIZ_CD, 3, 2),'00', NVL(RPT.RSLT_AMT, 0)
		                                                        , NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0))   AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                                        	AND TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		            AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD  LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 1, 2) = (
		                                            SELECT SUBSTR(A.REFER_CODE, 1, 2)
		                                            FROM COM.TC_COMMCODE A 
		                                            WHERE 1 = 1
		                                            AND A.SYS_PART = 'D'
		                                            AND A.COMM_PART = 'M104'
		                                            AND A.COMM_CODE = '5'
		                                           )
		            AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
		            

		           ) MA
		      GROUP BY ROLLUP(MA.BIZ_CD)
		      HAVING SUM(MA.PLAN_AMT) + SUM(MA.RSLT_AMT) + SUM(MA.PRE_RSLT_AMT) > 0
		     ) MMA    
		WHERE MMA.GROUP_ID NOT LIKE '%1%'			     
    ]]>
    </query> 

    <!-- 판관비중분류실적분석 조회 -->
    <query name="SEL_TAB4_CHART">
    <![CDATA[
    	/*******
    	* 판관비중분류차트 조회
    	*******/
		SELECT MMA.BIZ_CD
		       ,DECODE(MMA.GROUP_ID, '1', '합계',(SELECT A.BIZ_CD_NM FROM MSS.ME_BIZCDMST A WHERE A.BIZ_CD = MMA.BIZ_CD)) AS BIZ_CD_NM
		       ,MMA.PLAN_AMT		                                                                                AS PLAN_AMT
           	   ,MMA.RSLT_AMT		                                                                                AS RSLT_AMT
           	   ,DECODE(MMA.RSLT_AMT,0,0,ROUND((MMA.RSLT_AMT - MMA.PLAN_AMT)/MMA.RSLT_AMT*100,2))                          AS DEC_RATIO 
           	   ,MMA.PRE_RSLT_AMT		                                                                              AS PRE_RSLT_AMT
           	   ,DECODE(MMA.RSLT_AMT,0,0,ROUND((MMA.RSLT_AMT - MMA.PRE_RSLT_AMT)/MMA.RSLT_AMT*100,2))                      AS INC_DEC_RATIO
		       ,MMA.GROUP_ID
		       ,?	AS BIZ_RSLT_YM
		       ,?	AS STR_CD
           	   ,? 	AS SUM_GB
		       ,?	AS DEPT_CD
		       ,?	AS TEAM_CD
		       ,?	AS PC_CD
		FROM (
		      SELECT MA.BIZ_CD
                 	,ROUND(SUM(MA.PLAN_AMT)/1000000)      AS PLAN_AMT
                 	,ROUND(SUM(MA.RSLT_AMT)/1000000)      AS RSLT_AMT
		            ,ROUND(SUM(MA.PRE_RSLT_AMT)/1000000)  AS PRE_RSLT_AMT
		            ,GROUPING(MA.BIZ_CD)   AS GROUP_ID
		      FROM (

                	/* 계획 */
		            SELECT RPT.BIZ_CD
		                   , DECODE(SUBSTR(RPT.BIZ_CD, 3, 2),'00', NVL(RPT.PLAN_AMT, 0)
		                                                         , NVL(RPT.PLAN_AMT, 0) + NVL(RPT.SUB_PLAN_AMT, 0))   AS PLAN_AMT
                           ,0                                                                                         AS RSLT_AMT                                      
		                   ,0                                                                                         AS PRE_RSLT_AMT
		            FROM MSS.ME_BIZPLANRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_PLAN_YM BETWEEN ? AND ?
		            AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD  LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 1, 2) = (
		                                            SELECT SUBSTR(A.REFER_CODE, 1, 2)
		                                            FROM COM.TC_COMMCODE A 
		                                            WHERE 1 = 1
		                                            AND A.SYS_PART = 'D'
		                                            AND A.COMM_PART = 'M104'
		                                            AND A.COMM_CODE = '5'
		                                           )
		            AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'

                	UNION ALL

                	/* 실적 */
		            SELECT RPT.BIZ_CD
		                   ,0                                                                                         AS PLAN_AMT
                           ,DECODE(SUBSTR(RPT.BIZ_CD, 3, 2),'00', NVL(RPT.RSLT_AMT, 0)
		                                                        , NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0))   AS RSLT_AMT
                           ,0                                                                                         AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_RSLT_YM BETWEEN ? AND ?
		            AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD  LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 1, 2) = (
		                                            SELECT SUBSTR(A.REFER_CODE, 1, 2)
		                                            FROM COM.TC_COMMCODE A 
		                                            WHERE 1 = 1
		                                            AND A.SYS_PART = 'D'
		                                            AND A.COMM_PART = 'M104'
		                                            AND A.COMM_CODE = '5'
		                                           )
		            AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
                
                	UNION ALL
                
                	/* 전년실적 */
		            SELECT RPT.BIZ_CD
		                   ,0                                                                                         AS PLAN_AMT
                       	   ,0                                                                                         AS RSLT_AMT
                       	   ,DECODE(SUBSTR(RPT.BIZ_CD, 3, 2),'00', NVL(RPT.RSLT_AMT, 0)
		                                                        , NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0))   AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                                        	AND TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		            AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD  LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 1, 2) = (
		                                            SELECT SUBSTR(A.REFER_CODE, 1, 2)
		                                            FROM COM.TC_COMMCODE A 
		                                            WHERE 1 = 1
		                                            AND A.SYS_PART = 'D'
		                                            AND A.COMM_PART = 'M104'
		                                            AND A.COMM_CODE = '5'
		                                           )
		            AND SUBSTR(RPT.BIZ_CD, 5, 2) = '00'
		            

		           ) MA
		      GROUP BY ROLLUP(MA.BIZ_CD)
		      HAVING SUM(MA.PLAN_AMT) + SUM(MA.RSLT_AMT) + SUM(MA.PRE_RSLT_AMT) > 0
		     ) MMA    
		WHERE MMA.GROUP_ID NOT LIKE '%1%'			     
    ]]>
    </query> 

    
    <!-- 판관비소분류실적분석 조회 -->
    <query name="SEL_TAB4_S">
    <![CDATA[
		/*******
		* 판관비소분류실적분석 조회
		*******/
		SELECT MMA.BIZ_CD
		       ,DECODE(MMA.GROUP_ID, '1', '합계',(SELECT A.BIZ_CD_NM FROM MSS.ME_BIZCDMST A WHERE A.BIZ_CD = MMA.BIZ_CD)) AS BIZ_CD_NM
		       ,MMA.PLAN_AMT		                                                                                  AS PLAN_AMT
           	   ,MMA.RSLT_AMT	                                                                                  AS RSLT_AMT
           	   ,DECODE(MMA.RSLT_AMT,0,0,ROUND((MMA.RSLT_AMT - MMA.PLAN_AMT)/MMA.RSLT_AMT*100,2))                          AS DEC_RATIO
           	   ,MMA.PRE_RSLT_AMT                                                        							AS PRE_RSLT_AMT		       
		       ,DECODE(MMA.RSLT_AMT,0,0,ROUND((MMA.RSLT_AMT - MMA.PRE_RSLT_AMT)/MMA.RSLT_AMT*100,2))                      AS INC_DEC_RATIO
		       ,MMA.GROUP_ID
		       ,?	AS BIZ_RSLT_YM
		       ,?	AS STR_CD
           	   ,? 	AS SUM_GB
		       ,?	AS DEPT_CD
		       ,?	AS TEAM_CD
		       ,?	AS PC_CD     
		FROM (
		      SELECT MA.BIZ_CD
		             ,SUM(MA.PLAN_AMT)      AS PLAN_AMT
                 	 ,SUM(MA.RSLT_AMT)      AS RSLT_AMT
                 	 ,SUM(MA.PRE_RSLT_AMT)  AS PRE_RSLT_AMT
		             ,GROUPING(MA.BIZ_CD)   AS GROUP_ID
		      FROM (
		            /* 계획 */
		            SELECT RPT.BIZ_CD
		                   , DECODE(SUBSTR(RPT.BIZ_CD, 5, 2),'00', NVL(RPT.PLAN_AMT, 0)
		                                                         , NVL(RPT.PLAN_AMT, 0) + NVL(RPT.SUB_PLAN_AMT, 0))   AS PLAN_AMT
		                   , 0                                                                                        AS RSLT_AMT
		                   , 0                                                                                        AS PRE_RSLT_AMT
		            FROM MSS.ME_BIZPLANRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_PLAN_YM BETWEEN ? AND ?
		            AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD  LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 1, 4) = SUBSTR(?,1,4)
		            AND SUBSTR(RPT.BIZ_CD, 3, 2) != '00'

                UNION ALL

                /* 실적 */
		            SELECT RPT.BIZ_CD
                       	   ,0                                                                                         AS PLAN_AMT
		                   ,DECODE(SUBSTR(RPT.BIZ_CD, 5, 2),'00', NVL(RPT.RSLT_AMT, 0)
		                                                        , NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0))   AS RSLT_AMT
                           ,0                                                                                         AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_RSLT_YM BETWEEN ? AND ?
		            AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD  LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 1, 4) = SUBSTR(?,1,4)
		            AND SUBSTR(RPT.BIZ_CD, 3, 2) != '00'
                                
                UNION ALL
                
                /* 전년실적 */
		            SELECT RPT.BIZ_CD
                       	   ,0                                                                                         AS PLAN_AMT
		                   ,0                                                                                         AS RSLT_AMT
                       	   ,DECODE(SUBSTR(RPT.BIZ_CD, 5, 2),'00', NVL(RPT.RSLT_AMT, 0)
		                                                        , NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0))   AS PRE_RSLT_AMT
		                   
		            FROM MSS.ME_BIZRSLTRPT RPT WHERE 1 = 1
		            AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                                        	AND TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		            AND RPT.STR_CD  LIKE ?
		            AND RPT.DEPT_CD  LIKE ?
		            AND RPT.TEAM_CD LIKE ?
		            AND RPT.PC_CD   LIKE ?
		            AND SUBSTR(RPT.BIZ_CD, 1, 4) = SUBSTR(?,1,4)
		            AND SUBSTR(RPT.BIZ_CD, 3, 2) != '00'

		           ) MA
		      GROUP BY ROLLUP(MA.BIZ_CD)
		      HAVING SUM(MA.PLAN_AMT) + SUM(MA.RSLT_AMT) + SUM(MA.PRE_RSLT_AMT) > 0
		     ) MMA
		WHERE MMA.GROUP_ID NOT LIKE '%1%'			     
    ]]>
    </query>       

    <!-- 판관비실적분석 엑셀 조회 헤더  -->
    <gauce name="H_SEL_TAB4_EXCEL">
    	<column colName="ORG_CD"			colType="TB_STRING" 	size="10"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="ORG_NAME"			colType="TB_STRING" 	size="60"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
    	<column colName="BIZ_CD"			colType="TB_STRING" 	size="6"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="BIZ_CD_NM"			colType="TB_STRING" 	size="60"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="PLAN_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="RSLT_AMT"			colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="DEC_RATIO"			colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
        <column colName="PRE_RSLT_AMT"		colType="TB_DECIMAL"	size="13"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="INC_DEC_RATIO"		colType="TB_DECIMAL"	size="13"	dec="2" keyType="TB_NORMAL"    roundMode="ROUND" />
		<column colName="GROUP_ID"			colType="TB_STRING" 	size="6"	dec="0" keyType="TB_NORMAL"    roundMode="ROUND" />
    </gauce>  

    <!-- 판관비실적분석 엑셀 조회 -->
    <query name="SEL_TAB4_EXCEL">
    <![CDATA[
    	/*******
    	* 판관비계획분석 엑셀 조회
    	*******/
		SELECT MMA.ORG_CD
		       ,(SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD)                                                  AS ORG_NAME
		       ,DECODE(MMA.GROUP_ID, '00', MMA.BIZ_CD, '')			                                                                            AS BIZ_CD
		       ,DECODE(MMA.GROUP_ID, '11', '총계'
		                           , '01', (SELECT A.BIZ_CD_NM FROM MSS.ME_BIZCDMST A WHERE A.BIZ_CD = RPAD(MMA.BIZ_CD,6,'00')) || '계'
		                           , (SELECT A.BIZ_CD_NM FROM MSS.ME_BIZCDMST A WHERE A.BIZ_CD = RPAD(MMA.BIZ_CD,6,'00'))
		              )                                                                                                                     AS BIZ_CD_NM
		       
           	   ,MMA.PLAN_AMT
           	   ,MMA.RSLT_AMT
           	   ,DECODE(MMA.RSLT_AMT,0,0,ROUND((MMA.RSLT_AMT - MMA.PLAN_AMT)/MMA.RSLT_AMT*100,2))                                            AS DEC_RATIO
           	   ,MMA.PRE_RSLT_AMT
		       ,DECODE(MMA.RSLT_AMT,0,0,ROUND((MMA.RSLT_AMT - MMA.PRE_RSLT_AMT)/MMA.RSLT_AMT*100,2))                                        AS INC_DEC_RATIO
		       ,MMA.GROUP_ID
		FROM (
		      SELECT XA.ORG_CD
		             ,XA.L_BIZ_CD || XA.M_BIZ_CD || XA.S_BIZ_CD AS BIZ_CD
                 	 ,SUM(XA.PLAN_AMT)      AS PLAN_AMT
                 	 ,SUM(XA.RSLT_AMT)      AS RSLT_AMT
		             ,SUM(XA.PRE_RSLT_AMT)  AS PRE_RSLT_AMT
		             ,GROUPING(XA.M_BIZ_CD) || GROUPING(XA.S_BIZ_CD)           AS GROUP_ID
		      FROM (
		            SELECT MA.ORG_CD
		                   ,SUBSTR(MA.BIZ_CD, 1, 2) AS L_BIZ_CD
		                   ,SUBSTR(MA.BIZ_CD, 3, 2) AS M_BIZ_CD
		                   ,SUBSTR(MA.BIZ_CD, 5, 2) AS S_BIZ_CD
                       	   ,SUM(MA.PLAN_AMT)        AS PLAN_AMT
                       	   ,SUM(MA.RSLT_AMT)        AS RSLT_AMT
		                   ,SUM(MA.PRE_RSLT_AMT)    AS PRE_RSLT_AMT
		                   
		            FROM (
                      	  /* 계획 */
		                  SELECT RPT.ORG_CD
		                         ,RPT.BIZ_CD
		                         ,DECODE(SUBSTR(RPT.BIZ_CD, 3, 2),'00',NVL(RPT.PLAN_AMT, 0)
		                                                         ,DECODE(SUBSTR(RPT.BIZ_CD, 5, 2),'00',NVL(RPT.PLAN_AMT, 0)
		                                                                                              ,NVL(RPT.PLAN_AMT, 0) + NVL(RPT.SUB_PLAN_AMT, 0)))   AS PLAN_AMT
		                         ,0                                                                                                                        AS RSLT_AMT
		                         ,0                                                                                                                        AS PRE_RSLT_AMT
		                  FROM MSS.ME_BIZPLANRPT RPT 
		                  WHERE 1 = 1
		                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ?
		                  AND RPT.STR_CD  LIKE ?
		                  AND SUBSTR(RPT.BIZ_CD, 1, 2) = (
		                                                  SELECT SUBSTR(A.REFER_CODE, 1, 2)
		                                                  FROM COM.TC_COMMCODE A 
		                                                  WHERE 1 = 1
		                                                  AND A.SYS_PART = 'D'
		                                                  AND A.COMM_PART = 'M104'
		                                                  AND A.COMM_CODE = '5'
		                                                 )
                      
                      	  UNION ALL

                      	  /* 전년실적 */
		                  SELECT RPT.ORG_CD
		                         ,RPT.BIZ_CD
                             	 ,0                                                                                                                        AS PLAN_AMT
                             	 ,DECODE(SUBSTR(RPT.BIZ_CD, 3, 2),'00',NVL(RPT.RSLT_AMT, 0)
		                                                         ,DECODE(SUBSTR(RPT.BIZ_CD, 5, 2),'00',NVL(RPT.RSLT_AMT, 0)
		                                                                                              ,NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0)))   AS RSLT_AMT
		                         ,0                                                                                                                        AS PRE_RSLT_AMT
		                         
		                  FROM MSS.ME_BIZRSLTRPT RPT 
		                  WHERE 1 = 1
		                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ?
		                  AND RPT.STR_CD  LIKE ?
		                  AND SUBSTR(RPT.BIZ_CD, 1, 2) = (
		                                                  SELECT SUBSTR(A.REFER_CODE, 1, 2)
		                                                  FROM COM.TC_COMMCODE A 
		                                                  WHERE 1 = 1
		                                                  AND A.SYS_PART = 'D'
		                                                  AND A.COMM_PART = 'M104'
		                                                  AND A.COMM_CODE = '5'
		                                                 )
                      
                      	  UNION ALL
                                                     
                      	  /* 전년실적 */
		                  SELECT RPT.ORG_CD
		                         ,RPT.BIZ_CD
                             	 ,0                                                                                                                        AS PLAN_AMT
                             	 ,0                                                                                                                        AS RSLT_AMT
		                         ,DECODE(SUBSTR(RPT.BIZ_CD, 3, 2),'00',NVL(RPT.RSLT_AMT, 0)
		                                                         ,DECODE(SUBSTR(RPT.BIZ_CD, 5, 2),'00',NVL(RPT.RSLT_AMT, 0)
		                                                                                              ,NVL(RPT.RSLT_AMT, 0) + NVL(RPT.SUB_RSLT_AMT, 0)))   AS PRE_RSLT_AMT
		                         
		                  FROM MSS.ME_BIZRSLTRPT RPT 
		                  WHERE 1 = 1
		                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
                                              AND TO_CHAR(TO_DATE(?, 'YYYYMM') + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
		                  AND RPT.STR_CD  LIKE ?
		                  AND SUBSTR(RPT.BIZ_CD, 1, 2) = (
		                                                  SELECT SUBSTR(A.REFER_CODE, 1, 2)
		                                                  FROM COM.TC_COMMCODE A 
		                                                  WHERE 1 = 1
		                                                  AND A.SYS_PART = 'D'
		                                                  AND A.COMM_PART = 'M104'
		                                                  AND A.COMM_CODE = '5'
		                                                 )
                      
		                 ) MA
		            GROUP BY MA.ORG_CD, MA.BIZ_CD
		            HAVING SUM(MA.PLAN_AMT) + SUM(MA.RSLT_AMT) + SUM(MA.PRE_RSLT_AMT) > 0
		           ) XA
		      GROUP BY XA.ORG_CD, XA.L_BIZ_CD, ROLLUP(XA.M_BIZ_CD, XA.S_BIZ_CD)
		     ) MMA    
    ]]>
    </query>
    
    <query name="SEL_CUST_PIE">
        <![CDATA[
        SELECT SUM(BLACK)  AS BLACK
             , SUM(GOLD)   AS GOLD
             , SUM(BLUE)   AS BLUE
             , SUM(GREEN)  AS GREEN
          FROM ( SELECT COUNT(1) AS BLACK
                      , 0        AS GOLD
                      , 0        AS BLUE
                      , 0        AS GREEN
                   FROM DPS.PS_DAYCUST
                  WHERE STR_CD LIKE ? || '%'
                    AND SALE_DT BETWEEN ? AND ?
                    AND CUST_GRADE = '41'
                  UNION ALL
                 SELECT 0        AS BLACK
                      , COUNT(1) AS GOLD
                      , 0        AS BLUE
                      , 0        AS GREEN
                   FROM DPS.PS_DAYCUST
                  WHERE STR_CD LIKE ? || '%'
                    AND SALE_DT BETWEEN ? AND ?
                    AND CUST_GRADE = '31'
                  UNION ALL
                 SELECT 0        AS BLACK
                      , 0        AS GOLD
                      , COUNT(1) AS BLUE
                      , 0        AS GREEN
                   FROM DPS.PS_DAYCUST
                  WHERE STR_CD LIKE ? || '%'
                    AND SALE_DT BETWEEN ? AND ?
                    AND CUST_GRADE = '21'
                  UNION ALL
                 SELECT 0        AS BLACK
                      , 0        AS GOLD
                      , 0        AS BLUE
                      , COUNT(1) AS GREEN
                   FROM DPS.PS_DAYCUST
                  WHERE STR_CD LIKE ? || '%'
                    AND SALE_DT BETWEEN ? AND ?
                    AND CUST_GRADE = '11') X
        ]]>
    </query>
    
    <query name="SEL_CUST_PIE2">
        <![CDATA[
        SELECT SUM(BLACK)/1000000  AS BLACK
             , SUM(GOLD)/1000000   AS GOLD
             , SUM(BLUE)/1000000   AS BLUE
             , SUM(GREEN)/1000000  AS GREEN
          FROM ( SELECT SUM(SALE_AMT) AS BLACK
                      , 0             AS GOLD
                      , 0             AS BLUE
                      , 0             AS GREEN
                   FROM DPS.PS_DAYCUST
                  WHERE STR_CD LIKE ? || '%'
                    AND SALE_DT BETWEEN ? AND ?
                    AND CUST_GRADE = '41'
                  UNION ALL
                 SELECT 0             AS BLACK
                      , SUM(SALE_AMT) AS GOLD
                      , 0             AS BLUE
                      , 0             AS GREEN
                   FROM DPS.PS_DAYCUST
                  WHERE STR_CD LIKE ? || '%'
                    AND SALE_DT BETWEEN ? AND ?
                    AND CUST_GRADE = '31'
                  UNION ALL
                 SELECT 0              AS BLACK
                      , 0              AS GOLD
                      , SUM(SALE_AMT)  AS BLUE
                      , 0              AS GREEN
                   FROM DPS.PS_DAYCUST
                  WHERE STR_CD LIKE ? || '%'
                    AND SALE_DT BETWEEN ? AND ?
                    AND CUST_GRADE = '21'
                  UNION ALL
                 SELECT 0             AS BLACK
                      , 0             AS GOLD
                      , 0             AS BLUE
                      , SUM(SALE_AMT) AS GREEN
                   FROM DPS.PS_DAYCUST
                  WHERE STR_CD LIKE ? || '%'
                    AND SALE_DT BETWEEN ? AND ?
                    AND CUST_GRADE = '11') X
        ]]>
    </query>

    <!-- 점별 매출실적분석 조회 -->
    <query name="SEL_TAB1_STR_PRINT">
        <![CDATA[
        	/*******
        	* 점별 매출실적분석 조회
        	*******/
			SELECT XA.ORG_CD
			       ,XA.ORG_NAME
			       ,XA.SUM_GUBUN
			       /* 매출액 */
			       ,TRUNC(XA.PLAN_SALES_AMT)             AS PLAN_SALES_AMT
			       ,TRUNC(XA.RSLT_SALES_AMT)             AS RSLT_SALES_AMT
			       ,XA.SALES_AMT_ACHIEVE_RATE
			       ,TRUNC(XA.PRE_RSLT_SALES_AMT)         AS PRE_RSLT_SALES_AMT
			       ,XA.SALES_AMT_GROWTH_RATE
			       /* 매출이익액 */
			       ,TRUNC(XA.PLAN_SALES_PROFIT_AMT)      AS PLAN_SALES_PROFIT_AMT
			       ,TRUNC(XA.RSLT_SALES_PROFIT_AMT)      AS RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_ACHIEVE_RATE
			       ,TRUNC(XA.PRE_RSLT_SALES_PROFIT_AMT)  AS PRE_RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_GROWTH_RATE
			       /* 이익율 */
			       ,XA.PLAN_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE
			       ,DECODE(XA.PLAN_PROFIT_RATE, 0, 0
			                                     , ROUND(XA.RSLT_PROFIT_RATE/XA.PLAN_PROFIT_RATE*100,2))                               AS PROFIT_RATE_ACHIEVE_RATE 
			       ,XA.PRE_RSLT_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE - XA.PRE_RSLT_PROFIT_RATE                                                                      AS PROFIT_RATE_DIFFERENT                                                                                          
			
			FROM (
			      SELECT MMA.ORG_CD
			             ,NVL((SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD), '합계')                       AS ORG_NAME
			      			 ,DECODE(GROUP_GUBUN, '1', '0', '2')                                                                            AS SUM_GUBUN
			             /* 매출액 */
			             ,MMA.PLAN_SALES_AMT/1000000                                                                                    AS PLAN_SALES_AMT
			             ,MMA.RSLT_SALES_AMT/1000000                                                                                    AS RSLT_SALES_AMT
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_AMT/MMA.PLAN_SALES_AMT*100,2))                              AS SALES_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_AMT/1000000                                                                                        AS PRE_RSLT_SALES_AMT
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_AMT - MMA.PRE_RSLT_SALES_AMT)/MMA.RSLT_SALES_AMT*100,2))  AS SALES_AMT_GROWTH_RATE
			             /* 매출이익액 */
			             ,MMA.PLAN_SALES_PROFIT_AMT/1000000                                                                             AS PLAN_SALES_PROFIT_AMT
			             ,MMA.RSLT_SALES_PROFIT_AMT/1000000                                                                             AS RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.PLAN_SALES_PROFIT_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.PLAN_SALES_PROFIT_AMT*100,2))                AS SALES_PROFIT_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_PROFIT_AMT/1000000																			AS PRE_RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.RSLT_SALES_PROFIT_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_PROFIT_AMT - MMA.PRE_RSLT_SALES_PROFIT_AMT)/MMA.RSLT_SALES_PROFIT_AMT*100,2))  AS SALES_PROFIT_AMT_GROWTH_RATE
			                                                                                      
			             /* 이익율 */
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_AMT*100,2))                      AS PLAN_PROFIT_RATE
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.RSLT_SALES_AMT*100,2))                      AS RSLT_PROFIT_RATE
			             ,DECODE(MMA.PRE_RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PRE_RSLT_SALES_PROFIT_AMT/MMA.PRE_RSLT_SALES_AMT*100,2))              AS PRE_RSLT_PROFIT_RATE
			      FROM (
			            SELECT RPAD(MA.STR_CD, 10, '00')            AS ORG_CD
			                   ,SUM(MA.PLAN_SALES_AMT)              AS PLAN_SALES_AMT
			            			 ,SUM(MA.RSLT_SALES_AMT)              AS RSLT_SALES_AMT
			            			 ,SUM(MA.PRE_RSLT_SALES_AMT)          AS PRE_RSLT_SALES_AMT    
			            			 ,SUM(MA.PLAN_SALES_PROFIT_AMT)       AS PLAN_SALES_PROFIT_AMT
			                   ,SUM(MA.RSLT_SALES_PROFIT_AMT)       AS RSLT_SALES_PROFIT_AMT
			                   ,SUM(MA.PRE_RSLT_SALES_PROFIT_AMT)   AS PRE_RSLT_SALES_PROFIT_AMT
			                   ,GROUPING(MA.STR_CD)                 AS GROUP_GUBUN
			            FROM (
			                  /* 계획 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)) AS PLAN_SALES_AMT
			                         ,0                                               AS RSLT_SALES_AMT
			                         ,0                                               AS PRE_RSLT_SALES_AMT
			                         ,0                                               AS PLAN_SALES_PROFIT_AMT
			                         ,0                                               AS RSLT_SALES_PROFIT_AMT
			                         ,0                                               AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                  
			                  UNION ALL
			                  
			                  /* 계획 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0))    AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                 ) MA
			            WHERE 1 = 1 
			            GROUP BY  ROLLUP(MA.STR_CD)     
			           ) MMA
			     ) XA        
        ]]>
    </query>
    
    <!-- 팀별 매출실적분석 조회 -->
    <query name="SEL_TAB1_TEAM_PRINT">
        <![CDATA[
        	/*******
        	* 팀별 매출실적분석 조회
        	*******/
			SELECT XA.ORG_CD
			       ,XA.ORG_NAME
			       ,XA.SUM_GUBUN
			       /* 매출액 */
			       ,XA.PLAN_SALES_AMT
			       ,XA.RSLT_SALES_AMT
			       ,XA.SALES_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_AMT
			       ,XA.SALES_AMT_GROWTH_RATE
			       /* 매출이익액 */
			       ,XA.PLAN_SALES_PROFIT_AMT
			       ,XA.RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_GROWTH_RATE
			       /* 이익율 */
			       ,XA.PLAN_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE
			       ,DECODE(XA.PLAN_PROFIT_RATE, 0, 0
			                                     , ROUND(XA.RSLT_PROFIT_RATE/XA.PLAN_PROFIT_RATE*100,2))                               AS PROFIT_RATE_ACHIEVE_RATE 
			       ,XA.PRE_RSLT_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE - XA.PRE_RSLT_PROFIT_RATE                                                                      AS PROFIT_RATE_DIFFERENT                                                                                          
			
			FROM (
			      SELECT DECODE(GROUP_GUBUN, '11', '', MMA.ORG_CD)   AS ORG_CD
						       ,DECODE(GROUP_GUBUN, '11', '합계', (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD)) AS ORG_NAME                                        
						       ,DECODE(GROUP_GUBUN, '11', '0', '2')          AS SUM_GUBUN
			             /* 매출액 */
			             ,MMA.PLAN_SALES_AMT/1000000                                                                                    AS PLAN_SALES_AMT
			             ,MMA.RSLT_SALES_AMT/1000000                                                                                    AS RSLT_SALES_AMT
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_AMT/MMA.PLAN_SALES_AMT*100,2))                              AS SALES_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_AMT/1000000                                                                                        AS PRE_RSLT_SALES_AMT
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_AMT - MMA.PRE_RSLT_SALES_AMT)/MMA.RSLT_SALES_AMT*100,2))  AS SALES_AMT_GROWTH_RATE
			             /* 매출이익액 */
			             ,MMA.PLAN_SALES_PROFIT_AMT/1000000                                                                             AS PLAN_SALES_PROFIT_AMT
			             ,MMA.RSLT_SALES_PROFIT_AMT/1000000                                                                             AS RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.PLAN_SALES_PROFIT_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.PLAN_SALES_PROFIT_AMT*100,2))                AS SALES_PROFIT_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_PROFIT_AMT/1000000                                                                         AS PRE_RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.RSLT_SALES_PROFIT_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_PROFIT_AMT - MMA.PRE_RSLT_SALES_PROFIT_AMT)/MMA.RSLT_SALES_PROFIT_AMT*100,2))  AS SALES_PROFIT_AMT_GROWTH_RATE
			             
			             /* 이익율 */
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_AMT*100,2))                      AS PLAN_PROFIT_RATE
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.RSLT_SALES_AMT*100,2))                      AS RSLT_PROFIT_RATE
			             ,DECODE(MMA.PRE_RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PRE_RSLT_SALES_PROFIT_AMT/MMA.PRE_RSLT_SALES_AMT*100,2))              AS PRE_RSLT_PROFIT_RATE
			      FROM (
			            SELECT RPAD(MA.STR_CD || MA.DEPT_CD || MA.TEAM_CD, 10, '00') AS ORG_CD
			                   ,SUM(MA.PLAN_SALES_AMT)              AS PLAN_SALES_AMT
			            			 ,SUM(MA.RSLT_SALES_AMT)              AS RSLT_SALES_AMT
			            			 ,SUM(MA.PRE_RSLT_SALES_AMT)          AS PRE_RSLT_SALES_AMT    
			            			 ,SUM(MA.PLAN_SALES_PROFIT_AMT)       AS PLAN_SALES_PROFIT_AMT
			                   ,SUM(MA.RSLT_SALES_PROFIT_AMT)       AS RSLT_SALES_PROFIT_AMT
			                   ,SUM(MA.PRE_RSLT_SALES_PROFIT_AMT)   AS PRE_RSLT_SALES_PROFIT_AMT
			                   ,GROUPING(MA.DEPT_CD)||GROUPING(MA.TEAM_CD)             AS GROUP_GUBUN
			            FROM (
			                  /* 계획 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)) AS PLAN_SALES_AMT
			                         ,0                                               AS RSLT_SALES_AMT
			                         ,0                                               AS PRE_RSLT_SALES_AMT
			                         ,0                                               AS PLAN_SALES_PROFIT_AMT
			                         ,0                                               AS RSLT_SALES_PROFIT_AMT
			                         ,0                                               AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                  
			                  UNION ALL
			                  
			                  /* 계획 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0))    AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                  AND RPT.ORG_LEVEL >= 3
			                 ) MA
			            WHERE 1 = 1 
			            AND MA.STR_CD = ?
			            GROUP BY  MA.STR_CD,ROLLUP(MA.DEPT_CD,MA.TEAM_CD)
			           ) MMA
			           WHERE MMA.GROUP_GUBUN != '01'
			     ) XA        
        ]]>
    </query>    

    <!-- PC별 매출실적분석 조회 -->
    <query name="SEL_TAB1_PC_PRINT">
        <![CDATA[
        	/*******
        	* PC별 매출실적분석 조회
        	*******/
			SELECT XA.ORG_CD
			       ,XA.ORG_NAME
			       ,XA.SUM_GUBUN
			       /* 매출액 */
			       ,XA.PLAN_SALES_AMT
			       ,XA.RSLT_SALES_AMT
			       ,XA.SALES_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_AMT
			       ,XA.SALES_AMT_GROWTH_RATE
			       /* 매출이익액 */
			       ,XA.PLAN_SALES_PROFIT_AMT
			       ,XA.RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_ACHIEVE_RATE
			       ,XA.PRE_RSLT_SALES_PROFIT_AMT
			       ,XA.SALES_PROFIT_AMT_GROWTH_RATE
			       /* 이익율 */
			       ,XA.PLAN_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE
			       ,DECODE(XA.PLAN_PROFIT_RATE, 0, 0
			                                     , ROUND(XA.RSLT_PROFIT_RATE/XA.PLAN_PROFIT_RATE*100,2))                               AS PROFIT_RATE_ACHIEVE_RATE 
			       ,XA.PRE_RSLT_PROFIT_RATE
			       ,XA.RSLT_PROFIT_RATE - XA.PRE_RSLT_PROFIT_RATE                                                                      AS PROFIT_RATE_DIFFERENT                                                                                          
			
			FROM (
			      SELECT DECODE(GROUP_GUBUN, '000',MMA.ORG_CD, '')      AS ORG_CD
									 ,DECODE(GROUP_GUBUN, '111', '합계'
						                          , '001', (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD)||' 소계'
						                                 , (SELECT ORG.ORG_NAME FROM DPS.PC_ORGMST ORG WHERE ORG.ORG_CD = MMA.ORG_CD))        AS ORG_NAME                                        
									 ,DECODE(GROUP_GUBUN, '111', '0','001', '1', '2')          AS SUM_GUBUN
			             /* 매출액 */
			             ,MMA.PLAN_SALES_AMT/1000000                                                                                    AS PLAN_SALES_AMT
			             ,MMA.RSLT_SALES_AMT/1000000                                                                                    AS RSLT_SALES_AMT
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_AMT/MMA.PLAN_SALES_AMT*100,2))                              AS SALES_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_AMT/1000000                                                                                        AS PRE_RSLT_SALES_AMT
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_AMT - MMA.PRE_RSLT_SALES_AMT)/MMA.RSLT_SALES_AMT*100,2))  AS SALES_AMT_GROWTH_RATE
			             /* 매출이익액 */
			             ,MMA.PLAN_SALES_PROFIT_AMT/1000000                                                                             AS PLAN_SALES_PROFIT_AMT
			             ,MMA.RSLT_SALES_PROFIT_AMT/1000000                                                                             AS RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.PLAN_SALES_PROFIT_AMT, 0, 0
			                                          ,ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.PLAN_SALES_PROFIT_AMT*100,2))                AS SALES_PROFIT_AMT_ACHIEVE_RATE
			             ,MMA.PRE_RSLT_SALES_PROFIT_AMT/1000000                                                                         AS PRE_RSLT_SALES_PROFIT_AMT
			             ,DECODE(MMA.RSLT_SALES_PROFIT_AMT, 0, 0
			                                          , ROUND((MMA.RSLT_SALES_PROFIT_AMT - MMA.PRE_RSLT_SALES_PROFIT_AMT)/MMA.RSLT_SALES_PROFIT_AMT*100,2))  AS SALES_PROFIT_AMT_GROWTH_RATE
			             
			             /* 이익율 */
			             ,DECODE(MMA.PLAN_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PLAN_SALES_PROFIT_AMT/MMA.PLAN_SALES_AMT*100,2))                      AS PLAN_PROFIT_RATE
			             ,DECODE(MMA.RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.RSLT_SALES_PROFIT_AMT/MMA.RSLT_SALES_AMT*100,2))                      AS RSLT_PROFIT_RATE
			             ,DECODE(MMA.PRE_RSLT_SALES_AMT, 0, 0
			                                          , ROUND(MMA.PRE_RSLT_SALES_PROFIT_AMT/MMA.PRE_RSLT_SALES_AMT*100,2))              AS PRE_RSLT_PROFIT_RATE
			      FROM (
			            SELECT RPAD(MA.STR_CD || MA.DEPT_CD || MA.TEAM_CD || MA.PC_CD, 10, '00') AS ORG_CD
			                   ,SUM(MA.PLAN_SALES_AMT)              AS PLAN_SALES_AMT
			            			 ,SUM(MA.RSLT_SALES_AMT)              AS RSLT_SALES_AMT
			            			 ,SUM(MA.PRE_RSLT_SALES_AMT)          AS PRE_RSLT_SALES_AMT    
			            			 ,SUM(MA.PLAN_SALES_PROFIT_AMT)       AS PLAN_SALES_PROFIT_AMT
			                   ,SUM(MA.RSLT_SALES_PROFIT_AMT)       AS RSLT_SALES_PROFIT_AMT
			                   ,SUM(MA.PRE_RSLT_SALES_PROFIT_AMT)   AS PRE_RSLT_SALES_PROFIT_AMT
			                   ,GROUPING(MA.DEPT_CD)||GROUPING(MA.TEAM_CD)||GROUPING(MA.PC_CD)             AS GROUP_GUBUN
			            FROM (
			                  /* 계획 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0)) AS PLAN_SALES_AMT
			                         ,0                                               AS RSLT_SALES_AMT
			                         ,0                                               AS PRE_RSLT_SALES_AMT
			                         ,0                                               AS PLAN_SALES_PROFIT_AMT
			                         ,0                                               AS RSLT_SALES_PROFIT_AMT
			                         ,0                                               AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '1'   /* 총매출 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                  
			                  UNION ALL
			                  
			                  /* 계획 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                  
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,(NVL(RPT.PLAN_AMT,0) + NVL(RPT.SUB_PLAN_AMT,0))    AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                         
			                  FROM MSS.ME_BIZPLANRPT RPT 
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_PLAN_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS RSLT_SALES_PROFIT_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_PROFIT_AMT
			                                
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  
			                  AND RPT.BIZ_RSLT_YM BETWEEN ? AND ? 
			                  
			                  UNION ALL
			                  
			                  /* 전년실적 매출이익액 */
			                  SELECT RPT.STR_CD
			                         ,RPT.DEPT_CD
			                         ,RPT.TEAM_CD
			                         ,RPT.PC_CD
			                         ,RPT.ORG_CD
			                         ,RPT.ORG_FLAG
			                         ,RPT.ORG_LEVEL
			                         
			                         ,0                                                  AS PLAN_SALES_AMT
			                         ,0                                                  AS RSLT_SALES_AMT
			                         ,0                                                  AS PRE_RSLT_SALES_AMT
			                         ,0                                                  AS PLAN_SALES_PROFIT_AMT
			                         ,0                                                  AS RSLT_SALES_PROFIT_AMT
			                         ,(NVL(RPT.RSLT_AMT,0) + NVL(RPT.SUB_RSLT_AMT,0))    AS PRE_RSLT_SALES_PROFIT_AMT       
			                         
			                  FROM MSS.ME_BIZRSLTRPT RPT
			                  WHERE EXISTS (
			                                SELECT 1
			                                FROM COM.TC_COMMCODE A WHERE 1 = 1
			                                AND A.SYS_PART = 'D'
			                                AND A.COMM_PART = 'M104'
			                                AND A.COMM_CODE = '3'   /* 매출이익 */
			                                AND A.REFER_CODE = RPT.BIZ_CD
			                               )
			                  AND RPT.BIZ_RSLT_YM BETWEEN TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM') 
			                                      AND     TO_CHAR(TO_DATE(?, 'YYYYMM') +  + NUMTOYMINTERVAL (-1, 'year'), 'YYYYMM')
			                  AND RPT.ORG_LEVEL >= 3
			                 ) MA
			            WHERE 1 = 1 
			            AND MA.STR_CD = ?
			            GROUP BY  MA.STR_CD,ROLLUP(MA.DEPT_CD,MA.TEAM_CD,MA.PC_CD)
			           ) MMA
			           WHERE MMA.GROUP_GUBUN != '011' 
			     ) XA        
        ]]>
    </query>

</service>
