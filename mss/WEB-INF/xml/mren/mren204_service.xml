<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 김유완
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2010.04.14
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  계량기마스터관리 
 -->
<service name="/mren204.mr">
	<gauce name="H_SEL_MR_CNTRMST">
	    <column colName="CNTR_ID"            colType="TB_STRING"   size="8"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="STR_CD"             colType="TB_STRING"   size="2"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="VEN_CD"             colType="TB_STRING"   size="6"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="VEN_NM"             colType="TB_STRING"   size="40"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="COMP_NO"            colType="TB_STRING"   size="10"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="REP_NAME"           colType="TB_STRING"   size="40"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PHONE_NO"           colType="TB_STRING"   size="100"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="BELONG_STR_CD"      colType="TB_STRING"   size="2"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="CHAR_NAME"          colType="TB_STRING"   size="40"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PHONE1_NO"          colType="TB_STRING"   size="32"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PHONE2_NO"          colType="TB_STRING"   size="32"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PHONE3_NO"          colType="TB_STRING"   size="32"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PHONE_NO2"           colType="TB_STRING"   size="100"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="CNTR_TYPE"          colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="SAP_CNTR_ID"        colType="TB_STRING"   size="20"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="CNTR_S_DT"          colType="TB_STRING"   size="8"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="CNTR_E_DT"          colType="TB_STRING"   size="8"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="RENT_TYPE"          colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="RENT_FLAG"          colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="CNTR_AREA"          colType="TB_DECIMAL"  size="9"   dec="2"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="RENT_DEPOSIT"       colType="TB_DECIMAL"  size="12"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PAY_FLAG"           colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="EXCL_AREA"          colType="TB_DECIMAL"  size="9"   dec="2"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="MM_RENTFEE"         colType="TB_DECIMAL"  size="12"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="SHR_AREA"           colType="TB_DECIMAL"  size="9"   dec="2"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="DONG"               colType="TB_STRING"   size="3"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="FLOOR_FLAG"         colType="TB_STRING"   size="2"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="HO"                 colType="TB_STRING"   size="4"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="FILE_PATH"          colType="TB_STRING"   size="100" dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="FCL_TYPE"           colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="MNTN_CAL_YN"        colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="CHRG_YN"            colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="ARR_CAL_YN"         colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="ARR_RATE"           colType="TB_DECIMAL"  size="9"   dec="2"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PAY_TERM_TYPE"      colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PAY_TERM_DD"        colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="OFFICE_PAY_AMT"     colType="TB_DECIMAL"  size="12"  dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="RENT_CAL_YN"        colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="RENT_ARR_CAL_YN"    colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="RENT_ARR_RATE"      colType="TB_DECIMAL"  size="9"   dec="2"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="RENT_PAY_TERM_TYPE" colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="RENT_PAY_TERM_DD"   colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PWR_KIND_CD"        colType="TB_STRING"   size="2"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PWR_TYPE"           colType="TB_STRING"   size="100"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PWR_SEL_CHARGE"     colType="TB_STRING"   size="1"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PWR_CNTR_QTY"       colType="TB_DECIMAL"  size="7"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="PWR_REVER_RATE"     colType="TB_DECIMAL"  size="7"   dec="2"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="WWTR_KIND_CD"       colType="TB_STRING"   size="2"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="WWTR_QTY"           colType="TB_DECIMAL"  size="9"   dec="2"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="WWTR_CHARGE_YN"     colType="TB_STRING"   size="1"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="STM_KIND_CD"        colType="TB_STRING"   size="2"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="STM_QTY"            colType="TB_DECIMAL"  size="9"   dec="2"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="CWTR_KIND_CD"       colType="TB_STRING"   size="2"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="CWTR_QTY"           colType="TB_DECIMAL"  size="9"   dec="2"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="GAS_KIND_CD"        colType="TB_STRING"   size="2"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="GAS_REDU_TYPE"      colType="TB_STRING"   size="1"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="WTR_KIND_CD"        colType="TB_STRING"   size="2"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="DIV_RATE"           colType="TB_DECIMAL"  size="5"   dec="2"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="TV_CNT"             colType="TB_DECIMAL"  size="3"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="WTR_CAL_SIZE"       colType="TB_STRING"   size="2"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="REMARK"             colType="TB_STRING"   size="100" dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="OLD_FILE_PATH"      colType="TB_STRING"   size="100" dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="REAL_FILE_PATH"     colType="TB_URL"      size="100" dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="FILE_GB"            colType="TB_STRING"   size="1"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="CHANGED_FLAG"       colType="TB_STRING"   size="1"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	    <column colName="REG_DATE"           colType="TB_STRING"   size="8"   dec="0"   keyType="TB_NORMAL" roundMode="ROUND"/>
	</gauce>
	
	
	
	<query name="SEL_MR_CNTRMST">
	   <![CDATA[   
			SELECT 
			       CNT.CNTR_ID
			     , CNT.STR_CD
			     , CNT.VEN_CD
			     , VEN.VEN_NAME AS VEN_NM
			     , VEN.COMP_NO  AS COMP_NO  /*사업자 번호*/
			     , VEN.REP_NAME AS REP_NAME /*대표자*/
			     , VEN.PHONE1_NO||'-'||VEN.PHONE2_NO||'-'||VEN.PHONE3_NO AS PHONE_NO  /*전화번호*/
			     , CNT.BELONG_STR_CD     /*소속시설*/
                 , CNT.CHAR_NAME         /*담당자명*/
                 , CNT.PHONE1_NO         /*담당자연력처1*/
                 , CNT.PHONE2_NO         /*담당자연력처1*/
                 , CNT.PHONE3_NO         /*담당자연력처1*/
                 , DECODE(CNT.PHONE1_NO||'-'||CNT.PHONE2_NO||'-'||CNT.PHONE3_NO,'--','',CNT.PHONE1_NO||'-'||CNT.PHONE2_NO||'-'||CNT.PHONE3_NO) AS PHONE_NO2
                 , COM.FN_GET_COMM_NAME('D', 'M042', CNT.CNTR_TYPE) AS CNTR_TYPE         /*계약유형*/
                 , CNT.SAP_CNTR_ID       /*계약번호*/
                 , CNT.CNTR_S_DT         /*계약기간[시작일]*/
                 , CNT.CNTR_E_DT         /*계약기간[종료일]*/
                 , COM.FN_GET_COMM_NAME('D', 'P003', CNT.RENT_TYPE) AS RENT_TYPE         /*임대형태*/
                 , COM.FN_GET_COMM_NAME('D', 'P084', CNT.RENT_FLAG) AS RENT_FLAG         /*임대구분*/
                 , CNT.CNTR_AREA         /*계약면적*/
                 , CNT.RENT_DEPOSIT      /*임대보증금*/
                 , CNT.PAY_FLAG          /*입금상태*/
                 , CNT.EXCL_AREA         /*전용면적*/
                 , CNT.MM_RENTFEE        /*월임대료*/
                 , CNT.SHR_AREA          /*공유면적*/
                 , CNT.DONG              /*동*/
                 , CNT.FLOOR_FLAG        /*층*/
                 , CNT.HO                /*호*/
                 , CNT.FILE_PATH         /*첨부파일*/
                 , COM.FN_GET_COMM_NAME('D', 'M200', CNT.FCL_TYPE) AS FCL_TYPE          /*임대시설종류*/
                 , COM.FN_GET_COMM_NAME('D', 'D022', CNT.MNTN_CAL_YN) AS MNTN_CAL_YN       /*관리비부과여부*/
                 , COM.FN_GET_COMM_NAME('D', 'D022', CNT.CHRG_YN) AS CHRG_YN           /*관리비청구내역관리여부*/
                 , COM.FN_GET_COMM_NAME('D', 'D022', CNT.ARR_CAL_YN) AS ARR_CAL_YN        /*관리비연체계산여부*/
                 , CNT.ARR_RATE          /*관리비연체율*/
                 , COM.FN_GET_COMM_NAME('D', 'M044', CNT.PAY_TERM_TYPE) AS PAY_TERM_TYPE     /*관리비납부기한기준*/
                 , CNT.PAY_TERM_DD       /*관리비납부기한일*/
                 , CNT.OFFICE_PAY_AMT    /*오피스평당관리비*/
                 , COM.FN_GET_COMM_NAME('D', 'D022', CNT.RENT_CAL_YN) AS RENT_CAL_YN       /*임대료계산여부*/
                 , COM.FN_GET_COMM_NAME('D', 'D022', CNT.RENT_ARR_CAL_YN) AS RENT_ARR_CAL_YN   /*임대료연체계산여부*/
                 , CNT.RENT_ARR_RATE     /*임대료연체율*/                 
                 , COM.FN_GET_COMM_NAME('D', 'M044', CNT.RENT_PAY_TERM_TYPE) AS RENT_PAY_TERM_TYPE /*임대료납부기한기준*/ 
                 , CNT.RENT_PAY_TERM_DD   /*임대료납부기한일*/                                   
                 , CNT.PWR_KIND_CD       /*전기용도*/
                 , CNT.PWR_TYPE          /*전압*/
                 , CNT.PWR_SEL_CHARGE    /*선택요금*/
                 , CNT.PWR_CNTR_QTY      /*계약전력*/
                 , CNT.PWR_REVER_RATE    /*전력역률*/
                 , CNT.WWTR_KIND_CD      /*온수급탕용도*/
                 , CNT.WWTR_QTY          /*온수계약용량면적*/
                 , CNT.WWTR_CHARGE_YN    /*온수차등요금제여부*/
                 , CNT.STM_KIND_CD       /*증기용도*/
                 , CNT.STM_QTY           /*증기열교환기열량*/
                 , CNT.CWTR_KIND_CD      /*냉수용도*/
                 , CNT.CWTR_QTY          /*냉수열교환기열량*/
                 , CNT.GAS_KIND_CD       /*가수용도구분*/
                 , CNT.GAS_REDU_TYPE     /*도시가스경감구분*/
                 , CNT.WTR_KIND_CD       /*수도용도구분*/
                 , CNT.DIV_RATE          /*공용안분율*/
                 , CNT.TV_CNT            /*TV수신량*/
                 , CNT.WTR_CAL_SIZE      /*수도계량기구경*/
                 , CNT.REMARK            /*비고*/ 
			     , CNT.FILE_PATH AS OLD_FILE_PATH   
			     , ''            AS REAL_FILE_PATH   
			     , 'N' AS FILE_GB        
			     , 'N' AS CHANGED_FLAG   
			     , TO_CHAR(CNT.REG_DATE, 'YYYYMMDD') AS REG_DATE
			  FROM MSS.MR_CNTRMST   CNT
			     , DPS.PC_VENMST    VEN
			 WHERE CNT.VEN_CD = VEN.VEN_CD
			   AND CNT.VEN_CD LIKE ?||'%'
			   AND CNT.RENT_TYPE LIKE ?||'%'
			   AND CNT.RENT_FLAG LIKE ?||'%'
			   AND CNT.CNTR_TYPE LIKE ?||'%'
			   AND CNT.STR_CD = ? 
        ]]> 
	</query>
    
    <!-- 조회(계약시작일 기준) Query  -->
    <query name="SEL_MR_CNTRMST_WHERE_SDT"> 
        <![CDATA[   
               AND CNT.CNTR_S_DT BETWEEN ? AND ?
        ]]>        
    </query>
    
    <!-- 조회(계약종료일 기준) Query  -->
    <query name="SEL_MR_CNTRMST_WHERE_EDT"> 
        <![CDATA[   
               AND CNT.CNTR_E_DT BETWEEN ? AND ?
        ]]>        
    </query>
    
    <!-- 조회(현거주여부) Query  -->
    <query name="SEL_MR_CNTRMST_WHERE_STAY_NOW"> 
        <![CDATA[   
			   AND (CNT.CNTR_S_DT <= TO_CHAR(SYSDATE, 'YYYYMMDD') AND
			        CNT.CNTR_E_DT >= TO_CHAR(SYSDATE, 'YYYYMMDD'))
        ]]>        
    </query>
    
    <!-- 조회(전출일 기준) Query  -->
    <query name="SEL_MR_CNTRMST_ORDER_BY"> 
        <![CDATA[   
             ORDER BY CNT.VEN_CD
        ]]>        
    </query>
    
</service>