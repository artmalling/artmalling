<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 강진
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2012.05.23
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/dctm426.dm">
	<gauce name="H_MASTER">
		<column colName="ORG_CD"            colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
	    <column colName="ORG_NM"            colType="TB_STRING"  size="8"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="GUBUN"    			colType="TB_STRING"  size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="ENTR_PBN"         	colType="TB_STRING"  size="6"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="ENTR_PBN_NAME"     colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="CNT"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="01"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="02"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="03"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="04"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="05"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="06"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="07"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="08"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="09"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="10"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="11"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="12"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="13"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="14"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="15"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="16"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="17"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="18"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="19"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="20"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="21"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="22"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="23"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="24"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="25"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="26"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="27"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="28"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="29"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="30"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="31"     			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />

    </gauce>
    
    <gauce name="H_MASTER_GUBUN">
		<column colName="ORG_CD"            colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
	    <column colName="ORG_NM"            colType="TB_STRING"  size="8"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="ENTR_PBN"         	colType="TB_STRING"  size="6"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="ENTR_PBN_NAME"     colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_CNT"     		colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_CNT"     		colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_CNT"     		colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_01"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_01"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_01"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_02"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_02"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_02"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_03"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_03"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_03"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_04"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_04"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_04"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_05"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_05"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_05"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_06"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_06"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_06"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_07"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_07"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_07"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_08"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_08"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_08"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_09"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_09"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_09"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_10"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_10"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_10"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_11"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_11"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_11"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_12"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_12"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_12"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_13"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_13"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_13"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_14"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_14"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_14"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_15"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_15"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_15"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_16"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_16"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_16"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_17"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_17"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_17"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_18"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_18"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_18"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_19"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_19"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_19"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_20"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_20"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_20"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_21"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_21"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_21"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_22"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_22"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_22"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_23"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_23"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_23"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_24"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_24"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_24"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_25"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_25"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_25"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_26"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_26"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_26"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_27"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_27"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_27"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_28"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_28"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_28"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_29"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_29"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_29"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_30"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_30"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_30"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI0_31"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DI1_31"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="DIA_31"			colType="TB_DECIMAL"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
   
    
    <!--  회원가입현황조회(브랜드)  -->
    <query name="SEL_MASTER">
        <![CDATA[
		SELECT  DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1') AS ORG_CD
		      , DPS.FN_GET_ORG_NAME(SUBSTR(DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1'),1,2),
		                            SUBSTR(DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1'),3,2),
		                            SUBSTR(DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1'),5,2),
		                            SUBSTR(DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1'),7,2),
		                            SUBSTR(DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1'),9,2)) AS ORG_NM
		     , '' GUBUN
		     , ENTR_PBN
		     , NVL(DPS.FN_GET_PUMBUN_NAME(ENTR_PBN),'기타') ENTR_PBN_NAME
		     , COUNT(CUST_ID) CNT
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'01',CUST_ID,NULL)) "01"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'02',CUST_ID,NULL)) "02"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'03',CUST_ID,NULL)) "03"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'04',CUST_ID,NULL)) "04"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'05',CUST_ID,NULL)) "05"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'06',CUST_ID,NULL)) "06"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'07',CUST_ID,NULL)) "07"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'08',CUST_ID,NULL)) "08"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'09',CUST_ID,NULL)) "09"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'10',CUST_ID,NULL)) "10"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'11',CUST_ID,NULL)) "11"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'12',CUST_ID,NULL)) "12"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'13',CUST_ID,NULL)) "13"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'14',CUST_ID,NULL)) "14"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'15',CUST_ID,NULL)) "15"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'16',CUST_ID,NULL)) "16"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'17',CUST_ID,NULL)) "17"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'18',CUST_ID,NULL)) "18"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'19',CUST_ID,NULL)) "19"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'20',CUST_ID,NULL)) "20"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'21',CUST_ID,NULL)) "21"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'22',CUST_ID,NULL)) "22"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'23',CUST_ID,NULL)) "23"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'24',CUST_ID,NULL)) "24"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'25',CUST_ID,NULL)) "25"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'26',CUST_ID,NULL)) "26"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'27',CUST_ID,NULL)) "27"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'28',CUST_ID,NULL)) "28"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'29',CUST_ID,NULL)) "29"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'30',CUST_ID,NULL)) "30"
		     , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'31',CUST_ID,NULL)) "31"
		 FROM
		(
		SELECT CUST_ID
		     , REG_ID ENTR_PBN
		     , ENTR_DT
		  FROM DCS.DM_CUSTOMER
		WHERE NVL(DI,'9') IN ('0','1')
		  AND ENTR_DT LIKE ?||'%'
		  AND LENGTH(REG_ID) = 6
		  AND REG_ID NOT LIKE '9%'
		  AND REG_ID NOT LIKE 'M%'
		  AND REG_ID LIKE ?||'%'
		  AND CUST_ID LIKE ?||'%'	-- C : 점가입, M : 모바일 가입
		)
		GROUP BY ENTR_PBN
		ORDER BY CNT DESC
        ]]>
    </query>
    
    <query name="SEL_MASTER_GUBUN">
        <![CDATA[
		WITH CUST_LIST AS (
        SELECT CUST_ID
		     , REG_ID ENTR_PBN
		     , ENTR_DT
             , DI
		  FROM DCS.DM_CUSTOMER
		WHERE NVL(DI,'9') IN ('0','1')
		  AND ENTR_DT LIKE ?||'%'
		  AND LENGTH(REG_ID) = 6
		  AND REG_ID NOT LIKE '9%'
		  AND REG_ID NOT LIKE 'M%'
		  AND REG_ID LIKE ?||'%'
		  AND CUST_ID LIKE ?||'%'	-- C : 점가입, M : 모바일 가입
		)
		SELECT DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1') AS ORG_CD
			 , DPS.FN_GET_ORG_NAME(SUBSTR(DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1'),1,2),
				                   SUBSTR(DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1'),3,2),
				                   SUBSTR(DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1'),5,2),
				                   SUBSTR(DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1'),7,2),
				                   SUBSTR(DPS.FN_GET_PBNORGCD('4', '01', ENTR_PBN, '1'),9,2)) AS ORG_NM
		     , ENTR_PBN
		     , NVL(DPS.FN_GET_PUMBUN_NAME(ENTR_PBN),'기타') ENTR_PBN_NAME
		     , SUM(DECODE(DI,'0',NVL(CNT,0),0)) DI0_CNT
		     , SUM(DECODE(DI,'1',NVL(CNT,0),0)) DI1_CNT
		     , SUM(DECODE(DI,'A',NVL(CNT,0),0)) DIA_CNT
		     , SUM(DECODE(DI,'0',NVL(D01,0),0)) DI0_01
		     , SUM(DECODE(DI,'1',NVL(D01,0),0)) DI1_01
		     , SUM(DECODE(DI,'A',NVL(D01,0),0)) DIA_01
		     , SUM(DECODE(DI,'0',NVL(D02,0),0)) DI0_02
		     , SUM(DECODE(DI,'1',NVL(D02,0),0)) DI1_02
		     , SUM(DECODE(DI,'A',NVL(D02,0),0)) DIA_02
		     , SUM(DECODE(DI,'0',NVL(D03,0),0)) DI0_03
		     , SUM(DECODE(DI,'1',NVL(D03,0),0)) DI1_03
		     , SUM(DECODE(DI,'A',NVL(D03,0),0)) DIA_03
		     , SUM(DECODE(DI,'0',NVL(D04,0),0)) DI0_04
		     , SUM(DECODE(DI,'1',NVL(D04,0),0)) DI1_04
		     , SUM(DECODE(DI,'A',NVL(D04,0),0)) DIA_04
		     , SUM(DECODE(DI,'0',NVL(D05,0),0)) DI0_05
		     , SUM(DECODE(DI,'1',NVL(D05,0),0)) DI1_05
		     , SUM(DECODE(DI,'A',NVL(D05,0),0)) DIA_05
		     , SUM(DECODE(DI,'0',NVL(D06,0),0)) DI0_06
		     , SUM(DECODE(DI,'1',NVL(D06,0),0)) DI1_06
		     , SUM(DECODE(DI,'A',NVL(D06,0),0)) DIA_06
		     , SUM(DECODE(DI,'0',NVL(D07,0),0)) DI0_07
		     , SUM(DECODE(DI,'1',NVL(D07,0),0)) DI1_07
		     , SUM(DECODE(DI,'A',NVL(D07,0),0)) DIA_07
		     , SUM(DECODE(DI,'0',NVL(D08,0),0)) DI0_08
		     , SUM(DECODE(DI,'1',NVL(D08,0),0)) DI1_08
		     , SUM(DECODE(DI,'A',NVL(D08,0),0)) DIA_08
		     , SUM(DECODE(DI,'0',NVL(D09,0),0)) DI0_09
		     , SUM(DECODE(DI,'1',NVL(D09,0),0)) DI1_09
		     , SUM(DECODE(DI,'A',NVL(D09,0),0)) DIA_09
		     , SUM(DECODE(DI,'0',NVL(D10,0),0)) DI0_10
		     , SUM(DECODE(DI,'1',NVL(D10,0),0)) DI1_10
		     , SUM(DECODE(DI,'A',NVL(D10,0),0)) DIA_10
		     , SUM(DECODE(DI,'0',NVL(D11,0),0)) DI0_11
		     , SUM(DECODE(DI,'1',NVL(D11,0),0)) DI1_11
		     , SUM(DECODE(DI,'A',NVL(D11,0),0)) DIA_11
		     , SUM(DECODE(DI,'0',NVL(D12,0),0)) DI0_12
		     , SUM(DECODE(DI,'1',NVL(D12,0),0)) DI1_12
		     , SUM(DECODE(DI,'A',NVL(D12,0),0)) DIA_12
		     , SUM(DECODE(DI,'0',NVL(D13,0),0)) DI0_13
		     , SUM(DECODE(DI,'1',NVL(D13,0),0)) DI1_13
		     , SUM(DECODE(DI,'A',NVL(D13,0),0)) DIA_13
		     , SUM(DECODE(DI,'0',NVL(D14,0),0)) DI0_14
		     , SUM(DECODE(DI,'1',NVL(D14,0),0)) DI1_14
		     , SUM(DECODE(DI,'A',NVL(D14,0),0)) DIA_14
		     , SUM(DECODE(DI,'0',NVL(D15,0),0)) DI0_15
		     , SUM(DECODE(DI,'1',NVL(D15,0),0)) DI1_15
		     , SUM(DECODE(DI,'A',NVL(D15,0),0)) DIA_15
		     , SUM(DECODE(DI,'0',NVL(D16,0),0)) DI0_16
		     , SUM(DECODE(DI,'1',NVL(D16,0),0)) DI1_16
		     , SUM(DECODE(DI,'A',NVL(D16,0),0)) DIA_16
		     , SUM(DECODE(DI,'0',NVL(D17,0),0)) DI0_17
		     , SUM(DECODE(DI,'1',NVL(D17,0),0)) DI1_17
		     , SUM(DECODE(DI,'A',NVL(D17,0),0)) DIA_17
		     , SUM(DECODE(DI,'0',NVL(D18,0),0)) DI0_18
		     , SUM(DECODE(DI,'1',NVL(D18,0),0)) DI1_18
		     , SUM(DECODE(DI,'A',NVL(D18,0),0)) DIA_18
		     , SUM(DECODE(DI,'0',NVL(D19,0),0)) DI0_19
		     , SUM(DECODE(DI,'1',NVL(D19,0),0)) DI1_19
		     , SUM(DECODE(DI,'A',NVL(D19,0),0)) DIA_19
		     , SUM(DECODE(DI,'0',NVL(D20,0),0)) DI0_20
		     , SUM(DECODE(DI,'1',NVL(D20,0),0)) DI1_20
		     , SUM(DECODE(DI,'A',NVL(D20,0),0)) DIA_20
		     , SUM(DECODE(DI,'0',NVL(D21,0),0)) DI0_21
		     , SUM(DECODE(DI,'1',NVL(D21,0),0)) DI1_21
		     , SUM(DECODE(DI,'A',NVL(D21,0),0)) DIA_21
		     , SUM(DECODE(DI,'0',NVL(D22,0),0)) DI0_22
		     , SUM(DECODE(DI,'1',NVL(D22,0),0)) DI1_22
		     , SUM(DECODE(DI,'A',NVL(D22,0),0)) DIA_22
		     , SUM(DECODE(DI,'0',NVL(D23,0),0)) DI0_23
		     , SUM(DECODE(DI,'1',NVL(D23,0),0)) DI1_23
		     , SUM(DECODE(DI,'A',NVL(D23,0),0)) DIA_23
		     , SUM(DECODE(DI,'0',NVL(D24,0),0)) DI0_24
		     , SUM(DECODE(DI,'1',NVL(D24,0),0)) DI1_24
		     , SUM(DECODE(DI,'A',NVL(D24,0),0)) DIA_24
		     , SUM(DECODE(DI,'0',NVL(D25,0),0)) DI0_25
		     , SUM(DECODE(DI,'1',NVL(D25,0),0)) DI1_25
		     , SUM(DECODE(DI,'A',NVL(D25,0),0)) DIA_25
		     , SUM(DECODE(DI,'0',NVL(D26,0),0)) DI0_26
		     , SUM(DECODE(DI,'1',NVL(D26,0),0)) DI1_26
		     , SUM(DECODE(DI,'A',NVL(D26,0),0)) DIA_26
		     , SUM(DECODE(DI,'0',NVL(D27,0),0)) DI0_27
		     , SUM(DECODE(DI,'1',NVL(D27,0),0)) DI1_27
		     , SUM(DECODE(DI,'A',NVL(D27,0),0)) DIA_27
		     , SUM(DECODE(DI,'0',NVL(D28,0),0)) DI0_28
		     , SUM(DECODE(DI,'1',NVL(D28,0),0)) DI1_28
		     , SUM(DECODE(DI,'A',NVL(D28,0),0)) DIA_28
		     , SUM(DECODE(DI,'0',NVL(D29,0),0)) DI0_29
		     , SUM(DECODE(DI,'1',NVL(D29,0),0)) DI1_29
		     , SUM(DECODE(DI,'A',NVL(D29,0),0)) DIA_29
		     , SUM(DECODE(DI,'0',NVL(D30,0),0)) DI0_30
		     , SUM(DECODE(DI,'1',NVL(D30,0),0)) DI1_30
		     , SUM(DECODE(DI,'A',NVL(D30,0),0)) DIA_30
		     , SUM(DECODE(DI,'0',NVL(D31,0),0)) DI0_31
		     , SUM(DECODE(DI,'1',NVL(D31,0),0)) DI1_31
		     , SUM(DECODE(DI,'A',NVL(D31,0),0)) DIA_31
		 FROM
		(
		SELECT ENTR_PBN
		     , DI
		     , COUNT(CUST_ID) CNT
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'01',CUST_ID,NULL)) "D01"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'02',CUST_ID,NULL)) "D02"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'03',CUST_ID,NULL)) "D03"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'04',CUST_ID,NULL)) "D04"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'05',CUST_ID,NULL)) "D05"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'06',CUST_ID,NULL)) "D06"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'07',CUST_ID,NULL)) "D07"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'08',CUST_ID,NULL)) "D08"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'09',CUST_ID,NULL)) "D09"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'10',CUST_ID,NULL)) "D10"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'11',CUST_ID,NULL)) "D11"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'12',CUST_ID,NULL)) "D12"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'13',CUST_ID,NULL)) "D13"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'14',CUST_ID,NULL)) "D14"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'15',CUST_ID,NULL)) "D15"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'16',CUST_ID,NULL)) "D16"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'17',CUST_ID,NULL)) "D17"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'18',CUST_ID,NULL)) "D18"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'19',CUST_ID,NULL)) "D19"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'20',CUST_ID,NULL)) "D20"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'21',CUST_ID,NULL)) "D21"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'22',CUST_ID,NULL)) "D22"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'23',CUST_ID,NULL)) "D23"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'24',CUST_ID,NULL)) "D24"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'25',CUST_ID,NULL)) "D25"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'26',CUST_ID,NULL)) "D26"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'27',CUST_ID,NULL)) "D27"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'28',CUST_ID,NULL)) "D28"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'29',CUST_ID,NULL)) "D29"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'30',CUST_ID,NULL)) "D30"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'31',CUST_ID,NULL)) "D31" FROM CUST_LIST
		WHERE DI = 1
		GROUP BY ENTR_PBN, DI
		UNION ALL
		SELECT ENTR_PBN
		     , DI
		     , COUNT(CUST_ID) CNT
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'01',CUST_ID,NULL)) "01"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'02',CUST_ID,NULL)) "02"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'03',CUST_ID,NULL)) "03"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'04',CUST_ID,NULL)) "04"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'05',CUST_ID,NULL)) "05"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'06',CUST_ID,NULL)) "06"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'07',CUST_ID,NULL)) "07"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'08',CUST_ID,NULL)) "08"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'09',CUST_ID,NULL)) "09"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'10',CUST_ID,NULL)) "10"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'11',CUST_ID,NULL)) "11"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'12',CUST_ID,NULL)) "12"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'13',CUST_ID,NULL)) "13"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'14',CUST_ID,NULL)) "14"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'15',CUST_ID,NULL)) "15"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'16',CUST_ID,NULL)) "16"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'17',CUST_ID,NULL)) "17"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'18',CUST_ID,NULL)) "18"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'19',CUST_ID,NULL)) "19"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'20',CUST_ID,NULL)) "20"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'21',CUST_ID,NULL)) "21"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'22',CUST_ID,NULL)) "22"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'23',CUST_ID,NULL)) "23"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'24',CUST_ID,NULL)) "24"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'25',CUST_ID,NULL)) "25"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'26',CUST_ID,NULL)) "26"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'27',CUST_ID,NULL)) "27"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'28',CUST_ID,NULL)) "28"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'29',CUST_ID,NULL)) "29"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'30',CUST_ID,NULL)) "30"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'31',CUST_ID,NULL)) "31" FROM CUST_LIST
		WHERE DI = 0
		GROUP BY ENTR_PBN, DI
		UNION ALL
		SELECT ENTR_PBN
		     , 'A' DI
		     , COUNT(CUST_ID) CNT
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'01',CUST_ID,NULL)) "01"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'02',CUST_ID,NULL)) "02"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'03',CUST_ID,NULL)) "03"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'04',CUST_ID,NULL)) "04"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'05',CUST_ID,NULL)) "05"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'06',CUST_ID,NULL)) "06"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'07',CUST_ID,NULL)) "07"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'08',CUST_ID,NULL)) "08"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'09',CUST_ID,NULL)) "09"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'10',CUST_ID,NULL)) "10"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'11',CUST_ID,NULL)) "11"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'12',CUST_ID,NULL)) "12"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'13',CUST_ID,NULL)) "13"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'14',CUST_ID,NULL)) "14"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'15',CUST_ID,NULL)) "15"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'16',CUST_ID,NULL)) "16"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'17',CUST_ID,NULL)) "17"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'18',CUST_ID,NULL)) "18"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'19',CUST_ID,NULL)) "19"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'20',CUST_ID,NULL)) "20"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'21',CUST_ID,NULL)) "21"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'22',CUST_ID,NULL)) "22"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'23',CUST_ID,NULL)) "23"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'24',CUST_ID,NULL)) "24"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'25',CUST_ID,NULL)) "25"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'26',CUST_ID,NULL)) "26"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'27',CUST_ID,NULL)) "27"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'28',CUST_ID,NULL)) "28"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'29',CUST_ID,NULL)) "29"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'30',CUST_ID,NULL)) "30"
			 , COUNT(DECODE(SUBSTR(ENTR_DT,7,2),'31',CUST_ID,NULL)) "31" FROM CUST_LIST
		GROUP BY ENTR_PBN, DI
		)
		GROUP BY ENTR_PBN
		ORDER BY DIA_CNT DESC
        ]]>
    </query>  
    
    
 </service>