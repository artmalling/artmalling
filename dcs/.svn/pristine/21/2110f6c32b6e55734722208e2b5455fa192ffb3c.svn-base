<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 강진
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2012.05.23
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/dctm428.dm">
	<gauce name="H_MASTER">
		<column colName="CHG_DT"           		colType="TB_STRING"  size="8" 	dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
	    <column colName="CHG_SEQ"           	colType="TB_STRING"  size="9"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="CUST_ID"    			colType="TB_STRING"  size="9"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="CUST_NAME"         	colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="CARD_NO"     			colType="TB_STRING"  size="64"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="MOBILE_PH"     		colType="TB_STRING"  size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="EMAIL"    				colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="MOBILE_PH1"     		colType="TB_STRING"  size="96"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="MOBILE_PH2"     		colType="TB_STRING"  size="96"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="MOBILE_PH3"     		colType="TB_STRING"  size="96"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="EMAIL1"     			colType="TB_STRING"  size="248" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="EMAIL2"     			colType="TB_STRING"  size="248" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />    	    
	    <column colName="EMAIL_YN"     			colType="TB_STRING"  size="1"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="SMS_YN"     			colType="TB_STRING"  size="1"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="SEND_DATE"     		colType="TB_STRING"  size="30"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="RECV_DATE"     		colType="TB_STRING"  size="30"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="APP_DATE"     			colType="TB_STRING"  size="30"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="PROC_GB"     			colType="TB_STRING"  size="1"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="PROC_GB_NM"     		colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="IF_CUST_ID"     		colType="TB_STRING"  size="9"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="IF_CARD_NO"     		colType="TB_STRING"  size="64"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="IF_USERID"     		colType="TB_STRING"  size="64"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="EMAIL_YN_CHG_YN"     	colType="TB_STRING"  size="1"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="EMAIL_YN_CHG_YN_NM"    colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />	    
	    <column colName="IF_EMAIL_YN"           colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="EMAIL_YN_NM"    		colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="SMS_YN_CHG_YN"      	colType="TB_STRING"  size="1"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="SMS_YN_CHG_YN_NM"   	colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="IF_SMS_YN"     		colType="TB_STRING"  size="1"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="SMS_YN_NM"    			colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="HOME_ADDR_CHG_YN"     	colType="TB_STRING"  size="1"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="HOME_ADDR_CHG_YN_NM"   colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="HOME_ADDR"     		colType="TB_STRING"  size="200" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="EMAIL_CHG_YN"     		colType="TB_STRING"  size="1" 	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="EMAIL_CHG_YN_NM"    	colType="TB_STRING"  size="10" 	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />    	    
	    <column colName="IF_EMAIL"     			colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="MOBILE_PH_CHG_YN"     	colType="TB_STRING"  size="1"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="MOBILE_PH_CHG_YN_NM"   colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="IF_MOBILE_PH"     		colType="TB_STRING"  size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="HNEW_ADDR_CHG_YN"     	colType="TB_STRING"  size="1"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="HNEW_ADDR_CHG_YN_NM"   colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="HNEW_ADDR"     		colType="TB_STRING"  size="200" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="REG_DATE"     			colType="TB_STRING"  size="30"  	dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
	    <column colName="REG_ID"     			colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
   
    
    <!--  고객수신동의송신현황조회  -->
    <query name="SEL_MASTER">
        <![CDATA[
			SELECT
			      A.CHG_DT        -- 변경일자
			    , A.CHG_SEQ       -- 변경순번
			    , B.CUST_ID
			    , B.CUST_NAME
			    , DCS.SC_Crypto_FUN('DEC', C.CARD_NO) AS CARD_NO
			    , '' AS MOBILE_PH
			    , '' AS EMAIL
			    , DCS.SC_Crypto_FUN('DEC', B.MOBILE_PH1) AS MOBILE_PH1
			    , DCS.SC_Crypto_FUN('DEC', B.MOBILE_PH2) AS MOBILE_PH2
			    , DCS.SC_Crypto_FUN('DEC', B.MOBILE_PH3) AS MOBILE_PH3
			    , DCS.SC_Crypto_FUN('DEC', B.EMAIL1) AS EMAIL1
			    , DCS.SC_Crypto_FUN('DEC', B.EMAIL2) AS EMAIL2	    			    
			    , B.EMAIL_YN
			    , B.SMS_YN
			    , A.SEND_DATE     -- 송신일자
			    , A.RECV_DATE     -- 수신일자
			    , A.APP_DATE      -- 적용일자
			    , A.PROC_GB       -- 적용구분
			    , CASE WHEN PROC_GB = '1' THEN '자료생성'
			           WHEN PROC_GB = '2' THEN '자료송신'
			           WHEN PROC_GB = '3' THEN '자료수신'
			           WHEN PROC_GB = '4' THEN '자료적용'
			      END PROC_GB_NM -- 적용구분
			    , A.CUST_ID AS IF_CUST_ID        -- 회원 ID
			    , A.CARD_NO AS IF_CARD_NO       -- 카드번호
			    , A.USERID  AS IF_USERID       -- 회원식별자
			    , A.EMAIL_YN_CHG_YN    -- EMAIL 수신여부 변경
			    , CASE WHEN A.EMAIL_YN_CHG_YN = 'Y' THEN '변경'
			           ELSE ''
			      END EMAIL_YN_CHG_YN_NM
			    , A.EMAIL_YN AS IF_EMAIL_YN
			    , CASE WHEN A.EMAIL_YN = 'Y' THEN '수신'
			           WHEN A.EMAIL_YN = 'N' THEN '미수신'
			           ELSE ''
			      END EMAIL_YN_NM
			    , SMS_YN_CHG_YN
			    , CASE WHEN A.SMS_YN_CHG_YN = 'Y' THEN '변경'
			           ELSE ''
			      END SMS_YN_CHG_YN_NM
			    , A.SMS_YN AS IF_SMS_YN
			    , CASE WHEN A.SMS_YN = 'Y' THEN '수신'
			           WHEN A.SMS_YN = 'N' THEN '미수신'
			           ELSE ''
			      END SMS_YN_NM
			    , A.HOME_ADDR_CHG_YN
			    , CASE WHEN A.HOME_ADDR_CHG_YN = 'Y' THEN '변경'
			           ELSE ''
			      END HOME_ADDR_CHG_YN_NM
			      , CASE WHEN A.HOME_ADDR_CHG_YN = 'Y'
			           THEN  A.HOME_ZIP_CD1||'-'|| A.HOME_ZIP_CD2||'   '||A.HOME_ADDR1||'   '||A.HOME_ADDR2
			           ELSE ''
			      END HOME_ADDR
			    , A.EMAIL_CHG_YN
			    , CASE WHEN A.EMAIL_CHG_YN = 'Y' THEN '변경'
			           ELSE ''
			      END EMAIL_CHG_YN_NM
			    , CASE WHEN A.EMAIL_CHG_YN = 'Y'
			           THEN A.EMAIL1||'-'||A.EMAIL2
			           ELSE ''
			      END IF_EMAIL
			    , MOBILE_PH_CHG_YN
			    , CASE WHEN A.MOBILE_PH_CHG_YN = 'Y' THEN '변경'
			           ELSE ''
			      END MOBILE_PH_CHG_YN_NM
			    , CASE WHEN MOBILE_PH_CHG_YN = 'Y'
			           THEN A.MOBILE_PH1||'-'||A.MOBILE_PH2||'-'||A.MOBILE_PH3
			           ELSE ''
			      END  IF_MOBILE_PH
			    , HNEW_ADDR_CHG_YN
			    , CASE WHEN A.HNEW_ADDR_CHG_YN = 'Y' THEN '변경'
			           ELSE ''
			      END HNEW_ADDR_CHG_YN_NM
			    , CASE WHEN A.HNEW_ADDR_CHG_YN = 'Y'
			           THEN  A.HNEW_ZIP_CD1||'-'|| A.HNEW_ZIP_CD2||'   '||A.HNEW_ADDR1||'   '||A.HNEW_ADDR2
			           ELSE ''
			      END HNEW_ADDR
			    , A.REG_DATE
			    , A.REG_ID
			FROM DCS.DH_IF_HPAGE_INFO A,
			     DCS.DM_CUSTOMER B,
			     DCS.DM_CARD C
			WHERE A.CHG_DT >= ?
			  AND A.CHG_DT <= ?
			  AND A.CARD_NO = C.CARD_NO(+)
			  AND A.CUST_ID = B.CUST_ID(+)
			ORDER BY A.CHG_DT
			    , A.CHG_SEQ  
        ]]>
    </query> 
    
    
    
 </service>