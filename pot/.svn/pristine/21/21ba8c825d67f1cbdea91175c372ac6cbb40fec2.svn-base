<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 정진영
 * 회 사 명 : FKSS
 * 작 성 일 : 2010.02.16
 * 변 경 일  :
 * 변경내용 :
 * 개     요  : 품번코드(점별) 공통 XML
 -->
<service name="/ccom012.cc">	
 
    <!-- 점별품번 조회 -->
    <gauce name="H_STRPBN">
        <column colName="SEL"              colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="PUMBUN_CD"        colType="TB_STRING" size="6"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="PUMBUN_NAME"      colType="TB_STRING" size="40"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="RECP_NAME"        colType="TB_STRING" size="20"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="SKU_FLAG"         colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="REP_PUMBUN_CD"    colType="TB_STRING" size="6"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="SKU_TYPE"         colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="BIZ_TYPE"         colType="TB_STRING" size="2"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="TAX_FLAG"         colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="CHAR_BUYER_CD"    colType="TB_STRING" size="6"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="CHAR_BUYER_NAME"  colType="TB_STRING" size="40"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="CHAR_SM_CD"       colType="TB_STRING" size="6"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="CHAR_SM_NAME"     colType="TB_STRING" size="40"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="VEN_CD"           colType="TB_STRING" size="6"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="VEN_NAME"         colType="TB_STRING" size="40"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="STYLE_TYPE"       colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="BUYER_EMP_NAME"   colType="TB_STRING" size="10" dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="BUY_ORG_CD"       colType="TB_STRING" size="10" dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="SALE_ORG_CD"      colType="TB_STRING" size="10" dec="0" keyType="TB_NORMAL"  roundMode="" />
        <column colName="BRAND_CD"         colType="TB_STRING" size="5"  dec="0" keyType="TB_NORMAL" roundMode="" />
        <column colName="BRAND_NM"         colType="TB_STRING" size="40" dec="0" keyType="TB_NORMAL" roundMode="" />
        <column colName="PUMBUN_TYPE"      colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL" roundMode="" />
    </gauce>  
    
    <!-- 품번 조회 -->
    <gauce name="H_PBNMST_INFO">
        <column colName="PUMBUN_CD"        colType="TB_STRING" size="6"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NAME"      colType="TB_STRING" size="40" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="RECP_NAME"        colType="TB_STRING" size="20" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_CD"           colType="TB_STRING" size="6"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_NAME"         colType="TB_STRING" size="40" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BIZ_TYPE"         colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BIZ_FLAG"         colType="TB_STRING" size="2"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REP_PUMBUN_CD"    colType="TB_STRING" size="6"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REP_PUMBUN_NAME"  colType="TB_STRING" size="40" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TAX_FLAG"         colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_FLAG"      colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_TYPE"      colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_FLAG"         colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_TYPE"         colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STYLE_TYPE"       colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ITG_ORD_FLAG"     colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BRAND_CD"         colType="TB_STRING" size="5"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="APP_S_DT"         colType="TB_STRING" size="8"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="APP_E_DT"         colType="TB_STRING" size="8"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="USE_YN"           colType="TB_STRING" size="1"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BRAND_NM"         colType="TB_STRING" size="40" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>  
    <!-- 품번코드조회 SQL -->
    <query name="SEL_STRPBN">
        <![CDATA[                                        
            SELECT 'F'        AS SEL
                 , PBN.PUMBUN_CD
                 , PBN.PUMBUN_NAME
                 , PBN.RECP_NAME
                 , PBN.SKU_FLAG
                 , PBN.REP_PUMBUN_CD
                 , PBN.SKU_TYPE
                 , PBN.BIZ_TYPE
                 , PBN.TAX_FLAG
                 , SPN.CHAR_BUYER_CD
                 , BUY.BUYER_NAME     AS CHAR_BUYER_NAME
                 , SPN.CHAR_SM_CD
                 , SM.BUYER_NAME      AS CHAR_SM_NAME
                 , PBN.VEN_CD
                 , VEN.VEN_NAME
                 , PBN.STYLE_TYPE
                 , DPS.FN_GET_BUYER_NAME(CHAR_BUYER_CD) AS BUYER_EMP_NAME
                 , SPN.BUY_ORG_CD
                 , SPN.SALE_ORG_CD
                 , PBN.BRAND_CD
                 , BRD.BRAND_NM
                 , PBN.PUMBUN_TYPE
              FROM DPS.PC_PBNMST   PBN
        ]]>
    </query>
    
    <query name="SEL_STRPBN_WHERE_NOT_STR_CD">
        <![CDATA[
                 , (SELECT null AS STR_CD, null AS CHAR_BUYER_CD, null AS CHAR_SM_CD, null AS BUY_ORG_CD, null AS SALE_ORG_CD, null AS SALE_BUY_FLAG, null AS FLOR_CD
                      FROM DUAL
                   ) SPN
                 , (SELECT NULL AS BUYER_NAME 
                      FROM DUAL 
                   )   BUY
                 , (SELECT NULL AS BUYER_NAME
                      FROM DUAL
                   )  SM
                 , DPS.PC_VENMST   VEN
                 , DPS.PC_BRDMST   BRD
             WHERE PBN.VEN_CD        = VEN.VEN_CD
               AND BRD.BRAND_CD  (+) = PBN.BRAND_CD  
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_STR_CD">
        <![CDATA[
                 , DPS.PC_STRPBN   SPN
                 , DPS.PC_BUYERMST BUY
                 , DPS.PC_BUYERMST SM
                 , DPS.PC_VENMST   VEN
                 , DPS.PC_BRDMST   BRD
             WHERE PBN.VEN_CD        = VEN.VEN_CD
               AND BRD.BRAND_CD   (+)= PBN.BRAND_CD
               AND SPN.PUMBUN_CD     = PBN.PUMBUN_CD
               AND SPN.CHAR_BUYER_CD = BUY.BUYER_CD(+)
               AND SPN.CHAR_SM_CD    = SM.BUYER_CD(+)  
               AND SPN.STR_CD    = ?
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_PUMBUN_CD">
        <![CDATA[
               AND PBN.PUMBUN_CD   = ?
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_LIKE_PUMBUN_CD">
        <![CDATA[
               AND PBN.PUMBUN_CD   LIKE ?||'%'
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_PUMBUN_NM">
        <![CDATA[
               AND PBN.PUMBUN_NAME LIKE '%'||?||'%'
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_AUTHORITY">
        <![CDATA[
               AND EXISTS ( SELECT MYORG.USER_ID
                              FROM COM.V_MYORG MYORG
                             WHERE MYORG.PUMBUN_CD   = PBN.PUMBUN_CD
                               AND MYORG.USER_ID     = ?
                               AND MYORG.ORG_FLAG    = ?
                               AND ROWNUM            = 1
                          )
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_AUTHORITY_STR">
        <![CDATA[
               AND EXISTS ( SELECT MYORG.USER_ID
                              FROM COM.V_MYORG MYORG
                             WHERE MYORG.PUMBUN_CD   = PBN.PUMBUN_CD
                               AND MYORG.STR_CD      = ?
                               AND MYORG.USER_ID     = ?
                               AND MYORG.ORG_FLAG    = ?
                               AND ROWNUM            = 1
                          )
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_ORG_CD">
        <![CDATA[
               AND (SPN.BUY_ORG_CD  IN (
                                         SELECT ORG_CD
                                           FROM DPS.PC_ORGMST
                                          START WITH ORG_CD     <> ?
                                        CONNECT BY PRIOR ORG_CD = P_ORG_CD
                                       )
                   OR SPN.SALE_ORG_CD IN (
                                           SELECT ORG_CD
                                             FROM DPS.PC_ORGMST
                                            START WITH ORG_CD     <> ?
                                          CONNECT BY PRIOR ORG_CD = P_ORG_CD
                                         )
                   )
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_VEN_CD">
        <![CDATA[
               AND PBN.VEN_CD    = ?
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_BUYER_CD">
        <![CDATA[
               AND (SPN.CHAR_BUYER_CD = ? OR SPN.CHAR_SM_CD = ? ) 
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_PUMBUN_TYPE">
        <![CDATA[
               AND PBN.PUMBUN_TYPE    = ?
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_SKU_FLAG">
        <![CDATA[
               AND PBN.SKU_FLAG = ?  
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_SKU_TYPE">
        <![CDATA[
               AND PBN.SKU_TYPE = ?  
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_ITG_ORD_FLAG">
        <![CDATA[
               AND PBN.ITG_ORD_FLAG = ?
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_USE_YN">
        <![CDATA[
               AND PBN.USE_YN      = ?
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_BIZ_TYPE">
        <![CDATA[
               AND PBN.BIZ_TYPE      = ?
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_BUY_SALE_FLAG">
        <![CDATA[
               AND SPN.SALE_BUY_FLAG      = ?
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_STYLE_TYPE">
        <![CDATA[
               AND PBN.STYLE_TYPE         = ?
        ]]>
    </query>
    <query name="SEL_STRPBN_WHERE_FLOR_CD">
        <![CDATA[
               AND SPN.FLOR_CD            = ?
        ]]>
    </query>
    <query name="SEL_STRPBN_ORDER">
        <![CDATA[
             ORDER BY SPN.STR_CD, PBN.PUMBUN_CD
        ]]>
    </query>
    <query name="SEL_PBNMST_INFO">
        <![CDATA[
            SELECT PBN.PUMBUN_CD
                 , PBN.PUMBUN_NAME
                 , PBN.RECP_NAME
                 , PBN.VEN_CD
                 , VEN.VEN_NAME
                 , PBN.BIZ_TYPE
                 , PBN.BIZ_FLAG
                 , PBN.REP_PUMBUN_CD
                 , REPPBN.PUMBUN_NAME AS REP_PUMBUN_NAME
                 , PBN.TAX_FLAG
                 , PBN.PUMBUN_FLAG
                 , PBN.PUMBUN_TYPE
                 , PBN.SKU_FLAG
                 , PBN.SKU_TYPE
                 , PBN.STYLE_TYPE
                 , PBN.ITG_ORD_FLAG
                 , PBN.BRAND_CD
                 , PBN.APP_S_DT
                 , PBN.APP_E_DT
                 , PBN.USE_YN
                 , BRD.BRAND_NM
              FROM DPS.PC_PBNMST PBN
                 , DPS.PC_PBNMST REPPBN
                 , DPS.PC_VENMST VEN
                 , DPS.PC_BRDMST BRD
            WHERE PBN.REP_PUMBUN_CD = REPPBN.PUMBUN_CD
              AND PBN.VEN_CD        = VEN.VEN_CD
              AND BRD.BRAND_CD   (+)= PBN.BRAND_CD
              AND PBN.PUMBUN_CD     = ?
        ]]>
    </query>
</service>