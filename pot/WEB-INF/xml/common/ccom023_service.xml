<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 이재득
 * 회 사 명 : FKSS
 * 작 성 일 : 2010.03.24
 * 변 경 일  :
 * 변경내용 :
 * 개     요  : OFFER SHEET 공통 XML
 -->
<service name="/ccom023.cc">	

    <gauce name="H_SEL_OFFMST">
        <column colName="STR_CD"              colType="TB_STRING"  size="2"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="OFFER_YM"            colType="TB_STRING"  size="6"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="OFFER_SEQ_NO"        colType="TB_DECIMAL" size="5"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="OFFER_DT"            colType="TB_STRING"  size="8"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="OFFER_SHEET_NO"      colType="TB_STRING"  size="30"  dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="PUMBUN_CD"           colType="TB_STRING"  size="6"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="PUMBUN_NAME"         colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="VEN_CD"              colType="TB_STRING"  size="6"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="VEN_NAME"            colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="BUYER_CD"            colType="TB_STRING"  size="6"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="PRC_COND"            colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="SHIPPMENT_CD"        colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="CURRENCY_CD"         colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="OFFER_TOT_QTY"       colType="TB_DECIMAL" size="9"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="OFFER_TOT_AMT"       colType="TB_DECIMAL" size="13"  dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="PAYMENT_COND"        colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="PAYMENT_DTL_COND"    colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="SHIP_PORT"           colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="ARRI_PORT"           colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="LC_DATE"             colType="TB_STRING"  size="8"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="LC_NO"               colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="LC_EFFECTIVE_DT"     colType="TB_STRING"  size="8"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="LC_OPEN_BANK"        colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="VENDOR_INFO"         colType="TB_STRING"  size="20"  dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="IMPORT_COUNTRY"      colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="ATTN"                colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="MESSRS"              colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="VALIDITY"            colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="SHIPPMENT"           colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="PACKING"             colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="INSURANCE"           colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="PRICE"               colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="ORIGIN"              colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="INSPECTION"          colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="DELIVERY"            colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="BL_NO"               colType="TB_STRING"  size="30"  dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="BL_DT"               colType="TB_STRING"  size="8"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="PAYMENT"             colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="COMMODITY"           colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="PACKING_CHARGE"      colType="TB_DECIMAL" size="13"  dec="2" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="NCV"                 colType="TB_DECIMAL" size="13"  dec="2" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="SHIPPER"             colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="EXC_APP_DT"          colType="TB_STRING"  size="8"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="EXC_RATE"            colType="TB_DECIMAL" size="13"  dec="2" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="CLOSE_FLAG"          colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="CLOSE_DT"            colType="TB_STRING"  size="8"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="EXPNC_CLOSE_FLAG"    colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="COST_CLOSE_FLAG"     colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="SKU_TYPE"            colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="STYLE_TYPE"          colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
    </gauce>      
    <gauce name="H_SEL_OFFDTL">
        <column colName="SKU_CD"              colType="TB_STRING"  size="13"  dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="STYLE_CD"            colType="TB_STRING"  size="54"  dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="COLOR_CD"            colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="SIZE_CD"             colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="OFFER_QTY"           colType="TB_DECIMAL" size="9"   dec="0" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="OFFER_UNIT_AMT"      colType="TB_DECIMAL" size="13"  dec="2" keyType="TB_NORMAL"  roundMode="ROUND" />
        <column colName="OFFER_AMT"           colType="TB_DECIMAL" size="13"  dec="2" keyType="TB_NORMAL"  roundMode="ROUND" />
    </gauce>  

    <!-- 조회 SQL -->
    <query name="SEL_OFFMST">
        <![CDATA[                                        
            SELECT MST.STR_CD            , MST.OFFER_YM             , MST.OFFER_SEQ_NO           , MST.OFFER_DT        , MST.OFFER_SHEET_NO     
                 , MST.PUMBUN_CD         , PBN.PUMBUN_NAME          , MST.VEN_CD                 , VEN.VEN_NAME        , MST.BUYER_CD           
                 , MST.PRC_COND          , MST.SHIPPMENT_CD         , MST.CURRENCY_CD            , MST.OFFER_TOT_QTY   , MST.OFFER_TOT_AMT      
                 , MST.PAYMENT_COND      , MST.PAYMENT_DTL_COND     , MST.SHIP_PORT              , MST.ARRI_PORT       , MST.LC_DATE            
                 , MST.LC_NO             , MST.LC_EFFECTIVE_DT      , MST.LC_OPEN_BANK           , MST.VENDOR_INFO     , MST.IMPORT_COUNTRY     
                 , MST.ATTN              , MST.MESSRS               , MST.VALIDITY               , MST.SHIPPMENT       , MST.PACKING            
                 , MST.INSURANCE         , MST.PRICE                , MST.ORIGIN                 , MST.INSPECTION      , MST.DELIVERY           
                 , MST.BL_NO             , MST.BL_DT                , MST.PAYMENT                , MST.COMMODITY       , MST.PACKING_CHARGE     
                 , MST.NCV               , MST.SHIPPER              , MST.EXC_APP_DT             , MST.EXC_RATE        , MST.CLOSE_FLAG         
                 , MST.CLOSE_DT          , MST.EXPNC_CLOSE_FLAG     , MST.COST_CLOSE_FLAG        , PBN.SKU_TYPE        , PBN.STYLE_TYPE
              FROM DPS.PO_OFFMST MST
                  ,DPS.PC_STRPBN PBN
                  ,DPS.PC_STRVENMST VEN
             WHERE MST.STR_CD          =    PBN.STR_CD
               AND MST.PUMBUN_CD       =    PBN.PUMBUN_CD
               AND MST.STR_CD          =    VEN.STR_CD
               AND MST.VEN_CD          =    VEN.VEN_CD     
               AND MST.STR_CD          =    ?     
               AND MST.OFFER_DT        >=   ?     
               AND MST.OFFER_DT        <=   ?
               AND MST.OFFER_SHEET_NO  LIKE ?||'%'
               AND MST.PUMBUN_CD       LIKE ?||'%'
               AND PBN.PUMBUN_NAME     LIKE '%'||?||'%'
               AND MST.VEN_CD          LIKE ?||'%'
               AND VEN.VEN_NAME        LIKE '%'||?||'%'
               AND MST.CLOSE_FLAG      = 'N'
             ORDER BY MST.OFFER_DT, MST.OFFER_SHEET_NO
        ]]>
    </query>
    
    <query name="SEL_OFFDTL">
        <![CDATA[
			SELECT SKU_CD
			     , MAX(STYLE_CD)       AS STYLE_CD
			     , MAX(COLOR_CD)       AS COLOR_CD
			     , MAX(SIZE_CD)        AS SIZE_CD
			     , SUM(OFFER_QTY)      AS OFFER_QTY
			     , SUM(OFFER_UNIT_AMT) AS OFFER_UNIT_AMT
			     , SUM(OFFER_AMT)      AS OFFER_AMT
			  FROM DPS.PO_OFFDTL
			 WHERE STR_CD        = ?
			   AND OFFER_YM      = ?
			   AND OFFER_SEQ_NO  = ?
			 GROUP BY SKU_CD
        ]]>
    </query>   
</service>