<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자    : 박래형
 * 회 사 명    : FKSS
 * 작 성 일    : 2010.04.08 
 * 변 경 일    :  
 * 변경내용 : 
 * 개    요       :  개발팀에서 기입해주세요
 --> 
<service name="/pord119.po">
    <!-- 발주현황 조회  리스트 -->
    <gauce name="H_LIST"> 
        <column colName="STR_CD"                  colType="TB_STRING"     size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STR_NM_1"                colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD"               colType="TB_STRING"     size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NM_1"             colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_CD"                  colType="TB_STRING"     size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_NM_1"                colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD_2"             colType="TB_STRING"     size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NM_2"             colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_CD"                colType="TB_STRING"     size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_NM_1"              colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SLIP_NO"                 colType="TB_STRING"     size="12"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SLIP_FLAG"               colType="TB_STRING"     size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SLIP_FLAG_NM"            colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD_3"             colType="TB_STRING"     size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NM_3"             colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_CD_2"                colType="TB_STRING"     size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_NM_2"                colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_DT"                  colType="TB_STRING"     size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CONF_DT"                 colType="TB_STRING"     size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DELI_DT"                 colType="TB_STRING"     size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CHK_DT"                  colType="TB_STRING"     size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MG_RATE"                 colType="TB_DECIMAL"    size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="COST_TAMT"               colType="TB_DECIMAL"    size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_TAMT"               colType="TB_DECIMAL"    size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_GAP_TAMT"           colType="TB_DECIMAL"    size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="GAP_TAMT"                colType="TB_DECIMAL"    size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="GAP_RATE"                colType="TB_DECIMAL"    size="5"    dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BIZ_TYPE"                colType="TB_STRING"     size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BIZ_TYPE_NM"             colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TAX_FLAG"                colType="TB_STRING"     size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TAX_FLAG_NM"             colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PAY_COND"                colType="TB_STRING"     size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PAY_COND_NM"             colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD_4"             colType="TB_STRING"     size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NM_4"             colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_NM_2"              colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SLIP_PROC_STAT"          colType="TB_STRING"     size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SLIP_PROC_STAT_NM"       colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PAIR_STR_CD"             colType="TB_STRING"     size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PAIR_SLIP_NO"            colType="TB_STRING"     size="12"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_FLAG"                colType="TB_STRING"     size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_TYPE"                colType="TB_STRING"     size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_OWN_FLAG_1"          colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_OWN_FLAG_2"          colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_OWN_FLAG_3"          colType="TB_STRING"     size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STYLE_TYPE"              colType="TB_STRING"     size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STYLE_TYPE1"             colType="TB_STRING"     size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STYLE_TYPE2"             colType="TB_STRING"     size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <!-- 발주현황 조회(매입,반품,점출입,매가인상하) -->
    <gauce name="H_DETAIL1"> 
        <column colName="STR_CD"                  colType="TB_STRING"   size="2"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STR_NM"                  colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SLIP_NO"                 colType="TB_STRING"   size="12"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_SEQ_NO"              colType="TB_DECIMAL"  size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_SRT_CD"           colType="TB_STRING"   size="4"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_CD"               colType="TB_STRING"   size="8"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_NM"               colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_CD"                  colType="TB_STRING"   size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_NM"                  colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STYLE_CD"                colType="TB_STRING"   size="54"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="COLOR_CD"                colType="TB_STRING"   size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SIZE_CD"                 colType="TB_STRING"   size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_UNIT_CD"             colType="TB_STRING"   size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_UNIT_NM"             colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_QTY"                 colType="TB_DECIMAL"  size="8"    dec="1"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CHK_QTY"                 colType="TB_DECIMAL"  size="8"    dec="1"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MG_RATE"                 colType="TB_DECIMAL"  size="5"    dec="2"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_COST_PRC"            colType="TB_DECIMAL"  size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_COST_AMT"            colType="TB_DECIMAL"  size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_SALE_PRC"            colType="TB_DECIMAL"  size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_SALE_AMT"            colType="TB_DECIMAL"  size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="OLD_SALE_PRC"            colType="TB_DECIMAL"  size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="OLD_SALE_AMT"            colType="TB_DECIMAL"  size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="N_NEW_SALE_PRC"          colType="TB_DECIMAL"  size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="N_NEW_SALE_AMT"          colType="TB_DECIMAL"  size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_GAP_RATE"            colType="TB_DECIMAL"  size="5"    dec="2"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_GAP_AMT"             colType="TB_DECIMAL"  size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_TYPE"                colType="TB_STRING"   size="1"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />      
        <column colName="RATE"                    colType="TB_DECIMAL"  size="5"    dec="2"  keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <!-- 발주현황 조회(대출) -->
    <gauce name="H_DETAIL2"> 
        <column colName="STR_CD"                  colType="TB_STRING"   size="2"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STR_NM"                  colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SLIP_NO"                 colType="TB_STRING"   size="12"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_SEQ_NO"              colType="TB_DECIMAL"  size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_SRT_CD"           colType="TB_STRING"   size="4"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_CD"               colType="TB_STRING"   size="8"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_NM"               colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_CD"                  colType="TB_STRING"   size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_NM"                  colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STYLE_CD"                colType="TB_STRING"   size="54"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="COLOR_CD"                colType="TB_STRING"   size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SIZE_CD"                 colType="TB_STRING"   size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_UNIT_CD"             colType="TB_STRING"   size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_UNIT_NM"             colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_QTY"                 colType="TB_DECIMAL"  size="8"    dec="1"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CHK_QTY"                 colType="TB_DECIMAL"  size="8"    dec="1"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_COST_PRC"            colType="TB_DECIMAL"  size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_COST_AMT"            colType="TB_DECIMAL"  size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_SALE_PRC"            colType="TB_DECIMAL"  size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_SALE_AMT"            colType="TB_DECIMAL"  size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_GAP_RATE"            colType="TB_DECIMAL"  size="5"    dec="2"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_TYPE"                colType="TB_STRING"   size="1"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />      
        <column colName="RATE"                    colType="TB_DECIMAL"  size="5"    dec="2"  keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <!-- 발주현황 조회(대입) -->
    <gauce name="H_DETAIL3"> 
        <column colName="STR_CD"                  colType="TB_STRING"   size="2"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STR_NM"                  colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SLIP_NO"                 colType="TB_STRING"   size="12"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_SEQ_NO"              colType="TB_DECIMAL"  size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_SRT_CD"           colType="TB_STRING"   size="8"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_CD"               colType="TB_STRING"   size="8"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_NM"               colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_CD"                  colType="TB_STRING"   size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_NM"                  colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STYLE_CD"                colType="TB_STRING"   size="54"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="COLOR_CD"                colType="TB_STRING"   size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SIZE_CD"                 colType="TB_STRING"   size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_UNIT_CD"             colType="TB_STRING"   size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_UNIT_NM"             colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_QTY"                 colType="TB_DECIMAL"  size="8"    dec="1"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CHK_QTY"                 colType="TB_DECIMAL"  size="8"    dec="1"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_COST_PRC"            colType="TB_DECIMAL"  size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_COST_AMT"            colType="TB_DECIMAL"  size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_SALE_PRC"            colType="TB_DECIMAL"  size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_SALE_AMT"            colType="TB_DECIMAL"  size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_GAP_RATE"            colType="TB_DECIMAL"  size="5"    dec="2"  keyType="TB_NORMAL" roundMode="ROUND" />      
        <column colName="RATE"                    colType="TB_DECIMAL"  size="5"    dec="2"  keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>

    <!-- 발주현황  리스트 조회(매장조직) -->
    <query name="SEL_LIST1">
        <![CDATA[
            SELECT SLP.STR_CD                                                           /* 점코드     */
                 , DPS.FN_GET_STORE_NAME(SLP.STR_CD)     AS STR_NM_1                    /* 점명       */
                 , SLP.PUMBUN_CD                                                        /* 품번코드   */
                 , DPS.FN_GET_PUMBUN_NAME(SLP.PUMBUN_CD) AS PUMBUN_NM_1                 /* 품번명     */
                 , SLP.VEN_CD                                                           /* 협력사코드 */
                 , DPS.FN_GET_VENDOR_NAME(SLP.VEN_CD)    AS VEN_NM_1                    /* 협력사명   */
                 , SLP.PUMBUN_CD                         AS PUMBUN_CD_2                 /* 품번코드   */
                 , DPS.FN_GET_PUMBUN_NAME(SLP.PUMBUN_CD) AS PUMBUN_NM_2                 /* 품번명     */
                 , SLP.BUYER_CD                                                         /* 바이어코드 */
                 , DPS.FN_GET_BUYER_NAME(SLP.BUYER_CD)     AS BUYER_NM_1                /* 바이어명   */
                 , SLP.SLIP_NO
                 , SLP.SLIP_FLAG                                                        /* 전표구분   */
                 , COM.FN_GET_COMM_NAME('D', 'P201', SLP.SLIP_FLAG) AS  SLIP_FLAG_NM    /* 전표구분명 */
                 , SLP.PUMBUN_CD                         AS PUMBUN_CD_3                 /* 품번코드   */
                 , DPS.FN_GET_PUMBUN_NAME(SLP.PUMBUN_CD) AS PUMBUN_NM_3                 /* 품번명     */                 
                 , SLP.VEN_CD                            AS VEN_CD_2                    /* 협력사코드 */
                 , DPS.FN_GET_VENDOR_NAME(SLP.VEN_CD)    AS VEN_NM_2                    /* 협력사명   */
                 , SLP.ORD_DT                                                           /* 발주일     */
                 , SLP.ORD_CF_DT                         AS CONF_DT                     /* 발주확정일     */
                 , SLP.DELI_DT                                                          /* 납품예정일 */
                 , SLP.CHK_DT                                                           /* 검품확정일 */
                 , DECODE(PBN.SKU_FLAG, '2', (
                                              SELECT NVL(MAX(SLPD.MG_RATE),0)
                                                FROM DPS.PO_SLPDTL SLPD 
                                               WHERE SLPD.STR_CD  = SLP.STR_CD 
                                                 AND SLPD.SLIP_NO = SLP.SLIP_NO 
                                                 AND ROWNUM = 1
                                             )
                                      , 0 ) AS MG_RATE                                  /* 마진율     */
                 , CASE WHEN SLP.SLIP_FLAG IN ('B','C','E') 
                        THEN DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_COST_TAMT*(-1), SLP.NEW_COST_TAMT*(-1))
                   ELSE DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_COST_TAMT, SLP.NEW_COST_TAMT ) END AS COST_TAMT  /* 원가금액   */
                   
                 , CASE WHEN SLP.SLIP_FLAG IN ('B','C','E') 
                        THEN DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_SALE_TAMT*(-1), SLP.NEW_SALE_TAMT*(-1))
                   ELSE DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_SALE_TAMT, SLP.NEW_SALE_TAMT ) END AS SALE_TAMT  /* 매가금액   */
                 , CASE WHEN SLP.SLIP_FLAG = 'G' THEN DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_GAP_SALE_TAMT
                                                                                 , SLP.GAP_SALE_TAMT)
                        ELSE 0 
                        END  AS SALE_GAP_TAMT                                           /* 매가차액   */
                 , DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_GAP_AMT , SLP.GAP_TOT_AMT)  AS GAP_TAMT   /* 점출차익액 */
                 , DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_GAP_RATE, SLP.NEW_GAP_RATE) AS GAP_RATE   /* 점출차익율 */
                 , SLP.BIZ_TYPE                                                         /* 거래형태   */
                 , COM.FN_GET_COMM_NAME('D', 'P002', SLP.BIZ_TYPE) AS BIZ_TYPE_NM       /* 거래형태명 */
                 , SLP.TAX_FLAG                                                         /* 과세구분   */
                 , COM.FN_GET_COMM_NAME('D', 'P004', SLP.TAX_FLAG) AS TAX_FLAG_NM       /* 과세구분명 */                 
                 , SLP.PAY_COND                                                         /* 지불조건   */
                 , COM.FN_GET_COMM_NAME('D', 'P212', SLP.PAY_COND) AS PAY_COND_NM       /* 지불조건명 */             
                 , PSLP.PUMBUN_CD                         AS PUMBUN_CD_4                /* 품번코드   */               
                 , DPS.FN_GET_PUMBUN_NAME(PSLP.PUMBUN_CD) AS PUMBUN_NM_4                /* 품번명     */
                 , DPS.FN_GET_BUYER_NAME(SLP.BUYER_CD)   AS  BUYER_NM_2                 /* 바이어명   */
                 , SLP.SLIP_PROC_STAT                                                   /* 전표상태   */
                 , COM.FN_GET_COMM_NAME('D', 'P207', SLP.SLIP_PROC_STAT) AS SLIP_PROC_STAT_NM               /* 전표상태명 */
                 , SLP.PAIR_STR_CD
                 , SLP.PAIR_SLIP_NO
                 , PBN.SKU_FLAG
                 , PBN.SKU_TYPE
                 , COM.FN_GET_COMM_NAME('D', 'P202', SLP.ORD_OWN_FLAG) AS  ORD_OWN_FLAG_1    /* 발주주체 */
                 , COM.FN_GET_COMM_NAME('D', 'P202', SLP.ORD_OWN_FLAG) AS  ORD_OWN_FLAG_2    /* 발주주체 */
                 , COM.FN_GET_COMM_NAME('D', 'P202', SLP.ORD_OWN_FLAG) AS  ORD_OWN_FLAG_3    /* 발주주체 */
                 , PBN.STYLE_TYPE
                 , (SELECT STYLE_TYPE                                                                    
                      FROM DPS.PC_STRPBN 
                     WHERE STR_CD = SLP.STR_CD 
                       AND PUMBUN_CD = SLP.PUMBUN_CD)  AS STYLE_TYPE1
                 , (SELECT STYLE_TYPE 
                      FROM DPS.PC_STRPBN 
                     WHERE STR_CD = PSLP.STR_CD 
                       AND PUMBUN_CD = PSLP.PUMBUN_CD) AS STYLE_TYPE2
              FROM DPS.PO_SLPMST SLP
                 , DPS.PO_SLPMST PSLP
                 , DPS.PC_STRPBN PBN
             WHERE SLP.STR_CD = ?
               AND DECODE(?  , '0', SLP.ORD_DT
                             , '1', SLP.ORD_CF_DT
                             , '2', SLP.DELI_DT
                             , '3', SLP.CHK_DT) BETWEEN ? AND ?
               AND DECODE(?  , '1', SLP.PUMBUN_CD
                             , '2', SLP.BUYER_CD
                             , '3', SLP.VEN_CD) LIKE ? || '%'
               AND EXISTS ( SELECT MYORG.USER_ID
                              FROM COM.V_MYORG MYORG
                             WHERE MYORG.STR_CD      = SLP.STR_CD
                               AND MYORG.PUMBUN_CD   = SLP.PUMBUN_CD
                               AND MYORG.USER_ID     = ?
                               AND ROWNUM            = 1
                               AND MYORG.ORG_FLAG    = ?
                          )
               AND SLP.DEL_FLAG     = 'N'
               AND PBN.SALE_ORG_CD  LIKE ?||?||?||?||'%'
               AND SLP.ORD_OWN_FLAG LIKE ? || '%'
               AND SLP.TAX_FLAG     LIKE ? || '%'
               AND PBN.STR_CD       = SLP.STR_CD
               AND SLP.STR_CD       = PSLP.PAIR_STR_CD(+)
               AND SLP.SLIP_NO      = PSLP.PAIR_SLIP_NO(+)
               AND PBN.PUMBUN_CD    = SLP.PUMBUN_CD
        ]]>
    </query> 
    
    <!-- 품번 기준 -->
    <query name="OB_PUMBUN">
        <![CDATA[
            ORDER BY SLP.PUMBUN_CD 
        ]]>
    </query> 
    
    <!-- 바이어 기준 -->
    <query name="OB_BUYER">
        <![CDATA[
            ORDER BY SLP.BUYER_CD 
        ]]>
    </query> 
    
    <!-- 협력사 기준 -->
    <query name="OB_VEN">
        <![CDATA[
            ORDER BY SLP.VEN_CD 
        ]]>
    </query> 

    <!-- 발주현황  리스트 조회(매입조직) -->
    <query name="SEL_LIST2">
        <![CDATA[
            SELECT SLP.STR_CD                                                           /* 점코드     */
                 , DPS.FN_GET_STORE_NAME(SLP.STR_CD)     AS STR_NM_1                    /* 점명       */
                 , SLP.PUMBUN_CD                                                        /* 품번코드   */
                 , DPS.FN_GET_PUMBUN_NAME(SLP.PUMBUN_CD) AS PUMBUN_NM_1                 /* 품번명     */
                 , SLP.VEN_CD                                                           /* 협력사코드 */
                 , DPS.FN_GET_VENDOR_NAME(SLP.VEN_CD)    AS VEN_NM_1                    /* 협력사명   */
                 , SLP.PUMBUN_CD                         AS PUMBUN_CD_2                 /* 품번코드   */
                 , DPS.FN_GET_PUMBUN_NAME(SLP.PUMBUN_CD) AS PUMBUN_NM_2                 /* 품번명     */
                 , SLP.BUYER_CD                                                         /* 바이어코드 */
                 , SLP.BUYER_CD                          AS BUYER_NM_1                  /* 바이어명   */
                 , SLP.SLIP_NO
                 , SLP.SLIP_FLAG                                                        /* 전표구분   */
                 , COM.FN_GET_COMM_NAME('D', 'P201', SLP.SLIP_FLAG) AS  SLIP_FLAG_NM    /* 전표구분명 */
                 , SLP.PUMBUN_CD                         AS PUMBUN_CD_3                 /* 품번코드   */
                 , DPS.FN_GET_PUMBUN_NAME(SLP.PUMBUN_CD) AS PUMBUN_NM_3                 /* 품번명     */                 
                 , SLP.VEN_CD                            AS VEN_CD_2                    /* 협력사코드 */
                 , DPS.FN_GET_VENDOR_NAME(SLP.VEN_CD)    AS VEN_NM_2                    /* 협력사명   */
                 , SLP.ORD_DT                                                           /* 발주일     */
                 , SLP.ORD_CF_DT  AS CONF_DT                                            /* 발주확정일     */
                 , SLP.DELI_DT                                                          /* 납품예정일 */
                 , SLP.CHK_DT                                                           /* 검품확정일 */
                 , DECODE(PBN.SKU_FLAG, '2', (
                                              SELECT NVL(MAX(SLPD.MG_RATE),0)
                                                FROM DPS.PO_SLPDTL SLPD 
                                               WHERE SLPD.STR_CD  = SLP.STR_CD 
                                                 AND SLPD.SLIP_NO = SLP.SLIP_NO 
                                                 AND ROWNUM = 1
                                             )
                                      , 0 ) AS MG_RATE                                  /* 마진율     */
                 , CASE WHEN SLP.SLIP_FLAG IN ('B','C','E') 
                        THEN DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_COST_TAMT*(-1), SLP.NEW_COST_TAMT*(-1))
                   ELSE DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_COST_TAMT, SLP.NEW_COST_TAMT ) END AS COST_TAMT  /* 원가금액   */
                   
                 , CASE WHEN SLP.SLIP_FLAG IN ('B','C','E') 
                        THEN DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_SALE_TAMT*(-1), SLP.NEW_SALE_TAMT*(-1))
                   ELSE DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_SALE_TAMT, SLP.NEW_SALE_TAMT ) END AS SALE_TAMT  /* 매가금액   */
                 , CASE WHEN SLP.SLIP_FLAG = 'G' THEN DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_GAP_SALE_TAMT
                                                                                 , SLP.GAP_SALE_TAMT)
                        ELSE 0 
                        END  AS SALE_GAP_TAMT                                           /* 매가차액   */
                 , CASE WHEN SLP.SLIP_FLAG = 'G' THEN 0
                        ELSE DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_GAP_AMT
                                                      , 0)
                        END  AS GAP_TAMT                                                /* 점출차익액 */
                 , DECODE(SLP.SLIP_PROC_STAT, '09', SLP.CHK_GAP_RATE
                                            , 0) AS GAP_RATE                            /* 점출차익율 */
                 , SLP.BIZ_TYPE                                                         /* 거래형태   */
                 , COM.FN_GET_COMM_NAME('D', 'P002', SLP.BIZ_TYPE) AS BIZ_TYPE_NM       /* 거래형태명 */
                 , SLP.TAX_FLAG                                                         /* 과세구분   */
                 , COM.FN_GET_COMM_NAME('D', 'P004', SLP.TAX_FLAG) AS TAX_FLAG_NM       /* 과세구분명 */                 
                 , SLP.PAY_COND                                                         /* 지불조건   */
                 , COM.FN_GET_COMM_NAME('D', 'P212', SLP.PAY_COND) AS PAY_COND_NM       /* 지불조건명 */           
                 , PSLP.PUMBUN_CD                         AS PUMBUN_CD_4                /* 품번코드   */               
                 , DPS.FN_GET_PUMBUN_NAME(PSLP.PUMBUN_CD) AS PUMBUN_NM_4                /* 품번명     */
                 , SLP.BUYER_CD      AS  BUYER_NM_2                                     /* 바이어명   */
                 , SLP.SLIP_PROC_STAT                                                   /* 전표상태   */
                 , COM.FN_GET_COMM_NAME('D', 'P207', SLP.SLIP_PROC_STAT) AS SLIP_PROC_STAT_NM               /* 전표상태명 */
                 , SLP.PAIR_STR_CD
                 , SLP.PAIR_SLIP_NO
                 , PBN.SKU_FLAG
                 , PBN.SKU_TYPE
                 , COM.FN_GET_COMM_NAME('D', 'P202', SLP.ORD_OWN_FLAG) AS  ORD_OWN_FLAG_1    /* 발주주체 */
                 , COM.FN_GET_COMM_NAME('D', 'P202', SLP.ORD_OWN_FLAG) AS  ORD_OWN_FLAG_2    /* 발주주체 */
                 , COM.FN_GET_COMM_NAME('D', 'P202', SLP.ORD_OWN_FLAG) AS  ORD_OWN_FLAG_3    /* 발주주체 */
                 , PBN.STYLE_TYPE
                 , (SELECT STYLE_TYPE                                                                    
                      FROM DPS.PC_STRPBN 
                     WHERE STR_CD = SLP.STR_CD 
                       AND PUMBUN_CD = SLP.PUMBUN_CD)  AS STYLE_TYPE1
                 , (SELECT STYLE_TYPE 
                      FROM DPS.PC_STRPBN 
                     WHERE STR_CD = PSLP.STR_CD 
                       AND PUMBUN_CD = PSLP.PUMBUN_CD) AS STYLE_TYPE2
              FROM DPS.PO_SLPMST SLP
                 , DPS.PO_SLPMST PSLP
                 , DPS.PC_STRPBN PBN
             WHERE SLP.STR_CD = ?
               AND DECODE(?  , '0', SLP.ORD_DT
                             , '1', ORD_CF_DT
                             , '2', SLP.DELI_DT
                             , '3', SLP.CHK_DT) BETWEEN ? AND ?
               AND DECODE(?  , '1', SLP.PUMBUN_CD
                             , '2', SLP.BUYER_CD
                             , '3', SLP.VEN_CD) LIKE ? || '%'
               AND EXISTS ( SELECT MYORG.USER_ID
                              FROM COM.V_MYORG MYORG
                             WHERE MYORG.STR_CD      = SLP.STR_CD
                               AND MYORG.PUMBUN_CD   = SLP.PUMBUN_CD
                               AND MYORG.USER_ID     = ?
                               AND ROWNUM            = 1
                               AND MYORG.ORG_FLAG    = ?
                          )
               AND SLP.DEL_FLAG     = 'N'
               AND PBN.BUY_ORG_CD   LIKE ?||?||?||?||'%'
               AND SLP.ORD_OWN_FLAG LIKE ? || '%'
               AND PBN.STR_CD       = SLP.STR_CD
               AND SLP.STR_CD       = PSLP.PAIR_STR_CD(+)
               AND SLP.SLIP_NO      = PSLP.PAIR_SLIP_NO(+)
               AND PBN.PUMBUN_CD    = SLP.PUMBUN_CD
        ]]>
    </query> 
    
    <!-- 발주현황 디테일 조회 (매입,반품,점출입,매가인상하)-->
    <query name="SEL_DETAIL1">
        <![CDATA[
            SELECT DTL.STR_CD
                 , DPS.FN_GET_STORE_NAME(DTL.STR_CD) AS STR_NM
                 , DTL.SLIP_NO                                                                      --전표번호
                 , DTL.ORD_SEQ_NO                                                                   --전표순번
                 , DTL.PUMMOK_SRT_CD                                                                --단축코드
                 , DTL.PUMMOK_CD                                                                    --품목코드
                 , DPS.FN_GET_PUMMOK_NAME(DTL.PUMMOK_CD) AS  PUMMOK_NM                              --품목명
                 , DTL.SKU_CD                                                                       --단품코드
                 , DPS.FN_GET_SKU_NAME(DTL.SKU_CD) AS SKU_NM                                        --단품명
                 , DTL.STYLE_CD        
                 , DTL.COLOR_CD
                 , DTL.SIZE_CD
                 , DTL.ORD_UNIT_CD                                                                  --단위
                 , COM.FN_GET_COMM_NAME('D', 'P013', DTL.ORD_UNIT_CD) AS ORD_UNIT_NM                --단위명
                 , DTL.ORD_QTY                                                                      --수량
                 , DTL.CHK_QTY                                                                      --검품수량
                 , DTL.MG_RATE                                                                      --마진율
                 , DTL.NEW_COST_PRC                                                                 --원가단가 
                 , CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_COST_AMT                          --원가금액
                                                     ELSE DTL.NEW_COST_AMT
                   END      AS NEW_COST_AMT
                 , DTL.NEW_SALE_PRC                                                                 --매가단가
                 , CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_SALE_AMT                          --매가금액
                                                     ELSE DTL.NEW_SALE_AMT
                   END      AS NEW_SALE_AMT
                 , DTL.OLD_SALE_PRC                                                                 --구매가단가
                 , CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_OLD_SALE_AMT                      --구매가금액
                                                     ELSE DTL.OLD_SALE_AMT
                   END      AS OLD_SALE_AMT
                 , DTL.NEW_SALE_PRC              AS  N_NEW_SALE_PRC                                 --신매가단가
                 , CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_SALE_AMT                          --신매가금액
                                                     ELSE DTL.NEW_SALE_AMT
                   END      AS N_NEW_SALE_AMT
                 , CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_GAP_RATE                          --차익율
                                                     ELSE DTL.NEW_GAP_RATE
                   END      AS NEW_GAP_RATE
                 , CASE MST.SLIP_FLAG WHEN 'G' THEN (CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_GAP_COST_AMT
                                                                             ELSE DTL.GAP_SALE_AMT END)      --차익액                                                                  
                   ELSE (CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.NEW_GAP_AMT
                                                 ELSE DTL.CHK_GAP_AMT END)
                   END      AS NEW_GAP_AMT
                 , PBN.SKU_TYPE
                 , DPS.FN_GET_PMKPRFRT(DTL.STR_CD
                                     , MST.NEW_PRC_APP_DT
                                     , MST.BIZ_TYPE
                                     , DTL.PUMMOK_CD
                                     , DTL.SKU_CD)              AS RATE     /* 목표이익율 */
              FROM DPS.PO_SLPDTL    DTL  
                 , DPS.PO_SLPMST    MST
                 , DPS.PC_STRPBN    PBN
             WHERE DTL.STR_CD    = ?               
               AND DTL.STR_CD    = MST.STR_CD
               AND DTL.STR_CD    = PBN.STR_CD
               AND MST.PUMBUN_CD = PBN.PUMBUN_CD
               AND DTL.SLIP_NO   = MST.SLIP_NO
               AND DTL.SLIP_NO   = ?
               AND MST.SLIP_FLAG = ?
        ]]>
    </query> 
    
    <!-- 발주현황 디테일 조회 (대출)-->
    <query name="SEL_DETAIL2">
        <![CDATA[
            SELECT DTL.STR_CD
                 , DPS.FN_GET_STORE_NAME(DTL.STR_CD) AS STR_NM
                 , DTL.SLIP_NO                                                                      --전표번호
                 , DTL.ORD_SEQ_NO                                                                   --전표순번
                 , DTL.PUMMOK_SRT_CD                                                                --단축코드
                 , DTL.PUMMOK_CD                                                                    --품목코드
                 , DPS.FN_GET_PUMMOK_NAME(DTL.PUMMOK_CD) AS  PUMMOK_NM                              --품목명
                 , DTL.SKU_CD                                                                       --단품코드
                 , DPS.FN_GET_SKU_NAME(DTL.SKU_CD) AS SKU_NM                                        --단품명
                 , DTL.STYLE_CD        
                 , DTL.COLOR_CD
                 , DTL.SIZE_CD
                 , DTL.ORD_UNIT_CD                                                                  --단위
                 , COM.FN_GET_COMM_NAME('D', 'P013', DTL.ORD_UNIT_CD) AS ORD_UNIT_NM                --단위명
                 , DTL.ORD_QTY                                                                      --수량
                 , DTL.CHK_QTY                                                                      --검품수량
                 , DTL.NEW_COST_PRC                                                                 --원가단가 
                 , CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_COST_AMT                          --원가금액
                                                     ELSE DTL.NEW_COST_AMT
                   END      AS NEW_COST_AMT
                 , DTL.NEW_SALE_PRC                                                                 --매가단가
                 , CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_SALE_AMT                          --매가금액
                                                     ELSE DTL.NEW_SALE_AMT
                   END      AS NEW_SALE_AMT
                 , CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_GAP_RATE                          --차익율
                                                     ELSE DTL.NEW_GAP_RATE
                   END      AS NEW_GAP_RATE
                 , PBN.SKU_TYPE
                 , DPS.FN_GET_PMKPRFRT(DTL.STR_CD
                                     , MST.NEW_PRC_APP_DT
                                     , MST.BIZ_TYPE
                                     , DTL.PUMMOK_CD
                                     , DTL.SKU_CD)              AS RATE     /* 목표이익율 */
              FROM DPS.PO_SLPDTL    DTL  
                 , DPS.PO_SLPMST    MST
                 , DPS.PC_STRPBN    PBN
             WHERE DTL.STR_CD    = ?               
               AND DTL.STR_CD    = MST.STR_CD
               AND DTL.STR_CD    = PBN.STR_CD
               AND MST.PUMBUN_CD = PBN.PUMBUN_CD
               AND DTL.SLIP_NO   = MST.SLIP_NO
               AND DTL.SLIP_NO   = ?
        ]]>
    </query> 
    
    <!-- 발주현황 디테일 조회 (대입)-->
    <query name="SEL_DETAIL3">
        <![CDATA[
            SELECT DTL.STR_CD
                 , DPS.FN_GET_STORE_NAME(DTL.STR_CD) AS STR_NM
                 , DTL.SLIP_NO                                                                      --전표번호
                 , DTL.ORD_SEQ_NO                                                                   --전표순번
                 , DTL.PUMMOK_SRT_CD                                                                --단축코드
                 , DTL.PUMMOK_CD                                                                    --품목코드
                 , DPS.FN_GET_PUMMOK_NAME(DTL.PUMMOK_CD) AS  PUMMOK_NM                              --품목명
                 , DTL.SKU_CD                                                                       --단품코드
                 , DPS.FN_GET_SKU_NAME(DTL.SKU_CD) AS SKU_NM                                        --단품명
                 , DTL.STYLE_CD         
                 , DTL.COLOR_CD
                 , DTL.SIZE_CD
                 , DTL.ORD_UNIT_CD                                                                  --단위
                 , COM.FN_GET_COMM_NAME('D', 'P013', DTL.ORD_UNIT_CD) AS ORD_UNIT_NM                --단위명
                 , DTL.ORD_QTY                                                                      --수량
                 , DTL.CHK_QTY                                                                      --검품수량
                 , DTL.NEW_COST_PRC                                                                 --원가단가 
                 , CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_COST_AMT                          --원가금액
                                                     ELSE DTL.NEW_COST_AMT
                   END      AS NEW_COST_AMT
                 , DTL.NEW_SALE_PRC                                                                 --매가단가
                 , CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_SALE_AMT                          --매가금액
                                                     ELSE DTL.NEW_SALE_AMT
                   END      AS NEW_SALE_AMT
                 , CASE MST.SLIP_PROC_STAT WHEN '09' THEN DTL.CHK_GAP_RATE                          --차익율
                                                     ELSE DTL.NEW_GAP_RATE
                   END      AS NEW_GAP_RATE
                 , DPS.FN_GET_PMKPRFRT(DTL.STR_CD
                                     , MST.NEW_PRC_APP_DT
                                     , MST.BIZ_TYPE
                                     , DTL.PUMMOK_CD
                                     , DTL.SKU_CD)              AS RATE     /* 목표이익율 */
              FROM DPS.PO_SLPDTL    DTL  
                 , DPS.PO_SLPMST    MST
             WHERE DTL.STR_CD    = MST.STR_CD
               AND DTL.STR_CD    = ?
               AND DTL.SLIP_NO   = MST.SLIP_NO
               AND DTL.SLIP_NO   = ?
        ]]>
    </query> 
    
</service>