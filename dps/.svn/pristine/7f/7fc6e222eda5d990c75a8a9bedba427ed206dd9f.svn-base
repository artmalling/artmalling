<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 정진영
 * 회 사 명 : FKSS
 * 작 성 일 : 2010.04.28
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  점별행사단품을 관리한다.
 -->
<service name="/pcod706.pc">
    <gauce name="H_SEL_EVTMST"> 
        <column colName="EVENT_THME_CD"         colType="TB_STRING"  size="4"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_THME_NAME"       colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_S_DT"            colType="TB_STRING"  size="8"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_E_DT"            colType="TB_STRING"  size="8"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />            
        <column colName="EVENT_TYPE"            colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />            
        <column colName="EVENT_TYPE_NAME"       colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_PLU_FLAG"        colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_PLU_FLAG_NAME"   colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_MNG_FLAG"        colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_MNG_FLAG_NAME"   colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_ORG_CD"          colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_ORG_NAME"        colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />        
        <column colName="EVENT_CHAR_ID"         colType="TB_STRING"  size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_CHAR_NAME"       colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="GOAL_SALE_AMT"         colType="TB_DECIMAL" size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="GOAL_PROF_AMT"         colType="TB_DECIMAL" size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />   
        <column colName="CONF_YN"               colType="TB_STRING" size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />  
        <column colName="NEW_YN"                colType="TB_STRING" size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
    </gauce>
    <gauce name="H_SEL_MASTER">
        <column colName="STR_CD"             colType="TB_STRING"   size="2"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_CD"             colType="TB_STRING"   size="13"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_NAME"           colType="TB_STRING"   size="40"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_CD"           colType="TB_STRING"   size="11"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="APP_S_DT"           colType="TB_STRING"   size="8"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="APP_E_DT"           colType="TB_STRING"   size="8"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REDU_RATE"          colType="TB_INT"      size="2"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_COST_PRC"      colType="TB_INT"      size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_SALE_PRC"      colType="TB_INT"      size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_MG_RATE"       colType="TB_DECIMAL"  size="5"    dec="2"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_COST_PRC"     colType="TB_INT"      size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_PRICE"        colType="TB_INT"      size="9"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_MG_RATE"      colType="TB_DECIMAL"  size="5"    dec="2"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="LIMIT_SALE_QTY"     colType="TB_INT"      size="6"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DC_DIV_RATE"        colType="TB_INT"      size="3"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CPN_ISSUE_QTY"      colType="TB_INT"      size="6"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CPN_BARCODE"        colType="TB_STRING"   size="16"   dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CONF_YN"            colType="TB_STRING"   size="1"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_YN"            colType="TB_STRING"   size="1"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_APP_S_DT"       colType="TB_STRING"   size="8"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_TYPE"           colType="TB_STRING"   size="1"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BIZ_TYPE"           colType="TB_STRING"   size="1"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD"           colType="TB_STRING"   size="6"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NAME"           colType="TB_STRING"   size="40"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_CD"           colType="TB_STRING"   size="6"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_NAME"           colType="TB_STRING"   size="40"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="RUND_FLAG"           colType="TB_STRING"   size="1"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TAX_FLAG"           colType="TB_STRING"   size="1"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    <gauce name="H_SEL_TEMP">
    	<column colName="PUMBUN_CD"           colType="TB_STRING"   size="6"    dec="0"  keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    <!-- 쿼리는 전부 대문자 -->
    <!-- 행사마스터 조회 쿼리  -->
    <query name="SEL_EVTMST">
        <![CDATA[
            SELECT             EVT.EVENT_THME_CD   
                 , DPS.FN_GET_EVTTHME_NAME(EVT.EVENT_THME_CD)            AS EVENT_THME_NAME    
                 , SEN.EVENT_S_DT        
                 , SEN.EVENT_E_DT        
                 , EVT.EVENT_TYPE
                 , COM.FN_GET_COMM_NAME('D','P072',EVT.EVENT_TYPE)       AS EVENT_TYPE_NAME
                 , EVT.EVENT_PLU_FLAG     
                 , COM.FN_GET_COMM_NAME('D','P071',EVT.EVENT_PLU_FLAG)   AS EVENT_PLU_FLAG_NAME
                 , EVT.EVENT_MNG_FLAG     
                 , COM.FN_GET_COMM_NAME('D','P073',EVT.EVENT_MNG_FLAG)   AS EVENT_MNG_FLAG_NAME
                 , EVT.EVENT_ORG_CD      
                 , DPS.FN_GET_ORG_NAME(SUBSTR(EVT.EVENT_ORG_CD,1,2)
                                       , SUBSTR(EVT.EVENT_ORG_CD,3,2)
                                       , SUBSTR(EVT.EVENT_ORG_CD,5,2)
                                       , SUBSTR(EVT.EVENT_ORG_CD,7,2)
                                       , SUBSTR(EVT.EVENT_ORG_CD,9,2))   AS EVENT_ORG_NAME
                 , EVT.EVENT_CHAR_ID       
                 , COM.FN_GET_USER_NAME(EVT.EVENT_CHAR_ID)               AS EVENT_CHAR_NAME
              FROM DPS.PC_EVTMST      EVT
                 , DPS.PC_STREVT      SEN
             WHERE EVT.EVENT_CD     = SEN.EVENT_CD 
               AND SEN.STR_CD       = ?
               AND SEN.EVENT_CD     = ?
             ORDER BY EVT.EVENT_CD
        ]]>
    </query>
    
    <!-- 점별행사단품 조회 쿼리 -->
    <query name="SEL_STREVTSKU">
        <![CDATA[
            SELECT SSEP.STR_CD                   
                 , SSEP.SKU_CD    
                 , SKU.SKU_NAME
                 , SSEP.EVENT_CD                 
                 , SSEP.APP_S_DT               
                 , SSEP.APP_E_DT               
                 , SSEP.REDU_RATE                 
                 , SSEP.NORM_COST_PRC                 
                 , SSEP.NORM_SALE_PRC             
                 , SSEP.NORM_MG_RATE            
                 , SSEP.EVENT_COST_PRC                 
                 , SSEP.EVENT_PRICE            
                 , SSEP.EVENT_MG_RATE            
                 , SSEP.LIMIT_SALE_QTY           
                 , SSEP.DC_DIV_RATE              
                 , SSEP.CPN_ISSUE_QTY            
                 , SSEP.CPN_BARCODE              
                 , CASE WHEN SSEP.CONF_FLAG = '1' THEN 'N'
                        ELSE 'Y'
                   END                 AS CONF_YN
                 , 'Y'                 AS NORM_YN           
                 , SSEP.APP_S_DT       AS ORG_APP_S_DT
                 , SKU.SKU_TYPE
                 , PBN.BIZ_TYPE
                 , SKU.PUMBUN_CD
                 , PBN.PUMBUN_NAME
                 , SVM.VEN_CD
                 , SVM.VEN_NAME
                 , SVM.RUND_FLAG
                 , PNM.TAX_FLAG
              FROM DPS.PC_STRSKUEVTPRC SSEP
                 , DPS.PC_STRSKUMST       SKU
                 , DPS.PC_STRPBN       PBN
                 , DPS.PC_STRVENMST    SVM
                 , DPS.PC_PBNMST       PNM
             WHERE SSEP.STR_CD      = SKU.STR_CD
               AND SSEP.SKU_CD      = SKU.SKU_CD
               AND SKU.STR_CD       = PBN.STR_CD
               AND SKU.PUMBUN_CD    = PBN.PUMBUN_CD
               AND SKU.STR_CD       = SVM.STR_CD
               AND SKU.VEN_CD       = SVM.VEN_CD
               AND SKU.PUMBUN_CD    = PNM.PUMBUN_CD
               AND SSEP.STR_CD     = ?
               AND SSEP.EVENT_CD   = ?
               AND SKU.PUMBUN_CD   LIKE ?
               AND EXISTS ( SELECT MYORG.USER_ID
                              FROM COM.V_MYORG MYORG
                             WHERE MYORG.PUMBUN_CD   = SKU.PUMBUN_CD
                               AND MYORG.STR_CD      = SSEP.STR_CD
                               AND MYORG.USER_ID     = ?
                               AND MYORG.ORG_FLAG    = ?
                               AND ROWNUM            = 1
                          )
        ]]>   
    </query>
    <query name="SEL_STREVTSKU_ORDER">
        <![CDATA[
             ORDER BY SSEP.SKU_CD
        ]]>   
    </query>
    
    <!-- 점별행사단품 복사용 조회 쿼리 -->
    <query name="SEL_STREVTSKU_COPY">
        <![CDATA[
            SELECT SEV.STR_CD
                 , SSPM.SKU_CD
                 , SKU.SKU_NAME
                 , SEV.EVENT_CD
                 , SEV.EVENT_S_DT   	AS APP_S_DT                               
                 , SEV.EVENT_E_DT  		AS APP_E_DT  
                 , SSEP.REDU_RATE
                 , SSPM.NORM_COST_PRC
                 , SSPM.NORM_SALE_PRC
                 , SSPM.NORM_MG_RATE
                 , SSPM.NORM_COST_PRC  AS EVENT_COST_PRC
                 , ''                  AS EVENT_PRICE
                 , ''                  AS EVENT_MG_RATE
                 , ''                  AS LIMIT_SALE_QTY           
                 , ''                  AS DC_DIV_RATE              
                 , ''                  AS CPN_ISSUE_QTY            
                 , ''                  AS CPN_BARCODE            
                 , 'N'                 AS CONF_YN          
                 , 'Y'                 AS NORM_YN  
                 , SEV.EVENT_S_DT      AS ORG_APP_S_DT  
                 , TEMP.SKU_TYPE
	                 , TEMP.BIZ_TYPE
	                 , TEMP.PUMBUN_CD
	                 , TEMP.PUMBUN_NAME
	                 , TEMP.VEN_CD
	                 , TEMP.VEN_NAME
	                 , TEMP.RUND_FLAG
	                 , TEMP.TAX_FLAG   
              FROM DPS.PC_STREVT       SEV
                 , DPS.PC_STRSKUPRCMST SSPM
                 , DPS.PC_SKUMST       SKU
                 , (SELECT SKU_CD
                         , REDU_RATE
                      FROM DPS.PC_STRSKUEVTPRC 
                     WHERE STR_CD   = ? 
                       AND EVENT_CD = ?
                   ) SSEP
	            ,(SELECT A2.STR_CD
	                  ,A2.SKU_CD
	                 , A2.SKU_TYPE
	                 , A3.BIZ_TYPE
	                 , A2.PUMBUN_CD
	                 , A3.PUMBUN_NAME
	                 , A4.VEN_CD
	                 , A4.VEN_NAME
	                 , A4.RUND_FLAG
	                 , A5.TAX_FLAG   
	                FROM DPS.PC_STRSKUMST    A2
	                 , DPS.PC_STRPBN       A3
	                 , DPS.PC_STRVENMST    A4
	                 , DPS.PC_PBNMST       A5
	            WHERE A2.STR_CD       = A3.STR_CD
	               AND A2.PUMBUN_CD    = A3.PUMBUN_CD
	               AND A2.STR_CD       = A4.STR_CD
	               AND A2.VEN_CD       = A4.VEN_CD
	               AND A2.PUMBUN_CD    = A5.PUMBUN_CD) TEMP 
             WHERE SEV.STR_CD     = SSPM.STR_CD
               AND SSPM.SKU_CD    = SSEP.SKU_CD
               AND SSPM.STR_CD = TEMP.STR_CD  
               AND SSPM.SKU_CD = TEMP.SKU_CD 
               AND SSPM.EVENT_CD  = '00000000000'
               AND SEV.EVENT_S_DT BETWEEN SSPM.APP_S_DT AND SSPM.APP_E_DT
               AND SSPM.SKU_CD    = SKU.SKU_CD
               AND SEV.STR_CD     = ?
               AND SEV.EVENT_CD   = ?
               AND SKU.PUMBUN_CD  LIKE ?
               AND EXISTS (SELECT MYORG.USER_ID
                             FROM COM.V_MYORG MYORG
                            WHERE MYORG.PUMBUN_CD   = SKU.PUMBUN_CD
                              AND MYORG.STR_CD      = SSPM.STR_CD
                              AND MYORG.USER_ID     = ?
                              AND MYORG.ORG_FLAG    = ?
                              AND ROWNUM            = 1
                          )
               AND NOT EXISTS (SELECT EVENT_CD
                                 FROM DPS.PC_STRSKUEVTPRC
                                WHERE STR_CD   = SEV.STR_CD
                                  AND SKU_CD   = SKU.SKU_CD
                                  AND (SEV.EVENT_S_DT BETWEEN APP_S_DT AND APP_E_DT 
                                      OR SEV.EVENT_E_DT BETWEEN APP_S_DT AND APP_E_DT)
                              )
             ORDER BY SSPM.SKU_CD
        ]]>   
    </query>
    <!-- 점별행사단품 중복검사-->
    <query name="SEL_STREVTSKU_DUP_CNT">
        <![CDATA[
            SELECT COUNT(*) AS CNT 
             FROM DPS.PC_STRSKUEVTPRC
            WHERE STR_CD     = ?
              AND SKU_CD     = ?
              AND (? BETWEEN APP_S_DT AND APP_E_DT 
                  OR ? BETWEEN APP_S_DT AND APP_E_DT)
              AND ROWNUM     <= 2
        ]]>   
    </query>
    
    <!-- 점별행사품번 확정여부-->
    <query name="SEL_STREVTPBN_CONF_YN">
        <![CDATA[
            SELECT CONF_FLAG
              FROM DPS.PC_STRPBNEVTMG
             WHERE STR_CD         = ?
               AND PUMBUN_CD      = ?
               AND EVENT_CD       = ?
               AND EVENT_FLAG     = '00'
               AND EVENT_RATE     = '00'
               AND APP_S_DT       = ?
        ]]>   
    </query>
    
    <!-- 점별행사품번 중복여부-->
    <query name="SEL_STREVTPBN_CHECK">
        <![CDATA[
            SELECT COUNT(*) AS CNT
              FROM DPS.PC_STRPBNEVTMG
             WHERE STR_CD         = ?
               AND PUMBUN_CD      = ?
               AND EVENT_CD       = ?
               AND EVENT_FLAG     = '00'
               AND EVENT_RATE     = '00'
               AND APP_S_DT       = ?
               AND ROWNUM = 1
        ]]>   
    </query>
    
    <!-- 점별행사단품 확정여부-->
    <query name="SEL_STREVTSKU_CONF_YN">
        <![CDATA[
            SELECT CONF_FLAG
              FROM DPS.PC_STRSKUEVTPRC
             WHERE STR_CD         = ?
               AND SKU_CD         = ?
               AND EVENT_CD       = ?
               AND APP_S_DT       = ?
        ]]>   
    </query>
    <!-- 점별행사품번 삭제여부 조회-->
    <query name="SEL_STREVTPBN_DEL_YN">
        <![CDATA[
            SELECT CASE WHEN CNT.CNT > 0 THEN 'N'
                        WHEN SPEM.GOAL_SALE_AMT > 0  THEN 'N'
                        WHEN SPEM.GOAL_PROF_AMT > 0  THEN 'N'
                        ELSE 'Y'
                   END              AS DEL_YN
              FROM (SELECT COUNT(*) AS CNT 
                      FROM DPS.PC_STRSKUEVTPRC SSEP
                         , DPS.PC_STRSKUMST    SSM
                     WHERE SSEP.STR_CD     = SSM.STR_CD
                       AND SSEP.SKU_CD     = SSM.SKU_CD
                       AND SSEP.STR_CD     = ?
                       AND SSM.PUMBUN_CD   = ? 
                       AND SSEP.EVENT_CD   = ?
                       AND SSEP.APP_S_DT   = ?
                       AND ROWNUM          = 1
                   ) CNT
                 , DPS.PC_STRPBNEVTMG SPEM
             WHERE SPEM.STR_CD         = ?
               AND SPEM.PUMBUN_CD      = ?
               AND SPEM.EVENT_CD       = ?
               AND SPEM.EVENT_FLAG     = '00'
               AND SPEM.EVENT_RATE     = '00'
               AND SPEM.APP_S_DT       = ?
        ]]>   
    </query>
    
    <!-- 점별행사품번 등록 -->
    <query name="INS_STREVTPBN">
        <![CDATA[
           INSERT INTO DPS.PC_STRPBNEVTMG(STR_CD
                                         , PUMBUN_CD
                                         , PUMMOK_CD
                                         , EVENT_CD
                                         , EVENT_FLAG
                                         , EVENT_RATE
                                         , APP_S_DT
                                         , APP_E_DT
                                         , MOD_E_DT
                                         , REDU_RATE
                                         , NORM_MG_RATE
                                         , EVENT_MG_RATE
                                         , SKU_FLAG
                                         , GOAL_SALE_AMT
                                         , GOAL_PROF_AMT
                                         , LIMIT_SALE_QTY
                                         , DC_DIV_RATE
                                         , CPN_ISSUE_QTY
                                         , CPN_BARCODE
                                         , EVENT_PLACE_CD
                                         , CONF_FLAG
                                         , CONF_DATE
                                         , CONF_ID
                                         , PROC_FLAG
                                         , REG_DATE
                                         , REG_ID
                                         , MOD_DATE
                                         , MOD_ID
                                          )
                                    VALUES(?
                                         , ?
                                         , '********'
                                         , ?
                                         , '00'
                                         , '00'
                                         , ?
                                         , ?
                                         , ?
                                         , 0
                                         , 0
                                         , 0
                                         , '1'
                                         , 0
                                         , 0
                                         , 0
                                         , 0
                                         , 0
                                         , NULL
                                         , NULL
                                         , '1'
                                         , NULL
                                         , NULL
                                         , NULL
                                         , SYSDATE
                                         , ?
                                         , SYSDATE
                                         , ?
                                          )
        ]]>   
    </query>
    <!-- 점별행사품번 수정 -->
    <query name="UPD_STREVTPBN">
        <![CDATA[
            UPDATE DPS.PC_STRPBNEVTMG
               SET GOAL_SALE_AMT  = ?
                 , GOAL_PROF_AMT  = ?
                 , MOD_DATE       = SYSDATE
                 , MOD_ID         = ?
             WHERE STR_CD         = ?
               AND PUMBUN_CD      = ?
               AND EVENT_CD       = ?
               AND EVENT_FLAG     = '00'
               AND EVENT_RATE     = '00'
               AND APP_S_DT       = ?
        ]]>   
    </query>
    <!-- 점별행사품번 삭제 -->
    <query name="DEL_STREVTPBN">
        <![CDATA[
            DELETE
              FROM DPS.PC_STRPBNEVTMG
             WHERE STR_CD         = ?
               AND PUMBUN_CD      = ?
               AND EVENT_CD       = ?
               AND EVENT_FLAG     = '00'
               AND EVENT_RATE     = '00'
               AND APP_S_DT       = ?
        ]]>   
    </query>
    <!-- 점별행사단품 등록 -->
    <query name="INS_STREVTSKU">
        <![CDATA[
            INSERT INTO DPS.PC_STRSKUEVTPRC(STR_CD
                                          , SKU_CD
                                          , EVENT_CD
                                          , APP_S_DT
                                          , APP_E_DT
                                          , MOD_E_DT
                                          , REDU_RATE
                                          , NORM_COST_PRC
                                          , NORM_SALE_PRC
                                          , NORM_MG_RATE
                                          , EVENT_COST_PRC
                                          , EVENT_PRICE
                                          , EVENT_MG_RATE
                                          , LIMIT_SALE_QTY
                                          , DC_DIV_RATE
                                          , CPN_ISSUE_QTY
                                          , CPN_BARCODE
                                          , EVENT_PLACE_CD
                                          , CONF_FLAG
                                          , CONF_DATE
                                          , CONF_ID
                                          , REMARK
                                          , PROC_FLAG
                                          , REG_DATE
                                          , REG_ID
                                          , MOD_DATE
                                          , MOD_ID
                                           )
                                     VALUES(?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , ?
                                          , SYSDATE
                                          , ?
                                          , SYSDATE
                                          , ?
                                           )
        ]]>   
    </query>
    <!-- 점별행사단품 수정 -->
    <query name="UPD_STREVTSKU">
        <![CDATA[
            UPDATE DPS.PC_STRSKUEVTPRC
               SET APP_E_DT       = ?
                 , REDU_RATE      = ?
                 , NORM_COST_PRC  = ?
                 , NORM_SALE_PRC  = ?
                 , NORM_MG_RATE   = ?
                 , EVENT_COST_PRC = ?
                 , EVENT_PRICE    = ?
                 , EVENT_MG_RATE  = ?
                 , LIMIT_SALE_QTY = ?
                 , DC_DIV_RATE    = ?
                 , CPN_ISSUE_QTY  = ?
                 , CPN_BARCODE    = ?
                 , MOD_DATE       = SYSDATE
                 , MOD_ID         = ?
             WHERE STR_CD         = ?
               AND SKU_CD         = ?
               AND EVENT_CD       = ?
               AND APP_S_DT       = ?
        ]]>   
    </query>
    <!-- 점별행사단품 삭제 -->
    <query name="DEL_STREVTSKU">
        <![CDATA[
            DELETE
              FROM DPS.PC_STRSKUEVTPRC
             WHERE STR_CD         = ?
               AND SKU_CD         = ?
               AND EVENT_CD       = ?
               AND APP_S_DT       = ?
        ]]>   
    </query>
    
    <!-- 마진율 체크  MARIO OUTLET START 2011-08-11 -->
    <query name="SEL_PC_MARGINMST_CHECK">
        <![CDATA[
            SELECT COUNT(*) AS CNT
              FROM DPS.PC_MARGINMST
             WHERE STR_CD       = ?
               AND PUMBUN_CD    = (SELECT PUMBUN_CD FROM DPS.PC_SKUMST SKU WHERE SKU_CD = ?)
               AND NORM_MG_RATE = ?
               --AND ((MG_FLAG <> '0') OR
               --     (MG_FLAG  = '0' AND EVENT_RATE <> '00'))
               AND ? >= APP_S_DT 
               AND ? <= APP_E_DT
        ]]>
    </query>
</service>