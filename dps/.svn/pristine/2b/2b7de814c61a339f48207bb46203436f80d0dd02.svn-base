<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 박종은
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2010.04.08
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/psal409.ps">

    <gauce name="H_SEL_MASTER"> 
        <column colName="CARD_FLAG"               colType="TB_STRING"      size="1"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CARD_PURCHASE"           colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BCOMP_NM"                colType="TB_STRING"      size="20"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CARD_PUBLISH"            colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CCOMP_NM"                colType="TB_STRING"      size="20"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOTAL"                   colType="TB_DECIMAL"     size="13"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_CNT"                colType="TB_DECIMAL"     size="7"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_SALE_AMT"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="RET_CNT"                 colType="TB_DECIMAL"     size="7"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="RET_SALE_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        
        
        <column colName="DAY_CAN_CNT"             colType="TB_DECIMAL"     size="20"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DAY_CAN_NORM_CNT"        colType="TB_DECIMAL"     size="20"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DAY_CAN_NORM_AMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DAY_CAN_RET_CNT"         colType="TB_DECIMAL"     size="20"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DAY_CAN_RET_AMT"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        
        
        
        <column colName="STR_CD"                  colType="TB_STRING"      size="4"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="LSSU_COMP"               colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="FLOR_CD"                 colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="POS_FLAG"                colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="POS_NO_S"                colType="TB_STRING"      size="4"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="POS_NO_E"                colType="TB_STRING"      size="4"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_DT_S"               colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_DT_E"               colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    
    <gauce name="H_SEL_DETAIL"> 
        <column colName="SALE_DT"                 colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="POS_NO"                  colType="TB_STRING"      size="4"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CNT"                     colType="TB_DECIMAL"     size="7"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_CNT"                colType="TB_DECIMAL"     size="7"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_SALE_AMT"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="RET_CNT"                 colType="TB_DECIMAL"     size="7"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="RET_SALE_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>


    <gauce name="H_SEL_POSNOMM"> 
        <column colName="POSNO_MIN"                   colType="TB_STRING"      size="4"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="POSNO_MAX"                   colType="TB_STRING"      size="4"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_DAY_INFO"> 
        <column colName="POS_NO"          colType="TB_STRING"      size="4"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TRAN_NO"         colType="TB_STRING"      size="5"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SEQ_NO"          colType="TB_DECIMAL"     size="5"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CARD_DATA"       colType="TB_STRING"      size="16"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="APPR_NO"         colType="TB_STRING"      size="12"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD"       colType="TB_STRING"      size="6"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NAME"     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_CD"          colType="TB_STRING"      size="13"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_NAME"        colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
   </gauce>

    <!-- 쿼리는 전부 대문자 -->
   
    <query name="SEL_CARD_SALE">        
        <![CDATA[
		    SELECT A.CARD_FLAG
		         , CASE WHEN A.CARD_FLAG = 'B' THEN '' ELSE A.CARD_PURCHASE END CARD_PURCHASE
                 , CASE WHEN A.CARD_FLAG = 'B' THEN '직불카드' ELSE MAX(C.BCOMP_NM) END  AS BCOMP_NM
                 , CASE WHEN A.CARD_FLAG = 'B' THEN '' ELSE A.CARD_PUBLISH END CARD_PUBLISH
                 , CASE WHEN A.CARD_FLAG = 'B' THEN '' ELSE MAX(D.CCOMP_NM) END AS CCOMP_NM
                 , SUM(TOTAL_CNT)                   AS TOTAL
                 , SUM(SALE_AMT)                   AS SALE_AMT
                 , SUM(ABS(NORM_CNT))          AS NORM_CNT
                 , SUM(NORM_SALE_AMT)         AS NORM_SALE_AMT
                 , SUM(ABS(RET_CNT))             AS RET_CNT
                 , SUM(RET_SALE_AMT)            AS RET_SALE_AMT
                 , SUM(DAY_CAN_NORM_CNT) + SUM(DAY_CAN_RET_CNT) AS DAY_CAN_CNT  -- 당일취소건수
                 , SUM(DAY_CAN_NORM_CNT)             AS DAY_CAN_NORM_CNT  -- 당일취소(정상)건수
                 , SUM(DAY_CAN_NORM_AMT)             AS DAY_CAN_NORM_AMT  -- 당일취소(정상)금액
                 , SUM(DAY_CAN_RET_CNT)             AS DAY_CAN_RET_CNT    -- 당일취소(취소)건수
                 , SUM(DAY_CAN_RET_AMT)             AS DAY_CAN_RET_AMT    -- 당일취소(취소)금액
                 , A.STR_CD
                 , ?                              AS LSSU_COMP
                 , ?                              AS FLOR_CD
                 , ?                              AS POS_FLAG
                 , ?                              AS POS_NO_S
                 , ?                              AS POS_NO_E
                 , ?                              AS SALE_DT_S
                 , ?                              AS SALE_DT_E
              FROM (
                    SELECT A.CARD_FLAG
                         , A.CARD_PURCHASE
                         , A.CARD_PUBLISH 
                         , A.STR_CD
                         , A.SALE_DT
                         , A.POS_NO
                         , A.TOTAL_CNT
                         , A.CNT
                         , A.SALE_AMT
                         , A.NORM_CNT
                         , A.NORM_SALE_AMT
                         , A.RET_CNT
                         , A.RET_SALE_AMT
                         , A.DAY_CAN_NORM_CNT
                         , A.DAY_CAN_NORM_AMT
                         , A.DAY_CAN_RET_CNT
                         , A.DAY_CAN_RET_AMT
                      FROM (SELECT 
                      				A.STR_CD
                                 , A.SALE_DT
                                 , A.POS_NO
                                 , CASE WHEN A.CARD_FLAG = '12' THEN 'B' ELSE 'A' END AS CARD_FLAG
                                 , A.CARD_PURCHASE
                                 , A.CARD_PUBLISH
                                 , NVL(SUM(1), 0)                                             AS TOTAL_CNT
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN 1 ELSE -1 END),0) AS CNT
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN A.PAY_AMT ELSE A.PAY_AMT * -1 END),0) AS SALE_AMT
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN 1 ELSE 0 END),0) AS NORM_CNT
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN 0 ELSE 1 END),0) AS RET_CNT
                                 , 0 AS  DAY_CAN_NORM_CNT
                                 , 0 AS  DAY_CAN_RET_CNT
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN A.PAY_AMT ELSE 0 END),0) AS NORM_SALE_AMT
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN 0 ELSE A.PAY_AMT END),0) AS RET_SALE_AMT
                                 , 0 AS  DAY_CAN_NORM_AMT
                                 , 0 AS  DAY_CAN_RET_AMT
                              FROM 
                                   DPS.PS_DISCARD      A
                                 , DPS.PS_TRHEADER  B
                             WHERE A.STR_CD        = B.STR_CD
                               AND A.SALE_DT       = B.SALE_DT
                               AND A.POS_NO        = B.POS_NO
                               AND A.TRAN_NO       = B.TRAN_NO 
                               AND A.STR_CD        = ?
                               AND A.SALE_DT       BETWEEN ? AND ?
                               AND A.POS_NO        BETWEEN ? AND ?
                               AND B.TRAN_MODE     NOT IN ('92', '24', '26', '21')
                               AND A.CARD_PUBLISH  LIKE ? || '%'
                               AND A.CARD_PURCHASE LIKE ? || '%'
                             GROUP BY A.STR_CD
                                 , A.SALE_DT
                                 , A.POS_NO
                                 , CASE WHEN A.CARD_FLAG = '12' THEN 'B' ELSE 'A' END
                                 , A.CARD_PURCHASE
                                 , A.CARD_PUBLISH
                            UNION ALL
                            SELECT 
                            		A.STR_CD
                                 , A.SALE_DT
                                 , A.POS_NO
                                 , CASE WHEN A.CARD_FLAG = '12' THEN 'B' ELSE 'A' END AS CARD_FLAG
                                 , A.CARD_PURCHASE
                                 , A.CARD_PUBLISH
                                 , 0                           AS TOTAL_CNT
                                 , 0                           AS CNT
                                 , 0                           AS SALE_AMT
                                 , 0                           AS NORM_CNT
                                 , 0                           AS RET_CNT
                                 , SUM(1)                      AS DAY_CAN_NORM_CNT
                                 , 0                           AS DAY_CAN_RET_CNT
                                 , 0                           AS NORM_SALE_AMT
                                 , 0                           AS RET_SALE_AMT
                                 , SUM(NVL(A.PAY_AMT,0))       AS  DAY_CAN_NORM_AMT
                                 , 0                           AS  DAY_CAN_RET_AMT
                              FROM DPS.PS_DISCARD   A
                                 , DPS.PS_TRHEADER  B
                             WHERE A.STR_CD        = B.STR_CD
                               AND A.SALE_DT       = B.SALE_DT
                               AND A.POS_NO        = B.POS_NO
                               AND A.TRAN_NO       = B.TRAN_NO
                               AND B.TRAN_FLAG     <> '0'
                               AND A.SALE_DT       BETWEEN ? AND ?
                               AND A.POS_NO        BETWEEN ? AND ?
                               AND B.TRAN_MODE     NOT IN ('92', '24', '26', '21')
                               AND A.CARD_TYPE_CD  BETWEEN ? AND ?
                               AND A.SALE_DT       = A.CARD_TYPE_CD
                               AND A.APPR_NO       = A.INPUT_FLAG
                               AND A.CARD_PUBLISH  LIKE ? || '%'
                               AND A.CARD_PURCHASE LIKE ? || '%'
                             GROUP BY A.STR_CD
                                 , A.SALE_DT
                                 , A.POS_NO
                                 , CASE WHEN A.CARD_FLAG = '12' THEN 'B' ELSE 'A' END
                                 , A.CARD_PURCHASE
                                 , A.CARD_PUBLISH
                            UNION ALL
                            SELECT 
                            		A.STR_CD
                                 , A.SALE_DT
                                 , A.POS_NO
                                 , CASE WHEN A.CARD_FLAG = '12' THEN 'B' ELSE 'A' END AS CARD_FLAG
                                 , A.CARD_PURCHASE
                                 , A.CARD_PUBLISH
                                 , 0                           AS TOTAL_CNT
                                 , 0                           AS CNT
                                 , 0                           AS SALE_AMT
                                 , 0                           AS NORM_CNT
                                 , 0                           AS RET_CNT
                                 , 0                           AS DAY_CAN_NORM_CNT
                                 , SUM(1)                      AS DAY_CAN_RET_CNT
                                 , 0                           AS NORM_SALE_AMT
                                 , 0                           AS RET_SALE_AMT
                                 , 0                           AS  DAY_CAN_NORM_AMT
                                 , SUM(NVL(A.PAY_AMT,0))       AS  DAY_CAN_RET_AMT
                              FROM DPS.PS_DISCARD      A
                                 , DPS.PS_TRHEADER  B
                             WHERE A.STR_CD        = B.STR_CD
                               AND A.SALE_DT       = B.SALE_DT
                               AND A.POS_NO        = B.POS_NO
                               AND A.TRAN_NO       = B.TRAN_NO
                               AND A.SALE_DT       BETWEEN ? AND ?
                               AND A.POS_NO        BETWEEN ? AND ?
                               AND B.TRAN_MODE     NOT IN ('92', '24', '26', '21')
                               AND B.TRAN_FLAG     = '0'
                               AND (A.STR_CD,A.SALE_DT,A.CARD_DATA,A.APPR_NO ) 
                                   IN ( SELECT 
                                   				E.STR_CD,E.CARD_TYPE_CD, E.CARD_DATA, E.INPUT_FLAG
                                          FROM DPS.PS_DISCARD   E
                                             , DPS.PS_TRHEADER  F
                                         WHERE E.STR_CD        = F.STR_CD
                                           AND E.SALE_DT       = F.SALE_DT
                                           AND E.POS_NO        = F.POS_NO
                                           AND E.TRAN_NO       = F.TRAN_NO
                                           AND F.TRAN_FLAG     <> '0'
                                           AND E.SALE_DT       BETWEEN ? AND ?
                                           AND E.POS_NO        BETWEEN ? AND ?
                                           AND F.TRAN_MODE     NOT IN ('92', '24', '26', '21')
                                           AND E.CARD_TYPE_CD     BETWEEN ? AND ?
                                           AND E.SALE_DT       = E.CARD_TYPE_CD
                                           AND E.APPR_NO       = E.INPUT_FLAG
                                      )
                               AND A.CARD_PUBLISH  LIKE ? || '%'
                               AND A.CARD_PURCHASE LIKE ? || '%'
                             GROUP BY A.STR_CD
                                 , A.SALE_DT
                                 , A.POS_NO
                                 , CASE WHEN A.CARD_FLAG = '12' THEN 'B' ELSE 'A' END
                                 , A.CARD_PURCHASE
                                 , A.CARD_PUBLISH
                           )   A
                         ,  ( SELECT 
                         			STR_CD
                                   , FLOR_CD
                                   , POS_FLAG
                                   , POS_NO
                                FROM DPS.PC_POSMST Z 
                               WHERE STR_CD      = ?
                                 AND FLOR_CD     LIKE ? || '%'
                                 AND POS_FLAG    LIKE ? || '%'
                            )   B
                     WHERE A.STR_CD          = B.STR_CD
                       AND A.POS_NO          = B.POS_NO
                   ) A
                 , (SELECT 
                 			CCOMP_CD AS BCOMP_CD
                         , CCOMP_NM AS BCOMP_NM
                      FROM DPS.PD_CARDCOMP C
                    ) C
                 , (SELECT 
                 			CCOMP_CD AS CCOMP_CD
                         , CCOMP_NM AS CCOMP_NM
                      FROM DPS.PD_CARDCOMP C
                    ) D
             WHERE C.BCOMP_CD (+)= A.CARD_PURCHASE
               AND D.CCOMP_CD (+)= A.CARD_PUBLISH
             GROUP BY
                   A.CARD_FLAG
                 , A.CARD_PURCHASE
                 , A.CARD_PUBLISH
                 , A.STR_CD
             ORDER BY
                   A.CARD_FLAG
                  ,A.CARD_PURCHASE
                  ,A.CARD_PUBLISH
        ]]>        
    </query>
    
    <query name="SEL_CARD_SALE_DATE">        
        <![CDATA[
            SELECT A.SALE_DT
                 , A.POS_NO
                 , SUM(ABS(CNT))                  AS CNT
                 , SUM(SALE_AMT)                  AS SALE_AMT
                 , SUM(ABS(NORM_CNT))                  AS NORM_CNT
                 , SUM(NORM_SALE_AMT)                  AS NORM_SALE_AMT
                 , SUM(ABS(RET_CNT))                  AS RET_CNT
                 , SUM(RET_SALE_AMT)                  AS RET_SALE_AMT
              FROM (
                    SELECT A.STR_CD
                         , A.SALE_DT
                         , A.POS_NO
                         , A.CNT
                         , A.SALE_AMT
                         , A.NORM_CNT
                         , A.NORM_SALE_AMT
                         , A.RET_CNT
                         , A.RET_SALE_AMT
                      FROM (SELECT A.STR_CD
                                 , A.SALE_DT
                                 , A.POS_NO
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN 1 ELSE -1 END),0) AS CNT
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN A.PAY_AMT ELSE A.PAY_AMT * -1 END),0) AS SALE_AMT
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN 1 ELSE 0 END),0) AS NORM_CNT
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN 0 ELSE 1 END),0) AS RET_CNT
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN A.PAY_AMT ELSE 0 END),0) AS NORM_SALE_AMT
                                 , NVL(SUM(CASE WHEN B.TRAN_FLAG = '0' THEN 0 ELSE A.PAY_AMT END),0) AS RET_SALE_AMT
                              FROM DPS.PS_DISCARD  A
                                 , DPS.PS_TRHEADER B
                                 , DPS.PD_CARDCOMP C
                             WHERE A.STR_CD        = B.STR_CD
                               AND A.SALE_DT       = B.SALE_DT
                               AND A.POS_NO        = B.POS_NO
                               AND A.TRAN_NO       = B.TRAN_NO 
                               AND A.CARD_PURCHASE = C.CCOMP_CD(+)
                               AND A.STR_CD        = ?
                               AND A.SALE_DT       BETWEEN ? AND ?
                               AND A.POS_NO        BETWEEN ? AND ?
                               AND B.TRAN_MODE     NOT IN ('92', '24', '26', '21')
                               AND A.CARD_PUBLISH  LIKE ? || '%'
                               AND A.CARD_PURCHASE LIKE ? || '%'
                               AND A.CARD_FLAG  IN (?, ?, ?, ?)
                             GROUP BY 
                                   A.STR_CD
                                 , A.SALE_DT
                                 , A.POS_NO
                           )   A
                         ,  ( SELECT STR_CD
                                   , FLOR_CD
                                   , POS_FLAG
                                   , POS_NO
                                FROM DPS.PC_POSMST 
                               WHERE STR_CD      = ?
                                 AND FLOR_CD     LIKE ? || '%'
                                 AND POS_FLAG    LIKE ? || '%'
                            )   B
                     WHERE A.STR_CD          = B.STR_CD
                       AND A.POS_NO          = B.POS_NO
                   ) A
             GROUP BY
                   A.SALE_DT
                 , A.POS_NO
             ORDER BY
                   A.SALE_DT
                 , A.POS_NO
            
        ]]>        
    </query>
    
    
    <query name="SEL_POS_TRAN">        
        <![CDATA[
			SELECT C.POS_NO
			     , C.TRAN_NO
			     , C.SEQ_NO
                 , B.CARD_DATA
			     , B.APPR_NO
			     , CASE WHEN A.TRAN_FLAG = '0' THEN C.SALE_AMT ELSE C.SALE_AMT * -1 END AS SALE_AMT
			     , C.PUMBUN_CD
			     , DPS.FN_GET_PUMBUN_NAME(C.PUMBUN_CD)                                  AS PUMBUN_NAME
			     , C.SKU_CD
			     , DPS.FN_GET_SKU_NAME(C.SKU_CD)                                        AS SKU_NAME
			  FROM DPS.PS_DISHEADER A
			     , DPS.PS_DISCARD   B
			     , DPS.PS_DISITEM   C
			 WHERE A.STR_CD         = B.STR_CD
			   AND A.SALE_DT        = B.SALE_DT
			   AND A.POS_NO         = B.POS_NO
			   AND A.TRAN_NO        = B.TRAN_NO 
			   AND A.STR_CD         = C.STR_CD
			   AND A.SALE_DT        = C.SALE_DT
			   AND A.POS_NO         = C.POS_NO 
			   AND A.TRAN_NO        = C.TRAN_NO 
			   AND A.STR_CD         = ?
			   AND A.SALE_DT        = ?
			   AND A.POS_NO         = ?
               AND B.CARD_PUBLISH  LIKE ? || '%'
               AND A.TRAN_MODE      <> '92'
			   AND B.PAY_AMT        <> 0
			 ORDER BY
			       C.POS_NO
                 , C.TRAN_NO
                 , C.SEQ_NO
        ]]>        
    </query>
    
    <query name="SEL_POSNOMM">        
        <![CDATA[
            SELECT MAX(A.POSNO_MIN) AS POSNO_MIN
                 , MAX(A.POSNO_MAX) AS POSNO_MAX
              FROM (
                    SELECT MIN(A.POS_NO) AS POSNO_MIN
                         , ''            AS POSNO_MAX
                      FROM DPS.PC_POSMST A
                      
                    UNION ALL
                      
                    SELECT ''            AS POSNO_MIN
                         , MAX(A.POS_NO) AS POSNO_MAX
                      FROM DPS.PC_POSMST A
                   ) A
        ]]>        
    </query>
    
    
</service>