<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : DHL
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2012.05.18
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/psal455.ps">
    
    <gauce name="H_SEL_MASTER1"> 
        <column colName="STR_CD"                      colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="RANK_NO"                     colType="TB_DECIMAL"     size="3"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_CD"                      colType="TB_STRING"      size="6"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_NAME"                    colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REP_PUMBUN_CD"               colType="TB_STRING"      size="6"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REP_PUMBUN_NM"               colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />

        <column colName="NORM_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PLAN_NORM_SAMT"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVE_RATE"                colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AVG_DAY"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AVG_AREA"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />

        <column colName="CMPR1_RANK_NO"               colType="TB_DECIMAL"     size="3"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_NORM_SALE_AMT"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_PLAN_NORM_SAMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_DAY"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_AREA"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />        
        <column colName="CMPR1_ACHIEVE_RATE"          colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_IRATE"            colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_DAY_RATE"     colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_AREA_RATE"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />

        <column colName="CMPR2_RANK_NO"               colType="TB_DECIMAL"     size="3"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_NORM_SALE_AMT"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_PLAN_NORM_SAMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_DAY"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_AREA"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />        
        <column colName="CMPR2_ACHIEVE_RATE"          colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_IRATE"            colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_DAY_RATE"     colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_AREA_RATE"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_MASTER2"> 
        <column colName="STR_CD"                      colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="RANK_NO"                     colType="TB_DECIMAL"     size="3"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD"                   colType="TB_STRING"      size="6"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NM"                   colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />

        <column colName="NORM_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PLAN_NORM_SAMT"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVE_RATE"                colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AVG_DAY"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AVG_AREA"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />

        <column colName="CMPR1_RANK_NO"               colType="TB_DECIMAL"     size="3"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_NORM_SALE_AMT"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_PLAN_NORM_SAMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_DAY"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_AREA"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />        
        <column colName="CMPR1_ACHIEVE_RATE"          colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_IRATE"            colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_DAY_RATE"     colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_AREA_RATE"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />

        <column colName="CMPR2_RANK_NO"               colType="TB_DECIMAL"     size="3"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_NORM_SALE_AMT"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_PLAN_NORM_SAMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_DAY"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_AREA"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />        
        <column colName="CMPR2_ACHIEVE_RATE"          colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_IRATE"            colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_DAY_RATE"     colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_AREA_RATE"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_MASTER3"> 
        <column colName="STR_CD"                      colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="RANK_NO"                     colType="TB_DECIMAL"     size="3"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_CD"                      colType="TB_STRING"      size="6"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_NAME"                    colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD"                   colType="TB_STRING"      size="6"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NM"                   colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />

        <column colName="NORM_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PLAN_NORM_SAMT"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVE_RATE"                colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AVG_DAY"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AVG_AREA"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />

        <column colName="CMPR1_RANK_NO"               colType="TB_DECIMAL"     size="3"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_NORM_SALE_AMT"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_PLAN_NORM_SAMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_DAY"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_AREA"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />        
        <column colName="CMPR1_ACHIEVE_RATE"          colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_IRATE"            colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_DAY_RATE"     colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR1_SALE_AVG_AREA_RATE"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />

        <column colName="CMPR2_RANK_NO"               colType="TB_DECIMAL"     size="3"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_NORM_SALE_AMT"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_PLAN_NORM_SAMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_DAY"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_AREA"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />        
        <column colName="CMPR2_ACHIEVE_RATE"          colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_IRATE"            colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_DAY_RATE"     colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPR2_SALE_AVG_AREA_RATE"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
        
    <gauce name="H_SEL_CMPRDT"> 
        <column colName="CMPR_DT"                 colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_CMPRDT2"> 
        <column colName="CMPR_DT"                 colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <!-- 쿼리는 전부 대문자 -->
     
    <!-- 마스터 조회 쿼리  -->
    <query name="SEL_SALE_VEN_YEAR">        
        <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 , X.VEN_CD                                AS VEN_CD
                 , DPS.FN_GET_VEN_NAME(X.VEN_CD)           AS VEN_NAME
                 , X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.REP_PUMBUN_CD) AS REP_PUMBUN_NM
                 --, X.PUMBUN_CD                             AS PUMBUN_CD
                 --, ''                                      AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 --, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 --, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 --, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 --, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 --, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 --, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , 0                                       AS CMPR2_RANK_NO
                 --, 0                                       AS CMPR2_SALE_QTY
                 --, 0                                       AS CMPR2_TOT_SALE_AMT
                 --, 0                                       AS CMPR2_VAT_AMT
                 --, 0                                       AS CMPR2_REDU_AMT
                 , 0                                       AS CMPR2_NORM_SALE_AMT
                 --, 0                                       AS CMPR2_DC_AMT
                 --, 0                                       AS CMPR2_NET_SALE_AMT
                 --, 0                                       AS CMPR2_SALE_PROF_AMT
                 --, 0                                       AS CMPR2_CUST_CNT
                 --, 0                                       AS CMPR2_SAL_COST_PRC
                 --, 0                                       AS CMPR2_PLAN_SALE_TAMT
                 , 0                                       AS CMPR2_PLAN_NORM_SAMT
                 , 0                                       AS CMPR2_SALE_AVG_DAY
                 , 0                                       AS CMPR2_SALE_AVG_AREA
                 , 0                                       AS CMPR2_ACHIEVE_RATE
                 , 0                                       AS CMPR2_SALE_IRATE
                 , 0                                       AS CMPR2_SALE_AVG_DAY_RATE
                 , 0                                       AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , UA.VEN_CD                                         AS VEN_CD
                         , UA.REP_PUMBUN_CD                                  AS REP_PUMBUN_CD
                         , ''                                                AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
                         , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
                                 ELSE
                                   ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
                                   - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
                                   )
                                   / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
                            END)                                                    AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY             -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT         -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT              -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT             -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT        -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT               -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT         -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT        -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT             -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC         -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE, 0))               AS AREA_SIZE            -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT       -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT       -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY       --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT   --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT        --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT       --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT  --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT         --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT   --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT  --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT       --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC   --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD     = ?
                               AND A.SALE_DT   >= ?   --매출기간시작일
                               AND A.SALE_DT   <= ?   --매출기간종료일
                               AND B.STR_CD     = A.STR_CD
                               AND B.PUMBUN_CD  = A.PUMBUN_CD
                               AND C.PUMBUN_CD  = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.SALE_DT   = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.EXE_DT    = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.VEN_CD
                            , UA.REP_PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.VEN_CD
                    , X.REP_PUMBUN_CD
    ]]>        
    </query>
    
    <query name="SEL_BUY_VEN_YEAR">        
        <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 , X.VEN_CD                                AS VEN_CD
                 , DPS.FN_GET_VEN_NAME(X.VEN_CD)           AS VEN_NAME
                 , X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.REP_PUMBUN_CD) AS REP_PUMBUN_NM
                 --, X.PUMBUN_CD                             AS PUMBUN_CD
                 --, ''                                      AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 --, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 --, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 --, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 --, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 --, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 --, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , 0                                       AS CMPR2_RANK_NO
                 --, 0                                       AS CMPR2_SALE_QTY
                 --, 0                                       AS CMPR2_TOT_SALE_AMT
                 --, 0                                       AS CMPR2_VAT_AMT
                 --, 0                                       AS CMPR2_REDU_AMT
                 , 0                                       AS CMPR2_NORM_SALE_AMT
                 --, 0                                       AS CMPR2_DC_AMT
                 --, 0                                       AS CMPR2_NET_SALE_AMT
                 --, 0                                       AS CMPR2_SALE_PROF_AMT
                 --, 0                                       AS CMPR2_CUST_CNT
                 --, 0                                       AS CMPR2_SAL_COST_PRC
                 --, 0                                       AS CMPR2_PLAN_SALE_TAMT
                 , 0                                       AS CMPR2_PLAN_NORM_SAMT
                 , 0                                       AS CMPR2_SALE_AVG_DAY
                 , 0                                       AS CMPR2_SALE_AVG_AREA
                 , 0                                       AS CMPR2_ACHIEVE_RATE
                 , 0                                       AS CMPR2_SALE_IRATE
                 , 0                                       AS CMPR2_SALE_AVG_DAY_RATE
                 , 0                                       AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , UA.VEN_CD                                         AS VEN_CD
                         , UA.REP_PUMBUN_CD                                  AS REP_PUMBUN_CD
                         , ''                                                AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?','YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 신장율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY             -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT         -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT              -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT             -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT        -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT               -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT         -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT        -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT             -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC         -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE, 0))               AS AREA_SIZE            -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT       -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT       -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY       --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT   --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT        --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT       --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT  --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT         --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT   --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT  --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT       --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC   --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD     = ?
                               AND A.SALE_DT   >= ?   --매출기간시작일
                               AND A.SALE_DT   <= ?   --매출기간종료일
                               AND B.STR_CD     = A.STR_CD
                               AND B.PUMBUN_CD  = A.PUMBUN_CD
                               AND C.PUMBUN_CD  = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.SALE_DT   = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.EXE_DT    = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.VEN_CD
                            , UA.REP_PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.VEN_CD
                    , X.REP_PUMBUN_CD
    ]]>        
    </query>
     <query name="SEL_SALE_VEN_WEEK">        
        <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 , X.VEN_CD                                AS VEN_CD
                 , DPS.FN_GET_VEN_NAME(X.VEN_CD)           AS VEN_NAME
                 , X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.REP_PUMBUN_CD) AS REP_PUMBUN_NM
                 --, X.PUMBUN_CD                             AS PUMBUN_CD
                 --, ''                                      AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 --, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 --, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 --, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 --, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 --, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 --, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , X.CMPR2_RANK_NO                         AS CMPR2_RANK_NO
                 --, X.CMPR2_SALE_QTY                        AS CMPR2_SALE_QTY
                 --, X.CMPR2_TOT_SALE_AMT                    AS CMPR2_TOT_SALE_AMT
                 --, X.CMPR2_VAT_AMT                         AS CMPR2_VAT_AMT
                 --, X.CMPR2_REDU_AMT                        AS CMPR2_REDU_AMT
                 , X.CMPR2_NORM_SALE_AMT                   AS CMPR2_NORM_SALE_AMT
                 --, X.CMPR2_DC_AMT                          AS CMPR2_DC_AMT
                 --, X.CMPR2_NET_SALE_AMT                    AS CMPR2_NET_SALE_AMT
                 --, X.CMPR2_SALE_PROF_AMT                   AS CMPR2_SALE_PROF_AMT
                 --, X.CMPR2_CUST_CNT                        AS CMPR2_CUST_CNT
                 --, X.CMPR2_SAL_COST_PRC                    AS CMPR2_SAL_COST_PRC
                 --, X.CMPR2_PLAN_SALE_TAMT                  AS CMPR2_PLAN_SALE_TAMT
                 , X.CMPR2_PLAN_NORM_SAMT                  AS CMPR2_PLAN_NORM_SAMT
                 , X.CMPR2_SALE_AVG_DAY                    AS CMPR2_SALE_AVG_DAY
                 , X.CMPR2_SALE_AVG_AREA                   AS CMPR2_SALE_AVG_AREA
                 , X.CMPR2_ACHIEVE_RATE                    AS CMPR2_ACHIEVE_RATE
                 , X.CMPR2_SALE_IRATE                      AS CMPR2_SALE_IRATE
                 , X.CMPR2_SALE_AVG_DAY_RATE               AS CMPR2_SALE_AVG_DAY_RATE
                 , X.CMPR2_SALE_AVG_AREA_RATE              AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , UA.VEN_CD                                         AS VEN_CD
                         , UA.REP_PUMBUN_CD                                  AS REP_PUMBUN_CD
                         , ''                                                AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                         , RANK() OVER (ORDER BY SUM(UA.CMPR2_NORM_SALE_AMT) DESC) AS CMPR2_RANK_NO
                         , SUM(UA.CMPR2_SALE_QTY      )                      AS CMPR2_SALE_QTY
                         , SUM(UA.CMPR2_TOT_SALE_AMT  )                      AS CMPR2_TOT_SALE_AMT
                         , SUM(UA.CMPR2_VAT_AMT       )                      AS CMPR2_VAT_AMT
                         , SUM(UA.CMPR2_REDU_AMT      )                      AS CMPR2_REDU_AMT
                         , SUM(UA.CMPR2_NORM_SALE_AMT )                      AS CMPR2_NORM_SALE_AMT
                         , SUM(UA.CMPR2_DC_AMT        )                      AS CMPR2_DC_AMT
                         , SUM(UA.CMPR2_NET_SALE_AMT  )                      AS CMPR2_NET_SALE_AMT
                         , SUM(UA.CMPR2_SALE_PROF_AMT )                      AS CMPR2_SALE_PROF_AMT
                         , SUM(UA.CMPR2_CUST_CNT      )                      AS CMPR2_CUST_CNT
                         , SUM(UA.CMPR2_SAL_COST_PRC  )                      AS CMPR2_SAL_COST_PRC
                         , SUM(UA.CMPR2_PLAN_SALE_TAMT)                      AS CMPR2_PLAN_SALE_TAMT
                         , SUM(UA.CMPR2_PLAN_NORM_SAMT)                      AS CMPR2_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR2_SALE_AVG_DAY       -- 일평균판매금액2
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR2_SALE_AVG_AREA      -- ㎡ 당매출2
                         , (CASE WHEN SUM(UA.CMPR2_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.CMPR2_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR2_ACHIEVE_RATE       -- 달성율2
                         , (CASE WHEN SUM(UA.CMPR2_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR2_NORM_SALE_AMT)-SUM(UA.CMPR2_NORM_SALE_AMT))/SUM(UA.CMPR2_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR2_SALE_IRATE         -- 신장율2
                         , (CASE WHEN SUM(NVL(UA.CMPR2_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR2_SALE_AVG_DAY_RATE  -- 일평균 대비율2
				                 , (CASE WHEN  SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR2_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율2
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY            -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT        -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT             -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT            -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT       -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT              -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT        -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT       -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT            -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC        -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE,0))                AS AREA_SIZE           -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT      -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT      -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?   --매출기간시작일
                               AND A.SALE_DT  <= ?   --매출기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일1
                               AND A.SALE_DT  <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일1
                               AND A.EXE_DT   <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR2_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR2_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR2_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR2_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR2_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일2
                               AND A.SALE_DT  <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일2
                               AND A.EXE_DT   <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.VEN_CD
                            , UA.REP_PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.VEN_CD
                    , X.REP_PUMBUN_CD
        ]]>        
    </query>
       <query name="SEL_BUY_VEN_WEEK">        
        <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 , X.VEN_CD                                AS VEN_CD
                 , DPS.FN_GET_VEN_NAME(X.VEN_CD)           AS VEN_NAME
                 , X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.REP_PUMBUN_CD) AS REP_PUMBUN_NM
                 --, X.PUMBUN_CD                             AS PUMBUN_CD
                 --, ''                                      AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 ---, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 ---, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 ---, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 ---, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 ---, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 ---, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , X.CMPR2_RANK_NO                         AS CMPR2_RANK_NO
                 --, X.CMPR2_SALE_QTY                        AS CMPR2_SALE_QTY
                 --, X.CMPR2_TOT_SALE_AMT                    AS CMPR2_TOT_SALE_AMT
                 --, X.CMPR2_VAT_AMT                         AS CMPR2_VAT_AMT
                 --, X.CMPR2_REDU_AMT                        AS CMPR2_REDU_AMT
                 , X.CMPR2_NORM_SALE_AMT                   AS CMPR2_NORM_SALE_AMT
                 --, X.CMPR2_DC_AMT                          AS CMPR2_DC_AMT
                 --, X.CMPR2_NET_SALE_AMT                    AS CMPR2_NET_SALE_AMT
                 --, X.CMPR2_SALE_PROF_AMT                   AS CMPR2_SALE_PROF_AMT
                 --, X.CMPR2_CUST_CNT                        AS CMPR2_CUST_CNT
                 --, X.CMPR2_SAL_COST_PRC                    AS CMPR2_SAL_COST_PRC
                 --, X.CMPR2_PLAN_SALE_TAMT                  AS CMPR2_PLAN_SALE_TAMT
                 , X.CMPR2_PLAN_NORM_SAMT                  AS CMPR2_PLAN_NORM_SAMT
                 , X.CMPR2_SALE_AVG_DAY                    AS CMPR2_SALE_AVG_DAY
                 , X.CMPR2_SALE_AVG_AREA                   AS CMPR2_SALE_AVG_AREA
                 , X.CMPR2_ACHIEVE_RATE                    AS CMPR2_ACHIEVE_RATE
                 , X.CMPR2_SALE_IRATE                      AS CMPR2_SALE_IRATE
                 , X.CMPR2_SALE_AVG_DAY_RATE               AS CMPR2_SALE_AVG_DAY_RATE
                 , X.CMPR2_SALE_AVG_AREA_RATE              AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , UA.VEN_CD                                         AS VEN_CD
                         , UA.REP_PUMBUN_CD                                  AS REP_PUMBUN_CD
                         , ''                                                AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1

                         , RANK() OVER (ORDER BY SUM(UA.CMPR2_NORM_SALE_AMT) DESC) AS CMPR2_RANK_NO
                         , SUM(UA.CMPR2_SALE_QTY      )                      AS CMPR2_SALE_QTY
                         , SUM(UA.CMPR2_TOT_SALE_AMT  )                      AS CMPR2_TOT_SALE_AMT
                         , SUM(UA.CMPR2_VAT_AMT       )                      AS CMPR2_VAT_AMT
                         , SUM(UA.CMPR2_REDU_AMT      )                      AS CMPR2_REDU_AMT
                         , SUM(UA.CMPR2_NORM_SALE_AMT )                      AS CMPR2_NORM_SALE_AMT
                         , SUM(UA.CMPR2_DC_AMT        )                      AS CMPR2_DC_AMT
                         , SUM(UA.CMPR2_NET_SALE_AMT  )                      AS CMPR2_NET_SALE_AMT
                         , SUM(UA.CMPR2_SALE_PROF_AMT )                      AS CMPR2_SALE_PROF_AMT
                         , SUM(UA.CMPR2_CUST_CNT      )                      AS CMPR2_CUST_CNT
                         , SUM(UA.CMPR2_SAL_COST_PRC  )                      AS CMPR2_SAL_COST_PRC
                         , SUM(UA.CMPR2_PLAN_SALE_TAMT)                      AS CMPR2_PLAN_SALE_TAMT
                         , SUM(UA.CMPR2_PLAN_NORM_SAMT)                      AS CMPR2_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/(TO_DATE(?','YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR2_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR2_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR2_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.CMPR2_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR2_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR2_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR2_NORM_SALE_AMT)-SUM(UA.CMPR2_NORM_SALE_AMT))/SUM(UA.CMPR2_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR2_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR2_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR2_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR2_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY            -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT        -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT             -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT            -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT       -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT              -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT        -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT       -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT            -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC        -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE,0))                AS AREA_SIZE           -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT      -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT      -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?   --매출기간시작일
                               AND A.SALE_DT  <= ?   --매출기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일1
                               AND A.SALE_DT  <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일1
                               AND A.EXE_DT   <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR2_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR2_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR2_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR2_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR2_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일2
                               AND A.SALE_DT  <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일2
                               AND A.EXE_DT   <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.VEN_CD
                            , UA.REP_PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.VEN_CD
                    , X.REP_PUMBUN_CD
                             
        ]]>        
    </query>

    <query name="SEL_SALE_BRAND_YEAR">        
     <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 --, X.VEN_CD                                AS VEN_CD
                 --, ''                                      AS VEN_NAME
                 --, X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 --, ''                                      AS REP_PUMBUN_NM
                 , X.PUMBUN_CD                             AS PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.PUMBUN_CD)     AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 --, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 --, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 --, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 --, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 --, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 --, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , 0                                       AS CMPR2_RANK_NO
                 --, 0                                       AS CMPR2_SALE_QTY
                 --, 0                                       AS CMPR2_TOT_SALE_AMT
                 --, 0                                       AS CMPR2_VAT_AMT
                 --, 0                                       AS CMPR2_REDU_AMT
                 , 0                                       AS CMPR2_NORM_SALE_AMT
                 --, 0                                       AS CMPR2_DC_AMT
                 --, 0                                       AS CMPR2_NET_SALE_AMT
                 --, 0                                       AS CMPR2_SALE_PROF_AMT
                 --, 0                                       AS CMPR2_CUST_CNT
                 --, 0                                       AS CMPR2_SAL_COST_PRC
                 --, 0                                       AS CMPR2_PLAN_SALE_TAMT
                 , 0                                       AS CMPR2_PLAN_NORM_SAMT
                 , 0                                       AS CMPR2_SALE_AVG_DAY
                 , 0                                       AS CMPR2_SALE_AVG_AREA
                 , 0                                       AS CMPR2_ACHIEVE_RATE
                 , 0                                       AS CMPR2_SALE_IRATE
                 , 0                                       AS CMPR2_SALE_AVG_DAY_RATE
                 , 0                                       AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , ''                                                AS VEN_CD
                         , ''                                                AS REP_PUMBUN_CD
                         , UA.PUMBUN_CD                                      AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                    AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY             -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT         -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT              -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT             -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT        -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT               -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT         -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT        -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT             -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC         -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE, 0))               AS AREA_SIZE            -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT       -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT       -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY       --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT   --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT        --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT       --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT  --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT         --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT   --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT  --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT       --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC   --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD     = ?
                               AND A.SALE_DT   >= ?   --매출기간시작일
                               AND A.SALE_DT   <= ?   --매출기간종료일
                               AND B.STR_CD     = A.STR_CD
                               AND B.PUMBUN_CD  = A.PUMBUN_CD
                               AND C.PUMBUN_CD  = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.SALE_DT   = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.EXE_DT    = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.PUMBUN_CD
        ]]>        
    </query>

    <query name="SEL_BUY_BRAND_YEAR">        
     <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 --, X.VEN_CD                                AS VEN_CD
                 --, ''                                      AS VEN_NAME
                 --, X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 --, ''                                      AS REP_PUMBUN_NM
                 , X.PUMBUN_CD                             AS PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.PUMBUN_CD)     AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 --, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 --, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 --, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 --, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 --, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 --, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , 0                                       AS CMPR2_RANK_NO
                 --, 0                                       AS CMPR2_SALE_QTY
                 --, 0                                       AS CMPR2_TOT_SALE_AMT
                 --, 0                                       AS CMPR2_VAT_AMT
                 --, 0                                       AS CMPR2_REDU_AMT
                 , 0                                       AS CMPR2_NORM_SALE_AMT
                 --, 0                                       AS CMPR2_DC_AMT
                 --, 0                                       AS CMPR2_NET_SALE_AMT
                 --, 0                                       AS CMPR2_SALE_PROF_AMT
                 --, 0                                       AS CMPR2_CUST_CNT
                 --, 0                                       AS CMPR2_SAL_COST_PRC
                 --, 0                                       AS CMPR2_PLAN_SALE_TAMT
                 , 0                                       AS CMPR2_PLAN_NORM_SAMT
                 , 0                                       AS CMPR2_SALE_AVG_DAY
                 , 0                                       AS CMPR2_SALE_AVG_AREA
                 , 0                                       AS CMPR2_ACHIEVE_RATE
                 , 0                                       AS CMPR2_SALE_IRATE
                 , 0                                       AS CMPR2_SALE_AVG_DAY_RATE
                 , 0                                       AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , ''                                                AS VEN_CD
                         , ''                                                AS REP_PUMBUN_CD
                         , UA.PUMBUN_CD                                      AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 신장율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY             -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT         -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT              -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT             -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT        -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT               -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT         -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT        -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT             -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC         -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE, 0))               AS AREA_SIZE            -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT       -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT       -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY       --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT   --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT        --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT       --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT  --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT         --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT   --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT  --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT       --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC   --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD     = ?
                               AND A.SALE_DT   >= ?   --매출기간시작일
                               AND A.SALE_DT   <= ?   --매출기간종료일
                               AND B.STR_CD     = A.STR_CD
                               AND B.PUMBUN_CD  = A.PUMBUN_CD
                               AND C.PUMBUN_CD  = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.SALE_DT   = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.EXE_DT    = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.PUMBUN_CD
        ]]>        
    </query>
    <query name="SEL_SALE_BRAND_WEEK">        
     <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 --, X.VEN_CD                                AS VEN_CD
                 --, ''                                      AS VEN_NAME
                 --, X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 --, ''                                      AS REP_PUMBUN_NM
                 , X.PUMBUN_CD                             AS PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.PUMBUN_CD)     AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 --, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 --, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 --, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 --, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 --, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 --, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , X.CMPR2_RANK_NO                         AS CMPR2_RANK_NO
                 --, X.CMPR2_SALE_QTY                        AS CMPR2_SALE_QTY
                 --, X.CMPR2_TOT_SALE_AMT                    AS CMPR2_TOT_SALE_AMT
                 --, X.CMPR2_VAT_AMT                         AS CMPR2_VAT_AMT
                 --, X.CMPR2_REDU_AMT                        AS CMPR2_REDU_AMT
                 , X.CMPR2_NORM_SALE_AMT                   AS CMPR2_NORM_SALE_AMT
                 --, X.CMPR2_DC_AMT                          AS CMPR2_DC_AMT
                 --, X.CMPR2_NET_SALE_AMT                    AS CMPR2_NET_SALE_AMT
                 --, X.CMPR2_SALE_PROF_AMT                   AS CMPR2_SALE_PROF_AMT
                 --, X.CMPR2_CUST_CNT                        AS CMPR2_CUST_CNT
                 --, X.CMPR2_SAL_COST_PRC                    AS CMPR2_SAL_COST_PRC
                 --, X.CMPR2_PLAN_SALE_TAMT                  AS CMPR2_PLAN_SALE_TAMT
                 , X.CMPR2_PLAN_NORM_SAMT                  AS CMPR2_PLAN_NORM_SAMT
                 , X.CMPR2_SALE_AVG_DAY                    AS CMPR2_SALE_AVG_DAY
                 , X.CMPR2_SALE_AVG_AREA                   AS CMPR2_SALE_AVG_AREA
                 , X.CMPR2_ACHIEVE_RATE                    AS CMPR2_ACHIEVE_RATE
                 , X.CMPR2_SALE_IRATE                      AS CMPR2_SALE_IRATE
                 , X.CMPR2_SALE_AVG_DAY_RATE               AS CMPR2_SALE_AVG_DAY_RATE
                 , X.CMPR2_SALE_AVG_AREA_RATE              AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , ''                                                AS VEN_CD
                         , ''                                                AS REP_PUMBUN_CD
                         , UA.PUMBUN_CD                                      AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                         , RANK() OVER (ORDER BY SUM(UA.CMPR2_NORM_SALE_AMT) DESC) AS CMPR2_RANK_NO
                         , SUM(UA.CMPR2_SALE_QTY      )                      AS CMPR2_SALE_QTY
                         , SUM(UA.CMPR2_TOT_SALE_AMT  )                      AS CMPR2_TOT_SALE_AMT
                         , SUM(UA.CMPR2_VAT_AMT       )                      AS CMPR2_VAT_AMT
                         , SUM(UA.CMPR2_REDU_AMT      )                      AS CMPR2_REDU_AMT
                         , SUM(UA.CMPR2_NORM_SALE_AMT )                      AS CMPR2_NORM_SALE_AMT
                         , SUM(UA.CMPR2_DC_AMT        )                      AS CMPR2_DC_AMT
                         , SUM(UA.CMPR2_NET_SALE_AMT  )                      AS CMPR2_NET_SALE_AMT
                         , SUM(UA.CMPR2_SALE_PROF_AMT )                      AS CMPR2_SALE_PROF_AMT
                         , SUM(UA.CMPR2_CUST_CNT      )                      AS CMPR2_CUST_CNT
                         , SUM(UA.CMPR2_SAL_COST_PRC  )                      AS CMPR2_SAL_COST_PRC
                         , SUM(UA.CMPR2_PLAN_SALE_TAMT)                      AS CMPR2_PLAN_SALE_TAMT
                         , SUM(UA.CMPR2_PLAN_NORM_SAMT)                      AS CMPR2_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR2_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR2_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR2_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.CMPR2_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR2_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR2_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR2_NORM_SALE_AMT)-SUM(UA.CMPR2_NORM_SALE_AMT))/SUM(UA.CMPR2_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR2_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR2_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR2_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR2_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY            -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT        -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT             -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT            -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT       -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT              -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT        -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT       -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT            -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC        -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE,0))                AS AREA_SIZE           -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT      -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT      -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?   --매출기간시작일
                               AND A.SALE_DT  <= ?   --매출기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일1
                               AND A.SALE_DT  <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일1
                               AND A.EXE_DT   <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR2_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR2_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR2_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR2_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR2_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일2
                               AND A.SALE_DT  <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일2
                               AND A.EXE_DT   <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.PUMBUN_CD
        ]]>        
    </query>

    <query name="SEL_BUY_BRAND_WEEK">        
     <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 --, X.VEN_CD                                AS VEN_CD
                 --, ''                                      AS VEN_NAME
                 --, X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 --, ''                                      AS REP_PUMBUN_NM
                 , X.PUMBUN_CD                             AS PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.PUMBUN_CD)     AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 --, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 --, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 --, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 --, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 --, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 --, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , X.CMPR2_RANK_NO                         AS CMPR2_RANK_NO
                 --, X.CMPR2_SALE_QTY                        AS CMPR2_SALE_QTY
                 --, X.CMPR2_TOT_SALE_AMT                    AS CMPR2_TOT_SALE_AMT
                 --, X.CMPR2_VAT_AMT                         AS CMPR2_VAT_AMT
                 --, X.CMPR2_REDU_AMT                        AS CMPR2_REDU_AMT
                 , X.CMPR2_NORM_SALE_AMT                   AS CMPR2_NORM_SALE_AMT
                 --, X.CMPR2_DC_AMT                          AS CMPR2_DC_AMT
                 --, X.CMPR2_NET_SALE_AMT                    AS CMPR2_NET_SALE_AMT
                 --, X.CMPR2_SALE_PROF_AMT                   AS CMPR2_SALE_PROF_AMT
                 --, X.CMPR2_CUST_CNT                        AS CMPR2_CUST_CNT
                 --, X.CMPR2_SAL_COST_PRC                    AS CMPR2_SAL_COST_PRC
                 --, X.CMPR2_PLAN_SALE_TAMT                  AS CMPR2_PLAN_SALE_TAMT
                 , X.CMPR2_PLAN_NORM_SAMT                  AS CMPR2_PLAN_NORM_SAMT
                 , X.CMPR2_SALE_AVG_DAY                    AS CMPR2_SALE_AVG_DAY
                 , X.CMPR2_SALE_AVG_AREA                   AS CMPR2_SALE_AVG_AREA
                 , X.CMPR2_ACHIEVE_RATE                    AS CMPR2_ACHIEVE_RATE
                 , X.CMPR2_SALE_IRATE                      AS CMPR2_SALE_IRATE
                 , X.CMPR2_SALE_AVG_DAY_RATE               AS CMPR2_SALE_AVG_DAY_RATE
                 , X.CMPR2_SALE_AVG_AREA_RATE              AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , ''                                                AS VEN_CD
                         , ''                                                AS REP_PUMBUN_CD
                         , UA.PUMBUN_CD                                      AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                   AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                         , RANK() OVER (ORDER BY SUM(UA.CMPR2_NORM_SALE_AMT) DESC) AS CMPR2_RANK_NO
                         , SUM(UA.CMPR2_SALE_QTY      )                      AS CMPR2_SALE_QTY
                         , SUM(UA.CMPR2_TOT_SALE_AMT  )                      AS CMPR2_TOT_SALE_AMT
                         , SUM(UA.CMPR2_VAT_AMT       )                      AS CMPR2_VAT_AMT
                         , SUM(UA.CMPR2_REDU_AMT      )                      AS CMPR2_REDU_AMT
                         , SUM(UA.CMPR2_NORM_SALE_AMT )                      AS CMPR2_NORM_SALE_AMT
                         , SUM(UA.CMPR2_DC_AMT        )                      AS CMPR2_DC_AMT
                         , SUM(UA.CMPR2_NET_SALE_AMT  )                      AS CMPR2_NET_SALE_AMT
                         , SUM(UA.CMPR2_SALE_PROF_AMT )                      AS CMPR2_SALE_PROF_AMT
                         , SUM(UA.CMPR2_CUST_CNT      )                      AS CMPR2_CUST_CNT
                         , SUM(UA.CMPR2_SAL_COST_PRC  )                      AS CMPR2_SAL_COST_PRC
                         , SUM(UA.CMPR2_PLAN_SALE_TAMT)                      AS CMPR2_PLAN_SALE_TAMT
                         , SUM(UA.CMPR2_PLAN_NORM_SAMT)                      AS CMPR2_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR2_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR2_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR2_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.CMPR2_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR2_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR2_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR2_NORM_SALE_AMT)-SUM(UA.CMPR2_NORM_SALE_AMT))/SUM(UA.CMPR2_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR2_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR2_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR2_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR2_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY            -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT        -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT             -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT            -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT       -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT              -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT        -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT       -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT            -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC        -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE,0))                AS AREA_SIZE           -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT      -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT      -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?   --매출기간시작일
                               AND A.SALE_DT  <= ?   --매출기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일1
                               AND A.SALE_DT  <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일1
                               AND A.EXE_DT   <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR2_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR2_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR2_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR2_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR2_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일2
                               AND A.SALE_DT  <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일2
                               AND A.EXE_DT   <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.PUMBUN_CD
        ]]>        
    </query>
    
    
    <query name="SEL_SALE_VEN_BRAND_YEAR">        
     <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 , X.VEN_CD                                AS VEN_CD
                 , DPS.FN_GET_VEN_NAME(X.VEN_CD)           AS VEN_NAME
                 --, X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 --, ''                                      AS REP_PUMBUN_NM
                 , X.PUMBUN_CD                             AS PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.PUMBUN_CD)     AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 --, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 --, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 --, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 --, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 --, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 --, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , 0                                       AS CMPR2_RANK_NO
                 --, 0                                       AS CMPR2_SALE_QTY
                 --, 0                                       AS CMPR2_TOT_SALE_AMT
                 --, 0                                       AS CMPR2_VAT_AMT
                 --, 0                                       AS CMPR2_REDU_AMT
                 , 0                                       AS CMPR2_NORM_SALE_AMT
                 --, 0                                       AS CMPR2_DC_AMT
                 --, 0                                       AS CMPR2_NET_SALE_AMT
                 --, 0                                       AS CMPR2_SALE_PROF_AMT
                 --, 0                                       AS CMPR2_CUST_CNT
                 --, 0                                       AS CMPR2_SAL_COST_PRC
                 --, 0                                       AS CMPR2_PLAN_SALE_TAMT
                 , 0                                       AS CMPR2_PLAN_NORM_SAMT
                 , 0                                       AS CMPR2_SALE_AVG_DAY
                 , 0                                       AS CMPR2_SALE_AVG_AREA
                 , 0                                       AS CMPR2_ACHIEVE_RATE
                 , 0                                       AS CMPR2_SALE_IRATE
                 , 0                                       AS CMPR2_SALE_AVG_DAY_RATE
                 , 0                                       AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , UA.VEN_CD                                         AS VEN_CD
                         , ''                                                AS REP_PUMBUN_CD
                         , UA.PUMBUN_CD                                      AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                    AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY             -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT         -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT              -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT             -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT        -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT               -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT         -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT        -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT             -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC         -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE, 0))               AS AREA_SIZE            -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT       -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT       -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY       --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT   --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT        --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT       --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT  --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT         --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT   --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT  --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT       --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC   --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD     = ?
                               AND A.SALE_DT   >= ?   --매출기간시작일
                               AND A.SALE_DT   <= ?   --매출기간종료일
                               AND B.STR_CD     = A.STR_CD
                               AND B.PUMBUN_CD  = A.PUMBUN_CD
                               AND C.PUMBUN_CD  = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.SALE_DT   = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.EXE_DT    = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.VEN_CD
                            , UA.PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.VEN_CD
                    , X.PUMBUN_CD
        ]]>        
    </query>

    <query name="SEL_BUY_VEN_BRAND_YEAR">        
     <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 , X.VEN_CD                                AS VEN_CD
                 , DPS.FN_GET_VEN_NAME(X.VEN_CD)           AS VEN_NAME
                 --, X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 --, ''                                      AS REP_PUMBUN_NM
                 , X.PUMBUN_CD                             AS PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.PUMBUN_CD)     AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 --, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 --, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 --, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 --, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 --, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 --, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , 0                                       AS CMPR2_RANK_NO
                 --, 0                                       AS CMPR2_SALE_QTY
                 --, 0                                       AS CMPR2_TOT_SALE_AMT
                 --, 0                                       AS CMPR2_VAT_AMT
                 --, 0                                       AS CMPR2_REDU_AMT
                 , 0                                       AS CMPR2_NORM_SALE_AMT
                 --, 0                                       AS CMPR2_DC_AMT
                 --, 0                                       AS CMPR2_NET_SALE_AMT
                 --, 0                                       AS CMPR2_SALE_PROF_AMT
                 --, 0                                       AS CMPR2_CUST_CNT
                 --, 0                                       AS CMPR2_SAL_COST_PRC
                 --, 0                                       AS CMPR2_PLAN_SALE_TAMT
                 , 0                                       AS CMPR2_PLAN_NORM_SAMT
                 , 0                                       AS CMPR2_SALE_AVG_DAY
                 , 0                                       AS CMPR2_SALE_AVG_AREA
                 , 0                                       AS CMPR2_ACHIEVE_RATE
                 , 0                                       AS CMPR2_SALE_IRATE
                 , 0                                       AS CMPR2_SALE_AVG_DAY_RATE
                 , 0                                       AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , UA.VEN_CD                                         AS VEN_CD
                         , ''                                                AS REP_PUMBUN_CD
                         , UA.PUMBUN_CD                                      AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 신장율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY             -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT         -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT              -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT             -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT        -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT               -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT         -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT        -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT             -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC         -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE, 0))               AS AREA_SIZE            -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT       -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT       -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY       --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT   --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT        --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT       --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT  --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT         --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT   --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT  --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT       --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC   --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD     = ?
                               AND A.SALE_DT   >= ?   --매출기간시작일
                               AND A.SALE_DT   <= ?   --매출기간종료일
                               AND B.STR_CD     = A.STR_CD
                               AND B.PUMBUN_CD  = A.PUMBUN_CD
                               AND C.PUMBUN_CD  = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.SALE_DT   = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE           -- 매장크기합(㎡)
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PS_SCHEDULE C
                                 , DPS.PC_PBNMST D
                             WHERE C.STR_CD    = ?
                               AND C.SALE_DT  >= ?  --매출기간시작일
                               AND C.SALE_DT  <= ?  --매출기간종료일
                               AND A.STR_CD    = C.STR_CD
                               AND A.EXE_DT    = C.CMPR_DT
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.VEN_CD
                            , UA.PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.VEN_CD
                    , X.PUMBUN_CD
        ]]>        
    </query>
    <query name="SEL_SALE_VEN_BRAND_WEEK">        
     <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 , X.VEN_CD                                AS VEN_CD
                 , DPS.FN_GET_VEN_NAME(X.VEN_CD)           AS VEN_NAME
                 --, X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 --, ''                                      AS REP_PUMBUN_NM
                 , X.PUMBUN_CD                             AS PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.PUMBUN_CD)     AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 --, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 --, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 --, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 --, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 --, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 --, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , X.CMPR2_RANK_NO                         AS CMPR2_RANK_NO
                 --, X.CMPR2_SALE_QTY                        AS CMPR2_SALE_QTY
                 --, X.CMPR2_TOT_SALE_AMT                    AS CMPR2_TOT_SALE_AMT
                 --, X.CMPR2_VAT_AMT                         AS CMPR2_VAT_AMT
                 --, X.CMPR2_REDU_AMT                        AS CMPR2_REDU_AMT
                 , X.CMPR2_NORM_SALE_AMT                   AS CMPR2_NORM_SALE_AMT
                 --, X.CMPR2_DC_AMT                          AS CMPR2_DC_AMT
                 --, X.CMPR2_NET_SALE_AMT                    AS CMPR2_NET_SALE_AMT
                 --, X.CMPR2_SALE_PROF_AMT                   AS CMPR2_SALE_PROF_AMT
                 --, X.CMPR2_CUST_CNT                        AS CMPR2_CUST_CNT
                 --, X.CMPR2_SAL_COST_PRC                    AS CMPR2_SAL_COST_PRC
                 --, X.CMPR2_PLAN_SALE_TAMT                  AS CMPR2_PLAN_SALE_TAMT
                 , X.CMPR2_PLAN_NORM_SAMT                  AS CMPR2_PLAN_NORM_SAMT
                 , X.CMPR2_SALE_AVG_DAY                    AS CMPR2_SALE_AVG_DAY
                 , X.CMPR2_SALE_AVG_AREA                   AS CMPR2_SALE_AVG_AREA
                 , X.CMPR2_ACHIEVE_RATE                    AS CMPR2_ACHIEVE_RATE
                 , X.CMPR2_SALE_IRATE                      AS CMPR2_SALE_IRATE
                 , X.CMPR2_SALE_AVG_DAY_RATE               AS CMPR2_SALE_AVG_DAY_RATE
                 , X.CMPR2_SALE_AVG_AREA_RATE              AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , UA.VEN_CD                                         AS VEN_CD
                         , ''                                                AS REP_PUMBUN_CD
                         , UA.PUMBUN_CD                                      AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                         , RANK() OVER (ORDER BY SUM(UA.CMPR2_NORM_SALE_AMT) DESC) AS CMPR2_RANK_NO
                         , SUM(UA.CMPR2_SALE_QTY      )                      AS CMPR2_SALE_QTY
                         , SUM(UA.CMPR2_TOT_SALE_AMT  )                      AS CMPR2_TOT_SALE_AMT
                         , SUM(UA.CMPR2_VAT_AMT       )                      AS CMPR2_VAT_AMT
                         , SUM(UA.CMPR2_REDU_AMT      )                      AS CMPR2_REDU_AMT
                         , SUM(UA.CMPR2_NORM_SALE_AMT )                      AS CMPR2_NORM_SALE_AMT
                         , SUM(UA.CMPR2_DC_AMT        )                      AS CMPR2_DC_AMT
                         , SUM(UA.CMPR2_NET_SALE_AMT  )                      AS CMPR2_NET_SALE_AMT
                         , SUM(UA.CMPR2_SALE_PROF_AMT )                      AS CMPR2_SALE_PROF_AMT
                         , SUM(UA.CMPR2_CUST_CNT      )                      AS CMPR2_CUST_CNT
                         , SUM(UA.CMPR2_SAL_COST_PRC  )                      AS CMPR2_SAL_COST_PRC
                         , SUM(UA.CMPR2_PLAN_SALE_TAMT)                      AS CMPR2_PLAN_SALE_TAMT
                         , SUM(UA.CMPR2_PLAN_NORM_SAMT)                      AS CMPR2_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR2_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR2_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR2_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.CMPR2_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR2_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR2_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR2_NORM_SALE_AMT)-SUM(UA.CMPR2_NORM_SALE_AMT))/SUM(UA.CMPR2_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR2_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR2_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR2_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR2_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY            -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT        -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT             -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT            -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT       -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT              -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT        -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT       -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT            -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC        -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE,0))                AS AREA_SIZE           -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT      -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT      -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?   --매출기간시작일
                               AND A.SALE_DT  <= ?   --매출기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일1
                               AND A.SALE_DT  <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일1
                               AND A.EXE_DT   <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR2_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR2_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR2_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR2_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR2_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일2
                               AND A.SALE_DT  <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.SALE_ORG_CD, 3, 2)            AS DEPT_CD
                                 , SUBSTR(B.SALE_ORG_CD, 5, 2)            AS TEAM_CD
                                 , SUBSTR(B.SALE_ORG_CD, 7, 2)            AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일2
                               AND A.EXE_DT   <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.SALE_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.VEN_CD
                            , UA.PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.VEN_CD
                    , X.PUMBUN_CD
        ]]>        
    </query>

    <query name="SEL_BUY_VEN_BRAND_WEEK">        
     <![CDATA[
            SELECT X.STR_CD                                AS STR_CD
                 , X.RANK_NO                               AS RANK_NO
                 , X.VEN_CD                                AS VEN_CD
                 , DPS.FN_GET_VEN_NAME(X.VEN_CD)           AS VEN_NAME
                 --, X.REP_PUMBUN_CD                         AS REP_PUMBUN_CD
                 --, ''                                      AS REP_PUMBUN_NM
                 , X.PUMBUN_CD                             AS PUMBUN_CD
                 , DPS.FN_GET_PUMBUN_NAME(X.PUMBUN_CD)     AS PUMBUN_NM
                 --, X.SALE_QTY                              AS SALE_QTY
                 --, X.TOT_SALE_AMT                          AS TOT_SALE_AMT
                 --, X.VAT_AMT                               AS VAT_AMT
                 --, X.REDU_AMT                              AS REDU_AMT
                 , X.NORM_SALE_AMT                         AS NORM_SALE_AMT
                 --, X.DC_AMT                                AS DC_AMT
                 --, X.NET_SALE_AMT                          AS NET_SALE_AMT
                 --, X.SALE_PROF_AMT                         AS SALE_PROF_AMT
                 --, X.CUST_CNT                              AS CUST_CNT
                 --, X.SAL_COST_PRC                          AS SAL_COST_PRC
                 --, X.PLAN_SALE_TAMT                        AS PLAN_SALE_TAMT
                 , X.PLAN_NORM_SAMT                        AS PLAN_NORM_SAMT
                 , X.ACHIEVE_RATE                          AS ACHIEVE_RATE
                 , X.SALE_AVG_DAY                          AS SALE_AVG_DAY
                 , X.SALE_AVG_AREA                         AS SALE_AVG_AREA
                 , X.CMPR1_RANK_NO                         AS CMPR1_RANK_NO
                 --, X.CMPR1_SALE_QTY                        AS CMPR1_SALE_QTY
                 --, X.CMPR1_TOT_SALE_AMT                    AS CMPR1_TOT_SALE_AMT
                 --, X.CMPR1_VAT_AMT                         AS CMPR1_VAT_AMT
                 --, X.CMPR1_REDU_AMT                        AS CMPR1_REDU_AMT
                 , X.CMPR1_NORM_SALE_AMT                   AS CMPR1_NORM_SALE_AMT
                 --, X.CMPR1_DC_AMT                          AS CMPR1_DC_AMT
                 --, X.CMPR1_NET_SALE_AMT                    AS CMPR1_NET_SALE_AMT
                 --, X.CMPR1_SALE_PROF_AMT                   AS CMPR1_SALE_PROF_AMT
                 --, X.CMPR1_CUST_CNT                        AS CMPR1_CUST_CNT
                 --, X.CMPR1_SAL_COST_PRC                    AS CMPR1_SAL_COST_PRC
                 --, X.CMPR1_PLAN_SALE_TAMT                  AS CMPR1_PLAN_SALE_TAMT
                 , X.CMPR1_PLAN_NORM_SAMT                  AS CMPR1_PLAN_NORM_SAMT
                 , X.CMPR1_SALE_AVG_DAY                    AS CMPR1_SALE_AVG_DAY
                 , X.CMPR1_SALE_AVG_AREA                   AS CMPR1_SALE_AVG_AREA
                 , X.CMPR1_ACHIEVE_RATE                    AS CMPR1_ACHIEVE_RATE
                 , X.CMPR1_SALE_IRATE                      AS CMPR1_SALE_IRATE
                 , X.CMPR1_SALE_AVG_DAY_RATE               AS CMPR1_SALE_AVG_DAY_RATE
                 , X.CMPR1_SALE_AVG_AREA_RATE              AS CMPR1_SALE_AVG_AREA_RATE
                 , X.CMPR2_RANK_NO                         AS CMPR2_RANK_NO
                 --, X.CMPR2_SALE_QTY                        AS CMPR2_SALE_QTY
                 --, X.CMPR2_TOT_SALE_AMT                    AS CMPR2_TOT_SALE_AMT
                 --, X.CMPR2_VAT_AMT                         AS CMPR2_VAT_AMT
                 --, X.CMPR2_REDU_AMT                        AS CMPR2_REDU_AMT
                 , X.CMPR2_NORM_SALE_AMT                   AS CMPR2_NORM_SALE_AMT
                 --, X.CMPR2_DC_AMT                          AS CMPR2_DC_AMT
                 --, X.CMPR2_NET_SALE_AMT                    AS CMPR2_NET_SALE_AMT
                 --, X.CMPR2_SALE_PROF_AMT                   AS CMPR2_SALE_PROF_AMT
                 --, X.CMPR2_CUST_CNT                        AS CMPR2_CUST_CNT
                 --, X.CMPR2_SAL_COST_PRC                    AS CMPR2_SAL_COST_PRC
                 --, X.CMPR2_PLAN_SALE_TAMT                  AS CMPR2_PLAN_SALE_TAMT
                 , X.CMPR2_PLAN_NORM_SAMT                  AS CMPR2_PLAN_NORM_SAMT
                 , X.CMPR2_SALE_AVG_DAY                    AS CMPR2_SALE_AVG_DAY
                 , X.CMPR2_SALE_AVG_AREA                   AS CMPR2_SALE_AVG_AREA
                 , X.CMPR2_ACHIEVE_RATE                    AS CMPR2_ACHIEVE_RATE
                 , X.CMPR2_SALE_IRATE                      AS CMPR2_SALE_IRATE
                 , X.CMPR2_SALE_AVG_DAY_RATE               AS CMPR2_SALE_AVG_DAY_RATE
                 , X.CMPR2_SALE_AVG_AREA_RATE              AS CMPR2_SALE_AVG_AREA_RATE
              FROM (
                    SELECT UA.STR_CD                                         AS STR_CD
                         , RANK() OVER (ORDER BY SUM(UA.NORM_SALE_AMT) DESC) AS RANK_NO
                         , UA.VEN_CD                                         AS VEN_CD
                         , ''                                                AS REP_PUMBUN_CD
                         , UA.PUMBUN_CD                                      AS PUMBUN_CD
                         , SUM(UA.SALE_QTY           )                       AS SALE_QTY
                         , SUM(UA.TOT_SALE_AMT       )                       AS TOT_SALE_AMT
                         , SUM(UA.VAT_AMT            )                       AS VAT_AMT
                         , SUM(UA.REDU_AMT           )                       AS REDU_AMT
                         , SUM(UA.NORM_SALE_AMT      )                       AS NORM_SALE_AMT
                         , SUM(UA.DC_AMT             )                       AS DC_AMT
                         , SUM(UA.NET_SALE_AMT       )                       AS NET_SALE_AMT
                         , SUM(UA.SALE_PROF_AMT      )                       AS SALE_PROF_AMT
                         , SUM(UA.CUST_CNT           )                       AS CUST_CNT
                         , SUM(UA.SAL_COST_PRC       )                       AS SAL_COST_PRC
                         , SUM(UA.PLAN_SALE_TAMT     )                       AS PLAN_SALE_TAMT
                         , SUM(UA.PLAN_NORM_SAMT     )                       AS PLAN_NORM_SAMT
                         , (CASE WHEN SUM(UA.PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.PLAN_NORM_SAMT))*100 
                            END)                                             AS ACHIEVE_RATE        -- 달성율
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS SALE_AVG_DAY        -- 일평균 매출
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                             ELSE (SUM(UA.NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) END) AS SALE_AVG_AREA   -- ㎡ 매출
                         , RANK() OVER (ORDER BY SUM(UA.CMPR1_NORM_SALE_AMT) DESC) AS CMPR1_RANK_NO
                         , SUM(UA.CMPR1_SALE_QTY      )                      AS CMPR1_SALE_QTY
                         , SUM(UA.CMPR1_TOT_SALE_AMT  )                      AS CMPR1_TOT_SALE_AMT
                         , SUM(UA.CMPR1_VAT_AMT       )                      AS CMPR1_VAT_AMT
                         , SUM(UA.CMPR1_REDU_AMT      )                      AS CMPR1_REDU_AMT
                         , SUM(UA.CMPR1_NORM_SALE_AMT )                      AS CMPR1_NORM_SALE_AMT
                         , SUM(UA.CMPR1_DC_AMT        )                      AS CMPR1_DC_AMT
                         , SUM(UA.CMPR1_NET_SALE_AMT  )                      AS CMPR1_NET_SALE_AMT
                         , SUM(UA.CMPR1_SALE_PROF_AMT )                      AS CMPR1_SALE_PROF_AMT
                         , SUM(UA.CMPR1_CUST_CNT      )                      AS CMPR1_CUST_CNT
                         , SUM(UA.CMPR1_SAL_COST_PRC  )                      AS CMPR1_SAL_COST_PRC
                         , SUM(UA.CMPR1_PLAN_SALE_TAMT)                      AS CMPR1_PLAN_SALE_TAMT
                         , SUM(UA.CMPR1_PLAN_NORM_SAMT)                      AS CMPR1_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR1_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR1_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR1_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR1_NORM_SALE_AMT)/SUM(UA.CMPR1_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR1_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR1_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR1_NORM_SALE_AMT)-SUM(UA.CMPR1_NORM_SALE_AMT))/SUM(UA.CMPR1_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR1_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR1_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR1_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR1_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR1_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1

                         , RANK() OVER (ORDER BY SUM(UA.CMPR2_NORM_SALE_AMT) DESC) AS CMPR2_RANK_NO
                         , SUM(UA.CMPR2_SALE_QTY      )                      AS CMPR2_SALE_QTY
                         , SUM(UA.CMPR2_TOT_SALE_AMT  )                      AS CMPR2_TOT_SALE_AMT
                         , SUM(UA.CMPR2_VAT_AMT       )                      AS CMPR2_VAT_AMT
                         , SUM(UA.CMPR2_REDU_AMT      )                      AS CMPR2_REDU_AMT
                         , SUM(UA.CMPR2_NORM_SALE_AMT )                      AS CMPR2_NORM_SALE_AMT
                         , SUM(UA.CMPR2_DC_AMT        )                      AS CMPR2_DC_AMT
                         , SUM(UA.CMPR2_NET_SALE_AMT  )                      AS CMPR2_NET_SALE_AMT
                         , SUM(UA.CMPR2_SALE_PROF_AMT )                      AS CMPR2_SALE_PROF_AMT
                         , SUM(UA.CMPR2_CUST_CNT      )                      AS CMPR2_CUST_CNT
                         , SUM(UA.CMPR2_SAL_COST_PRC  )                      AS CMPR2_SAL_COST_PRC
                         , SUM(UA.CMPR2_PLAN_SALE_TAMT)                      AS CMPR2_PLAN_SALE_TAMT
                         , SUM(UA.CMPR2_PLAN_NORM_SAMT)                      AS CMPR2_PLAN_NORM_SAMT
                         , (CASE WHEN (TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD')) <= 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/(TO_DATE(?,'YYYYMMDD')+1-TO_DATE(?,'YYYYMMDD'))) 
                            END)                                             AS CMPR2_SALE_AVG_DAY       -- 일평균판매금액
                         , (CASE WHEN SUM(UA.AREA_SIZE) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.AREA_SIZE)) 
                            END)                                             AS CMPR2_SALE_AVG_AREA      -- ㎡ 당매출
                         , (CASE WHEN SUM(UA.CMPR2_PLAN_NORM_SAMT) = 0 THEN 0
                                 ELSE (SUM(UA.CMPR2_NORM_SALE_AMT)/SUM(UA.CMPR2_PLAN_NORM_SAMT)*100) 
                            END)                                             AS CMPR2_ACHIEVE_RATE       -- 달성율
                         , (CASE WHEN SUM(UA.CMPR2_NORM_SALE_AMT)  = 0 THEN 0
                                 ELSE  (SUM(UA.CMPR2_NORM_SALE_AMT)-SUM(UA.CMPR2_NORM_SALE_AMT))/SUM(UA.CMPR2_NORM_SALE_AMT)*100 
                            END)                                             AS CMPR2_SALE_IRATE         -- 신장율
                         , (CASE WHEN SUM(NVL(UA.CMPR2_NORM_SALE_AMT, 0)) = 0 THEN 0
                                 ELSE
                                     ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                                     )
                                     / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / (TO_DATE(?)+1 - TO_DATE(?)))
                            END)                                             AS CMPR2_SALE_AVG_DAY_RATE  -- 일평균 대비율1
				                 , (CASE WHEN  SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) = 0 OR SUM(NVL(UA.AREA_SIZE, 0)) = 0  THEN 0
				                         ELSE
				                           ( (SUM(NVL(UA.NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           - (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                           )
				                           / (SUM(NVL(UA.CMPR2_NORM_SALE_AMT,0)) / SUM(NVL(UA.AREA_SIZE, 0)))
				                    END)                                                  AS CMPR2_SALE_AVG_AREA_RATE -- ㎡ 당매출 대비율1
                      FROM (
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD                               AS VEN_CD
                                 , A.PUMBUN_CD                            AS PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , SUM(A.SALE_QTY)                        AS SALE_QTY            -- 판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS TOT_SALE_AMT        -- 총매출금액
                                 , SUM(A.VAT_AMT)                         AS VAT_AMT             -- 부가세
                                 , SUM(A.REDU_AMT)                        AS REDU_AMT            -- 할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS NORM_SALE_AMT       -- 정상매출금액
                                 , SUM(A.DC_AMT)                          AS DC_AMT              -- 에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS NET_SALE_AMT        -- 순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS SALE_PROF_AMT       -- 매출이익액
                                 , SUM(A.CUST_CNT)                        AS CUST_CNT            -- 객수
                                 , SUM(A.SAL_COST_PRC)                    AS SAL_COST_PRC        -- 판매원가
                                 , SUM(NVL(B.AREA_SIZE,0))                AS AREA_SIZE           -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT      -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT      -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?   --매출기간시작일
                               AND A.SALE_DT  <= ?   --매출기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , C.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '매출일'                               AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS PLAN_SALE_TAMT -- 매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST C
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?   --매출계획기간시작일
                               AND A.EXE_DT   <= ?   --매출계획기간종료일
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND C.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, C.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR1_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR1_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR1_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR1_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR1_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일1
                               AND A.SALE_DT  <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일1'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일1
                               AND A.EXE_DT   <= ?  --대비기간종료일1
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , A.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.SALE_DT                              AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , SUM(A.SALE_QTY)                        AS CMPR2_SALE_QTY      --  대비판매수량
                                 , SUM(A.TOT_SALE_AMT)                    AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , SUM(A.VAT_AMT)                         AS CMPR2_VAT_AMT       --  대비부가세
                                 , SUM(A.REDU_AMT)                        AS CMPR2_REDU_AMT      --  대비할인금액
                                 , SUM(A.NORM_SALE_AMT)                   AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , SUM(A.DC_AMT)                          AS CMPR2_DC_AMT        --  대비에누리금액
                                 , SUM(A.NET_SALE_AMT)                    AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , SUM(A.SALE_PROF_AMT)                   AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , SUM(A.CUST_CNT)                        AS CMPR2_CUST_CNT      --  대비객수
                                 , SUM(A.SAL_COST_PRC)                    AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_DAYPBN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.SALE_DT  >= ?  --대비기간시작일2
                               AND A.SALE_DT  <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, A.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.SALE_DT
                            UNION ALL
                            SELECT A.STR_CD
                                 , SUBSTR(B.BUY_ORG_CD, 3, 2)             AS DEPT_CD
                                 , SUBSTR(B.BUY_ORG_CD, 5, 2)             AS TEAM_CD
                                 , SUBSTR(B.BUY_ORG_CD, 7, 2)             AS PC_CD
                                 , B.VEN_CD
                                 , A.PUMBUN_CD
                                 , D.REP_PUMBUN_CD                        AS REP_PUMBUN_CD
                                 , '대비일2'                              AS GUBUN
                                 , A.EXE_DT                               AS SALE_DT
                                 , 0                                      AS SALE_QTY      -- 판매수량
                                 , 0                                      AS TOT_SALE_AMT  -- 총매출금액
                                 , 0                                      AS VAT_AMT       -- 부가세
                                 , 0                                      AS REDU_AMT      -- 할인금액
                                 , 0                                      AS NORM_SALE_AMT -- 정상매출금액
                                 , 0                                      AS DC_AMT        -- 에누리금액
                                 , 0                                      AS NET_SALE_AMT  -- 순매출금액
                                 , 0                                      AS SALE_PROF_AMT -- 매출이익액
                                 , 0                                      AS CUST_CNT      -- 객수
                                 , 0                                      AS SAL_COST_PRC  -- 판매원가
                                 , 0                                      AS AREA_SIZE     -- 매장면적
                                 , 0                                      AS PLAN_SALE_TAMT -- 매출계획
                                 , 0                                      AS PLAN_NORM_SAMT -- 매출계획(정상)
                                 , 0                                      AS CMPR1_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR1_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR1_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR1_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR1_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR1_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR1_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR1_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR1_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR1_SAL_COST_PRC  --  대비판매원가
                                 , 0                                      AS CMPR1_PLAN_SALE_TAMT -- 대비매출계획
                                 , 0                                      AS CMPR1_PLAN_NORM_SAMT -- 대비매출계획(정상)
                                 , 0                                      AS CMPR2_SALE_QTY      --  대비판매수량
                                 , 0                                      AS CMPR2_TOT_SALE_AMT  --  대비총매출금액
                                 , 0                                      AS CMPR2_VAT_AMT       --  대비부가세
                                 , 0                                      AS CMPR2_REDU_AMT      --  대비할인금액
                                 , 0                                      AS CMPR2_NORM_SALE_AMT --  대비정상매출금액
                                 , 0                                      AS CMPR2_DC_AMT        --  대비에누리금액
                                 , 0                                      AS CMPR2_NET_SALE_AMT  --  대비순매출금액
                                 , 0                                      AS CMPR2_SALE_PROF_AMT --  대비매출이익액
                                 , 0                                      AS CMPR2_CUST_CNT      --  대비객수
                                 , 0                                      AS CMPR2_SAL_COST_PRC  --  대비판매원가
                                 , SUM(A.ORIGIN_SALE_TAMT)                AS CMPR2_PLAN_SALE_TAMT -- 대비매출계획
                                 , SUM(A.ORIGIN_NORM_SAMT)                AS CMPR2_PLAN_NORM_SAMT -- 대비매출계획(정상)
                              FROM DPS.PS_ACTPUMBUN A
                                 , DPS.PC_STRPBN B
                                 , DPS.PC_PBNMST D
                             WHERE A.STR_CD    = ?
                               AND A.EXE_DT   >= ?  --대비기간시작일2
                               AND A.EXE_DT   <= ?  --대비기간종료일2
                               AND B.STR_CD    = A.STR_CD
                               AND B.PUMBUN_CD = A.PUMBUN_CD
                               AND D.PUMBUN_CD = A.PUMBUN_CD
                             GROUP BY A.STR_CD, B.BUY_ORG_CD, B.VEN_CD, A.PUMBUN_CD, D.REP_PUMBUN_CD, A.EXE_DT
                           ) UA
                     WHERE UA.STR_CD = ?
                       AND UA.DEPT_CD LIKE ?||'%'
                       AND UA.TEAM_CD LIKE ?||'%'
                       AND UA.PC_CD   LIKE ?||'%'
                     GROUP BY UA.STR_CD
                            , UA.VEN_CD
                            , UA.PUMBUN_CD
                   ) X
             WHERE X.RANK_NO <= ?
             ORDER BY X.STR_CD
                    , X.RANK_NO
                    , X.VEN_CD
                    , X.PUMBUN_CD
        ]]>        
    </query>
    
    <query name="SEL_CMPRDT_S">       
        <![CDATA[
            SELECT CMPR_DT                
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>        
    </query>
    
    <query name="SEL_CMPRDT_E">       
        <![CDATA[
            SELECT CMPR_DT                
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>        
    </query>

     <query name="SEARCH_CMPR_DATE">
        <![CDATA[
          SELECT NVL(MAX(CMPR_DT), TO_CHAR(ADD_MONTHS(?, -12),'YYYYMMDD')) AS CMPR_DT
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>    
    </query>
    
     <query name="SEARCH_CMPR_DATE_OLD">
        <![CDATA[
          SELECT NVL(MAX(CMPR_DT), TO_CHAR(TO_DATE(?, 'YYYYMMDD') - 354, 'YYYYMMDD')) AS CMPR_DT
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>    
    </query>
    
     <query name="SEARCH_YEAR_CMPR_DATE_S1">
        <![CDATA[
          SELECT NVL(MAX(CMPR_DT), TO_CHAR(ADD_MONTHS(SYSDATE, -12),'YYYYMMDD')) AS CMPR_DT
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>    
    </query>

     <query name="SEARCH_YEAR_CMPR_DATE_E1">
        <![CDATA[
          SELECT NVL(MAX(CMPR_DT), TO_CHAR(ADD_MONTHS(SYSDATE, -12),'YYYYMMDD')) AS CMPR_DT
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>    
    </query>

     <query name="SEARCH_YEAR_CMPR_DATE_S2">
        <![CDATA[
          SELECT NVL(MAX(CMPR_DT), TO_CHAR(ADD_MONTHS(SYSDATE, -12),'YYYYMMDD')) AS CMPR_DT
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = (SELECT NVL(MAX(CMPR_DT), TO_CHAR(ADD_MONTHS(SYSDATE, -12),'YYYYMMDD'))
 				               FROM DPS.PS_SCHEDULE
 				              WHERE STR_CD  = ?
				                AND SALE_DT = ?)

        ]]>    
    </query>

     <query name="SEARCH_YEAR_CMPR_DATE_E2">
        <![CDATA[
          SELECT NVL(MAX(CMPR_DT), TO_CHAR(ADD_MONTHS(SYSDATE, -12),'YYYYMMDD')) AS CMPR_DT
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = (SELECT NVL(MAX(CMPR_DT), TO_CHAR(ADD_MONTHS(SYSDATE, -12),'YYYYMMDD'))
 				               FROM DPS.PS_SCHEDULE
 				              WHERE STR_CD  = ?
				                AND SALE_DT = ?)
        ]]>    
    </query>

     <query name="SEARCH_WEEK_CMPR_DATE_S1">
        <![CDATA[
          SELECT TO_CHAR(TO_DATE(?)- 7),'YYYYMMDD')) AS CMPR_DT
              FROM DUAL
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>    
    </query>

     <query name="SEARCH_WEEK_CMPR_DATE_E1">
        <![CDATA[
          SELECT NVL(MAX(CMPR_DT), TO_CHAR(TO_DATE(?, 'YYYYMMDD') - 354, 'YYYYMMDD')) AS CMPR_DT
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>    
    </query>

     <query name="SEARCH_WEEK_CMPR_DATE_S2">
        <![CDATA[
          SELECT NVL(MAX(CMPR_DT), TO_CHAR(TO_DATE(?, 'YYYYMMDD') - 354, 'YYYYMMDD')) AS CMPR_DT
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>    
    </query>

     <query name="SEARCH_WEEK_CMPR_DATE_E2">
        <![CDATA[
          SELECT NVL(MAX(CMPR_DT), TO_CHAR(TO_DATE(?, 'YYYYMMDD') - 354, 'YYYYMMDD')) AS CMPR_DT
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>    
    </query>
</service>