<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 박종은
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2011.04.08
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/psal458.ps">

    <gauce name="H_SEL_MASTER"> 
        <column colName="PUMMOK_CD"                  colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBOK_NM"                  colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PBN_CNT"                    colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DAY_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACC_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT"	                 colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="UNIT"    	          	  	 colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_MASTER2"> 
        <column colName="PUMMOK_CD"                  colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBOK_NM"                  colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ONLINE_PC"                  colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD"                  colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NM"                  colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DAY_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACC_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT"	                 colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="UNIT"    	          	  	 colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
    </gauce>
    
    <gauce name="H_SEL_MASTER3"> 
        <column colName="PUMMOK_CD"                  colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBOK_NM"                  colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_CD"                     colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_NM"                     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DAY_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACC_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT"	                 colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="UNIT"    	          	  	 colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
    </gauce>
    
    <gauce name="H_SEL_MASTER4"> 
        <column colName="PUMMOK_CD"                  colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBOK_NM"                  colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_CD"                     colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_NM"                     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DAY_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACC_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT"	                 colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="UNIT"    	          	  	 colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_MASTER5">
    	<column colName="ORG_CD"	                 colType="TB_STRING"      size="20"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_NM"	                 colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ONLINE_PC"                  colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="PUMBUN_CD"                  colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NM"                  colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DAY_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACC_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT"	                 colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="UNIT"    	          	  	 colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_MASTER6"> 
        <column colName="ORG_CD"                     colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_NM"                     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ONLINE_PC"                  colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DAY_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACC_SALE_AMT"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT"	                 colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="UNIT"    	          	  	 colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <!-- 쿼리는 전부 대문자 -->
    
    
    <query name="SEL_SALE_MALL">
        <![CDATA[
            SELECT A.PUMMOK_CD                 AS PUMMOK_CD
			     , MAX(B.PUMMOK_NAME)          AS PUMMOK_NM
			     , COUNT(DISTINCT A.PUMBUN_CD) AS PBN_CNT
			     , SUM(CASE WHEN A.SALE_DT = ? THEN NVL(A.TOT_SALE_AMT,0) ELSE 0 END ) AS DAY_SALE_AMT
			     , SUM(NVL(A.TOT_SALE_AMT,0))  AS ACC_SALE_AMT
			     , SUM(SALE_QTY) CUST_CNT
			     , ? 						   AS UNIT
			  FROM DPS.PS_DAYPBN A
			     , DPS.PC_PMKMST B
			 WHERE A.SALE_DT >= ?
			   AND A.SALE_DT <= ?
			   AND A.STR_CD   = ? 
			   AND A.PUMMOK_CD IN (SELECT COMM_CODE
			                         FROM COM.TC_COMMCODE C
			                        WHERE C.SYS_PART = 'D'
			                          AND C.COMM_PART = 'P613'
			                          AND C.USE_YN = 'Y'
			                      )
			   AND A.PUMBUN_CD IN (SELECT PUMBUN_CD FROM DPS.PC_PBNMST 
                                   WHERE PUMBUN_CD LIKE ? ||'%' AND PUMBUN_NAME LIKE '%'||?||'%')
			   AND B.PUMMOK_CD = A.PUMMOK_CD
			 GROUP BY A.PUMMOK_CD
			 ORDER BY A.PUMMOK_CD
        ]]>    
    </query>      
    
    <query name="SEL_SALE_BRAND">
        <![CDATA[
            SELECT A.PUMMOK_CD                 AS PUMMOK_CD
			     , MAX(B.PUMMOK_NAME)          AS PUMMOK_NM
			     , COM.FN_GET_COMM_NAME('D','PS34',MAX(D.SAP_ORG_CD))           AS ONLINE_PC
			     , A.PUMBUN_CD                 AS PUMBUN_CD
			     , MAX(C.PUMBUN_NAME)          AS PUMBUN_NM
			     , SUM(CASE WHEN A.SALE_DT = ? THEN NVL(A.TOT_SALE_AMT,0) ELSE 0 END ) AS DAY_SALE_AMT
			     , SUM(NVL(A.TOT_SALE_AMT,0))  AS ACC_SALE_AMT
			     , SUM(SALE_QTY) CUST_CNT
			     , ? 						   AS UNIT
			  FROM DPS.PS_DAYPBN A
			     , DPS.PC_PMKMST B
			     , DPS.PC_STRPBN C
			     , DPS.PC_ORGMST D
			 WHERE A.SALE_DT >= ?
			   AND A.SALE_DT <= ?
			   AND A.STR_CD   = ? 
			   AND A.PUMMOK_CD IN (SELECT COMM_CODE
			                         FROM COM.TC_COMMCODE C
			                        WHERE C.SYS_PART = 'D'
			                          AND C.COMM_PART = 'P613'
			                          AND C.USE_YN = 'Y'
			                      )
			   AND B.PUMMOK_CD = A.PUMMOK_CD
			   AND C.STR_CD    = A.STR_CD
			   AND C.PUMBUN_CD = A.PUMBUN_CD
			   AND C.SALE_ORG_CD = D.ORG_CD
			   AND A.PUMBUN_CD IN (SELECT PUMBUN_CD FROM DPS.PC_PBNMST 
                                   WHERE PUMBUN_CD LIKE ? ||'%' AND PUMBUN_NAME LIKE '%'||?||'%')
			 GROUP BY A.PUMMOK_CD, A.PUMBUN_CD
			 ORDER BY A.PUMMOK_CD, A.PUMBUN_CD
        ]]>    
    </query>
    
    <query name="SEL_SALE_PC">
        <![CDATA[
            SELECT A.PUMMOK_CD                      AS PUMMOK_CD
			     , MAX(B.PUMMOK_NAME)               AS PUMMOK_NM
			     , SUBSTR(C.SALE_ORG_CD,1,8)||'00'  AS ORG_CD
			     , MAX(D.ORG_SHORT_NAME)            AS ORG_NM
			     , SUM(CASE WHEN A.SALE_DT = ? THEN NVL(A.TOT_SALE_AMT,0) ELSE 0 END ) AS DAY_SALE_AMT
			     , SUM(NVL(A.TOT_SALE_AMT,0)) 	    AS ACC_SALE_AMT
			     , SUM(SALE_QTY) CUST_CNT
			     , ? 						   		AS UNIT
			  FROM DPS.PS_DAYPBN A
			     , DPS.PC_PMKMST B
			     , DPS.PC_STRPBN C
			     , DPS.PC_ORGMST D
			 WHERE A.SALE_DT >= ?
			   AND A.SALE_DT <= ?
			   AND A.STR_CD   = ?
			   AND A.PUMMOK_CD IN (SELECT COMM_CODE
			                         FROM COM.TC_COMMCODE C
			                        WHERE C.SYS_PART = 'D'
			                          AND C.COMM_PART = 'P613'
			                          AND C.USE_YN = 'Y'
			                      )
			   AND B.PUMMOK_CD = A.PUMMOK_CD
			   AND C.STR_CD    = A.STR_CD
			   AND C.PUMBUN_CD = A.PUMBUN_CD
			   AND D.ORG_CD    = SUBSTR(C.SALE_ORG_CD,1,8)||'00'
			   AND A.PUMBUN_CD IN (SELECT PUMBUN_CD FROM DPS.PC_PBNMST 
                                   WHERE PUMBUN_CD LIKE ? ||'%' AND PUMBUN_NAME LIKE '%'||?||'%')
			 GROUP BY A.PUMMOK_CD, SUBSTR(C.SALE_ORG_CD,1,8)
			 ORDER BY A.PUMMOK_CD, SUBSTR(C.SALE_ORG_CD,1,8)
        ]]>    
    </query> 
    
    <query name="SEL_SALE_PUMMOK">
        <![CDATA[
            SELECT A.PUMMOK_CD                      AS PUMMOK_CD
			     , MAX(B.PUMMOK_NAME)               AS PUMMOK_NM
			     , C.VEN_CD                         AS VEN_CD
			     , MAX(D.VEN_NAME)                  AS VEN_NM
			     , SUM(CASE WHEN A.SALE_DT = ? THEN NVL(A.TOT_SALE_AMT,0) ELSE 0 END ) AS DAY_SALE_AMT
			     , SUM(NVL(A.TOT_SALE_AMT,0)) 		AS ACC_SALE_AMT
			     , SUM(SALE_QTY) CUST_CNT
			     , ? 						 		AS UNIT
			  FROM DPS.PS_DAYPBN A
			     , DPS.PC_PMKMST B
			     , DPS.PC_STRPBN C
			     , DPS.PC_STRVENMST D
			 WHERE A.SALE_DT >= ?
			   AND A.SALE_DT <= ?
			   AND A.STR_CD   = ?
			   AND A.PUMMOK_CD IN (SELECT COMM_CODE
			                         FROM COM.TC_COMMCODE C
			                        WHERE C.SYS_PART = 'D'
			                          AND C.COMM_PART = 'P613'
			                          AND C.USE_YN = 'Y'
			                      )
			   AND B.PUMMOK_CD = A.PUMMOK_CD
			   AND C.STR_CD    = A.STR_CD
			   AND C.PUMBUN_CD = A.PUMBUN_CD
			   AND D.STR_CD    = C.STR_CD 
			   AND D.VEN_CD    = C.VEN_CD
			   AND A.PUMBUN_CD IN (SELECT PUMBUN_CD FROM DPS.PC_PBNMST 
                                   WHERE PUMBUN_CD LIKE ? ||'%' AND PUMBUN_NAME LIKE '%'||?||'%')
			 GROUP BY A.PUMMOK_CD, C.VEN_CD
			 ORDER BY A.PUMMOK_CD, C.VEN_CD
        ]]>    
    </query>  
    
    <query name="SEL_SALE_BRAND2">
        <![CDATA[
            SELECT 
            	   SALE_ORG_CD AS ORG_CD
            	 , ORG_NAME    AS ORG_NM
            	 , COM.FN_GET_COMM_NAME('D','PS34',MAX(D.SAP_ORG_CD))           AS ONLINE_PC
                 , A.PUMBUN_CD                 AS PUMBUN_CD
                 , MAX(C.PUMBUN_NAME)          AS PUMBUN_NM
                 , SUM(CASE WHEN A.SALE_DT = ? THEN NVL(A.TOT_SALE_AMT,0) ELSE 0 END ) AS DAY_SALE_AMT
                 , SUM(NVL(A.TOT_SALE_AMT,0))  AS ACC_SALE_AMT
                 , SUM(SALE_QTY) CUST_CNT
                 , ? 						   AS UNIT
              FROM DPS.PS_DAYPBN A
                 , DPS.PC_PMKMST B
                 , DPS.PC_STRPBN C
                 , DPS.PC_ORGMST D
             WHERE A.SALE_DT >= ?
               AND A.SALE_DT <= ?
               AND A.STR_CD   = ? 
               AND A.PUMMOK_CD IN (SELECT COMM_CODE
                                     FROM COM.TC_COMMCODE C
                                    WHERE C.SYS_PART = 'D'
                                      AND C.COMM_PART = 'P613'
                                      AND C.USE_YN = 'Y'
                                  )
               AND B.PUMMOK_CD = A.PUMMOK_CD
               AND C.STR_CD    = A.STR_CD
               AND C.PUMBUN_CD = A.PUMBUN_CD
               AND SALE_ORG_CD = D.ORG_CD
               AND A.PUMBUN_CD IN (SELECT PUMBUN_CD FROM DPS.PC_PBNMST 
                                   WHERE PUMBUN_CD LIKE ? ||'%' AND PUMBUN_NAME LIKE '%'||?||'%')
             GROUP BY SALE_ORG_CD,ORG_NAME,A.PUMBUN_CD,SORT_ORDER,D.SAP_ORG_CD
             ORDER BY (SELECT INQR_ORDER FROM COM.TC_COMMCODE WHERE SYS_PART = 'D' AND COMM_PART = 'PS34' AND COMM_CODE = D.SAP_ORG_CD),SORT_ORDER,A.PUMBUN_CD
        ]]>    
    </query>
    
    <query name="SEL_SALE_PC2">
        <![CDATA[
            SELECT 
                  C.SALE_ORG_CD   AS ORG_CD
                 , MAX(D.ORG_SHORT_NAME)            AS ORG_NM
                 , COM.FN_GET_COMM_NAME('D','PS34',MAX(D.SAP_ORG_CD))           AS ONLINE_PC
                 , SUM(CASE WHEN A.SALE_DT = ? THEN NVL(A.TOT_SALE_AMT,0) ELSE 0 END ) AS DAY_SALE_AMT
                 , SUM(NVL(A.TOT_SALE_AMT,0)) 		AS ACC_SALE_AMT
                 , SUM(SALE_QTY) CUST_CNT
                 , ? 						   		AS UNIT
              FROM DPS.PS_DAYPBN A
                 , DPS.PC_PMKMST B
                 , DPS.PC_STRPBN C
                 , DPS.PC_ORGMST D
             WHERE A.SALE_DT >= ?
               AND A.SALE_DT <= ?
               AND A.STR_CD   = ? 
               AND A.PUMMOK_CD IN (SELECT COMM_CODE
                                     FROM COM.TC_COMMCODE C
                                    WHERE C.SYS_PART = 'D'
                                      AND C.COMM_PART = 'P613'
                                      AND C.USE_YN = 'Y'
                                  )
               AND B.PUMMOK_CD = A.PUMMOK_CD
               AND C.STR_CD    = A.STR_CD
               AND C.PUMBUN_CD = A.PUMBUN_CD
               AND D.ORG_CD    = C.SALE_ORG_CD
               AND A.PUMBUN_CD IN (SELECT PUMBUN_CD FROM DPS.PC_PBNMST 
                                   WHERE PUMBUN_CD LIKE ? ||'%' AND PUMBUN_NAME LIKE '%'||?||'%')
             GROUP BY C.SALE_ORG_CD,D.SAP_ORG_CD
             ORDER BY (SELECT INQR_ORDER FROM COM.TC_COMMCODE WHERE SYS_PART = 'D' AND COMM_PART = 'PS34' AND COMM_CODE = D.SAP_ORG_CD)
        ]]>    
    </query>  
         
</service>