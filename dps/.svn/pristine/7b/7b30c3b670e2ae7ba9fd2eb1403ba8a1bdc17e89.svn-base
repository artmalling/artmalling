<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 박종은
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2011.04.08
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/psal502.ps">

    <gauce name="H_SEL_MASTER"> 
        <column colName="STR_CD"                colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="POS_NO"                colType="TB_STRING"      size="4"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="POS_NAME"              colType="TB_STRING"      size="40"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="R_CASH_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="R_GIFT_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PREP_CASH_AMT"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PREP_GIFT_AMT"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MIDDLE_CASH_AMT"       colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MIDDLE_GIFT_AMT"       colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MAGAM_CASH_AMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MAGAM_GIFT_AMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EXC_CASH_AMT"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EXC_GIFT_AMT"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CASH_GIFT_RTN"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="GIFT_GIFT_RTN"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CASH_AMT"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="JCARD_AMT"             colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="OCARD_AMT"             colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DCARD_AMT"             colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CCARD_AMT"             colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="POINT_AMT"             colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="GIFT_DRAWL_AMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="JGIFT_AMT"             colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="OGIFT_DRAWL_AMT"       colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="COUPON_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="JBOX_SALE_AMT"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="INCEN_SALE_AMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_SALE_AMT"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="COD_SALE_AMT"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="COD_CAN_AMT"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SPS_SALE_AMT"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SPS_CAN_AMT"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="USE_SALE_AMT"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="USE_CAN_AMT"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="OKCASHBAG_AMT"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_POSNO"> 
        <column colName="POSNO"                   colType="TB_STRING"      size="4"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_POSNOMM"> 
        <column colName="POSNO_MIN"                   colType="TB_STRING"      size="4"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="POSNO_MAX"                   colType="TB_STRING"      size="4"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    
    <!-- 쿼리는 전부 대문자 -->
    
    <query name="SEL_SALE_POS_M">        
        <![CDATA[
			SELECT G.STR_CD
			     , G.POS_NO
			     , G.POS_NAME
			     --, NVL(B.PREP_CASH_AMT,0) + NVL(C.MIDDLE_CASH_AMT,0) + NVL(D.PDA_CASH_AMT,0) + NVL(A.CASH_AMT,0)      AS R_CASH_AMT
			     --, NVL(B.PREP_GIFT_AMT,0) + NVL(C.MIDDLE_GIFT_AMT,0) + NVL(D.PDA_GIFT_AMT,0) + NVL(A.GIFT_DRAWL_AMT,0) + NVL(A.JGIFT_AMT,0) + NVL(A.OGIFT_DRAWL_AMT,0)      AS R_GIFT_AMT
			     --, NVL(B.PREP_CASH_AMT,0)  + NVL(D.PDA_CASH_AMT,0) + NVL(A.CASH_AMT,0)      AS R_CASH_AMT
			     --, NVL(B.PREP_GIFT_AMT,0) +  NVL(D.PDA_GIFT_AMT,0) + NVL(A.GIFT_DRAWL_AMT,0) + NVL(A.JGIFT_AMT,0) + NVL(A.OGIFT_DRAWL_AMT,0)      AS R_GIFT_AMT
			     , NVL(D.PDA_CASH_AMT,0) + NVL(A.CASH_AMT,0)      AS R_CASH_AMT
			     , NVL(D.PDA_GIFT_AMT,0) + NVL(A.GIFT_DRAWL_AMT,0) + NVL(A.JGIFT_AMT,0) + NVL(A.OGIFT_DRAWL_AMT,0)      AS R_GIFT_AMT
			     , NVL(B.PREP_CASH_AMT,0)    AS PREP_CASH_AMT
			     , NVL(B.PREP_GIFT_AMT,0)    AS PREP_GIFT_AMT
			     , NVL(C.MIDDLE_CASH_AMT,0) AS MIDDLE_CASH_AMT
			     , NVL(C.MIDDLE_GIFT_AMT,0) AS MIDDLE_GIFT_AMT
			     , NVL(E.MAGAM_CASH_AMT,0)  AS MAGAM_CASH_AMT
			     , NVL(E.MAGAM_GIFT_AMT,0)  AS MAGAM_GIFT_AMT
			     --, NVL(E.MAGAM_CASH_AMT,0) - (NVL(B.PREP_CASH_AMT,0) + NVL(C.MIDDLE_CASH_AMT,0) + NVL(D.PDA_CASH_AMT,0) + NVL(A.CASH_AMT,0))   AS EXC_CASH_AMT
			     --, NVL(E.MAGAM_GIFT_AMT,0) - (NVL(B.PREP_GIFT_AMT,0) + NVL(C.MIDDLE_GIFT_AMT,0) + NVL(D.PDA_GIFT_AMT,0) + NVL(A.GIFT_DRAWL_AMT,0) + NVL(A.JGIFT_AMT,0) + NVL(A.OGIFT_DRAWL_AMT,0)) AS EXC_GIFT_AMT
			     --, NVL(E.MAGAM_CASH_AMT,0) + NVL(C.MIDDLE_CASH_AMT,0) - (NVL(B.PREP_CASH_AMT,0)  + NVL(D.PDA_CASH_AMT,0) + NVL(A.CASH_AMT,0))   AS EXC_CASH_AMT
			     --, NVL(E.MAGAM_GIFT_AMT,0) + NVL(C.MIDDLE_GIFT_AMT,0) - (NVL(B.PREP_GIFT_AMT,0)  + NVL(D.PDA_GIFT_AMT,0) + NVL(A.GIFT_DRAWL_AMT,0) + NVL(A.JGIFT_AMT,0) + NVL(A.OGIFT_DRAWL_AMT,0)) AS EXC_GIFT_AMT
			     , NVL(E.MAGAM_CASH_AMT,0) + NVL(C.MIDDLE_CASH_AMT,0) + NVL(F.CASH_GIFT_RTN,0) - (NVL(B.PREP_CASH_AMT,0)  + NVL(D.PDA_CASH_AMT,0) + NVL(A.CASH_AMT,0))   AS EXC_CASH_AMT
			     , NVL(E.MAGAM_GIFT_AMT,0) + NVL(C.MIDDLE_GIFT_AMT,0) - (NVL(F.CASH_GIFT_RTN,0) + NVL(B.PREP_GIFT_AMT,0)  + NVL(D.PDA_GIFT_AMT,0) + NVL(A.GIFT_DRAWL_AMT,0) + NVL(A.JGIFT_AMT,0) + NVL(A.OGIFT_DRAWL_AMT,0)) AS EXC_GIFT_AMT
			     , NVL(F.CASH_GIFT_RTN,0)   AS CASH_GIFT_RTN
			     , NVL(F.GIFT_GIFT_RTN,0)   AS GIFT_GIFT_RTN
			     , NVL(A.CASH_AMT,0)        AS CASH_AMT
			     , NVL(A.JCARD_AMT,0)       AS JCARD_AMT
			     , NVL(A.OCARD_AMT,0)       AS OCARD_AMT
			     , NVL(A.DCARD_AMT,0)       AS DCARD_AMT
			     , NVL(A.CCARD_AMT,0)       AS CCARD_AMT
			     , NVL(A.POINT_AMT,0)       AS POINT_AMT
			     , NVL(A.GIFT_DRAWL_AMT,0)  AS GIFT_DRAWL_AMT
			     , NVL(A.JGIFT_AMT,0)       AS JGIFT_AMT
			     , NVL(A.OGIFT_DRAWL_AMT,0) AS OGIFT_DRAWL_AMT
			     , NVL(A.COUPON_AMT,0)      AS COUPON_AMT
			     , NVL(A.JBOX_SALE_AMT,0)   AS JBOX_SALE_AMT
			     , NVL(A.INCEN_SALE_AMT,0)  AS INCEN_SALE_AMT
			     , NVL(A.ORD_SALE_AMT,0)    AS ORD_SALE_AMT
			     , NVL(A.COD_SALE_AMT,0)    AS COD_SALE_AMT
			     , NVL(A.COD_CAN_AMT,0)     AS COD_CAN_AMT
			     , NVL(A.SPS_SALE_AMT,0)    AS SPS_SALE_AMT
			     , NVL(A.SPS_CAN_AMT,0)     AS SPS_CAN_AMT
			     , NVL(A.USE_SALE_AMT,0)    AS USE_SALE_AMT
			     , NVL(A.USE_CAN_AMT,0)     AS USE_CAN_AMT
			     , NVL(A.OKCASHBAG_AMT,0)   AS OKCASHBAG_AMT
			  FROM (  
			        SELECT A.STR_CD
			             , A.POS_NO
			             , SUM(A.CASH_AMT)                                                 AS CASH_AMT
			             , SUM(A.JCARD_AMT)                                                AS JCARD_AMT
			             , SUM(A.OCARD_AMT)                                                AS OCARD_AMT
			             , SUM(A.DCARD_AMT)                                                AS DCARD_AMT
			             , SUM(A.CCARD_AMT)                                                AS CCARD_AMT
			             , SUM(A.POINT_AMT)                                                AS POINT_AMT
			             , SUM(A.GIFT_DRAWL_AMT)                                           AS GIFT_DRAWL_AMT
			             , SUM(A.JGIFT_AMT)                                                AS JGIFT_AMT
			             , SUM(A.OGIFT_DRAWL_AMT)                                          AS OGIFT_DRAWL_AMT
			             , SUM(A.ALLIA_COUPON_AMT) + SUM(A.ENURI_COUPON_AMT) + SUM(A.CMS_COUPON_AMT)      AS COUPON_AMT
			             , SUM(A.JBOX_SALE_AMT)                                            AS JBOX_SALE_AMT
			             , SUM(A.INCEN_SALE_AMT)                                           AS INCEN_SALE_AMT
			             , SUM(A.ORD_SALE_AMT)                                             AS ORD_SALE_AMT
			             , SUM(A.COD_SALE_AMT)                                             AS COD_SALE_AMT
			             , SUM(A.COD_CAN_AMT)                                              AS COD_CAN_AMT
			             , SUM(A.SPS_SALE_AMT)                                             AS SPS_SALE_AMT
			             , SUM(A.SPS_CAN_AMT)                                              AS SPS_CAN_AMT
			             , SUM(A.USE_SALE_AMT)                                             AS USE_SALE_AMT
			             , SUM(A.USE_CAN_AMT)                                              AS USE_CAN_AMT
			             , SUM(A.OKCASHBAG_AMT)                                            AS OKCASHBAG_AMT
			          FROM DPS.PS_DAYAPPRTYPE     A
			             , DPS.PC_POSMST          C
			         WHERE A.STR_CD    = C.STR_CD
			           AND A.POS_NO    = C.POS_NO
			           AND A.STR_CD   LIKE ? || '%'
			           AND C.POS_FLAG LIKE ? || '%'
			           AND A.POS_NO    >= ?
			           AND A.POS_NO    <= ?
			           AND A.SALE_DT   = ?
			         GROUP BY
			               A.STR_CD
			             , A.POS_NO
			       ) A
			     , (
			        SELECT A.STR_CD
			             , A.POS_NO
			             , SUM(A.PREP_CASH_AMT)      AS PREP_CASH_AMT
			             , SUM(A.PREP_GIFT_AMT)      AS PREP_GIFT_AMT
			          FROM (
			                SELECT A.STR_CD
			                     , A.POS_NO
			                     , (CASE WHEN A.DATA_TYPE = '00' THEN SUM(A.AMT) ELSE 0 END) AS PREP_CASH_AMT
			                     , (CASE WHEN A.DATA_TYPE = '20' THEN SUM(A.AMT) ELSE 0 END) AS PREP_GIFT_AMT
			                  FROM DPS.PS_DISPREP     A
			                     , DPS.PC_POSMST      B
			                 WHERE A.STR_CD     = B.STR_CD
			                   AND A.POS_NO     = B.POS_NO
			                   AND A.STR_CD     LIKE ? || '%'
			                   AND B.POS_FLAG   LIKE ? || '%'
			                   AND A.POS_NO     >= ?
			                   AND A.POS_NO     <= ?
			                   AND A.SALE_DT    = ?
			                 GROUP BY
			                       A.STR_CD
			                     , A.POS_NO
			                     , A.DATA_TYPE
			               ) A
			         GROUP BY
			               A.STR_CD
			             , A.POS_NO
			       ) B
			     , (
			        SELECT A.STR_CD
			             , A.POS_NO
			             , SUM(A.MIDDLE_CASH_AMT)      AS MIDDLE_CASH_AMT
			             , SUM(A.MIDDLE_GIFT_AMT)      AS MIDDLE_GIFT_AMT
			          FROM (
			                SELECT A.STR_CD
			                     , A.POS_NO
			                     , (CASE WHEN A.DATA_TYPE = '00' THEN SUM(A.AMT) ELSE 0 END) AS MIDDLE_CASH_AMT
			                     , (CASE WHEN A.DATA_TYPE = '20' THEN SUM(A.AMT) ELSE 0 END) AS MIDDLE_GIFT_AMT
			                  FROM DPS.PS_DISMIDDLE   A
			                     , DPS.PC_POSMST      B
			                 WHERE A.STR_CD     = B.STR_CD
			                   AND A.POS_NO     = B.POS_NO
			                   AND A.STR_CD     LIKE ? || '%'
			                   AND B.POS_FLAG   LIKE ? || '%'
			                   AND A.POS_NO     >= ?
			                   AND A.POS_NO     <= ?
			                   AND A.SALE_DT    = ?
			                 GROUP BY
			                       A.STR_CD
			                     , A.POS_NO
			                     , A.DATA_TYPE
			               ) A
			         GROUP BY
			               A.STR_CD
			             , A.POS_NO
			       ) C
			     , (
			        SELECT A.STR_CD
			             , A.POS_NO
			             , SUM(A.PDA_CASH_AMT)      AS PDA_CASH_AMT
			             , SUM(A.PDA_GIFT_AMT)      AS PDA_GIFT_AMT
			          FROM (
			                SELECT A.STR_CD
			                     , A.POS_NO
			                     , (CASE WHEN A.DATA_TYPE = '00' THEN SUM(A.AMT) ELSE 0 END) AS PDA_CASH_AMT
			                     , (CASE WHEN A.DATA_TYPE = '20' THEN SUM(A.AMT) ELSE 0 END) AS PDA_GIFT_AMT
			                  FROM DPS.PS_DISPDA      A
			                     , DPS.PC_POSMST      B
			                 WHERE A.STR_CD     = B.STR_CD
			                   AND A.POS_NO     = B.POS_NO
			                   AND A.STR_CD     LIKE ? || '%'
			                   AND B.POS_FLAG   LIKE ? || '%'
			                   AND A.POS_NO     >= ?
			                   AND A.POS_NO     <= ?
			                   AND A.SALE_DT    = ?
			                 GROUP BY
			                       A.STR_CD
			                     , A.POS_NO
			                     , A.DATA_TYPE
			               ) A
			         GROUP BY
			               A.STR_CD
			             , A.POS_NO
			       ) D
			     , (
			        SELECT A.STR_CD
			             , A.POS_NO
			             , SUM(A.MAGAM_CASH_AMT)      AS MAGAM_CASH_AMT
			             , SUM(A.MAGAM_GIFT_AMT)      AS MAGAM_GIFT_AMT
			          FROM (
			                SELECT A.STR_CD
			                     , A.POS_NO
			                     , (CASE WHEN A.DATA_TYPE = '00' THEN SUM(A.AMT) ELSE 0 END) AS MAGAM_CASH_AMT
			                     , (CASE WHEN A.DATA_TYPE = '20' THEN SUM(A.AMT) ELSE 0 END) AS MAGAM_GIFT_AMT
			                  FROM DPS.PS_DISMAGAM    A
			                     , DPS.PC_POSMST      B
			                 WHERE A.STR_CD     = B.STR_CD
			                   AND A.POS_NO     = B.POS_NO
			                   AND A.STR_CD     LIKE ? || '%'
			                   AND B.POS_FLAG   LIKE ? || '%'
			                   AND A.POS_NO     >= ?
			                   AND A.POS_NO     <= ?
			                   AND A.SALE_DT    = ?
			                   AND A.TRAN_NO IN (SELECT MAX(TRAN_NO)
			                                       FROM DPS.PS_DISMAGAM
			                                      WHERE STR_CD = A.STR_CD
			                                        AND SALE_DT = A.SALE_DT
			                                        AND POS_NO = A.POS_NO)
			                 GROUP BY
			                       A.STR_CD
			                     , A.POS_NO
			                     , A.DATA_TYPE
			               ) A
			         GROUP BY
			               A.STR_CD
			             , A.POS_NO
			       ) E
			     , (
			        SELECT A.STR_CD
			             , A.POS_NO
			             , SUM(A.CASH_GIFT_RTN)      AS CASH_GIFT_RTN
			             , SUM(A.GIFT_GIFT_RTN)      AS GIFT_GIFT_RTN
			          FROM (
			                SELECT A.STR_CD
			                     , A.POS_NO
			                     , (CASE WHEN A.BALANCE_FLAG = '303' THEN SUM(A.NORM_TRAN_AMT) ELSE 0 END) AS CASH_GIFT_RTN
			                     , (CASE WHEN A.BALANCE_FLAG = '112' THEN SUM(A.NORM_TRAN_AMT) ELSE 0 END) AS GIFT_GIFT_RTN
			                  FROM DPS.PS_TRTOTAL    A
			                     , DPS.PC_POSMST      B
			                 WHERE A.STR_CD     = B.STR_CD
			                   AND A.POS_NO     = B.POS_NO
			                   AND A.STR_CD     LIKE ? || '%'
			                   AND B.POS_FLAG   LIKE ? || '%'
			                   AND A.POS_NO     >= ?
			                   AND A.POS_NO     <= ?
			                   AND A.SALE_DT    = ?
                 			   AND A.TOTAL_FLAG = '01'
			                 GROUP BY
			                       A.STR_CD
			                     , A.POS_NO
			                     , A.BALANCE_FLAG
			               ) A
			         GROUP BY
			               A.STR_CD
			             , A.POS_NO
			       ) F
			       , (
			       	  SELECT
			       	       A.STR_CD
			       	       , A.POS_NO
			       	       , A.POS_NAME
			       	    FROM DPS.PC_POSMST A
			       	       , (
			       	           SELECT
			       	                STR_CD
			       	                , POS_NO
			       	             FROM DPS.PS_DISPOSMAGAM
			       	            WHERE STR_CD     LIKE ? || '%'
			       	              AND SALE_DT    = ?
			       	          ) B
			       	   WHERE A.STR_CD = B.STR_CD(+)
			       	     AND A.POS_NO = B.POS_NO(+)
			       	     AND A.STR_CD     LIKE ? || '%'
			       	     AND A.USE_YN = 'Y'
			       	     AND A.POS_FLAG   LIKE ? || '%'  
			       	     AND A.POS_NO     >= ?
			             AND A.POS_NO     <= ?

			       ) G
			WHERE G.STR_CD = A.STR_CD(+)
               AND G.POS_NO = A.POS_NO(+)
               AND G.STR_CD = B.STR_CD(+)
               AND G.POS_NO = B.POS_NO(+)
               AND G.STR_CD = C.STR_CD(+)
               AND G.POS_NO = C.POS_NO(+)
               AND G.STR_CD = D.STR_CD(+)
               AND G.POS_NO = D.POS_NO(+)
               AND G.STR_CD = E.STR_CD(+)
               AND G.POS_NO = E.POS_NO(+)
               AND G.STR_CD = F.STR_CD(+)
               AND G.POS_NO = F.POS_NO(+)
			 ORDER BY
			       G.STR_CD
                 , G.POS_NO
            
        ]]>        
    </query>
    
    <query name="SEL_POSNO">        
        <![CDATA[
            SELECT A.POS_NO
              FROM DPS.PC_POSMST A
             WHERE A.POS_NO = ?
        ]]>        
    </query>
    
    <query name="SEL_POSNOMM">        
        <![CDATA[
            SELECT MAX(A.POSNO_MIN) AS POSNO_MIN
                 , MAX(A.POSNO_MAX) AS POSNO_MAX
              FROM (
		            SELECT MIN(A.POS_NO) AS POSNO_MIN
		                 , ''            AS POSNO_MAX
		              FROM DPS.PC_POSMST A
		              
		            UNION ALL
		              
		            SELECT ''            AS POSNO_MIN
		                 , MAX(A.POS_NO) AS POSNO_MAX
		              FROM DPS.PC_POSMST A
		           ) A
        ]]>        
    </query>
    
    
</service>