<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 박종은
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2010.04.20
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/psal577.ps">

    <gauce name="H_SEL_MASTER"> 
        <column colName="PART_NAME"               colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PC_NAME"                 colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRO_AMT_D"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_D"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_ACHIV_RATE_D"        colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_INCRE_RATE_D"        colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT_D"              colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CNT_INCRE_RATE_D"        colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CNTAMT_D"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CNTAMT_INCRE_RATE_D"     colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRE_AMT_D"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PCUST_CMT_D"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PCNTAMT_D"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRO_AMT_M"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_M"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_ACHIV_RATE_M"        colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_INCRE_RATE_M"        colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT_M"              colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CNT_INCRE_RATE_M"        colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CNTAMT_M"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CNTAMT_INCRE_RATE_M"     colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRE_AMT_M"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PCUST_CMT_M"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PCNTAMT_M"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRO_AMT_Y"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_Y"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_ACHIV_RATE_Y"        colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_INCRE_RATE_Y"        colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT_Y"              colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CNT_INCRE_RATE_Y"        colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CNTAMT_Y"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CNTAMT_INCRE_RATE_Y"     colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRE_AMT_Y"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PCUST_CMT_Y"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PCNTAMT_Y"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="STR_CD"                  colType="TB_STRING"      size="2"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="ORG_CD"                  colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="UNIT"    	              colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_DETAIL"> 
        <column colName="PART_NAME"               colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PC_NAME"                 colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRO_AMT_D"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_D"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_ACHIV_RATE_D"        colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_INCRE_RATE_D"        colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PROF_RATE_D"             colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PROF_INCRE_RATE_D"       colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRE_AMT_D"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PREPROF_RATE_D"          colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRO_AMT_M"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_M"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_ACHIV_RATE_M"        colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_INCRE_RATE_M"        colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PROF_RATE_M"             colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PROF_INCRE_RATE_M"       colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRE_AMT_M"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PREPROF_RATE_M"          colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRO_AMT_Y"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_Y"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_ACHIV_RATE_Y"        colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AMT_INCRE_RATE_Y"        colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PROF_RATE_Y"             colType="TB_DECIMAL"     size="13"       dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PROF_INCRE_RATE_Y"       colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PRE_AMT_Y"               colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PREPROF_RATE_Y"          colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STR_CD"                  colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="ORG_CD"                  colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="UNIT"    	              colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    
    <gauce name="H_SEL_MASTER2"> 
        <column colName="GROUP_NAME"         colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_NAME"           colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMNTS1"             colType="TB_STRING"      size="2000"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMNTS2"             colType="TB_STRING"      size="2000"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REG_USER"           colType="TB_STRING"      size="30"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="GRP_ORDER"          colType="TB_DECIMAL"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="INGRP_ORDER"        colType="TB_DECIMAL"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="USER_ID"            colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="ORG_CD_TOP"         colType="TB_STRING"      size="12"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="ORG_CD"             colType="TB_STRING"      size="12"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />        
    </gauce>
    
    
    <gauce name="H_SEL_DETAIL2"> 
        <column colName="GROUP_NAME"              colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="POST_CMNTS"              colType="TB_STRING"      size="2000"       dec="0" keyType="TB_NORMAL" roundMode="ROUND"/>
        <column colName="PRE_CMNTS"               colType="TB_STRING"      size="2000"       dec="0" keyType="TB_NORMAL" roundMode="ROUND"/>
        <column colName="REG_USER"                colType="TB_STRING"      size="30"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="GRP_ORDER"               colType="TB_DECIMAL"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="INGRP_ORDER"             colType="TB_DECIMAL"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="USER_ID"                 colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    
    <gauce name="H_SEL_CMPRDT"> 
        <column colName="CMPR_DT"                 colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    
    <!-- 쿼리는 전부 대문자 -->
    <!-- 당초팀별월매출계획 조회 쿼리  -->
   
   <query name="SEL_SALE_PUMBUN">        
        <![CDATA[
		WITH SALE_DATA AS 
		(
			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
			     , NORM_SALE_AMT SALE_AMT_M
			     , SALE_PROF_AMT/1.1 PROF_AMT_M
			     , 0 SALE_AMT_Y
			     , 0 PROF_AMT_Y
			     , 0 PRO_AMT_M
			     , 0 PRO_AMT_Y
			     , 0 PRE_AMT_M
			     , 0 PREPROF_AMT_M
			     , 0 PRE_AMT_Y
			     , 0 PREPROF_AMT_Y 
			     , 0 PREPRO_AMT_M
			     , 0 PREPRO_AMT_Y
			     , NORM_SALE_AMT/1.1 PURE_AMT_M
			     , 0 PURE_AMT_Y
			     , 0 PREPURE_AMT_M
			     , 0 PREPURE_AMT_Y
                 , 0 SALE_AMT_D
                 , 0 PROF_AMT_D
                 , 0 PRO_AMT_D
                 , 0 PRE_AMT_D
                 , 0 PREPROF_AMT_D
                 , 0 PURE_AMT_D
                 , 0 PREPURE_AMT_D  			     
			 FROM DPS.PS_DAYPBN
		    WHERE 1=1
			  AND STR_CD= ?
			  AND SALE_DT BETWEEN SUBSTR(?,1,6)||'00' AND ?
			  
			--- 월
			  UNION ALL
  
			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
			     , 0 SALE_AMT_M
			     , 0 PROF_AMT_M
			     , NORM_SALE_AMT SALE_AMT_Y
			     , SALE_PROF_AMT/1.1 PROF_AMT_Y
			     , 0 PRO_AMT_M
			     , 0 PRO_AMT_Y
			     , 0 PRE_AMT_M
			     , 0 PREPROF_AMT_M
			     , 0 PRE_AMT_Y
			     , 0 PREPROF_AMT_Y 
		         , 0 PREPRO_AMT_M
		         , 0 PREPRO_AMT_Y
		         , 0 PURE_AMT_M
		         , NORM_SALE_AMT/1.1 PURE_AMT_Y
		         , 0 PREPURE_AMT_M
		         , 0 PREPURE_AMT_Y
                 , 0 SALE_AMT_D
                 , 0 PROF_AMT_D
                 , 0 PRO_AMT_D
                 , 0 PRE_AMT_D
                 , 0 PREPROF_AMT_D
                 , 0 PURE_AMT_D
                 , 0 PREPURE_AMT_D  		         
			  FROM DPS.PS_DAYPBN
			 WHERE 1=1
  			   AND STR_CD= ?
  			   AND SALE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?
  			 -- 년  
  			   UNION ALL
  
			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
			     , 0 SALE_AMT_M
			     , 0 PROF_AMT_M
			     , 0 SALE_AMT_Y
			     , 0 PROF_AMT_Y
			     , 0 PRO_AMT_M
			     , ORIGIN_SALE_TAMT PRO_AMT_Y
			     , 0 PRE_AMT_M
			     , 0 PREPROF_AMT_M
			     , 0 PRE_AMT_Y
			     , 0 PREPROF_AMT_Y 
       			 , 0 PREPRO_AMT_M
       			 , 0 PREPRO_AMT_Y
       			 , 0 PURE_AMT_M
       			 , 0 PURE_AMT_Y
       			 , 0 PREPURE_AMT_M
       			 , 0 PREPURE_AMT_Y
                 , 0 SALE_AMT_D
                 , 0 PROF_AMT_D
                 , 0 PRO_AMT_D
                 , 0 PRE_AMT_D
                 , 0 PREPROF_AMT_D
                 , 0 PURE_AMT_D
                 , 0 PREPURE_AMT_D         			 
			  FROM DPS.PS_ACTPUMBUN
			 WHERE 1=1
  			   AND STR_CD= ?
  			   AND EXE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?
  			   AND ORIGIN_SALE_TAMT <> 0
  			-- 목표년
  			UNION ALL
  
			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
			     , 0 SALE_AMT_M
			     , 0 PROF_AMT_M
			     , 0 SALE_AMT_Y
			     , 0 PROF_AMT_Y
			     , ORIGIN_SALE_TAMT PRO_AMT_M
			     , 0 PRO_AMT_Y
			     , 0 PRE_AMT_M
			     , 0 PREPROF_AMT_M
			     , 0 PRE_AMT_Y
			     , 0 PREPROF_AMT_Y 
       			 , 0 PREPRO_AMT_M
       			 , 0 PREPRO_AMT_Y
       			 , 0 PURE_AMT_M
       			 , 0 PURE_AMT_Y
       			 , 0 PREPURE_AMT_M
       			 , 0 PREPURE_AMT_Y
                 , 0 SALE_AMT_D
                 , 0 PROF_AMT_D
                 , 0 PRO_AMT_D
                 , 0 PRE_AMT_D
                 , 0 PREPROF_AMT_D
                 , 0 PURE_AMT_D
                 , 0 PREPURE_AMT_D         			 
       	      FROM DPS.PS_ACTPUMBUN
			 WHERE 1=1
  			   AND STR_CD= ?
  			   AND EXE_DT  BETWEEN SUBSTR(?,1,6)||'00' AND ?
  			   AND ORIGIN_SALE_TAMT <> 0
  			-- 목표월
  			UNION ALL  
  
  
			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
			     , 0 SALE_AMT_M
			     , 0 PROF_AMT_M
			     , 0 SALE_AMT_Y
			     , 0 PROF_AMT_Y
			     , 0 PRO_AMT_M
			     , 0 PRO_AMT_Y
			     , NORM_SALE_AMT PRE_AMT_M
			     , SALE_PROF_AMT/1.1 PREPROF_AMT_M
			     , 0 PRE_AMT_Y
			     , 0 PREPROF_AMT_Y 
			     , 0 PREPRO_AMT_M
			     , 0 PREPRO_AMT_Y
			     , 0 PURE_AMT_M
			     , 0 PURE_AMT_Y
			     , NORM_SALE_AMT/1.1 PREPURE_AMT_M
			     , 0 PREPURE_AMT_Y
                 , 0 SALE_AMT_D
                 , 0 PROF_AMT_D
                 , 0 PRO_AMT_D
                 , 0 PRE_AMT_D
                 , 0 PREPROF_AMT_D
                 , 0 PURE_AMT_D
                 , 0 PREPURE_AMT_D  			     
			  FROM DPS.PS_DAYPBN
			 WHERE 1=1
			   AND STR_CD= ?
			   AND SALE_DT BETWEEN SUBSTR(?,1,6)||'00' AND ?
  			 --- 대비월
  			UNION ALL
  
			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
			     , 0 SALE_AMT_M
			     , 0 PROF_AMT_M
			     , 0 SALE_AMT_Y
			     , 0 PROF_AMT_Y
			     , 0 PRO_AMT_M
			     , 0 PRO_AMT_Y
			     , 0 PRE_AMT_M
			     , 0 PREPROF_AMT_M
			     , NORM_SALE_AMT PRE_AMT_Y
			     , SALE_PROF_AMT/1.1 PREPROF_AMT_Y 
			     , 0 PREPRO_AMT_M
			     , 0 PREPRO_AMT_Y
			     , 0 PURE_AMT_M
			     , 0 PURE_AMT_Y
			     , 0 PREPURE_AMT_M
			     , NORM_SALE_AMT/1.1 PREPURE_AMT_Y
                 , 0 SALE_AMT_D
                 , 0 PROF_AMT_D
                 , 0 PRO_AMT_D
                 , 0 PRE_AMT_D
                 , 0 PREPROF_AMT_D
                 , 0 PURE_AMT_D
                 , 0 PREPURE_AMT_D  			     
			  FROM DPS.PS_DAYPBN
			 WHERE 1=1
			   AND STR_CD= ?
			   AND SALE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?
  			  -- 대비년
  			 UNION ALL

            SELECT STR_CD
			     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
			     , 0 SALE_AMT_M
			     , 0 PROF_AMT_M
			     , 0 SALE_AMT_Y
			     , 0 PROF_AMT_Y
			     , 0 PRO_AMT_M
			     , 0 PRO_AMT_Y
			     , 0 PRE_AMT_M
			     , 0 PREPROF_AMT_M
			     , 0 PRE_AMT_Y
			     , 0 PREPROF_AMT_Y 
			     , 0 PREPRO_AMT_M
			     , 0 PREPRO_AMT_Y
			     , 0 PURE_AMT_M
			     , 0 PURE_AMT_Y
			     , 0 PREPURE_AMT_M
			     , 0 PREPURE_AMT_Y
                 , NORM_SALE_AMT SALE_AMT_D
                 , SALE_PROF_AMT/1.1 PROF_AMT_D
                 , 0 PRO_AMT_D
                 , 0 PRE_AMT_D
                 , 0 PREPROF_AMT_D
                 , NORM_SALE_AMT/1.1 PURE_AMT_D
                 , 0 PREPURE_AMT_D                   
			 FROM DPS.PS_DAYPBN
		    WHERE 1=1
			  AND STR_CD= ?
			  AND SALE_DT BETWEEN ? AND ?
			--- 일
			  UNION ALL
  
			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
			     , 0 SALE_AMT_M
			     , 0 PROF_AMT_M
			     , 0 SALE_AMT_Y
			     , 0 PROF_AMT_Y
			     , 0 PRO_AMT_M
			     , 0 PRO_AMT_Y
			     , 0 PRE_AMT_M
			     , 0 PREPROF_AMT_M
			     , 0 PRE_AMT_Y
			     , 0 PREPROF_AMT_Y 
       			 , 0 PREPRO_AMT_M
       			 , 0 PREPRO_AMT_Y
       			 , 0 PURE_AMT_M
       			 , 0 PURE_AMT_Y
       			 , 0 PREPURE_AMT_M
       			 , 0 PREPURE_AMT_Y
                 , 0 SALE_AMT_D
                 , 0 PROF_AMT_D
                 , ORIGIN_SALE_TAMT PRO_AMT_D
                 , 0 PRE_AMT_D
                 , 0 PREPROF_AMT_D
                 , 0 PURE_AMT_D          
                 , 0 PREPURE_AMT_D                   
       	      FROM DPS.PS_ACTPUMBUN
			 WHERE 1=1
  			   AND STR_CD= ?
  			   AND EXE_YM  BETWEEN ? AND ?  
			  AND EXE_DT BETWEEN ? AND ?               
  			   AND ORIGIN_SALE_TAMT <> 0
  			-- 목표일
  			UNION ALL  

			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
			     , 0 SALE_AMT_M
			     , 0 PROF_AMT_M
			     , 0 SALE_AMT_Y
			     , 0 PROF_AMT_Y
			     , 0 PRO_AMT_M
			     , 0 PRO_AMT_Y
			     , 0 PRE_AMT_M
			     , 0 PREPROF_AMT_M
			     , 0 PRE_AMT_Y
			     , 0 PREPROF_AMT_Y 
			     , 0 PREPRO_AMT_M
			     , 0 PREPRO_AMT_Y
			     , 0 PURE_AMT_M
			     , 0 PURE_AMT_Y
			     , 0 PREPURE_AMT_M
			     , 0 PREPURE_AMT_Y
                 , 0 SALE_AMT_D
                 , 0 PROF_AMT_D
                 , 0 PRO_AMT_D
                 , NORM_SALE_AMT PRE_AMT_D
                 , SALE_PROF_AMT/1.1 PREPROF_AMT_D
                 , 0 PURE_AMT_D   
                 , NORM_SALE_AMT/1.1 PREPURE_AMT_D                   
			  FROM DPS.PS_DAYPBN
			 WHERE 1=1
			   AND STR_CD= ?
			  AND SALE_DT BETWEEN ? AND ?  
			/* UNION ALL  
			SELECT STR_CD, SUBSTR(ORG_CD,1,8)||'00' ORG_CD, 0 SALE_AMT_M, 0 CUST_CNT_M, 0 SALE_AMT_Y, 0 PROF_AMT_Y, 0 PRO_AMT_M, 0 PRO_AMT_Y, 0 PRE_AMT_M, 0 PCUST_CNT_M, 0 PRE_AMT_Y , 0 PREPROF_AMT_Y 
			       , ORIGIN_SALE_TAMT PREPRO_AMT_M, 0 PREPRO_AMT_Y   FROM DPS.PS_ACTPUMBUN
			WHERE 1=1
			  AND STR_CD='01'
			  AND SUBSTR(EXE_YM,1,4) = '2016'
			  AND SUBSTR(EXE_DT,1,4) ='2016'
			  AND ORIGIN_SALE_TAMT <> 0
			  UNION ALL -- 대비목표년
			 
			SELECT STR_CD, SUBSTR(ORG_CD,1,8)||'00' ORG_CD, 0 SALE_AMT_M, 0 CUST_CNT_M, 0 SALE_AMT_Y, 0 PROF_AMT_Y, 0 PRO_AMT_M, 0 PRO_AMT_Y, 0 PRE_AMT_M, 0 PCUST_CNT_M, 0 PRE_AMT_Y , 0 PREPROF_AMT_Y 
			       , 0 PREPRO_AMT_M, ORIGIN_SALE_TAMT PREPRO_AMT_Y   FROM DPS.PS_ACTPUMBUN
			WHERE 1=1  
			  AND STR_CD='01'
			  AND EXE_YM = '201603'  
			  AND SUBSTR(EXE_DT,1,6) ='201603'
			  AND ORIGIN_SALE_TAMT <> 0
			  
			   -- 대비목표월  
			   */
			) 
			
			SELECT C.ORG_NAME PART_NAME
			     , DECODE(GROUPLEVEL,'STR','합계','PART','소계',B.ORG_NAME) PC_NAME
			     -- 일
			     , PRO_AMT_D
			     , SALE_AMT_D
			     , DECODE(PRO_AMT_D,0,0,ROUND((SALE_AMT_D/PRO_AMT_D)*100,2)) AMT_ACHIV_RATE_D
			     , DECODE(PRE_AMT_D,0,0,ROUND(((SALE_AMT_D-PRE_AMT_D)/PRE_AMT_D)*100,2)) AMT_INCRE_RATE_D
			     --, PROF_AMT_D
			     , DECODE(PURE_AMT_D,0,0,ROUND((PROF_AMT_D/PURE_AMT_D)*100,2) ) PROF_RATE_D
			     , DECODE(PREPROF_AMT_D,0,0,ROUND(((PROF_AMT_D-PREPROF_AMT_D)/PREPROF_AMT_D)*100,2)) PROF_INCRE_RATE_D
			     , PRE_AMT_D
			     --, PREPROF_AMT_D
			     , DECODE(PREPURE_AMT_D,0,0,ROUND((PREPROF_AMT_D/PREPURE_AMT_D)*100,2) ) PREPROF_RATE_D		
			     -- 월
			     , PRO_AMT_M
			     , SALE_AMT_M
			     , DECODE(PRO_AMT_M,0,0,ROUND((SALE_AMT_M/PRO_AMT_M)*100,2)) AMT_ACHIV_RATE_M
			     , DECODE(PRE_AMT_M,0,0,ROUND(((SALE_AMT_M-PRE_AMT_M)/PRE_AMT_M)*100,2)) AMT_INCRE_RATE_M
			     --, PROF_AMT_M
			     , DECODE(PURE_AMT_M,0,0,ROUND((PROF_AMT_M/PURE_AMT_M)*100,2) ) PROF_RATE_M
			     , DECODE(PREPROF_AMT_M,0,0,ROUND(((PROF_AMT_M-PREPROF_AMT_M)/PREPROF_AMT_M)*100,2)) PROF_INCRE_RATE_M
			     , PRE_AMT_M
			     --, PREPROF_AMT_M
			     , DECODE(PREPURE_AMT_M,0,0,ROUND((PREPROF_AMT_M/PREPURE_AMT_M)*100,2) ) PREPROF_RATE_M
			     -- 년
			     , PRO_AMT_Y
			     , SALE_AMT_Y
			     , DECODE(PRO_AMT_Y,0,0,ROUND((SALE_AMT_Y/PRO_AMT_Y)*100,2)) AMT_ACHIV_RATE_Y
			     , DECODE(PRE_AMT_Y,0,0,ROUND(((SALE_AMT_Y-PRE_AMT_Y)/PRE_AMT_Y)*100,2) ) AMT_INCRE_RATE_Y
			     --, PROF_AMT_Y
			     , DECODE(PURE_AMT_Y,0,0,ROUND((PROF_AMT_Y/PURE_AMT_Y)*100,2) ) PROF_RATE_Y
			     , DECODE(PREPROF_AMT_Y,0,0,ROUND(((PROF_AMT_Y-PREPROF_AMT_Y)/PREPROF_AMT_Y)*100,2)) PROF_INCRE_RATE_Y
			     , PRE_AMT_Y
			     --, PREPROF_AMT_Y
			     , DECODE(PREPURE_AMT_Y,0,0,ROUND((PREPROF_AMT_Y/PREPURE_AMT_Y)*100,2) ) PREPROF_RATE_Y
			     , A.STR_CD
			     , A.ORG_CD
			     , ? UNIT
			 FROM
			(
			SELECT STR_CD
			     , ORG_CD
			     , SUM(SALE_AMT_M) SALE_AMT_M
			     , SUM(PROF_AMT_M) PROF_AMT_M
			     , SUM(SALE_AMT_Y) SALE_AMT_Y
			     , SUM(PROF_AMT_Y) PROF_AMT_Y
			     , SUM(PRO_AMT_M) PRO_AMT_M
			     , SUM(PRO_AMT_Y) PRO_AMT_Y
			     , SUM(PRE_AMT_M) PRE_AMT_M
			     , SUM(PREPROF_AMT_M) PREPROF_AMT_M
			     , SUM(PRE_AMT_Y) PRE_AMT_Y
			     , SUM(PREPROF_AMT_Y) PREPROF_AMT_Y
			     , SUM(PURE_AMT_M) PURE_AMT_M
			     , SUM(PURE_AMT_Y) PURE_AMT_Y
			     , SUM(PREPURE_AMT_M) PREPURE_AMT_M
			     , SUM(PREPURE_AMT_Y) PREPURE_AMT_Y
			     , SUM(SALE_AMT_D) SALE_AMT_D
			     , SUM(PROF_AMT_D) PROF_AMT_D 
			     , SUM(PRO_AMT_D) PRO_AMT_D 
			     , SUM(PRE_AMT_D) PRE_AMT_D
			     , SUM(PREPROF_AMT_D) PREPROF_AMT_D
			     , SUM(PURE_AMT_D) PURE_AMT_D    
			     , SUM(PREPURE_AMT_D) PREPURE_AMT_D  			     
			     , 'PC' GROUPLEVEL
			FROM SALE_DATA
			GROUP BY STR_CD, ORG_CD 
			UNION ALL
			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,6)||'0000' ORG_CD
			     , SUM(SALE_AMT_M) SALE_AMT_M
			     , SUM(PROF_AMT_M) PROF_AMT_M
			     , SUM(SALE_AMT_Y) SALE_AMT_Y
			     , SUM(PROF_AMT_Y) PROF_AMT_Y
			     , SUM(PRO_AMT_M) PRO_AMT_M
			     , SUM(PRO_AMT_Y) PRO_AMT_Y
			     , SUM(PRE_AMT_M) PRE_AMT_M
			     , SUM(PREPROF_AMT_M) PREPROF_AMT_M
			     , SUM(PRE_AMT_Y) PRE_AMT_Y
			     , SUM(PREPROF_AMT_Y) PREPROF_AMT_Y
			     , SUM(PURE_AMT_M) PURE_AMT_M
			     , SUM(PURE_AMT_Y) PURE_AMT_Y
			     , SUM(PREPURE_AMT_M) PREPURE_AMT_M
			     , SUM(PREPURE_AMT_Y) PREPURE_AMT_Y
			     , SUM(SALE_AMT_D) SALE_AMT_D
			     , SUM(PROF_AMT_D) PROF_AMT_D 
			     , SUM(PRO_AMT_D) PRO_AMT_D 
			     , SUM(PRE_AMT_D) PRE_AMT_D
			     , SUM(PREPROF_AMT_D) PREPROF_AMT_D
			     , SUM(PURE_AMT_D) PURE_AMT_D    
			     , SUM(PREPURE_AMT_D) PREPURE_AMT_D  			          
			     , 'PART' GROUPLEVEL
			FROM SALE_DATA
			GROUP BY STR_CD, SUBSTR(ORG_CD,1,6)||'0000' 
			UNION ALL
			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,2)||'00000000' ORG_CD
			     , SUM(SALE_AMT_M) SALE_AMT_M
			     , SUM(PROF_AMT_M) PROF_AMT_M
			     , SUM(SALE_AMT_Y) SALE_AMT_Y
			     , SUM(PROF_AMT_Y) PROF_AMT_Y
			     , SUM(PRO_AMT_M) PRO_AMT_M
			     , SUM(PRO_AMT_Y) PRO_AMT_Y
			     , SUM(PRE_AMT_M) PRE_AMT_M
			     , SUM(PREPROF_AMT_M) PREPROF_AMT_M
			     , SUM(PRE_AMT_Y) PRE_AMT_Y
			     , SUM(PREPROF_AMT_Y) PREPROF_AMT_Y
			     , SUM(PURE_AMT_M) PURE_AMT_M
			     , SUM(PURE_AMT_Y) PURE_AMT_Y
			     , SUM(PREPURE_AMT_M) PREPURE_AMT_M
			     , SUM(PREPURE_AMT_Y) PREPURE_AMT_Y  
			     , SUM(SALE_AMT_D) SALE_AMT_D
			     , SUM(PROF_AMT_D) PROF_AMT_D 
			     , SUM(PRO_AMT_D) PRO_AMT_D 
			     , SUM(PRE_AMT_D) PRE_AMT_D
			     , SUM(PREPROF_AMT_D) PREPROF_AMT_D
			     , SUM(PURE_AMT_D) PURE_AMT_D    
			     , SUM(PREPURE_AMT_D) PREPURE_AMT_D  			        
			     , 'STR' GROUPLEVEL
			FROM SALE_DATA
			GROUP BY STR_CD, SUBSTR(ORG_CD,1,2)||'00000000' 
			) A, DPS.PC_ORGMST B, DPS.PC_ORGMST C
			WHERE A.STR_CD = B.STR_CD
			  AND A.ORG_CD = B.ORG_CD
			  AND SUBSTR(A.ORG_CD,1,6)||'0000' = C.ORG_CD
			ORDER BY STR_CD, ORG_CD  
        ]]>        
    </query>
    
     <query name="SEL_SALE_PUMBUN2">        
        <![CDATA[
	        SELECT   
	        		A.PUMBUN_CD               AS ORG_CD
                 , C.PUMBUN_NAME              AS ORG_NAME
                 , SUM(A.ORIGIN_SALE_TAMT)    AS ORIGIN_SALE_TAMT
                 , SUM(A.TOT_SALE_AMT)        AS TOT_SALE_AMT
                 , SUM(A.ACHIEVERATE)         AS ACHIEVERATE
                 , SUM(A.SALE_AMT_CMPR)       AS SALE_AMT_CMPR
                 , SUM(A.SALEIRATE)           AS SALEIRATE
                 , SUM(A.ORIGIN_SALE_TAMT_M)  AS ORIGIN_SALE_TAMT_M
                 , SUM(A.TOT_SALE_AMT_M)      AS TOT_SALE_AMT_M
                 , SUM(A.ACHIEVERATE_M)       AS ACHIEVERATE_M
                 , SUM(A.SALE_AMT_CMPR_M)     AS SALE_AMT_CMPR_M
                 , SUM(A.SALEIRATE_M)         AS SALEIRATE_M
                 , SUM(A.ORIGIN_SALE_TAMT_Y)  AS ORIGIN_SALE_TAMT_Y
                 , SUM(A.TOT_SALE_AMT_Y)      AS TOT_SALE_AMT_Y
                 , SUM(A.ACHIEVERATE_Y)       AS ACHIEVERATE_Y
                 , SUM(A.SALE_AMT_CMPR_Y)     AS SALE_AMT_CMPR_Y
                 , SUM(A.SALEIRATE_Y)         AS SALEIRATE_Y
                 , ?						  AS UNIT
              FROM (
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                                             AS ORG_CD
                          , A.PUMBUN_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , SUM(H.TOT_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 매출일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD  
                             UNION ALL
                             SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.TOT_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 대비일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD 
                             UNION ALL
                             SELECT 
                                    C.STR_CD         AS STR_CD
                                  , J.BUY_ORG_CD    AS ORG_CD
                                  , C.PUMBUN_CD      AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_STRPBN J
                                  , DPS.PC_ORGMST K
                              WHERE C.STR_CD    = ?
                                AND C.EXE_DT     = ?      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND J.STR_CD    = C.STR_CD
                                AND J.PUMBUN_CD = C.PUMBUN_CD
                                AND J.BUY_ORG_CD = K.ORG_CD
								AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                             GROUP BY C.STR_CD
                                     ,J.BUY_ORG_CD
                                     ,C.PUMBUN_CD
                            ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                      UNION ALL     
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , A.PUMBUN_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_M
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_M
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_M
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_M
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , SUM(H.TOT_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(?, 1, 6)       -- 매출일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD  
                             UNION ALL
                             SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.TOT_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(?, 1, 6)       -- 대비일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD 
                             UNION ALL
                             SELECT 
                                    C.STR_CD         AS STR_CD
                                  , J.BUY_ORG_CD    AS ORG_CD
                                  , C.PUMBUN_CD      AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_STRPBN J
                                  , DPS.PC_ORGMST K
                              WHERE C.STR_CD    = ?
                                AND SUBSTR(C.EXE_DT,1,6) = SUBSTR(?, 1, 6)      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND J.STR_CD    = C.STR_CD
                                AND J.PUMBUN_CD = C.PUMBUN_CD
                                AND J.BUY_ORG_CD = K.ORG_CD
								AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                             GROUP BY C.STR_CD
                                     ,J.BUY_ORG_CD
                                     ,C.PUMBUN_CD
                            ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                      UNION ALL
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , A.PUMBUN_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_Y
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_Y
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_Y
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_Y
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.SALE_AMT_CMPR,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_Y
                       FROM (SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , SUM(H.TOT_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(?, 1, 4)       -- 매출일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD  
                             UNION ALL
                             SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.TOT_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(?, 1, 4)       -- 대비일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD 
                             UNION ALL
                             SELECT 
                                    C.STR_CD         AS STR_CD
                                  , J.BUY_ORG_CD    AS ORG_CD
                                  , C.PUMBUN_CD      AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_STRPBN J
                                  , DPS.PC_ORGMST K
                              WHERE C.STR_CD    = ?
                                AND SUBSTR(C.EXE_DT,1,4) = SUBSTR(?, 1, 4)      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND J.STR_CD    = C.STR_CD
                                AND J.PUMBUN_CD = C.PUMBUN_CD
                                AND J.BUY_ORG_CD = K.ORG_CD
								AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                             GROUP BY C.STR_CD
                                     ,J.BUY_ORG_CD
                                     ,C.PUMBUN_CD
                            ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                   )              A
                 , DPS.PC_ORGMST  B
                 , DPS.PC_STRPBN  C
             WHERE LPAD(A.ORG_CD, 8) || '00' = B.ORG_CD
               AND LPAD(A.ORG_CD, 2)         = C.STR_CD
               AND A.PUMBUN_CD               = C.PUMBUN_CD
             GROUP BY
                   A.PUMBUN_CD
                 , C.PUMBUN_NAME
             ORDER BY
                   A.PUMBUN_CD
                   ------------------2	  
        ]]>        
    </query>
    
    <query name="SEL_SALE_PUMBUN_TEMP">        
        <![CDATA[
            SELECT   
            		A.PUMBUN_CD              AS ORG_CD
                 , C.PUMBUN_NAME            AS ORG_NAME
                 , SUM(A.ORIGIN_SALE_TAMT)  AS ORIGIN_SALE_TAMT
                 , SUM(A.TOT_SALE_AMT)      AS TOT_SALE_AMT
                 , SUM(A.ACHIEVERATE)       AS ACHIEVERATE
                 , SUM(A.SALE_AMT_CMPR)     AS SALE_AMT_CMPR
                 , SUM(A.SALEIRATE)         AS SALEIRATE
                 
                 , SUM(A.ORIGIN_SALE_TAMT_M)  AS ORIGIN_SALE_TAMT_M
                 , SUM(A.TOT_SALE_AMT_M)   AS TOT_SALE_AMT_M
                 , SUM(A.ACHIEVERATE_M)       AS ACHIEVERATE_M
                 , SUM(A.SALE_AMT_CMPR_M)     AS SALE_AMT_CMPR_M
                 , SUM(A.SALEIRATE_M)         AS SALEIRATE_M
                 
                 , SUM(A.ORIGIN_SALE_TAMT_Y)  AS ORIGIN_SALE_TAMT_Y
                 , SUM(A.TOT_SALE_AMT_Y)   AS TOT_SALE_AMT_Y
                 , SUM(A.ACHIEVERATE_Y)       AS ACHIEVERATE_Y
                 , SUM(A.SALE_AMT_CMPR_Y)     AS SALE_AMT_CMPR_Y
                 , SUM(A.SALEIRATE_Y)         AS SALEIRATE_Y
              FROM (
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                                                AS ORG_CD
                          , A.PUMBUN_CD
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPUMBUN  C
                              WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
                                AND C.PUMBUN_CD = A.PUMBUN_CD
                                AND C.EXE_DT    = ?
                               )                                                                                     AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                               AS TOT_SALE_AMT
                          , (CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                                          FROM DPS.PS_ACTPUMBUN  C
                                         WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
                                           AND C.PUMBUN_CD = A.PUMBUN_CD
                                           AND C.EXE_DT    = ?
                                        ) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/(SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
									                              FROM DPS.PS_ACTPUMBUN  C
									                             WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
									                               AND C.PUMBUN_CD = A.PUMBUN_CD
									                               AND C.EXE_DT    = ?
									                             ))*100  END )            AS ACHIEVERATE
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                               AS SALE_AMT_CMPR
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN   A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?) E
                          , DPS.PC_ORGMST             F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT            = ?
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                     
                      UNION ALL     
                      
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , A.PUMBUN_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPUMBUN  C
                              WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
                                AND C.PUMBUN_CD = A.PUMBUN_CD
                                AND C.EXE_YM    = LPAD(?,6) 
                               )                                                       AS ORIGIN_SALE_TAMT_M
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                 AS TOT_SALE_AMT_M
                          , ( CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                                           FROM DPS.PS_ACTPUMBUN  C
                                          WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
                                            AND C.PUMBUN_CD = A.PUMBUN_CD
                                            AND C.EXE_YM    = LPAD(?,6) 
                                           ) = 0 THEN 0 
                              ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/ (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                                                        FROM DPS.PS_ACTPUMBUN  C
			                                                       WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
			                                                         AND C.PUMBUN_CD = A.PUMBUN_CD
			                                                         AND C.EXE_YM    = LPAD(?,6) 
			                                                      ) )*100      END)                                                         AS ACHIEVERATE_M
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                                             AS SALE_AMT_CMPR_M
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE_M
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN      A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    LIKE LPAD(?,6) || '%') E
                          , DPS.PC_ORGMST                               F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT    LIKE LPAD(?,6) || '%'
                      GROUP BY
                           LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                            
                      UNION ALL
                      
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , A.PUMBUN_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPUMBUN  C
                              WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
                                AND C.PUMBUN_CD      = A.PUMBUN_CD
                                AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
                               )                                                       AS ORIGIN_SALE_TAMT_Y
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                 AS TOT_SALE_AMT_Y
                          , (CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                                          FROM DPS.PS_ACTPUMBUN  C
                                         WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
                                           AND C.PUMBUN_CD      = A.PUMBUN_CD
                                           AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
                                          ) = 0 THEN 0 
                             ELSE( SUM(NVL(A.TOT_SALE_AMT,0))/ (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
		                                                          FROM DPS.PS_ACTPUMBUN  C
		                                                         WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
		                                                           AND C.PUMBUN_CD      = A.PUMBUN_CD
		                                                           AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
		                                                        ) )*100    END )                                                           AS ACHIEVERATE_Y
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                                              AS SALE_AMT_CMPR_Y
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN      A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    LIKE LPAD(?,4) || '%') E
                          , DPS.PC_ORGMST                               F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT    LIKE LPAD(?,4) || '%'
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                   )              A
                 , DPS.PC_ORGMST  B
                 , DPS.PC_STRPBN  C
             WHERE LPAD(A.ORG_CD, 8) || '00' = B.ORG_CD
               AND LPAD(A.ORG_CD, 2)         = C.STR_CD
               AND A.PUMBUN_CD               = C.PUMBUN_CD
               AND EXISTS ( SELECT MYORG.USER_ID
                              FROM COM.V_MYORG MYORG
                             WHERE MYORG.STR_CD      = SUBSTR(A.ORG_CD,1,2)
                               AND MYORG.DEPT_CD     = SUBSTR(A.ORG_CD,3,2)
                               AND MYORG.TEAM_CD     = SUBSTR(A.ORG_CD,5,2)
                               AND MYORG.PC_CD       = SUBSTR(A.ORG_CD,7,2)
                               AND MYORG.PUMBUN_CD   = A.PUMBUN_CD
                               AND MYORG.USER_ID     = ?
                           )
             GROUP BY
                   A.PUMBUN_CD
                 , C.PUMBUN_NAME
             ORDER BY
                   A.PUMBUN_CD
  ------------------3
            
        ]]>        
    </query>
    
    <query name="SEL_SALE_PC">        
        <![CDATA[
			WITH SALE_DATA AS 
			(
				SELECT STR_CD
				     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
				     , NORM_SALE_AMT SALE_AMT_M
				     , CUST_CNT CUST_CNT_M
				     , 0 SALE_AMT_Y
				     , 0 CUST_CNT_Y
				     , 0 PRO_AMT_M
				     , 0 PRO_AMT_Y
				     , 0 PRE_AMT_M
				     , 0 PCUST_CNT_M
				     , 0 PRE_AMT_Y
				     , 0 PCUST_CNT_Y 
				     , 0 PREPRO_AMT_M
				     , 0 PREPRO_AMT_Y
                 	 , 0 SALE_AMT_D
                 	 , 0 CUST_CNT_D
                 	 , 0 PRO_AMT_D
                 	 , 0 PRE_AMT_D
                 	 , 0 PCUST_CNT_D				     
				FROM DPS.PS_DAYPBN
				WHERE 1=1
				  AND STR_CD= ?
				  AND SALE_DT BETWEEN SUBSTR(?,1,6)||'00' AND ?
				  --- 월
			 UNION ALL
			  
				SELECT STR_CD
				     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
				     , 0 SALE_AMT_M
				     , 0 CUST_CNT_M
				     , NORM_SALE_AMT SALE_AMT_Y
				     , CUST_CNT CUST_CNT_Y
				     , 0 PRO_AMT_M
				     , 0 PRO_AMT_Y
				     , 0 PRE_AMT_M
				     , 0 PCUST_CNT_M
				     , 0 PRE_AMT_Y
				     , 0 PCUST_CNT_Y 
				     , 0 PREPRO_AMT_M
				     , 0 PREPRO_AMT_Y
                 	 , 0 SALE_AMT_D
                 	 , 0 CUST_CNT_D
                 	 , 0 PRO_AMT_D
                 	 , 0 PRE_AMT_D
                 	 , 0 PCUST_CNT_D				     
			    FROM DPS.PS_DAYPBN
				WHERE 1=1
				  AND STR_CD= ?
				  AND SALE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?
				  --- 년
			 UNION ALL
			  
				SELECT STR_CD
				     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
				     , 0 SALE_AMT_M
				     , 0 CUST_CNT_M
				     , 0 SALE_AMT_Y
				     , 0 CUST_CNT_Y
				     , 0 PRO_AMT_M
				     , ORIGIN_SALE_TAMT PRO_AMT_Y
				     , 0 PRE_AMT_M
				     , 0 PCUST_CNT_M
				     , 0 PRE_AMT_Y
				     , 0 PCUST_CNT_Y 
				     , 0 PREPRO_AMT_M
				     , 0 PREPRO_AMT_Y
                 	 , 0 SALE_AMT_D
                 	 , 0 CUST_CNT_D
                 	 , 0 PRO_AMT_D
                 	 , 0 PRE_AMT_D
                 	 , 0 PCUST_CNT_D				     
				  FROM DPS.PS_ACTPUMBUN
				WHERE 1=1
				  AND STR_CD=?
				  AND EXE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?
				  AND ORIGIN_SALE_TAMT <> 0
				 --- 목표년			  
			  UNION ALL
				  
				SELECT STR_CD
				     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
				     , 0 SALE_AMT_M
				     , 0 CUST_CNT_M
				     , 0 SALE_AMT_Y
				     , 0 CUST_CNT_Y
				     , ORIGIN_SALE_TAMT PRO_AMT_M
				     , 0 PRO_AMT_Y
				     , 0 PRE_AMT_M
				     , 0 PCUST_CNT_M
				     , 0 PRE_AMT_Y
				     , 0 PCUST_CNT_Y 
				     , 0 PREPRO_AMT_M
				     , 0 PREPRO_AMT_Y
                 	 , 0 SALE_AMT_D
                 	 , 0 CUST_CNT_D
                 	 , 0 PRO_AMT_D
                 	 , 0 PRE_AMT_D
                 	 , 0 PCUST_CNT_D				     
				  FROM DPS.PS_ACTPUMBUN
				WHERE 1=1
				  AND STR_CD= ?
				  AND EXE_DT  BETWEEN SUBSTR(?,1,6)||'00' AND ?
				  AND ORIGIN_SALE_TAMT <> 0
			      -- 목표월
			  UNION ALL  
				  
				  
				SELECT STR_CD
				     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
				     , 0 SALE_AMT_M
				     , 0 CUST_CNT_M
				     , 0 SALE_AMT_Y
				     , 0 CUST_CNT_Y
				     , 0 PRO_AMT_M
				     , 0 PRO_AMT_Y
				     , NORM_SALE_AMT PRE_AMT_M
				     , CUST_CNT PCUST_CNT_M
				     , 0 PRE_AMT_Y 
				     , 0 PCUST_CNT_Y 
				     , 0 PREPRO_AMT_M
				     , 0 PREPRO_AMT_Y
                 	 , 0 SALE_AMT_D
                 	 , 0 CUST_CNT_D
                 	 , 0 PRO_AMT_D
                 	 , 0 PRE_AMT_D
                 	 , 0 PCUST_CNT_D				     
				  FROM DPS.PS_DAYPBN
				WHERE 1=1
				  AND STR_CD= ?
				  AND SALE_DT BETWEEN SUBSTR(?,1,6)||'00' AND ? 
				 --- 대비월
			   UNION ALL
				  
				SELECT STR_CD
				     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
				     , 0 SALE_AMT_M
				     , 0 CUST_CNT_M
				     , 0 SALE_AMT_Y
				     , 0 CUST_CNT_Y
				     , 0 PRO_AMT_M
				     , 0 PRO_AMT_Y
				     , 0 PRE_AMT_M
				     , 0 PCUST_CNT_M
				     , NORM_SALE_AMT PRE_AMT_Y
				     , CUST_CNT PCUST_CNT_Y 
				     , 0 PREPRO_AMT_M
				     , 0 PREPRO_AMT_Y
                 	 , 0 SALE_AMT_D
                 	 , 0 CUST_CNT_D
                 	 , 0 PRO_AMT_D
                 	 , 0 PRE_AMT_D
                 	 , 0 PCUST_CNT_D				     
				  FROM DPS.PS_DAYPBN
				WHERE 1=1
				  AND STR_CD= ?
				  AND SALE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?
				  -- 대비년

                UNION ALL
                
                SELECT STR_CD
				     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
				     , 0 SALE_AMT_M
				     , 0 CUST_CNT_M
				     , 0 SALE_AMT_Y
				     , 0 CUST_CNT_Y
				     , 0 PRO_AMT_M
				     , 0 PRO_AMT_Y
				     , 0 PRE_AMT_M
				     , 0 PCUST_CNT_M
				     , 0 PRE_AMT_Y
				     , 0 PCUST_CNT_Y 
				     , 0 PREPRO_AMT_M
				     , 0 PREPRO_AMT_Y
                     , NORM_SALE_AMT SALE_AMT_D
                     , CUST_CNT CUST_CNT_D
                     , 0 PRO_AMT_D
                     , 0 PRE_AMT_D
                     , 0 PCUST_CNT_D
				FROM DPS.PS_DAYPBN
				WHERE 1=1
				  AND STR_CD= ?
				  AND SALE_DT BETWEEN ? AND ?
				  --- 일
			  UNION ALL
				  
				SELECT STR_CD
				     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
				     , 0 SALE_AMT_M
				     , 0 CUST_CNT_M
				     , 0 SALE_AMT_Y
				     , 0 CUST_CNT_Y
				     , 0 PRO_AMT_M
				     , 0 PRO_AMT_Y
				     , 0 PRE_AMT_M
				     , 0 PCUST_CNT_M
				     , 0 PRE_AMT_Y
				     , 0 PCUST_CNT_Y 
				     , 0 PREPRO_AMT_M
				     , 0 PREPRO_AMT_Y
                     , 0 SALE_AMT_D
                     , 0 CUST_CNT_D
                     , ORIGIN_SALE_TAMT PRO_AMT_D
                     , 0 PRE_AMT_D
                     , 0 PCUST_CNT_D
				  FROM DPS.PS_ACTPUMBUN
				WHERE 1=1
				  AND STR_CD= ?
				  AND EXE_YM BETWEEN ? AND ?  
                  AND EXE_DT BETWEEN ? AND ?
				  AND ORIGIN_SALE_TAMT <> 0
			      -- 목표일
			  UNION ALL 

                SELECT STR_CD
				     , SUBSTR(ORG_CD,1,8)||'00' ORG_CD
				     , 0 SALE_AMT_M
				     , 0 CUST_CNT_M
				     , 0 SALE_AMT_Y
				     , 0 CUST_CNT_Y
				     , 0 PRO_AMT_M
				     , 0 PRO_AMT_Y
				     , NORM_SALE_AMT PRE_AMT_M
				     , CUST_CNT PCUST_CNT_M
				     , 0 PRE_AMT_Y 
				     , 0 PCUST_CNT_Y 
				     , 0 PREPRO_AMT_M
				     , 0 PREPRO_AMT_Y
                     , 0 SALE_AMT_D
                     , 0 CUST_CNT_D
                     , 0 PRO_AMT_D
                     , NORM_SALE_AMT PRE_AMT_D
                     , CUST_CNT PCUST_CNT_D
				  FROM DPS.PS_DAYPBN
				WHERE 1=1
				  AND STR_CD= ?
				  AND SALE_DT BETWEEN ? AND ?				  
				/* UNION ALL  
				SELECT STR_CD, SUBSTR(ORG_CD,1,8)||'00' ORG_CD, 0 SALE_AMT_M, 0 CUST_CNT_M, 0 SALE_AMT_Y, 0 CUST_CNT_Y, 0 PRO_AMT_M, 0 PRO_AMT_Y, 0 PRE_AMT_M, 0 PCUST_CNT_M, 0 PRE_AMT_Y , 0 PCUST_CNT_Y 
				       , ORIGIN_SALE_TAMT PREPRO_AMT_M, 0 PREPRO_AMT_Y   FROM DPS.PS_ACTPUMBUN
				WHERE 1=1
				  AND STR_CD='01'
				  AND SUBSTR(EXE_YM,1,4) = '2016'
				  AND SUBSTR(EXE_DT,1,4) ='2016'
				  AND ORIGIN_SALE_TAMT <> 0
				  UNION ALL -- 대비목표년
				 
				SELECT STR_CD, SUBSTR(ORG_CD,1,8)||'00' ORG_CD, 0 SALE_AMT_M, 0 CUST_CNT_M, 0 SALE_AMT_Y, 0 CUST_CNT_Y, 0 PRO_AMT_M, 0 PRO_AMT_Y, 0 PRE_AMT_M, 0 PCUST_CNT_M, 0 PRE_AMT_Y , 0 PCUST_CNT_Y 
				       , 0 PREPRO_AMT_M, ORIGIN_SALE_TAMT PREPRO_AMT_Y   FROM DPS.PS_ACTPUMBUN
				WHERE 1=1  
				  AND STR_CD='01'
				  AND EXE_YM = '201603'  
				  AND SUBSTR(EXE_DT,1,6) ='201603'
				  AND ORIGIN_SALE_TAMT <> 0
				  
				   -- 대비목표월  
				   */
			) 
			
			SELECT C.ORG_NAME PART_NAME
			     , DECODE(GROUPLEVEL,'STR','합계','PART','소계',B.ORG_NAME) PC_NAME
			     -- 일
			     , PRO_AMT_D
			     , SALE_AMT_D
			     , DECODE(PRO_AMT_D,0,0,ROUND((SALE_AMT_D/PRO_AMT_D)*100,2)) AMT_ACHIV_RATE_D
			     , DECODE(PRE_AMT_D,0,0,ROUND(((SALE_AMT_D-PRE_AMT_D)/PRE_AMT_D)*100,2)) AMT_INCRE_RATE_D
			     , CUST_CNT_D
			     , DECODE(PCUST_CNT_D,0,0,ROUND(((CUST_CNT_D-PCUST_CNT_D)/PCUST_CNT_D)*100,2)) CNT_INCRE_RATE_D
			     , CNTAMT_D
			     , DECODE(PCNTAMT_D,0,0,ROUND(((CNTAMT_D-PCNTAMT_D)/PCNTAMT_D)*100,2)) CNTAMT_INCRE_RATE_D
			     , PRE_AMT_D
			     , PCUST_CNT_D
			     , PCNTAMT_D 			    
			     -- 월
			     , PRO_AMT_M
			     , SALE_AMT_M
			     , DECODE(PRO_AMT_M,0,0,ROUND((SALE_AMT_M/PRO_AMT_M)*100,2)) AMT_ACHIV_RATE_M
			     , DECODE(PRE_AMT_M,0,0,ROUND(((SALE_AMT_M-PRE_AMT_M)/PRE_AMT_M)*100,2)) AMT_INCRE_RATE_M
			     , CUST_CNT_M
			     , DECODE(PCUST_CNT_M,0,0,ROUND(((CUST_CNT_M-PCUST_CNT_M)/PCUST_CNT_M)*100,2)) CNT_INCRE_RATE_M
			     , CNTAMT_M
			     , DECODE(PCNTAMT_M,0,0,ROUND(((CNTAMT_M-PCNTAMT_M)/PCNTAMT_M)*100,2)) CNTAMT_INCRE_RATE_M
			     , PRE_AMT_M
			     , PCUST_CNT_M
			     , PCNTAMT_M
			     -- 년
			     , PRO_AMT_Y
			     , SALE_AMT_Y
			     , DECODE(PRO_AMT_Y,0,0,ROUND((SALE_AMT_Y/PRO_AMT_Y)*100,2)) AMT_ACHIV_RATE_Y
			     , DECODE(PRE_AMT_Y,0,0,ROUND(((SALE_AMT_Y-PRE_AMT_Y)/PRE_AMT_Y)*100,2)) AMT_INCRE_RATE_Y
			     , CUST_CNT_Y
			     , DECODE(PCUST_CNT_Y,0,0,ROUND(((CUST_CNT_Y-PCUST_CNT_Y)/PCUST_CNT_Y)*100,2)) CNT_INCRE_RATE_Y
			     , CNTAMT_Y
			     , DECODE(PCNTAMT_M,0,0,ROUND(((CNTAMT_M-PCNTAMT_M)/PCNTAMT_M)*100,2)) CNTAMT_INCRE_RATE_M
			     , PRE_AMT_Y
			     , PCUST_CNT_Y
			     , PCNTAMT_Y
			     , A.STR_CD
			     , A.ORG_CD
			     , ? UNIT
			 FROM
			(
			SELECT STR_CD
			     , ORG_CD
			     , SUM(SALE_AMT_M) SALE_AMT_M
			     , SUM(CUST_CNT_M) CUST_CNT_M
			     , SUM(SALE_AMT_Y) SALE_AMT_Y
			     , SUM(CUST_CNT_Y) CUST_CNT_Y
			     , SUM(PRO_AMT_M) PRO_AMT_M
			     , SUM(PRO_AMT_Y) PRO_AMT_Y
			     , SUM(PRE_AMT_M) PRE_AMT_M
			     , SUM(PCUST_CNT_M) PCUST_CNT_M
			     , SUM(PRE_AMT_Y) PRE_AMT_Y
			     , SUM(PCUST_CNT_Y) PCUST_CNT_Y
			--     , SUM(PREPRO_AMT_M) PREPRO_AMT_M
			--     , SUM(PREPRO_AMT_Y) PREPRO_AMT_Y
			     , DECODE(SUM(CUST_CNT_M),0,0,ROUND(SUM(SALE_AMT_M)/SUM(CUST_CNT_M),0) ) CNTAMT_M     
			     , DECODE(SUM(PCUST_CNT_M),0,0,ROUND(SUM(PRE_AMT_M)/SUM(PCUST_CNT_M),0) ) PCNTAMT_M     
			     , DECODE(SUM(CUST_CNT_Y),0,0,ROUND(SUM(SALE_AMT_Y)/SUM(CUST_CNT_Y),0) ) CNTAMT_Y     
			     , DECODE(SUM(PCUST_CNT_Y),0,0,ROUND(SUM(PRE_AMT_Y)/SUM(PCUST_CNT_Y),0) ) PCNTAMT_Y
			     , SUM(SALE_AMT_D) SALE_AMT_D
			     , SUM(CUST_CNT_D) CUST_CNT_D
			     , SUM(PRO_AMT_D) PRO_AMT_D
			     , SUM(PRE_AMT_D) PRE_AMT_D
			     , SUM(PCUST_CNT_D) PCUST_CNT_D
			     , DECODE(SUM(CUST_CNT_D),0,0,ROUND(SUM(SALE_AMT_D)/SUM(CUST_CNT_D),0) ) CNTAMT_D     
			     , DECODE(SUM(PCUST_CNT_D),0,0,ROUND(SUM(PRE_AMT_D)/SUM(PCUST_CNT_D),0) ) PCNTAMT_D 			          
			     , 'PC' GROUPLEVEL
			FROM SALE_DATA
			GROUP BY STR_CD, ORG_CD 
			UNION ALL
			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,6)||'0000' ORG_CD
			     , SUM(SALE_AMT_M) SALE_AMT_M
			     , SUM(CUST_CNT_M) CUST_CNT_M
			     , SUM(SALE_AMT_Y) SALE_AMT_Y
			     , SUM(CUST_CNT_Y) CUST_CNT_Y
			     , SUM(PRO_AMT_M) PRO_AMT_M
			     , SUM(PRO_AMT_Y) PRO_AMT_Y
			     , SUM(PRE_AMT_M) PRE_AMT_M
			     , SUM(PCUST_CNT_M) PCUST_CNT_M
			     , SUM(PRE_AMT_Y) PRE_AMT_Y
			     , SUM(PCUST_CNT_Y) PCUST_CNT_Y
			--     , SUM(PREPRO_AMT_M) PREPRO_AMT_M
			--     , SUM(PREPRO_AMT_Y) PREPRO_AMT_Y
			     , DECODE(SUM(CUST_CNT_M),0,0,ROUND(SUM(SALE_AMT_M)/SUM(CUST_CNT_M),0) ) CNTAMT_M     
			     , DECODE(SUM(PCUST_CNT_M),0,0,ROUND(SUM(PRE_AMT_M)/SUM(PCUST_CNT_M),0) ) PCNTAMT_M     
			     , DECODE(SUM(CUST_CNT_Y),0,0,ROUND(SUM(SALE_AMT_Y)/SUM(CUST_CNT_Y),0) ) CNTAMT_Y     
			     , DECODE(SUM(PCUST_CNT_Y),0,0,ROUND(SUM(PRE_AMT_Y)/SUM(PCUST_CNT_Y),0) ) PCNTAMT_Y
			     , SUM(SALE_AMT_D) SALE_AMT_D
			     , SUM(CUST_CNT_D) CUST_CNT_D
			     , SUM(PRO_AMT_D) PRO_AMT_D
			     , SUM(PRE_AMT_D) PRE_AMT_D
			     , SUM(PCUST_CNT_D) PCUST_CNT_D
			     , DECODE(SUM(CUST_CNT_D),0,0,ROUND(SUM(SALE_AMT_D)/SUM(CUST_CNT_D),0) ) CNTAMT_D     
			     , DECODE(SUM(PCUST_CNT_D),0,0,ROUND(SUM(PRE_AMT_D)/SUM(PCUST_CNT_D),0) ) PCNTAMT_D 			           
			     , 'PART' GROUPLEVEL
			FROM SALE_DATA
			GROUP BY STR_CD, SUBSTR(ORG_CD,1,6)||'0000' 
			UNION ALL
			SELECT STR_CD
			     , SUBSTR(ORG_CD,1,2)||'00000000' ORG_CD
			     , SUM(SALE_AMT_M) SALE_AMT_M
			     , SUM(CUST_CNT_M) CUST_CNT_M
			     , SUM(SALE_AMT_Y) SALE_AMT_Y
			     , SUM(CUST_CNT_Y) CUST_CNT_Y
			     , SUM(PRO_AMT_M) PRO_AMT_M
			     , SUM(PRO_AMT_Y) PRO_AMT_Y
			     , SUM(PRE_AMT_M) PRE_AMT_M
			     , SUM(PCUST_CNT_M) PCUST_CNT_M
			     , SUM(PRE_AMT_Y) PRE_AMT_Y
			     , SUM(PCUST_CNT_Y) PCUST_CNT_Y
			--     , SUM(PREPRO_AMT_M) PREPRO_AMT_M
			--     , SUM(PREPRO_AMT_Y) PREPRO_AMT_Y
			     , DECODE(SUM(CUST_CNT_M),0,0,ROUND(SUM(SALE_AMT_M)/SUM(CUST_CNT_M),0) ) CNTAMT_M     
			     , DECODE(SUM(PCUST_CNT_M),0,0,ROUND(SUM(PRE_AMT_M)/SUM(PCUST_CNT_M),0) ) PCNTAMT_M     
			     , DECODE(SUM(CUST_CNT_Y),0,0,ROUND(SUM(SALE_AMT_Y)/SUM(CUST_CNT_Y),0) ) CNTAMT_Y     
			     , DECODE(SUM(PCUST_CNT_Y),0,0,ROUND(SUM(PRE_AMT_Y)/SUM(PCUST_CNT_Y),0) ) PCNTAMT_Y 
			     , SUM(SALE_AMT_D) SALE_AMT_D
			     , SUM(CUST_CNT_D) CUST_CNT_D
			     , SUM(PRO_AMT_D) PRO_AMT_D
			     , SUM(PRE_AMT_D) PRE_AMT_D
			     , SUM(PCUST_CNT_D) PCUST_CNT_D
			     , DECODE(SUM(CUST_CNT_D),0,0,ROUND(SUM(SALE_AMT_D)/SUM(CUST_CNT_D),0) ) CNTAMT_D     
			     , DECODE(SUM(PCUST_CNT_D),0,0,ROUND(SUM(PRE_AMT_D)/SUM(PCUST_CNT_D),0) ) PCNTAMT_D 			          
			     , 'STR' GROUPLEVEL
			FROM SALE_DATA
			GROUP BY STR_CD, SUBSTR(ORG_CD,1,2)||'00000000' 
			) A, DPS.PC_ORGMST B, DPS.PC_ORGMST C
			WHERE A.STR_CD = B.STR_CD
			  AND A.ORG_CD = B.ORG_CD
			  AND SUBSTR(A.ORG_CD,1,6)||'0000' = C.ORG_CD
			ORDER BY STR_CD,ORG_CD
          
   			----- 1매출현황
        ]]>        
    </query>
    
    <query name="SEL_SALE_PC2">        
        <![CDATA[
		   	SELECT   
		   			A.ORG_CD
                     , B.ORG_SHORT_NAME         AS ORG_NAME
                     , SUM(A.ORIGIN_SALE_TAMT)  AS ORIGIN_SALE_TAMT
                     , SUM(A.TOT_SALE_AMT)   AS TOT_SALE_AMT
                     , SUM(A.ACHIEVERATE)       AS ACHIEVERATE
                     , SUM(A.SALE_AMT_CMPR)     AS SALE_AMT_CMPR
                     , SUM(A.SALEIRATE)         AS SALEIRATE
                     , SUM(A.ORIGIN_SALE_TAMT_M)  AS ORIGIN_SALE_TAMT_M
                     , SUM(A.TOT_SALE_AMT_M)   AS TOT_SALE_AMT_M
                     , SUM(A.ACHIEVERATE_M)       AS ACHIEVERATE_M
                     , SUM(A.SALE_AMT_CMPR_M)     AS SALE_AMT_CMPR_M
                     , SUM(A.SALEIRATE_M)         AS SALEIRATE_M
                     , SUM(A.ORIGIN_SALE_TAMT_Y)  AS ORIGIN_SALE_TAMT_Y
                     , SUM(A.TOT_SALE_AMT_Y)   AS TOT_SALE_AMT_Y
                     , SUM(A.ACHIEVERATE_Y)       AS ACHIEVERATE_Y
                     , SUM(A.SALE_AMT_CMPR_Y)     AS SALE_AMT_CMPR_Y
                     , SUM(A.SALEIRATE_Y)         AS SALEIRATE_Y
                     , ?                          AS SALEDT
                     , ?                          AS CMPRDT
                     , ? 						  AS UNIT
                FROM (
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                                             AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , SUM(H.TOT_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 매출일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.TOT_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 대비일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    C.STR_CD         AS STR_CD
                                  , SUBSTR(L.BUY_ORG_CD,1,8)||'00'    AS ORG_CD
                                  , 0                              AS TOT_SALE_AMT
                                  , 0                              AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_ORGMST K
                                  , DPS.PC_STRPBN L
                              WHERE C.STR_CD    = ?
                                AND C.EXE_DT     = ?      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND L.STR_CD = C.STR_CD
                                AND L.PUMBUN_CD = C.PUMBUN_CD
                                AND K.ORG_CD    = L.BUY_ORG_CD
                                AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY C.STR_CD
                                     , SUBSTR(L.BUY_ORG_CD,1,8)
                          ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                      UNION ALL     
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_M
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_M
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_M
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_M
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT  
                                    H.STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , SUM(H.TOT_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(?,1,6)      -- 매출일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.TOT_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(?,1,6)      -- 대비일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    C.STR_CD         AS STR_CD
                                  , SUBSTR(L.BUY_ORG_CD,1,8)||'00'    AS ORG_CD
                                  , 0                              AS TOT_SALE_AMT
                                  , 0                              AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_ORGMST K
                                  , DPS.PC_STRPBN L
                              WHERE C.STR_CD    = ?
                                AND SUBSTR(C.EXE_DT,1,6) = SUBSTR(?,1,6)      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND L.STR_CD = C.STR_CD
                                AND L.PUMBUN_CD = C.PUMBUN_CD
                                AND K.ORG_CD    = L.BUY_ORG_CD
                                AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY C.STR_CD
                                     , SUBSTR(L.BUY_ORG_CD,1,8)
                          ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                      UNION ALL
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_Y
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_Y
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_Y
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_Y
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_Y
                       FROM (SELECT  
                                    H.STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , SUM(H.TOT_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(?,1,4)      -- 매출일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.TOT_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(?,1,4)      -- 대비일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    C.STR_CD         AS STR_CD
                                  , SUBSTR(L.BUY_ORG_CD,1,8)||'00'    AS ORG_CD
                                  , 0                              AS TOT_SALE_AMT
                                  , 0                              AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_ORGMST K
                                  , DPS.PC_STRPBN L
                              WHERE C.STR_CD    = ?
                                AND SUBSTR(C.EXE_DT,1,4) = SUBSTR(?,1,4)      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND L.STR_CD = C.STR_CD
                                AND L.PUMBUN_CD = C.PUMBUN_CD
                                AND K.ORG_CD    = L.BUY_ORG_CD
                                AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY C.STR_CD
                                     , SUBSTR(L.BUY_ORG_CD,1,8)
                          ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                   )              A
                 , DPS.PC_ORGMST  B
             WHERE A.ORG_CD = B.ORG_CD
              GROUP BY
                    A.ORG_CD
                  , B.ORG_SHORT_NAME
              ORDER BY
                    A.ORG_CD 
                    ------------------5
		            
        ]]>        
    </query>
    
    <query name="SEL_SALE_PC_TEMP">        
        <![CDATA[
            SELECT   
            		A.ORG_CD
                 , B.ORG_SHORT_NAME         AS ORG_NAME
                 , SUM(A.ORIGIN_SALE_TAMT)  AS ORIGIN_SALE_TAMT
                 , SUM(A.TOT_SALE_AMT)   AS TOT_SALE_AMT
                 , SUM(A.ACHIEVERATE)       AS ACHIEVERATE
                 , SUM(A.SALE_AMT_CMPR)     AS SALE_AMT_CMPR
                 , SUM(A.SALEIRATE)         AS SALEIRATE
                 
                 , SUM(A.ORIGIN_SALE_TAMT_M)  AS ORIGIN_SALE_TAMT_M
                 , SUM(A.TOT_SALE_AMT_M)   AS TOT_SALE_AMT_M
                 , SUM(A.ACHIEVERATE_M)       AS ACHIEVERATE_M
                 , SUM(A.SALE_AMT_CMPR_M)     AS SALE_AMT_CMPR_M
                 , SUM(A.SALEIRATE_M)         AS SALEIRATE_M
                 
                 , SUM(A.ORIGIN_SALE_TAMT_Y)  AS ORIGIN_SALE_TAMT_Y
                 , SUM(A.TOT_SALE_AMT_Y)   AS TOT_SALE_AMT_Y
                 , SUM(A.ACHIEVERATE_Y)       AS ACHIEVERATE_Y
                 , SUM(A.SALE_AMT_CMPR_Y)     AS SALE_AMT_CMPR_Y
                 , SUM(A.SALEIRATE_Y)         AS SALEIRATE_Y
                 , ?                          AS SALEDT
                 , ?                          AS CMPRDT
              FROM (
                     SELECT  LPAD(A.ORG_CD, 8) || '00'                                                                              AS ORG_CD
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPC  C
                              WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
                                AND C.EXE_DT = ? 
                               )                                                       AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                                              AS TOT_SALE_AMT
                          , (CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                              FROM DPS.PS_ACTPC  C
			                             WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
			                               AND C.EXE_DT = ? 
			                            ) = 0 THEN 0
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/(SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
									                              FROM DPS.PS_ACTPC  C
									                             WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
									                               AND C.EXE_DT = ? 
									                            ) )*100  END)                                      AS ACHIEVERATE
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                                              AS SALE_AMT_CMPR
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN      A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT      = ?) E
                          , DPS.PC_ORGMST             F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT            = ?
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                     
                      UNION ALL     
                          
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPC  C
                              WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
                                AND C.EXE_YM = LPAD(?,6) 
                               )                                                       AS ORIGIN_SALE_TAMT_M
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                 AS TOT_SALE_AMT_M
                          , (CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                              FROM DPS.PS_ACTPC  C
			                             WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
			                               AND C.EXE_YM = LPAD(?,6) 
			                            ) = 0 THEN 0 
                             ELSE  ( SUM(NVL(A.TOT_SALE_AMT,0))/ (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                                                        FROM DPS.PS_ACTPC  C
			                                                       WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
			                                                         AND C.EXE_YM = LPAD(?,6) 
			                                                      ) )*100  END)        AS ACHIEVERATE_M
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                                              AS SALE_AMT_CMPR_M
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE_M
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN      A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT      LIKE LPAD(?,6) || '%') E
                          , DPS.PC_ORGMST                                 F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT    LIKE LPAD(?,6) || '%'
                      GROUP BY
                           LPAD(A.ORG_CD, 8)
                            
                      UNION ALL
                      
                     SELECT  LPAD(A.ORG_CD, 8) || '00'                AS ORG_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPC  C
                              WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
                                AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
                               )                                                       AS ORIGIN_SALE_TAMT_Y
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                                              AS TOT_SALE_AMT_Y
                          , (CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                              FROM DPS.PS_ACTPC  C
			                             WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
			                               AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
			                            )  = 0 THEN 0
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/ (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                                                       FROM DPS.PS_ACTPC  C
			                                                      WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
			                                                        AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
			                                                     ) )*100   END)         AS ACHIEVERATE_Y
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                                              AS SALE_AMT_CMPR_Y
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN      A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT      LIKE LPAD(?,4) || '%') E
                          , DPS.PC_ORGMST                                     F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT    LIKE LPAD(?,4) || '%'
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                   )              A
                 , DPS.PC_ORGMST  B
             WHERE A.ORG_CD = B.ORG_CD
               AND EXISTS  ( SELECT MYORG.USER_ID
                               FROM COM.V_MYORG MYORG
                              WHERE MYORG.STR_CD      = B.STR_CD
                                AND MYORG.DEPT_CD     = B.DEPT_CD
                                AND MYORG.TEAM_CD     = B.TEAM_CD
                                AND MYORG.PC_CD       = B.PC_CD
                                AND MYORG.USER_ID     = ?
                           )
             GROUP BY
                   A.ORG_CD
                 , B.ORG_SHORT_NAME
             ORDER BY
                   A.ORG_CD
                   ------------------6
  
            
        ]]>        
    </query>
    
    <query name="SEL_CMPRDT">        
        <![CDATA[
             SELECT NVL(MAX(CMPR_DT), TO_CHAR(ADD_MONTHS(TO_DATE(?, 'YYYYMMDD'),-12), 'YYYYMMDD'))
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD    = ?
               AND SALE_DT = ?
        ]]>        
    </query>
    
    <!--  -->
    <query name="SEL_CMNTS2">        
        <![CDATA[
			WITH GRP_LIST AS
			(
				SELECT A.GROUP_CD
				     , REPLACE(B.GROUP_NAME,'팀','') GROUP_NAME
				     , A.USER_ID
				     , A.USER_NAME
				     , A.POSITION 
				     , B.GRP_ORDER
				     , A.INGRP_ORDER
				FROM COM.TC_USRMST A
				   , COM.TC_GROUP B
				WHERE 1=1
				AND A.USE_YN = 'Y'
				AND A.GROUP_CD = B.GROUP_CD
				AND A.GROUP_CD IN ('104','112','113','114','115')
				ORDER BY GRP_ORDER, INGRP_ORDER, USER_ID
			)
			
			SELECT B.GROUP_NAME AS GROUP_NAME
			     , DECODE(A.GUBUN,1,A.CMNTS,NULL) AS POST_CMNTS
			     , DECODE(A.GUBUN,0,A.CMNTS,NULL) AS PRE_CMNTS
			     , B.USER_NAME||' '||B.POSITION AS REG_USER
			     , B.GRP_ORDER AS GRP_ORDER
			     , B.INGRP_ORDER AS INGRP_ORDER
			     , A.USER_ID AS USER_ID
			FROM
			(
				-- 당월 코멘트
				SELECT A.GRP_CD
				     , A.USER_ID
				     , A.CMNTS
				     , 0 GUBUN
				  FROM DPS.PS_RPT_CMNTS A
				WHERE 1=1
				  AND A.RPT_FLAG = 'W'
				  AND A.RPT_DT = ?||DPS.FN_GET_WEEK_INFO('',?)
				  AND ORG_CD IS NULL
				UNION ALL
				-- 전월 코멘트
				SELECT A.GRP_CD
				     , A.USER_ID
				     , A.CMNTS
				     , 1 GUBUN
				  FROM DPS.PS_RPT_CMNTS A
				WHERE 1=1
				  AND A.RPT_FLAG = 'W'
				  AND A.RPT_DT = ?||DPS.FN_GET_WEEK_INFO('',TO_CHAR(TO_DATE(?)-7,'YYYYMMDD'))
				  AND ORG_CD IS NULL
			) A
			, GRP_LIST B
			WHERE 1=1
			  AND A.GRP_CD = B.GROUP_CD
			  AND A.USER_ID = B.USER_ID
			ORDER BY GRP_ORDER , INGRP_ORDER , USER_ID
        ]]>        
    </query>
    
    
    <!--  -->
    <query name="SEL_CMNTS">        
        <![CDATA[    
			WITH ORG_LIST AS
			(
			SELECT A.GROUP_CD
			     , REPLACE(B.GROUP_NAME,'팀','') GROUP_NAME
			     , A.USER_ID
			     , A.USER_NAME
			     , A.POSITION 
			     , SUBSTR(C.ORG_CD,1,6)||'0000' ORG_CD_TOP
			     , E.ORG_NAME ORG_NAME_TOP 
			     , C.ORG_CD
			     , D.ORG_NAME
			     , B.GRP_ORDER
			     , A.INGRP_ORDER
			FROM COM.TC_USRMST A
			   , COM.TC_GROUP B
			   , COM.TC_USRORGAUTH C
			   , DPS.PC_ORGMST D
			   , DPS.PC_ORGMST E
			WHERE 1=1
			AND A.USE_YN = 'Y'
			AND A.GROUP_CD = B.GROUP_CD
			AND A.GROUP_CD IN ('113','114')
			AND A.USER_ID = C.USER_ID
			AND C.ORG_CD = D.ORG_CD
			AND SUBSTR(C.ORG_CD,1,6)||'0000' = E.ORG_CD
			ORDER BY GRP_ORDER, INGRP_ORDER, USER_ID,ORG_CD_TOP,ORG_CD
			)
			SELECT  B.ORG_NAME_TOP
			      , B.ORG_NAME
			      , A.CMNTS1
			      , A.CMNTS2
			      , B.GRP_ORDER
			      , B.INGRP_ORDER
			      , B.USER_ID
			      , B.ORG_CD_TOP
			      , B.ORG_CD
			FROM
			(
			SELECT GRP_CD
			     , USER_ID
			     , ORG_CD
			     , MIN(DECODE(RPT_FLAG,'SW1',CMNTS, NULL)) CMNTS1
			     , MIN(DECODE(RPT_FLAG,'SW2',CMNTS, NULL)) CMNTS2
			 FROM DPS.PS_RPT_CMNTS
			WHERE 1=1
			 AND STR_CD = '01'
			 AND RPT_DT = ?||DPS.FN_GET_WEEK_INFO('',?)
			 AND RPT_FLAG LIKE 'SW%'
			 GROUP BY GRP_CD, USER_ID, ORG_CD
			) A
			, ORG_LIST B
			WHERE 1=1
			  AND A.GRP_CD = B.GROUP_CD
			  AND A.USER_ID = B.USER_ID
			  AND A.ORG_CD = B.ORG_CD
			--ORDER BY GRP_ORDER, INGRP_ORDER, USER_ID,ORG_CD_TOP,ORG_CD
			ORDER BY GRP_ORDER, ORG_CD_TOP,ORG_CD,INGRP_ORDER
            ]]>        
    </query>
    
    
</service>