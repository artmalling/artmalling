<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 박종은
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2010.04.20
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/psal401.ps">

    <gauce name="H_SEL_MASTER"> 
        <column colName="ORG_CD"                  colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_NAME"                colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORIGIN_SALE_TAMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_SALE_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVERATE"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_CMPR"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALEIRATE"               colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORIGIN_SALE_TAMT_M"      colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_SALE_AMT_M"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVERATE_M"           colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_CMPR_M"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALEIRATE_M"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORIGIN_SALE_TAMT_Y"      colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_SALE_AMT_Y"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVERATE_Y"           colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_CMPR_Y"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALEIRATE_Y"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALEDT"                  colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMPRDT"                  colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="UNIT"    	              colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_DETAIL"> 
        <column colName="ORG_CD"                  colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_NAME"                colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORIGIN_SALE_TAMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_SALE_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVERATE"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_CMPR"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALEIRATE"               colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORIGIN_SALE_TAMT_M"      colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_SALE_AMT_M"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVERATE_M"           colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_CMPR_M"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALEIRATE_M"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORIGIN_SALE_TAMT_Y"      colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_SALE_AMT_Y"          colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVERATE_Y"           colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT_CMPR_Y"         colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALEIRATE_Y"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="UNIT"    	              colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_CMPRDT"> 
        <column colName="CMPR_DT"                 colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    
    <!-- 쿼리는 전부 대문자 -->
    <!-- 당초팀별월매출계획 조회 쿼리  -->
   
   <query name="SEL_SALE_PUMBUN">        
        <![CDATA[
	    	    SELECT 
	    	    	A.PUMBUN_CD               AS ORG_CD
                 , C.PUMBUN_NAME              AS ORG_NAME
                 , SUM(A.ORIGIN_SALE_TAMT)    AS ORIGIN_SALE_TAMT
                 , SUM(A.TOT_SALE_AMT)        AS TOT_SALE_AMT
                 , SUM(A.ACHIEVERATE)         AS ACHIEVERATE
                 , SUM(A.SALE_AMT_CMPR)       AS SALE_AMT_CMPR
                 , SUM(A.SALEIRATE)           AS SALEIRATE
                 , SUM(A.ORIGIN_SALE_TAMT_M)  AS ORIGIN_SALE_TAMT_M
                 , SUM(A.TOT_SALE_AMT_M)      AS TOT_SALE_AMT_M
                 , SUM(A.ACHIEVERATE_M)       AS ACHIEVERATE_M
                 , SUM(A.SALE_AMT_CMPR_M)     AS SALE_AMT_CMPR_M
                 , SUM(A.SALEIRATE_M)         AS SALEIRATE_M
                 , SUM(A.ORIGIN_SALE_TAMT_Y)  AS ORIGIN_SALE_TAMT_Y
                 , SUM(A.TOT_SALE_AMT_Y)      AS TOT_SALE_AMT_Y
                 , SUM(A.ACHIEVERATE_Y)       AS ACHIEVERATE_Y
                 , SUM(A.SALE_AMT_CMPR_Y)     AS SALE_AMT_CMPR_Y
                 , SUM(A.SALEIRATE_Y)         AS SALEIRATE_Y
                 , ?						  AS UNIT
              FROM (
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                                             AS ORG_CD
                          , A.PUMBUN_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT 
                                    H.STR_CD
                                  , I.SALE_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 매출일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.SALE_ORG_CD
                                     , H.PUMBUN_CD  
                             UNION ALL
                             SELECT 
                                    H.STR_CD
                                  , I.SALE_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 대비일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.SALE_ORG_CD
                                     , H.PUMBUN_CD 
                             UNION ALL
                             SELECT 
                                    C.STR_CD         AS STR_CD
                                  , J.SALE_ORG_CD    AS ORG_CD
                                  , C.PUMBUN_CD      AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_STRPBN J
                                  , DPS.PC_ORGMST K
                              WHERE C.STR_CD    = ?
                                AND C.EXE_DT     = ?      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND J.STR_CD    = C.STR_CD
                                AND J.PUMBUN_CD = C.PUMBUN_CD
                                AND J.SALE_ORG_CD = K.ORG_CD
								AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                             GROUP BY C.STR_CD
                                     ,J.SALE_ORG_CD
                                     ,C.PUMBUN_CD
                            ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                      UNION ALL     
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , A.PUMBUN_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_M
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_M
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_M
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_M
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT 
                                    H.STR_CD
                                  , I.SALE_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                --AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(일자, 1, 6)       -- 매출일자
                                AND H.SALE_DT BETWEEN SUBSTR(?,1,6)||'00' AND ?   -- 170318 수정 : 김준영 (월 누계 아닌 조회일 기준 누계
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.SALE_ORG_CD
                                     , H.PUMBUN_CD  
                             UNION ALL
                             SELECT 
                                    H.STR_CD
                                  , I.SALE_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                --AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(일자, 1, 6)       -- 대비일자
                                AND H.SALE_DT BETWEEN SUBSTR(?,1,6)||'00' AND ?   -- 170318 수정 : 김준영 (월 누계 아닌 조회일 기준 누계
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.SALE_ORG_CD
                                     , H.PUMBUN_CD 
                             UNION ALL
                             SELECT 
                                    C.STR_CD         AS STR_CD
                                  , J.SALE_ORG_CD    AS ORG_CD
                                  , C.PUMBUN_CD      AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_STRPBN J
                                  , DPS.PC_ORGMST K
                              WHERE C.STR_CD    = ?
                                --AND SUBSTR(C.EXE_DT,1,6) = SUBSTR(일자, 1, 6)      -- 매출일자
                                AND C.EXE_DT BETWEEN SUBSTR(?,1,6)||'00' AND ?   -- 170318 수정 : 김준영 (월 누계 아닌 조회일 기준 누계
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND J.STR_CD    = C.STR_CD
                                AND J.PUMBUN_CD = C.PUMBUN_CD
                                AND J.SALE_ORG_CD = K.ORG_CD
								AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                             GROUP BY C.STR_CD
                                     ,J.SALE_ORG_CD
                                     ,C.PUMBUN_CD
                            ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                      UNION ALL
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , A.PUMBUN_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_Y
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_Y
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_Y
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_Y
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_Y
                       FROM (SELECT 
                                    H.STR_CD
                                  , I.SALE_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                --AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(일자, 1, 4)       -- 매출일자
                                AND H.SALE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?   -- 170318 수정 : 김준영 (년 누계 아닌 조회일 기준 누계
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.SALE_ORG_CD
                                     , H.PUMBUN_CD  
                             UNION ALL
                             SELECT 
                                    H.STR_CD
                                  , I.SALE_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                --AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(일자, 1, 4)       -- 대비일자
                                AND H.SALE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?   -- 170318 수정 : 김준영 (년 누계 아닌 조회일 기준 누계
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.SALE_ORG_CD
                                     , H.PUMBUN_CD 
                             UNION ALL
                             SELECT 
                                    C.STR_CD         AS STR_CD
                                  , J.SALE_ORG_CD    AS ORG_CD
                                  , C.PUMBUN_CD      AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_STRPBN J
                                  , DPS.PC_ORGMST K
                              WHERE C.STR_CD    = ?
                                --AND SUBSTR(C.EXE_DT,1,4) = SUBSTR(일자, 1, 4)      -- 매출일자
                                AND C.EXE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?   -- 170318 수정 : 김준영  (년 누계 아닌 조회일 기준 누계
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND J.STR_CD    = C.STR_CD
                                AND J.PUMBUN_CD = C.PUMBUN_CD
                                AND J.SALE_ORG_CD = K.ORG_CD
								AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                             GROUP BY C.STR_CD
                                     ,J.SALE_ORG_CD
                                     ,C.PUMBUN_CD
                            ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                   )              A
                 , DPS.PC_ORGMST  B
                 , DPS.PC_STRPBN  C
             WHERE LPAD(A.ORG_CD, 8) || '00' = B.ORG_CD
               AND LPAD(A.ORG_CD, 2)         = C.STR_CD
               AND A.PUMBUN_CD               = C.PUMBUN_CD
             GROUP BY
                   A.PUMBUN_CD
                 , C.PUMBUN_NAME
             ORDER BY
                   A.PUMBUN_CD	  
                   ------------------1
        ]]>        
    </query>
    
     <query name="SEL_SALE_PUMBUN2">        
        <![CDATA[
	        SELECT   
	        		A.PUMBUN_CD               AS ORG_CD
                 , C.PUMBUN_NAME              AS ORG_NAME
                 , SUM(A.ORIGIN_SALE_TAMT)    AS ORIGIN_SALE_TAMT
                 , SUM(A.TOT_SALE_AMT)        AS TOT_SALE_AMT
                 , SUM(A.ACHIEVERATE)         AS ACHIEVERATE
                 , SUM(A.SALE_AMT_CMPR)       AS SALE_AMT_CMPR
                 , SUM(A.SALEIRATE)           AS SALEIRATE
                 , SUM(A.ORIGIN_SALE_TAMT_M)  AS ORIGIN_SALE_TAMT_M
                 , SUM(A.TOT_SALE_AMT_M)      AS TOT_SALE_AMT_M
                 , SUM(A.ACHIEVERATE_M)       AS ACHIEVERATE_M
                 , SUM(A.SALE_AMT_CMPR_M)     AS SALE_AMT_CMPR_M
                 , SUM(A.SALEIRATE_M)         AS SALEIRATE_M
                 , SUM(A.ORIGIN_SALE_TAMT_Y)  AS ORIGIN_SALE_TAMT_Y
                 , SUM(A.TOT_SALE_AMT_Y)      AS TOT_SALE_AMT_Y
                 , SUM(A.ACHIEVERATE_Y)       AS ACHIEVERATE_Y
                 , SUM(A.SALE_AMT_CMPR_Y)     AS SALE_AMT_CMPR_Y
                 , SUM(A.SALEIRATE_Y)         AS SALEIRATE_Y
                 , ?						  AS UNIT
              FROM (
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                                             AS ORG_CD
                          , A.PUMBUN_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 매출일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD  
                             UNION ALL
                             SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 대비일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD 
                             UNION ALL
                             SELECT 
                                    C.STR_CD         AS STR_CD
                                  , J.BUY_ORG_CD    AS ORG_CD
                                  , C.PUMBUN_CD      AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_STRPBN J
                                  , DPS.PC_ORGMST K
                              WHERE C.STR_CD    = ?
                                AND C.EXE_DT     = ?      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND J.STR_CD    = C.STR_CD
                                AND J.PUMBUN_CD = C.PUMBUN_CD
                                AND J.BUY_ORG_CD = K.ORG_CD
								AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                             GROUP BY C.STR_CD
                                     ,J.BUY_ORG_CD
                                     ,C.PUMBUN_CD
                            ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                      UNION ALL     
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , A.PUMBUN_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_M
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_M
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_M
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_M
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(?, 1, 6)       -- 매출일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD  
                             UNION ALL
                             SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(?, 1, 6)       -- 대비일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD 
                             UNION ALL
                             SELECT 
                                    C.STR_CD         AS STR_CD
                                  , J.BUY_ORG_CD    AS ORG_CD
                                  , C.PUMBUN_CD      AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_STRPBN J
                                  , DPS.PC_ORGMST K
                              WHERE C.STR_CD    = ?
                                AND SUBSTR(C.EXE_DT,1,6) = SUBSTR(?, 1, 6)      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND J.STR_CD    = C.STR_CD
                                AND J.PUMBUN_CD = C.PUMBUN_CD
                                AND J.BUY_ORG_CD = K.ORG_CD
								AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                             GROUP BY C.STR_CD
                                     ,J.BUY_ORG_CD
                                     ,C.PUMBUN_CD
                            ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                      UNION ALL
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , A.PUMBUN_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_Y
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_Y
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_Y
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_Y
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.SALE_AMT_CMPR,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_Y
                       FROM (SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(?, 1, 4)       -- 매출일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD  
                             UNION ALL
                             SELECT 
                                    H.STR_CD
                                  , I.BUY_ORG_CD      AS ORG_CD
                                  , H.PUMBUN_CD        AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(?, 1, 4)       -- 대비일자
								AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , I.BUY_ORG_CD
                                     , H.PUMBUN_CD 
                             UNION ALL
                             SELECT 
                                    C.STR_CD         AS STR_CD
                                  , J.BUY_ORG_CD    AS ORG_CD
                                  , C.PUMBUN_CD      AS PUMBUN_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_STRPBN J
                                  , DPS.PC_ORGMST K
                              WHERE C.STR_CD    = ?
                                AND SUBSTR(C.EXE_DT,1,4) = SUBSTR(?, 1, 4)      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND J.STR_CD    = C.STR_CD
                                AND J.PUMBUN_CD = C.PUMBUN_CD
                                AND J.BUY_ORG_CD = K.ORG_CD
								AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                             GROUP BY C.STR_CD
                                     ,J.BUY_ORG_CD
                                     ,C.PUMBUN_CD
                            ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                   )              A
                 , DPS.PC_ORGMST  B
                 , DPS.PC_STRPBN  C
             WHERE LPAD(A.ORG_CD, 8) || '00' = B.ORG_CD
               AND LPAD(A.ORG_CD, 2)         = C.STR_CD
               AND A.PUMBUN_CD               = C.PUMBUN_CD
             GROUP BY
                   A.PUMBUN_CD
                 , C.PUMBUN_NAME
             ORDER BY
                   A.PUMBUN_CD
                   ------------------2	  
        ]]>        
    </query>
    
    <query name="SEL_SALE_PUMBUN_TEMP">        
        <![CDATA[
            SELECT   
            		A.PUMBUN_CD              AS ORG_CD
                 , C.PUMBUN_NAME            AS ORG_NAME
                 , SUM(A.ORIGIN_SALE_TAMT)  AS ORIGIN_SALE_TAMT
                 , SUM(A.TOT_SALE_AMT)      AS TOT_SALE_AMT
                 , SUM(A.ACHIEVERATE)       AS ACHIEVERATE
                 , SUM(A.SALE_AMT_CMPR)     AS SALE_AMT_CMPR
                 , SUM(A.SALEIRATE)         AS SALEIRATE
                 
                 , SUM(A.ORIGIN_SALE_TAMT_M)  AS ORIGIN_SALE_TAMT_M
                 , SUM(A.TOT_SALE_AMT_M)   AS TOT_SALE_AMT_M
                 , SUM(A.ACHIEVERATE_M)       AS ACHIEVERATE_M
                 , SUM(A.SALE_AMT_CMPR_M)     AS SALE_AMT_CMPR_M
                 , SUM(A.SALEIRATE_M)         AS SALEIRATE_M
                 
                 , SUM(A.ORIGIN_SALE_TAMT_Y)  AS ORIGIN_SALE_TAMT_Y
                 , SUM(A.TOT_SALE_AMT_Y)   AS TOT_SALE_AMT_Y
                 , SUM(A.ACHIEVERATE_Y)       AS ACHIEVERATE_Y
                 , SUM(A.SALE_AMT_CMPR_Y)     AS SALE_AMT_CMPR_Y
                 , SUM(A.SALEIRATE_Y)         AS SALEIRATE_Y
              FROM (
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                                                AS ORG_CD
                          , A.PUMBUN_CD
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPUMBUN  C
                              WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
                                AND C.PUMBUN_CD = A.PUMBUN_CD
                                AND C.EXE_DT    = ?
                               )                                                                                     AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                               AS TOT_SALE_AMT
                          , (CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                                          FROM DPS.PS_ACTPUMBUN  C
                                         WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
                                           AND C.PUMBUN_CD = A.PUMBUN_CD
                                           AND C.EXE_DT    = ?
                                        ) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/(SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
									                              FROM DPS.PS_ACTPUMBUN  C
									                             WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
									                               AND C.PUMBUN_CD = A.PUMBUN_CD
									                               AND C.EXE_DT    = ?
									                             ))*100  END )            AS ACHIEVERATE
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                               AS SALE_AMT_CMPR
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN   A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?) E
                          , DPS.PC_ORGMST             F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT            = ?
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                     
                      UNION ALL     
                      
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , A.PUMBUN_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPUMBUN  C
                              WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
                                AND C.PUMBUN_CD = A.PUMBUN_CD
                                AND C.EXE_YM    = LPAD(?,6) 
                               )                                                       AS ORIGIN_SALE_TAMT_M
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                 AS TOT_SALE_AMT_M
                          , ( CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                                           FROM DPS.PS_ACTPUMBUN  C
                                          WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
                                            AND C.PUMBUN_CD = A.PUMBUN_CD
                                            AND C.EXE_YM    = LPAD(?,6) 
                                           ) = 0 THEN 0 
                              ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/ (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                                                        FROM DPS.PS_ACTPUMBUN  C
			                                                       WHERE C.ORG_CD    = LPAD(A.ORG_CD, 8) || '00'
			                                                         AND C.PUMBUN_CD = A.PUMBUN_CD
			                                                         AND C.EXE_YM    = LPAD(?,6) 
			                                                      ) )*100      END)                                                         AS ACHIEVERATE_M
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                                             AS SALE_AMT_CMPR_M
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE_M
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN      A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    LIKE LPAD(?,6) || '%') E
                          , DPS.PC_ORGMST                               F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT    LIKE LPAD(?,6) || '%'
                      GROUP BY
                           LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                            
                      UNION ALL
                      
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , A.PUMBUN_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPUMBUN  C
                              WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
                                AND C.PUMBUN_CD      = A.PUMBUN_CD
                                AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
                               )                                                       AS ORIGIN_SALE_TAMT_Y
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                 AS TOT_SALE_AMT_Y
                          , (CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                                          FROM DPS.PS_ACTPUMBUN  C
                                         WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
                                           AND C.PUMBUN_CD      = A.PUMBUN_CD
                                           AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
                                          ) = 0 THEN 0 
                             ELSE( SUM(NVL(A.TOT_SALE_AMT,0))/ (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
		                                                          FROM DPS.PS_ACTPUMBUN  C
		                                                         WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
		                                                           AND C.PUMBUN_CD      = A.PUMBUN_CD
		                                                           AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
		                                                        ) )*100    END )                                                           AS ACHIEVERATE_Y
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                                              AS SALE_AMT_CMPR_Y
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN      A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    LIKE LPAD(?,4) || '%') E
                          , DPS.PC_ORGMST                               F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT    LIKE LPAD(?,4) || '%'
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                          , A.PUMBUN_CD
                   )              A
                 , DPS.PC_ORGMST  B
                 , DPS.PC_STRPBN  C
             WHERE LPAD(A.ORG_CD, 8) || '00' = B.ORG_CD
               AND LPAD(A.ORG_CD, 2)         = C.STR_CD
               AND A.PUMBUN_CD               = C.PUMBUN_CD
               AND EXISTS ( SELECT MYORG.USER_ID
                              FROM COM.V_MYORG MYORG
                             WHERE MYORG.STR_CD      = SUBSTR(A.ORG_CD,1,2)
                               AND MYORG.DEPT_CD     = SUBSTR(A.ORG_CD,3,2)
                               AND MYORG.TEAM_CD     = SUBSTR(A.ORG_CD,5,2)
                               AND MYORG.PC_CD       = SUBSTR(A.ORG_CD,7,2)
                               AND MYORG.PUMBUN_CD   = A.PUMBUN_CD
                               AND MYORG.USER_ID     = ?
                           )
             GROUP BY
                   A.PUMBUN_CD
                 , C.PUMBUN_NAME
             ORDER BY
                   A.PUMBUN_CD
  ------------------3
            
        ]]>        
    </query>
    
    <query name="SEL_SALE_PC">        
        <![CDATA[
   			SELECT   
   					A.ORG_CD
			         , B.ORG_SHORT_NAME         AS ORG_NAME
			         , SUM(A.ORIGIN_SALE_TAMT)  AS ORIGIN_SALE_TAMT
			         , SUM(A.TOT_SALE_AMT)   AS TOT_SALE_AMT
			         , SUM(A.ACHIEVERATE)       AS ACHIEVERATE
			         , SUM(A.SALE_AMT_CMPR)     AS SALE_AMT_CMPR
			         , SUM(A.SALEIRATE)         AS SALEIRATE
			         , SUM(A.ORIGIN_SALE_TAMT_M)  AS ORIGIN_SALE_TAMT_M
			         , SUM(A.TOT_SALE_AMT_M)   AS TOT_SALE_AMT_M
			         , SUM(A.ACHIEVERATE_M)       AS ACHIEVERATE_M
			         , SUM(A.SALE_AMT_CMPR_M)     AS SALE_AMT_CMPR_M
			         , SUM(A.SALEIRATE_M)         AS SALEIRATE_M
			         , SUM(A.ORIGIN_SALE_TAMT_Y)  AS ORIGIN_SALE_TAMT_Y
			         , SUM(A.TOT_SALE_AMT_Y)   AS TOT_SALE_AMT_Y
			         , SUM(A.ACHIEVERATE_Y)       AS ACHIEVERATE_Y
			         , SUM(A.SALE_AMT_CMPR_Y)     AS SALE_AMT_CMPR_Y
			         , SUM(A.SALEIRATE_Y)         AS SALEIRATE_Y
			         , ?                          AS SALEDT
			         , ?                          AS CMPRDT
			         , ?						  AS UNIT
			    FROM (
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                                             AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.SALE_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 매출일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.SALE_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.SALE_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 대비일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.SALE_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    C.STR_CD         AS STR_CD
                                  , SUBSTR(L.SALE_ORG_CD,1,8)||'00'    AS ORG_CD
                                  , 0                              AS TOT_SALE_AMT
                                  , 0                              AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_ORGMST K
                                  , DPS.PC_STRPBN L
                              WHERE C.STR_CD    = ?
                                AND C.EXE_DT     = ?      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND L.STR_CD = C.STR_CD
                                AND L.PUMBUN_CD = C.PUMBUN_CD
                                AND K.ORG_CD    = L.SALE_ORG_CD
                                AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY C.STR_CD
                                     , SUBSTR(L.SALE_ORG_CD,1,8)
                          ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                      UNION ALL     
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_M
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_M
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_M
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_M
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT  
                                    H.STR_CD
                                  , SUBSTR(I.SALE_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                -- AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(일자,1,6)      -- 매출일자
                                AND H.SALE_DT BETWEEN SUBSTR(?,1,6)||'00' AND ?   -- 170318 수정 : 김준영 (월 누계 아닌 조회일 기준 누계)  
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.SALE_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.SALE_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                               -- AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(일자,1,6)      -- 대비일자
                                AND H.SALE_DT BETWEEN SUBSTR(?,1,6)||'00' AND ?   -- 170318 수정 : 김준영 (월 누계 아닌 조회일 기준 누계)  
                               
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.SALE_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    C.STR_CD         AS STR_CD
                                  , SUBSTR(L.SALE_ORG_CD,1,8)||'00'    AS ORG_CD
                                  , 0                              AS TOT_SALE_AMT
                                  , 0                              AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_ORGMST K
                                  , DPS.PC_STRPBN L
                              WHERE C.STR_CD    = ?
                                --AND SUBSTR(C.EXE_DT,1,6) = SUBSTR(일자,1,6)      -- 매출일자
                                AND C.EXE_DT BETWEEN SUBSTR(?,1,6)||'00' AND ?   -- 170318 수정 : 김준영 (월 누계 아닌 조회일 기준 누계)                                
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND L.STR_CD = C.STR_CD
                                AND L.PUMBUN_CD = C.PUMBUN_CD
                                AND K.ORG_CD    = L.SALE_ORG_CD
                                AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY C.STR_CD
                                     , SUBSTR(L.SALE_ORG_CD,1,8)
                          ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                      UNION ALL
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_Y
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_Y
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_Y
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_Y
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_Y
                       FROM (SELECT  
                                    H.STR_CD
                                  , SUBSTR(I.SALE_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                --AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(일자,1,4)      -- 매출일자
                                AND H.SALE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?   -- 170318 수정 : 김준영 (년 누계 아닌 조회일 기준 누계)  
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.SALE_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.SALE_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.SALE_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                --AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(일자,1,4)      -- 대비일자
                                AND H.SALE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?   -- 170318 수정 : 김준영 (년 누계 아닌 조회일 기준 누계
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.SALE_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    C.STR_CD         AS STR_CD
                                  , SUBSTR(L.SALE_ORG_CD,1,8)||'00'    AS ORG_CD
                                  , 0                              AS TOT_SALE_AMT
                                  , 0                              AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_ORGMST K
                                  , DPS.PC_STRPBN L
                              WHERE C.STR_CD    = ?
                                --AND SUBSTR(C.EXE_DT,1,4) = SUBSTR(일자,1,4)      -- 매출일자
                                AND C.EXE_DT BETWEEN SUBSTR(?,1,4)||'0000' AND ?   -- 170318 수정 : 김준영 (년 총 누계 아닌 조회일 기준 누계)
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND L.STR_CD = C.STR_CD
                                AND L.PUMBUN_CD = C.PUMBUN_CD
                                AND K.ORG_CD    = L.SALE_ORG_CD
                                AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY C.STR_CD
                                     , SUBSTR(L.SALE_ORG_CD,1,8)
                          ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                   )              A
                 , DPS.PC_ORGMST  B
             WHERE A.ORG_CD = B.ORG_CD
              GROUP BY
                    A.ORG_CD
                  , B.ORG_SHORT_NAME
              ORDER BY
                    A.ORG_CD     
                    ------------------4 
        ]]>        
    </query>
    
    <query name="SEL_SALE_PC2">        
        <![CDATA[
		   	SELECT   
		   			A.ORG_CD
                     , B.ORG_SHORT_NAME         AS ORG_NAME
                     , SUM(A.ORIGIN_SALE_TAMT)  AS ORIGIN_SALE_TAMT
                     , SUM(A.TOT_SALE_AMT)   AS TOT_SALE_AMT
                     , SUM(A.ACHIEVERATE)       AS ACHIEVERATE
                     , SUM(A.SALE_AMT_CMPR)     AS SALE_AMT_CMPR
                     , SUM(A.SALEIRATE)         AS SALEIRATE
                     , SUM(A.ORIGIN_SALE_TAMT_M)  AS ORIGIN_SALE_TAMT_M
                     , SUM(A.TOT_SALE_AMT_M)   AS TOT_SALE_AMT_M
                     , SUM(A.ACHIEVERATE_M)       AS ACHIEVERATE_M
                     , SUM(A.SALE_AMT_CMPR_M)     AS SALE_AMT_CMPR_M
                     , SUM(A.SALEIRATE_M)         AS SALEIRATE_M
                     , SUM(A.ORIGIN_SALE_TAMT_Y)  AS ORIGIN_SALE_TAMT_Y
                     , SUM(A.TOT_SALE_AMT_Y)   AS TOT_SALE_AMT_Y
                     , SUM(A.ACHIEVERATE_Y)       AS ACHIEVERATE_Y
                     , SUM(A.SALE_AMT_CMPR_Y)     AS SALE_AMT_CMPR_Y
                     , SUM(A.SALEIRATE_Y)         AS SALEIRATE_Y
                     , ?                          AS SALEDT
                     , ?                          AS CMPRDT
                     , ? 						  AS UNIT
                FROM (
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                                             AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 매출일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT    = ?      -- 대비일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    C.STR_CD         AS STR_CD
                                  , SUBSTR(L.BUY_ORG_CD,1,8)||'00'    AS ORG_CD
                                  , 0                              AS TOT_SALE_AMT
                                  , 0                              AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_ORGMST K
                                  , DPS.PC_STRPBN L
                              WHERE C.STR_CD    = ?
                                AND C.EXE_DT     = ?      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND L.STR_CD = C.STR_CD
                                AND L.PUMBUN_CD = C.PUMBUN_CD
                                AND K.ORG_CD    = L.BUY_ORG_CD
                                AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY C.STR_CD
                                     , SUBSTR(L.BUY_ORG_CD,1,8)
                          ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                      UNION ALL     
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_M
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_M
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_M
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_M
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_M
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM (SELECT  
                                    H.STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(?,1,6)      -- 매출일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,6) = SUBSTR(?,1,6)      -- 대비일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    C.STR_CD         AS STR_CD
                                  , SUBSTR(L.BUY_ORG_CD,1,8)||'00'    AS ORG_CD
                                  , 0                              AS TOT_SALE_AMT
                                  , 0                              AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_ORGMST K
                                  , DPS.PC_STRPBN L
                              WHERE C.STR_CD    = ?
                                AND SUBSTR(C.EXE_DT,1,6) = SUBSTR(?,1,6)      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND L.STR_CD = C.STR_CD
                                AND L.PUMBUN_CD = C.PUMBUN_CD
                                AND K.ORG_CD    = L.BUY_ORG_CD
                                AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY C.STR_CD
                                     , SUBSTR(L.BUY_ORG_CD,1,8)
                          ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                      UNION ALL
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                                        AS ORIGIN_SALE_TAMT_Y
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                            AS TOT_SALE_AMT_Y
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0)) = 0 THEN 0 
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100  END )         AS ACHIEVERATE_Y
                          , SUM(NVL(A.SALE_AMT_CMPR,0))                                                            AS SALE_AMT_CMPR_Y
                          , (CASE WHEN  SUM(NVL(A.SALE_AMT_CMPR,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.SALE_AMT_CMPR,0)))/SUM(NVL(A.SALE_AMT_CMPR,0)))*100 END)   AS SALEIRATE_Y
                       FROM (SELECT  
                                    H.STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , SUM(H.NORM_SALE_AMT)     AS TOT_SALE_AMT
                                  , 0                       AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(?,1,4)      -- 매출일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    H.STR_CD                             AS STR_CD
                                  , SUBSTR(I.BUY_ORG_CD,1,8)||'00'      AS ORG_CD
                                  , 0                       AS TOT_SALE_AMT
                                  , SUM(H.NORM_SALE_AMT)     AS SALE_AMT_CMPR
                                  , 0                       AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN I
                              WHERE H.STR_CD     = I.STR_CD
                                AND H.PUMBUN_CD  = I.PUMBUN_CD
                                AND I.BUY_ORG_CD = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND SUBSTR(H.SALE_DT,1,4) = SUBSTR(?,1,4)      -- 대비일자
                                AND H.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY H.STR_CD
                                     , SUBSTR(I.BUY_ORG_CD,1,8)
                             UNION ALL
                             SELECT  
                                    C.STR_CD         AS STR_CD
                                  , SUBSTR(L.BUY_ORG_CD,1,8)||'00'    AS ORG_CD
                                  , 0                              AS TOT_SALE_AMT
                                  , 0                              AS SALE_AMT_CMPR
                                  , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT
                               FROM DPS.PS_ACTPUMBUN  C
                                  , DPS.PC_ORGMST K
                                  , DPS.PC_STRPBN L
                              WHERE C.STR_CD    = ?
                                AND SUBSTR(C.EXE_DT,1,4) = SUBSTR(?,1,4)      -- 매출일자
                                AND K.STR_CD    = ?
                                AND K.DEPT_CD    LIKE ? || '%'
                                AND K.TEAM_CD    LIKE ? || '%'
                                AND K.PC_CD      LIKE ? || '%'
                                AND L.STR_CD = C.STR_CD
                                AND L.PUMBUN_CD = C.PUMBUN_CD
                                AND K.ORG_CD    = L.BUY_ORG_CD
                                AND C.PUMBUN_CD IN ( SELECT PUMBUN_CD
                                                FROM COM.V_MYORG MYORG
                                               WHERE MYORG.USER_ID     = ?
                                            )
                              GROUP BY C.STR_CD
                                     , SUBSTR(L.BUY_ORG_CD,1,8)
                          ) A
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                   )              A
                 , DPS.PC_ORGMST  B
             WHERE A.ORG_CD = B.ORG_CD
              GROUP BY
                    A.ORG_CD
                  , B.ORG_SHORT_NAME
              ORDER BY
                    A.ORG_CD 
                    ------------------5
		            
        ]]>        
    </query>
    
    <query name="SEL_SALE_PC_TEMP">        
        <![CDATA[
            SELECT   
            		A.ORG_CD
                 , B.ORG_SHORT_NAME         AS ORG_NAME
                 , SUM(A.ORIGIN_SALE_TAMT)  AS ORIGIN_SALE_TAMT
                 , SUM(A.TOT_SALE_AMT)   AS TOT_SALE_AMT
                 , SUM(A.ACHIEVERATE)       AS ACHIEVERATE
                 , SUM(A.SALE_AMT_CMPR)     AS SALE_AMT_CMPR
                 , SUM(A.SALEIRATE)         AS SALEIRATE
                 
                 , SUM(A.ORIGIN_SALE_TAMT_M)  AS ORIGIN_SALE_TAMT_M
                 , SUM(A.TOT_SALE_AMT_M)   AS TOT_SALE_AMT_M
                 , SUM(A.ACHIEVERATE_M)       AS ACHIEVERATE_M
                 , SUM(A.SALE_AMT_CMPR_M)     AS SALE_AMT_CMPR_M
                 , SUM(A.SALEIRATE_M)         AS SALEIRATE_M
                 
                 , SUM(A.ORIGIN_SALE_TAMT_Y)  AS ORIGIN_SALE_TAMT_Y
                 , SUM(A.TOT_SALE_AMT_Y)   AS TOT_SALE_AMT_Y
                 , SUM(A.ACHIEVERATE_Y)       AS ACHIEVERATE_Y
                 , SUM(A.SALE_AMT_CMPR_Y)     AS SALE_AMT_CMPR_Y
                 , SUM(A.SALEIRATE_Y)         AS SALEIRATE_Y
                 , ?                          AS SALEDT
                 , ?                          AS CMPRDT
              FROM (
                     SELECT  LPAD(A.ORG_CD, 8) || '00'                                                                              AS ORG_CD
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPC  C
                              WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
                                AND C.EXE_DT = ? 
                               )                                                       AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                                              AS TOT_SALE_AMT
                          , (CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                              FROM DPS.PS_ACTPC  C
			                             WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
			                               AND C.EXE_DT = ? 
			                            ) = 0 THEN 0
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/(SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
									                              FROM DPS.PS_ACTPC  C
									                             WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
									                               AND C.EXE_DT = ? 
									                            ) )*100  END)                                      AS ACHIEVERATE
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                                              AS SALE_AMT_CMPR
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN      A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT      = ?) E
                          , DPS.PC_ORGMST             F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT            = ?
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                     
                      UNION ALL     
                          
                     SELECT LPAD(A.ORG_CD, 8) || '00'                                  AS ORG_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPC  C
                              WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
                                AND C.EXE_YM = LPAD(?,6) 
                               )                                                       AS ORIGIN_SALE_TAMT_M
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                 AS TOT_SALE_AMT_M
                          , (CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                              FROM DPS.PS_ACTPC  C
			                             WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
			                               AND C.EXE_YM = LPAD(?,6) 
			                            ) = 0 THEN 0 
                             ELSE  ( SUM(NVL(A.TOT_SALE_AMT,0))/ (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                                                        FROM DPS.PS_ACTPC  C
			                                                       WHERE C.ORG_CD = LPAD(A.ORG_CD, 8) || '00'
			                                                         AND C.EXE_YM = LPAD(?,6) 
			                                                      ) )*100  END)        AS ACHIEVERATE_M
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                                              AS SALE_AMT_CMPR_M
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE_M
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_Y
                          , 0                                                          AS TOT_SALE_AMT_Y
                          , 0                                                          AS ACHIEVERATE_Y
                          , 0                                                          AS SALE_AMT_CMPR_Y
                          , 0                                                          AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN      A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT      LIKE LPAD(?,6) || '%') E
                          , DPS.PC_ORGMST                                 F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT    LIKE LPAD(?,6) || '%'
                      GROUP BY
                           LPAD(A.ORG_CD, 8)
                            
                      UNION ALL
                      
                     SELECT  LPAD(A.ORG_CD, 8) || '00'                AS ORG_CD
                          , 0                                                          AS ORIGIN_SALE_TAMT
                          , 0                                                          AS TOT_SALE_AMT
                          , 0                                                          AS ACHIEVERATE
                          , 0                                                          AS SALE_AMT_CMPR
                          , 0                                                          AS SALEIRATE
                          
                          , 0                                                          AS ORIGIN_SALE_TAMT_M
                          , 0                                                          AS TOT_SALE_AMT_M
                          , 0                                                          AS ACHIEVERATE_M
                          , 0                                                          AS SALE_AMT_CMPR_M
                          , 0                                                          AS SALEIRATE_M
                          
                          , (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
                               FROM DPS.PS_ACTPC  C
                              WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
                                AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
                               )                                                       AS ORIGIN_SALE_TAMT_Y
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                                                              AS TOT_SALE_AMT_Y
                          , (CASE WHEN (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                              FROM DPS.PS_ACTPC  C
			                             WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
			                               AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
			                            )  = 0 THEN 0
                             ELSE ( SUM(NVL(A.TOT_SALE_AMT,0))/ (SELECT SUM(NVL(C.ORIGIN_SALE_TAMT,0)) 
			                                                       FROM DPS.PS_ACTPC  C
			                                                      WHERE C.ORG_CD         = LPAD(A.ORG_CD, 8) || '00'
			                                                        AND LPAD(C.EXE_YM,4) = LPAD(?,4) 
			                                                     ) )*100   END)         AS ACHIEVERATE_Y
                          , SUM(NVL(E.TOT_SALE_AMT,0))                                                                              AS SALE_AMT_CMPR_Y
                          , (CASE WHEN  SUM(NVL(E.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(E.TOT_SALE_AMT,0)))/SUM(NVL(E.TOT_SALE_AMT,0)))*100 END)   AS SALEIRATE_Y
                       FROM DPS.PS_DAYPBN      A
                          , DPS.PS_SCHEDULE    D
                          , (SELECT H.ORG_CD
                                  , H.TOT_SALE_AMT 
                               FROM DPS.PS_DAYPBN H
                                  , DPS.PC_ORGMST G
                              WHERE H.ORG_CD     = G.ORG_CD
                                AND G.STR_CD    = ?
                                AND G.DEPT_CD    LIKE ? || '%'
                                AND G.TEAM_CD    LIKE ? || '%'
                                AND G.PC_CD      LIKE ? || '%'
                                AND H.SALE_DT      LIKE LPAD(?,4) || '%') E
                          , DPS.PC_ORGMST                                     F
                      WHERE A.STR_CD     = D.STR_CD(+)
                        AND A.SALE_DT    = D.SALE_DT(+)
                        AND A.ORG_CD     = E.ORG_CD(+)
                        AND A.ORG_CD     = F.ORG_CD
                        AND F.STR_CD    = ?
                        AND F.DEPT_CD    LIKE ? || '%'
                        AND F.TEAM_CD    LIKE ? || '%'
                        AND F.PC_CD      LIKE ? || '%'
                        AND A.SALE_DT    LIKE LPAD(?,4) || '%'
                      GROUP BY
                            LPAD(A.ORG_CD, 8)
                   )              A
                 , DPS.PC_ORGMST  B
             WHERE A.ORG_CD = B.ORG_CD
               AND EXISTS  ( SELECT MYORG.USER_ID
                               FROM COM.V_MYORG MYORG
                              WHERE MYORG.STR_CD      = B.STR_CD
                                AND MYORG.DEPT_CD     = B.DEPT_CD
                                AND MYORG.TEAM_CD     = B.TEAM_CD
                                AND MYORG.PC_CD       = B.PC_CD
                                AND MYORG.USER_ID     = ?
                           )
             GROUP BY
                   A.ORG_CD
                 , B.ORG_SHORT_NAME
             ORDER BY
                   A.ORG_CD
                   ------------------6
  
            
        ]]>        
    </query>
    
    <query name="SEL_CMPRDT">        
        <![CDATA[
             SELECT NVL(MAX(CMPR_DT), TO_CHAR(ADD_MONTHS(TO_DATE(?, 'YYYYMMDD'),-12), 'YYYYMMDD'))
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD    = ?
               AND SALE_DT = ?
        ]]>        
    </query>
    
</service>