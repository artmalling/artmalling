<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자    : 김경은
 * 회 사 명    : 
 * 작 성 일    : 2011.06.21
 * 변 경 일    : 
 * 변경내용 : 
 * 개    요       : 매장등급추이현황
 -->
<service name="/psal703.ps">
    
    <!-- 매장등급추이현황 -->
    <gauce name="H_MASTER"> 
        <column colName="STR_CD"            colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD"         colType="TB_STRING"      size="6"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NM"         colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE1"        colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE1"     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT1"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE1"         colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE1"      colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE2"        colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE2"     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT2"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE2"         colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE2"      colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE3"        colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE3"     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT3"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE3"         colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE3"      colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE4"        colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE4"     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT4"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE4"         colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE4"      colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE5"        colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE5"     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT5"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE5"         colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE5"      colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE6"        colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE6"     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT6"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE6"         colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE6"      colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE7"        colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE7"     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT7"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE7"         colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE7"      colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE8"        colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE8"     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT8"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE8"         colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE8"      colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE9"        colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE9"     colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT9"    colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE9"         colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE9"      colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE10"       colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE10"    colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT10"   colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE10"        colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE10"     colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE11"       colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE11"    colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT11"   colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE11"        colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE11"     colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE12"       colType="TB_DECIMAL"     size="7"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_GRADE12"    colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_WEIGHT12"   colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CS_SCORE12"        colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_SCORE12"     colType="TB_DECIMAL"     size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>

    <!-- 매장등급추이현황 DATA  -->
    <query name="SEL_MASTER">
        <![CDATA[
            SELECT STR_CD
			     , PUMBUN_CD
			     , DPS.FN_GET_PUMBUN_NAME(PUMBUN_CD) AS PUMBUN_NM
			     , SUM(AREA_SIZE1)      AS AREA_SIZE1
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE1))   AS PUMBUN_GRADE1
			     , SUM(PUMBUN_WEIGHT1)  AS PUMBUN_WEIGHT1
			     , SUM(CS_SCORE1)       AS CS_SCORE1
			     , SUM(BUYER_SCORE1)    AS BUYER_SCORE1
			     
			     , SUM(AREA_SIZE2)      AS AREA_SIZE2
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE2))   AS PUMBUN_GRADE2
			     , SUM(PUMBUN_WEIGHT2)  AS PUMBUN_WEIGHT2
			     , SUM(CS_SCORE2)       AS CS_SCORE2
			     , SUM(BUYER_SCORE2)    AS BUYER_SCORE2
			     
			     , SUM(AREA_SIZE3)      AS AREA_SIZE3
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE3))   AS PUMBUN_GRADE3
			     , SUM(PUMBUN_WEIGHT3)  AS PUMBUN_WEIGHT3
			     , SUM(CS_SCORE3)       AS CS_SCORE3
			     , SUM(BUYER_SCORE3)    AS BUYER_SCORE3
			     
			     , SUM(AREA_SIZE4)      AS AREA_SIZE4
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE4))   AS PUMBUN_GRADE4
			     , SUM(PUMBUN_WEIGHT4)  AS PUMBUN_WEIGHT4
			     , SUM(CS_SCORE4)       AS CS_SCORE4
			     , SUM(BUYER_SCORE4)    AS BUYER_SCORE4
			     
			     , SUM(AREA_SIZE5)      AS AREA_SIZE5
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE5))   AS PUMBUN_GRADE5
			     , SUM(PUMBUN_WEIGHT5)  AS PUMBUN_WEIGHT5
			     , SUM(CS_SCORE5)       AS CS_SCORE5
			     , SUM(BUYER_SCORE5)    AS BUYER_SCORE5
			     
			     , SUM(AREA_SIZE6)      AS AREA_SIZE6
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE6))   AS PUMBUN_GRADE6
			     , SUM(PUMBUN_WEIGHT6)  AS PUMBUN_WEIGHT6
			     , SUM(CS_SCORE6)       AS CS_SCORE6
			     , SUM(BUYER_SCORE6)    AS BUYER_SCORE6
			     
			     , SUM(AREA_SIZE7)      AS AREA_SIZE7
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE7))   AS PUMBUN_GRADE7
			     , SUM(PUMBUN_WEIGHT7)  AS PUMBUN_WEIGHT7
			     , SUM(CS_SCORE7)       AS CS_SCORE7
			     , SUM(BUYER_SCORE7)    AS BUYER_SCORE7
			     
			     , SUM(AREA_SIZE8)      AS AREA_SIZE8
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE8))   AS PUMBUN_GRADE8
			     , SUM(PUMBUN_WEIGHT8)  AS PUMBUN_WEIGHT8
			     , SUM(CS_SCORE8)       AS CS_SCORE8
			     , SUM(BUYER_SCORE8)    AS BUYER_SCORE8
			     
			     , SUM(AREA_SIZE9)      AS AREA_SIZE9
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE9))   AS PUMBUN_GRADE9
			     , SUM(PUMBUN_WEIGHT9)  AS PUMBUN_WEIGHT9
			     , SUM(CS_SCORE9)       AS CS_SCORE9
			     , SUM(BUYER_SCORE9)    AS BUYER_SCORE9
			     
			     , SUM(AREA_SIZE10)      AS AREA_SIZE10
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE10))   AS PUMBUN_GRADE10
			     , SUM(PUMBUN_WEIGHT10)  AS PUMBUN_WEIGHT10
			     , SUM(CS_SCORE10)       AS CS_SCORE10
			     , SUM(BUYER_SCORE10)    AS BUYER_SCORE10
			     
			     , SUM(AREA_SIZE11)      AS AREA_SIZE11
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE11))   AS PUMBUN_GRADE11
			     , SUM(PUMBUN_WEIGHT11)  AS PUMBUN_WEIGHT11
			     , SUM(CS_SCORE11)       AS CS_SCORE11
			     , SUM(BUYER_SCORE11)    AS BUYER_SCORE11
			     
			     , SUM(AREA_SIZE12)      AS AREA_SIZE12
			     , COM.FN_GET_COMM_NAME('D', 'P605', MAX(PUMBUN_GRADE12))   AS PUMBUN_GRADE12
			     , SUM(PUMBUN_WEIGHT12)  AS PUMBUN_WEIGHT12
			     , SUM(CS_SCORE12)       AS CS_SCORE12
			     , SUM(BUYER_SCORE12)    AS BUYER_SCORE1
			FROM (     
			        SELECT MST.STR_CD
			             , MST.PUMBUN_CD
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '01' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE1
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '01' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE1
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '01' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT1
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '01' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE1
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '01' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE1
			                    
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '02' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE2
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '02' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE2
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '02' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT2
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '02' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE2
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '02' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE2
			                    
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '03' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE3
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '03' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE3
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '03' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT3
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '03' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE3
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '03' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE3
			                    
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '04' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE4
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '04' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE4
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '04' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT4
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '04' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE4
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '04' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE4
			                    
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '05' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE5
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '05' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE5
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '05' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT5
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '05' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE5
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '05' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE5
			                    
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '06' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE6
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '06' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE6
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '06' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT6
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '06' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE6
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '06' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE6
			                    
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '07' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE7
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '07' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE7
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '07' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT7
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '07' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE7
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '07' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE7
			                    
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '08' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE8
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '08' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE8
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '08' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT8
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '08' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE8
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '08' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE8
			                    
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '09' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE9
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '09' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE9
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '09' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT9
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '09' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE9
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '09' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE9
			                    
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '10' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE10
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '10' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE10
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '10' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT10
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '10' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE10
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '10' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE10
			                    
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '11' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE11
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '11' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE11
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '11' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT11
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '11' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE11
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '11' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE11
			                    
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '12' 
			                    THEN AREA_SIZE ELSE 0 END             AS AREA_SIZE12
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '12' 
			                    THEN PUMBUN_GRADE ELSE '' END         AS PUMBUN_GRADE12
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '12' 
			                    THEN PUMBUN_WEIGHT ELSE 0 END         AS PUMBUN_WEIGHT12
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '12' 
			                    THEN CS.EVALU_SCORE ELSE 0 END        AS CS_SCORE12
			             , CASE WHEN SUBSTR(MST.EVALU_YM,5,2) = '12' 
			                    THEN BUYER.EVALU_SCORE ELSE 0 END     AS BUYER_SCORE12
			          FROM DPS.PS_YM_EVALUMST MST
			             , (SELECT STR_CD
			                    , EVALU_YM
			                    , PUMBUN_CD
			                    , EVALU_SCORE
			                 FROM DPS.PS_YM_EVALUDTL
			                WHERE STR_CD = ?
			                  AND SUBSTR(EVALU_YM,0,4) = ?
			                  AND VEN_EVALU_CD         = '07') CS       /* C/S점수 */
			             , (SELECT STR_CD
			                    , EVALU_YM
			                    , PUMBUN_CD
			                    , EVALU_SCORE
			                 FROM DPS.PS_YM_EVALUDTL
			                WHERE STR_CD = ?
			                  AND SUBSTR(EVALU_YM,0,4) = ?
			                  AND VEN_EVALU_CD         = '06') BUYER    /* 바이어점수 */
			         WHERE MST.STR_CD               = CS.STR_CD(+)
			           AND MST.EVALU_YM             = CS.EVALU_YM(+)
			           AND MST.PUMBUN_CD            = CS.PUMBUN_CD(+)
			           AND MST.STR_CD               = BUYER.STR_CD(+)
			           AND MST.EVALU_YM             = BUYER.EVALU_YM(+)
			           AND MST.PUMBUN_CD            = BUYER.PUMBUN_CD(+)
			           AND MST.STR_CD               = ?
			           AND SUBSTR(MST.EVALU_YM,0,4) = ?
			           AND MST.ORG_CD               LIKE ? || '%'
			      )
			 WHERE EXISTS ( SELECT MYORG.USER_ID
                              FROM COM.V_MYORG MYORG
                             WHERE MYORG.PUMBUN_CD = PUMBUN_CD
                               AND MYORG.STR_CD    = ?
                               AND MYORG.USER_ID   = ?
                               AND MYORG.ORG_FLAG  = '1'
                               AND ROWNUM          = 1
                           )     
			 GROUP BY STR_CD
			        , PUMBUN_CD    
			 ORDER BY STR_CD
			        , PUMBUN_CD
        ]]>
    </query> 
 

 </service>