<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 박종은
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2010.04.08
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/psal580.ps">

	<!-- 점별 파트별 헤더 -->
    <gauce name="H_SEL_MASTER"> 
		<column colName="STOR_NAME"            colType="TB_STRING"   size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PART_NAME"            colType="TB_STRING"   size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PC_NAME"              colType="TB_STRING"   size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="GUBUN"                colType="TB_STRING"   size="6"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="TOT_AMT"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY01"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY02"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY03"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY04"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY05"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY06"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY07"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY08"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY09"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY10"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY11"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY12"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY13"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY14"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY15"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY16"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY17"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY18"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY19"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY20"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY21"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY22"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY23"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY24"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY25"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY26"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY27"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY28"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY29"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY30"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY31"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="WEEKDAYS_AMT"  	   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="WEEKENDS_AMT"  	   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PC_CD"                colType="TB_STRING"   size="12"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
	
	<!-- 점별 파트별 헤더 -->
    <gauce name="H_SEL_MASTER_OLD"> 
		<column colName="STR_CD"               colType="TB_STRING"   size="2"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="TEAM_CD"              colType="TB_STRING"   size="2"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PART_CD"              colType="TB_STRING"   size="2"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PART_NM"              colType="TB_STRING"   size="50"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="SEARCH_CD"            colType="TB_STRING"   size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_ORIGIN_SALE_TAMT"  colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_TOT_SALE_AMT"      colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_ACHIEVE_RATE"      colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_REDU_AMT"          colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_NORM_SALE_AMT"     colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_DC_AMT"            colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_NET_SALE_AMT"      colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_SALE_PROF_AMT"     colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_PROF_RATE"         colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_CUST_CNT"          colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_CUST_DANGA"        colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_SALE_QTY"          colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_VAT_AMT"           colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="ORIGIN_SALE_TAMT"     colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="TOT_SALE_AMT"         colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="ACHIEVE_RATE"         colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="REDU_AMT"             colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="NORM_SALE_AMT"        colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DC_AMT"               colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="NET_SALE_AMT"         colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="SALE_PROF_AMT"        colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PROF_RATE"            colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="CUST_CNT"             colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="CUST_DANGA"           colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="SALE_QTY"             colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="VAT_AMT"              colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="SALE_ACHV_RATE"       colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PROF_ACHV_RATE"       colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="CUST_CNT_ACHV_RATE"   colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="CUST_DANGA_ACHV_RATE" colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="ORDER_FLAG"           colType="TB_STRING"   size="2"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PUMBUN_CD"            colType="TB_STRING"   size="6"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    
    
    
    <!-- 점별 파트별 -->
    <query name="SEL_MASTER">        
        <![CDATA[
			WITH SALE_DATA AS
			(
						-- 매출 데이터
						SELECT A.STR_CD
						     , A.SALE_DT
						     , SUBSTR(B.SALE_ORG_CD,1,2)||'00000000' STOR_CD
						     , SUBSTR(B.SALE_ORG_CD,1,6)||'0000' PART_CD
						     , SUBSTR(B.SALE_ORG_CD,1,8)||'00' PC_CD
						     , A.PUMBUN_CD
						     , B.PUMBUN_NAME
						     , A.NORM_SALE_AMT
						     , SUM(A.NORM_SALE_AMT) OVER (PARTITION BY A.STR_CD,A.SALE_DT,SUBSTR(B.SALE_ORG_CD,1,6)||'0000' , SUBSTR(B.SALE_ORG_CD,1,8)||'00'  ) OVERSUM
						     , A.NORM_SALE_AMT/1.1 PURE_AMT
						     , A.SALE_PROF_AMT/1.1 PROF_AMT
						     , 0 PRO_NORM_SALE_AMT
						     , 0 PRO_OVERSUM
						     , 0 PRO_PURE_AMT
						     , 0 PRO_PROF_AMT
						     , 0 BF_NORM_SALE_AMT
						     , 0 BF_OVERSUM
						     , 0 BF_PURE_AMT
						     , 0 BF_PROF_AMT
						 FROM DPS.PS_DAYPBN A
						    , DPS.PC_STRPBN B
						WHERE 1=1
						AND A.STR_CD = B.STR_CD
						AND A.PUMBUN_CD = B.PUMBUN_CD
						AND A.STR_CD= ?
						AND B.SALE_ORG_CD LIKE ?||?||?||?
						AND A.SALE_DT BETWEEN ? AND ?
						AND A.PUMBUN_CD LIKE ?||'%'						
						UNION ALL
						-- 목표 데이터
						SELECT A.STR_CD
						     , A.EXE_DT
						     , SUBSTR(B.SALE_ORG_CD,1,2)||'00000000' STOR_CD
						     , SUBSTR(B.SALE_ORG_CD,1,6)||'0000' PART_CD
						     , SUBSTR(B.SALE_ORG_CD,1,8)||'00' PC_CD
						     , A.PUMBUN_CD
						     , B.PUMBUN_NAME
						     , 0 NORM_SALE_AMT
						     , 0 OVERSUM
						     , 0 PURE_AMT
						     , 0 PROF_AMT
						     , A.ORIGIN_SALE_TAMT PRO_NORM_SALE_AMT
						     , SUM(A.ORIGIN_SALE_TAMT) OVER (PARTITION BY A.STR_CD,A.EXE_DT,SUBSTR(B.SALE_ORG_CD,1,6)||'0000' , SUBSTR(B.SALE_ORG_CD,1,8)||'00'  ) PRO_OVERSUM
						     , A.ORIGIN_SALE_TAMT/1.1 PRO_PURE_AMT
						     , A.ORIGIN_PROF_TAMT/1.1 PRO_PROF_AMT
						     , 0 BF_NORM_SALE_AMT
						     , 0 BF_OVERSUM
						     , 0 BF_PURE_AMT
						     , 0 BF_PROF_AMT
						 FROM DPS.PS_ACTPUMBUN A
						    , DPS.PC_STRPBN B
						WHERE 1=1
						AND A.STR_CD = B.STR_CD
						AND A.PUMBUN_CD = B.PUMBUN_CD
						AND A.STR_CD= ?
						AND B.SALE_ORG_CD LIKE ?||?||?||?
						AND A.EXE_DT BETWEEN ? AND ?
						AND A.PUMBUN_CD LIKE ?||'%'						
						UNION ALL
						-- 대비 데이터
						SELECT A.STR_CD
						     , A.SALE_DT
						     , SUBSTR(B.SALE_ORG_CD,1,2)||'00000000' STOR_CD
						     , SUBSTR(B.SALE_ORG_CD,1,6)||'0000' PART_CD
						     , SUBSTR(B.SALE_ORG_CD,1,8)||'00' PC_CD
						     , A.PUMBUN_CD
						     , B.PUMBUN_NAME
						     , 0 NORM_SALE_AMT
						     , 0 OVERSUM
						     , 0 PURE_AMT
						     , 0 PROF_AMT
						     , 0 BF_NORM_SALE_AMT
						     , 0 BF_OVERSUM
						     , 0 BF_PURE_AMT
						     , 0 BF_PROF_AMT
						     , A.NORM_SALE_AMT BF_NORM_SALE_AMT
						     , SUM(A.NORM_SALE_AMT) OVER (PARTITION BY A.STR_CD,A.SALE_DT,SUBSTR(B.SALE_ORG_CD,1,6)||'0000' , SUBSTR(B.SALE_ORG_CD,1,8)||'00'  ) BF_OVERSUM
						     , A.NORM_SALE_AMT/1.1 BF_PURE_AMT
						     , A.SALE_PROF_AMT/1.1 BF_PROF_AMT
						 FROM DPS.PS_DAYPBN A
						    , DPS.PC_STRPBN B
						WHERE 1=1
						AND A.STR_CD = B.STR_CD
						AND A.PUMBUN_CD = B.PUMBUN_CD
						AND A.STR_CD= ?
						AND B.SALE_ORG_CD LIKE ?||?||?||?
						AND A.SALE_DT BETWEEN ? AND ?
						AND A.PUMBUN_CD LIKE ?||'%'						
			)
			-- 본 쿼리
			SELECT MIN(STOR_NAME) STOR_NAME
			     , MIN(PART_NAME) PART_NAME
			     , MIN(PC_NAME) PC_NAME
			     , DECODE(ORD_GU,'0','매출','1','목표','대비') GUBUN
			     , SUM(TOT_AMT)/? TOT_AMT
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'01' ,TOT_AMT) ,0) )/? DAY01
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'02' ,TOT_AMT) ,0) )/? DAY02
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'03' ,TOT_AMT) ,0) )/? DAY03
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'04' ,TOT_AMT) ,0) )/? DAY04
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'05' ,TOT_AMT) ,0) )/? DAY05
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'06' ,TOT_AMT) ,0) )/? DAY06
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'07' ,TOT_AMT) ,0) )/? DAY07
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'08' ,TOT_AMT) ,0) )/? DAY08
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'09' ,TOT_AMT) ,0) )/? DAY09
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'10' ,TOT_AMT) ,0) )/? DAY10
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'11' ,TOT_AMT) ,0) )/? DAY11
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'12' ,TOT_AMT) ,0) )/? DAY12
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'13' ,TOT_AMT) ,0) )/? DAY13
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'14' ,TOT_AMT) ,0) )/? DAY14
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'15' ,TOT_AMT) ,0) )/? DAY15
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'16' ,TOT_AMT) ,0) )/? DAY16
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'17' ,TOT_AMT) ,0) )/? DAY17
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'18' ,TOT_AMT) ,0) )/? DAY18
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'19' ,TOT_AMT) ,0) )/? DAY19
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'20' ,TOT_AMT) ,0) )/? DAY20
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'21' ,TOT_AMT) ,0) )/? DAY21
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'22' ,TOT_AMT) ,0) )/? DAY22
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'23' ,TOT_AMT) ,0) )/? DAY23
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'24' ,TOT_AMT) ,0) )/? DAY24
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'25' ,TOT_AMT) ,0) )/? DAY25
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'26' ,TOT_AMT) ,0) )/? DAY26
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'27' ,TOT_AMT) ,0) )/? DAY27
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'28' ,TOT_AMT) ,0) )/? DAY28
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'29' ,TOT_AMT) ,0) )/? DAY29
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'30' ,TOT_AMT) ,0) )/? DAY30
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'31' ,TOT_AMT) ,0) )/? DAY31
			     , SUM(NVL(CASE WHEN TO_CHAR(TO_DATE(SALE_DT),'D') IN ('2','3','4','5','6') THEN TOT_AMT ELSE 0 END,0))/? WEEKDAYS_AMT
			     , SUM(NVL(CASE WHEN TO_CHAR(TO_DATE(SALE_DT),'D') IN ('1','7') THEN TOT_AMT ELSE 0 END,0))/? WEEKENDS_AMT
			     --, STR_CD
			     --, PART_CD
			     , PC_CD
			     --, 1000 UNIT
			FROM
			    (
						    -- 매출
						    SELECT A.STR_CD
						         , A.SALE_DT
						         , A.STOR_CD
						         , A.PART_CD
						         , '0' ORD_GU
						         , MIN(B.ORG_NAME) PART_NAME
						         , A.PC_CD
						         , MIN(C.ORG_NAME) PC_NAME
						         , MIN(D.ORG_NAME) STOR_NAME
						         --, A.PUMBUN_CD
						         --, A.PUMBUN_NAME
						         , SUM(NORM_SALE_AMT) TOT_AMT
						         , MIN(OVERSUM) OVERSUM
						    FROM 
						      SALE_DATA A
						    , DPS.PC_ORGMST B
						    , DPS.PC_ORGMST C
						    , DPS.PC_ORGMST D
						    WHERE 1=1
						      AND A.STR_CD = B.STR_CD
						      AND A.STR_CD = C.STR_CD
						      AND A.PART_CD = B.ORG_CD
						      AND A.PC_CD  = C.ORG_CD
						      AND A.STOR_CD = D.ORG_CD
						     GROUP BY A.STR_CD
						            , A.SALE_DT
						            , A.STOR_CD
						            , A.PART_CD
						            , A.PC_CD
						    UNION ALL
						    -- 목표
						    SELECT A.STR_CD
						         , A.SALE_DT
						         , A.STOR_CD
						         , A.PART_CD
						         , '1' ORD_GU
						         , MIN(B.ORG_NAME) PART_NAME
						         , A.PC_CD
						         , MIN(C.ORG_NAME) PC_NAME
						         , MIN(D.ORG_NAME) STOR_NAME
						         --, A.PUMBUN_CD
						         --, A.PUMBUN_NAME
						         , SUM(PRO_NORM_SALE_AMT) TOT_AMT
						         , MIN(PRO_OVERSUM) OVERSUM
						    FROM 
						      SALE_DATA A
						    , DPS.PC_ORGMST B
						    , DPS.PC_ORGMST C
						    , DPS.PC_ORGMST D
						    WHERE 1=1
						      AND A.STR_CD = B.STR_CD
						      AND A.STR_CD = C.STR_CD
						      AND A.PART_CD = B.ORG_CD
						      AND A.PC_CD  = C.ORG_CD
						      AND A.STOR_CD = D.ORG_CD
						     GROUP BY A.STR_CD
						            , A.SALE_DT
						            , A.STOR_CD
						            , A.PART_CD
						            , A.PC_CD
						    UNION ALL
						    -- 대비
						    SELECT A.STR_CD
						         , A.SALE_DT
						         , A.STOR_CD
						         , A.PART_CD
						         , '2' ORD_GU
						         , MIN(B.ORG_NAME) PART_NAME
						         , A.PC_CD
						         , MIN(C.ORG_NAME) PC_NAME
						         , MIN(D.ORG_NAME) STOR_NAME
						         --, A.PUMBUN_CD
						         --, A.PUMBUN_NAME
						         , SUM(BF_NORM_SALE_AMT) TOT_AMT
						         , MIN(BF_OVERSUM) OVERSUM
						    FROM 
						      SALE_DATA A
						    , DPS.PC_ORGMST B
						    , DPS.PC_ORGMST C
						    , DPS.PC_ORGMST D
						    WHERE 1=1
						      AND A.STR_CD = B.STR_CD
						      AND A.STR_CD = C.STR_CD
						      AND A.PART_CD = B.ORG_CD
						      AND A.PC_CD  = C.ORG_CD
						      AND A.STOR_CD = D.ORG_CD
						     GROUP BY A.STR_CD
						            , A.SALE_DT
						            , A.STOR_CD
						            , A.PART_CD
						            , A.PC_CD
							UNION ALL   
                            /*   합  계  */
						    -- 매출
						    SELECT A.STR_CD
						         , A.SALE_DT
						         , A.STOR_CD
						         , A.STR_CD||'00000000' PART_CD
						         , '0' ORD_GU
						         , '전  체' PART_NAME
						         , A.STR_CD PC_CD
						         , '합  계' PC_NAME
						         , MIN(D.ORG_NAME) STOR_NAME
						         --, A.PUMBUN_CD
						         --, A.PUMBUN_NAME
						         , SUM(NORM_SALE_AMT) TOT_AMT
						         , MIN(OVERSUM) OVERSUM
						    FROM 
						      SALE_DATA A
						    , DPS.PC_ORGMST D
						    WHERE 1=1
						      AND A.STR_CD = D.STR_CD
						      AND A.STOR_CD = D.ORG_CD
						     GROUP BY A.STR_CD
						            , A.SALE_DT
						            , A.STOR_CD
						    UNION ALL
						    -- 목표
						    SELECT A.STR_CD
						         , A.SALE_DT
						         , A.STOR_CD
						         , A.STR_CD||'00000000' PART_CD
						         , '1' ORD_GU
						         , '전  체' PART_NAME
						         , A.STR_CD PC_CD
						         , '합  계' PC_NAME
						         , MIN(D.ORG_NAME) STOR_NAME
						         --, A.PUMBUN_CD
						         --, A.PUMBUN_NAME
						         , SUM(PRO_NORM_SALE_AMT) TOT_AMT
						         , MIN(PRO_OVERSUM) OVERSUM
						    FROM 
						      SALE_DATA A
						    , DPS.PC_ORGMST D
						    WHERE 1=1
						      AND A.STR_CD = D.STR_CD
						      AND A.STOR_CD = D.ORG_CD
						     GROUP BY A.STR_CD
						            , A.SALE_DT
						            , A.STOR_CD
						    UNION ALL
						    -- 대비
						    SELECT A.STR_CD
						         , A.SALE_DT
						         , A.STOR_CD
						         , A.STR_CD||'00000000' PART_CD
						         , '2' ORD_GU
						         , '전  체' PART_NAME
						         , A.STR_CD PC_CD
						         , '합  계' PC_NAME
						         , MIN(D.ORG_NAME) STOR_NAME
						         --, A.PUMBUN_CD
						         --, A.PUMBUN_NAME
						         , SUM(BF_NORM_SALE_AMT) TOT_AMT
						         , MIN(BF_OVERSUM) OVERSUM
						    FROM 
						      SALE_DATA A
						    , DPS.PC_ORGMST D
						    WHERE 1=1
						      AND A.STR_CD = D.STR_CD
						      AND A.STOR_CD = D.ORG_CD
						     GROUP BY A.STR_CD
						            , A.SALE_DT
						            , A.STOR_CD     						    

			)
			 GROUP BY STR_CD
			        , PART_CD
			        , PC_CD
			        , ORD_GU
			 ORDER BY STR_CD
			        , PART_CD
			        , PC_CD
			        , ORD_GU
        ]]>        
    </query>
    
    
    <!-- 점별 파트별 -->
    <query name="SEL_MASTER_OLD">        
        <![CDATA[
			-- 마스터
			SELECT A.STR_CD
			     , A.TEAM_CD                                          /* 팀코드             */
			     , A.PART_CD                                          /* 파트코드           */
			     , A.PART_NM                                          /* 파트명             */
			     , A.STR_CD || A.TEAM_CD || A.PART_CD AS SEARCH_CD    /* 조회               */
			     , A.BF_ORIGIN_SALE_TAMT / ?  AS BF_ORIGIN_SALE_TAMT  /* (대비)목표매출     */
			     , A.BF_TOT_SALE_AMT     / ?  AS BF_TOT_SALE_AMT      /* (대비)총매출금액   */
			     , A.BF_ACHIEVE_RATE          AS BF_ACHIEVE_RATE      /* (대비)달성율       */
			     , A.BF_REDU_AMT         / ?  AS BF_REDU_AMT          /* (대비)할인금액     */
			     , A.BF_NORM_SALE_AMT    / ?  AS BF_NORM_SALE_AMT     /* (대비)정상매출금액 */
			     , A.BF_DC_AMT           / ?  AS BF_DC_AMT            /* (대비)에누리금액   */
			     , A.BF_NET_SALE_AMT     / ?  AS BF_NET_SALE_AMT      /* (대비)순매출금액   */
			     , A.BF_SALE_PROF_AMT    / ?  AS BF_SALE_PROF_AMT     /* (대비)매출이익액   */
			     , A.BF_PROF_RATE             AS BF_PROF_RATE         /* (대비)매출이익율   */
			     , A.BF_CUST_CNT              AS BF_CUST_CNT          /* (대비)객수         */
			     , A.BF_CUST_DANGA       / ?  AS BF_CUST_DANGA        /* (대비)객단가       */
			     , A.BF_SALE_QTY              AS BF_SALE_QTY          /* (대비)판매수량     */
			     , A.BF_VAT_AMT          / ?  AS BF_VAT_AMT           /* (대비)부가세       */
			     , A.ORIGIN_SALE_TAMT    / ?  AS ORIGIN_SALE_TAMT     /* (실적)목표매출     */
			     , A.TOT_SALE_AMT        / ?  AS TOT_SALE_AMT         /* (실적)총매출금액   */
			     , A.ACHIEVE_RATE             AS ACHIEVE_RATE         /* (실적)달성율       */
			     , A.REDU_AMT            / ?  AS REDU_AMT             /* (실적)할인금액     */
			     , A.NORM_SALE_AMT       / ?  AS NORM_SALE_AMT        /* (실적)정상매출금액 */
			     , A.DC_AMT              / ?  AS DC_AMT               /* (실적)에누리금액   */
			     , A.NET_SALE_AMT        / ?  AS NET_SALE_AMT         /* (실적)순매출금액   */
			     , A.SALE_PROF_AMT       / ?  AS SALE_PROF_AMT        /* (실적)매출이익액   */
			     , A.PROF_RATE                AS PROF_RATE            /* (실적)매출이익율   */
			     , A.CUST_CNT                 AS CUST_CNT             /* (실적)객수         */
			     , A.CUST_DANGA          / ?  AS CUST_DANGA           /* (실적)객단가       */
			     , A.SALE_QTY            / ?  AS SALE_QTY             /* (실적)판매수량     */
			     , A.VAT_AMT             / ?  AS VAT_AMT              /* (실적)부가세       */
			     , DECODE( A.BF_TOT_SALE_AMT, 0, 0
			             , (A.TOT_SALE_AMT  - A.BF_TOT_SALE_AMT)  / A.BF_TOT_SALE_AMT  * 100
			             ) AS SALE_ACHV_RATE              /* 매출액 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_SALE_PROF_AMT, 0, 0
			             , (A.SALE_PROF_AMT - A.BF_SALE_PROF_AMT) / A.BF_SALE_PROF_AMT * 100
			             ) AS PROF_ACHV_RATE              /* 이익액 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_CUST_CNT, 0, 0
			             , (A.CUST_CNT - A.BF_CUST_CNT) / A.BF_CUST_CNT * 100
			             ) AS CUST_CNT_ACHV_RATE          /* 고객수 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_CUST_DANGA, 0, 0
			             , (A.CUST_DANGA - A.BF_CUST_DANGA) / A.BF_CUST_DANGA * 100
			             ) AS CUST_DANGA_ACHV_RATE        /* 객단가 신장률 (실적 - 대비 / 대비 * 100) */
			     , A.ORDER_FLAG
			     , ? AS PUMBUN_CD /* 조회조건의 브랜드코드를 가져옴. 디테일에서 브랜드코드를 쓰기 위함  */
			  FROM ( 
			        -- 점별 합계
			        SELECT A.STR_CD
			             , ''                           AS TEAM_CD                  /* 팀코드             */
			             , ''                           AS PART_CD                  /* 파트코드           */
			             , '합계'                       AS PART_NM                  /* 파트명             */
			             , SUM(A.BF_ORIGIN_SALE_TAMT)   AS BF_ORIGIN_SALE_TAMT      /* (대비)목표매출     */
			             , SUM(A.BF_TOT_SALE_AMT)       AS BF_TOT_SALE_AMT          /* (대비)총매출금액   */
			             , DECODE(SUM(A.BF_ORIGIN_SALE_TAMT), 0, 0
			                    , ROUND(SUM(A.BF_TOT_SALE_AMT) 
			                          / SUM(A.BF_ORIGIN_SALE_TAMT)
			                          * 100, 2))        AS BF_ACHIEVE_RATE          /* (대비)달성율       */
			             , SUM(A.BF_REDU_AMT)           AS BF_REDU_AMT              /* (대비)할인금액     */
			             , SUM(A.BF_NORM_SALE_AMT)      AS BF_NORM_SALE_AMT         /* (대비)정상매출금액 */
			             , SUM(A.BF_DC_AMT)             AS BF_DC_AMT                /* (대비)에누리금액   */
			             , SUM(A.BF_NET_SALE_AMT)       AS BF_NET_SALE_AMT          /* (대비)순매출금액   */
			             , SUM(A.BF_SALE_PROF_AMT)      AS BF_SALE_PROF_AMT         /* (대비)매출이익액   */
			             , DECODE(SUM(A.BF_NORM_SALE_AMT_VAT), 0, 0
			                    , ROUND(SUM(A.BF_SALE_PROF_AMT) 
			                          / ROUND(SUM(A.BF_NORM_SALE_AMT_VAT), 0)
			                          * 100, 2))        AS BF_PROF_RATE             /* (대비)매출이익율   */
			             , SUM(A.BF_CUST_CNT)           AS BF_CUST_CNT              /* (대비)객수         */
			             , DECODE(SUM(A.BF_CUST_CNT), 0, 0
			                    , ROUND(SUM(A.BF_TOT_SALE_AMT) 
			                          / SUM(A.BF_CUST_CNT)
			                          , 2))             AS BF_CUST_DANGA            /* (대비)객단가       */
			             , SUM(A.BF_SALE_QTY)           AS BF_SALE_QTY              /* (대비)판매수량     */
			             , SUM(A.BF_VAT_AMT)            AS BF_VAT_AMT               /* (대비)부가세       */
			             , SUM(A.ORIGIN_SALE_TAMT)      AS ORIGIN_SALE_TAMT         /* (실적)목표매출     */
			             , SUM(A.TOT_SALE_AMT)          AS TOT_SALE_AMT             /* (실적)총매출금액   */
			             , DECODE(SUM(A.ORIGIN_SALE_TAMT), 0, 0
			                    , ROUND(SUM(A.TOT_SALE_AMT) 
			                          / SUM(A.ORIGIN_SALE_TAMT)
			                          * 100, 2))        AS ACHIEVE_RATE             /* (실적)달성율       */
			             , SUM(A.REDU_AMT)              AS REDU_AMT                 /* (실적)할인금액     */
			             , SUM(A.NORM_SALE_AMT)         AS NORM_SALE_AMT            /* (실적)정상매출금액 */
			             , SUM(A.DC_AMT)                AS DC_AMT                   /* (실적)에누리금액   */
			             , SUM(A.NET_SALE_AMT)          AS NET_SALE_AMT             /* (실적)순매출금액   */
			             , SUM(A.SALE_PROF_AMT)         AS SALE_PROF_AMT            /* (실적)매출이익액   */
			             , DECODE(SUM(A.NORM_SALE_AMT_VAT), 0, 0
			                    , ROUND(SUM(A.SALE_PROF_AMT) 
			                          / ROUND(SUM(A.NORM_SALE_AMT_VAT), 0)
			                          * 100, 2))        AS PROF_RATE                /* (실적)매출이익율   */
			             , SUM(A.CUST_CNT)              AS CUST_CNT                 /* (실적)객수         */
			             , DECODE(SUM(A.CUST_CNT), 0, 0
			                    , ROUND(SUM(A.TOT_SALE_AMT) 
			                          / SUM(A.CUST_CNT)
			                          , 2))             AS CUST_DANGA               /* (실적)객단가       */
			             , SUM(A.SALE_QTY)              AS SALE_QTY                 /* (실적)판매수량     */
			             , SUM(A.VAT_AMT)               AS VAT_AMT                  /* (실적)부가세       */
			             , A.ORDER_FLAG
			          FROM (
			                SELECT A.STR_CD
			                     , A.ORG_CD                             /* 조직코드     */
			                     , SUBSTR(A.ORG_CD, 3, 2) AS TEAM_CD    /* 팀코드       */
			                     , SUBSTR(A.ORG_CD, 5, 2) AS PART_CD    /* 파트코드     */
			                     , C.ORG_NAME             AS PART_NM    /* 파트명       */
			                     , SUBSTR(A.ORG_CD, 7, 2) AS PC_CD      /* PC코드       */
			                     , D.ORG_NAME             AS PC_NM      /* PC명         */
			                     , SUBSTR(A.ORG_CD, 9, 2) AS CORNER_CD  /* 코너코드     */
			                     , E.ORG_NAME             AS CORNER_NM  /* 코너명       */
			                     , A.PUMBUN_CD                          /* 브랜드 코드  */
			                     , B.PUMBUN_NAME                        /* 브랜드 명    */
			                     , A.BF_ORIGIN_SALE_TAMT                /* (대비)목표매출     */
			                     , A.BF_TOT_SALE_AMT                    /* (대비)총매출금액   */
			                     , A.BF_REDU_AMT                        /* (대비)할인금액     */
			                     , A.BF_NORM_SALE_AMT                   /* (대비)정상매출금액 */
			                     , A.BF_DC_AMT                          /* (대비)에누리금액   */
			                     , A.BF_NET_SALE_AMT                    /* (대비)순매출금액   */
			                     , A.BF_SALE_PROF_AMT                   /* (대비)매출이익액   */
			                     , A.BF_CUST_CNT                        /* (대비)객수         */
			                     , A.BF_SALE_QTY                        /* (대비)판매수량     */
			                     , A.BF_VAT_AMT                         /* (대비)부가세       */
			                     , A.BF_NORM_SALE_AMT_VAT               /* (대비)부가세 계산  */
			                     , A.ORIGIN_SALE_TAMT                   /* (실적)목표매출     */
			                     , A.TOT_SALE_AMT                       /* (실적)총매출금액   */
			                     , A.REDU_AMT                           /* (실적)할인금액     */
			                     , A.NORM_SALE_AMT                      /* (실적)정상매출금액 */
			                     , A.DC_AMT                             /* (실적)에누리금액   */
			                     , A.NET_SALE_AMT                       /* (실적)순매출금액   */
			                     , A.SALE_PROF_AMT                      /* (실적)매출이익액   */
			                     , A.CUST_CNT                           /* (실적)객수         */
			                     , A.SALE_QTY                           /* (실적)판매수량     */
			                     , A.VAT_AMT                            /* (실적)부가세       */
			                     , A.NORM_SALE_AMT_VAT                  /* (실적)부가세 계산  */             
			                     , '0'   AS ORDER_FLAG                  /* 정렬구분           */
			                  FROM (
			                        -- 매출  
			                        SELECT A.STR_CD
			                             , A.SALE_DT
			                             , A.ORG_CD
			                             , A.PUMBUN_CD                         /* 브랜드 코드        */
			                             , A.BF_SALE_QTY                       /* (대비)판매수량     */
			                             , A.BF_TOT_SALE_AMT                   /* (대비)총매출금액   */
			                             , A.BF_VAT_AMT                        /* (대비)부가세       */
			                             , A.BF_REDU_AMT                       /* (대비)할인금액     */
			                             , A.BF_NORM_SALE_AMT                  /* (대비)정상매출금액 */
			                             , A.BF_DC_AMT                         /* (대비)에누리금액   */
			                             , A.BF_NET_SALE_AMT                   /* (대비)순매출금액   */
			                             , A.BF_SALE_PROF_AMT                  /* (대비)매출이익액   */
			                             , A.BF_CUST_CNT                       /* (대비)객수         */
			                             , 0    AS BF_ORIGIN_SALE_TAMT         /* (대비)목표매출금액 */
			                             , CASE WHEN A.BF_NORM_SALE_AMT = 0 THEN 0
			                                    ELSE (CASE WHEN B.TAX_FLAG = '1' THEN A.BF_NORM_SALE_AMT / 1.1
			                                                                     ELSE A.BF_NORM_SALE_AMT
			                                          END)
			                               END  AS BF_NORM_SALE_AMT_VAT
			                             , A.SALE_QTY                          /* (실적)판매수량     */
			                             , A.TOT_SALE_AMT                      /* (실적)총매출금액   */
			                             , A.VAT_AMT                           /* (실적)부가세       */
			                             , A.REDU_AMT                          /* (실적)할인금액     */
			                             , A.NORM_SALE_AMT                     /* (실적)정상매출금액 */
			                             , A.DC_AMT                            /* (실적)에누리금액   */
			                             , A.NET_SALE_AMT                      /* (실적)순매출금액   */
			                             , A.SALE_PROF_AMT                     /* (실적)매출이익액   */
			                             , A.CUST_CNT                          /* (실적)객수         */
			                             , 0    AS ORIGIN_SALE_TAMT            /* (실적)목표매출금액 */
			                             , CASE WHEN A.NORM_SALE_AMT = 0 THEN 0
			                                    ELSE (CASE WHEN B.TAX_FLAG = '1' THEN A.NORM_SALE_AMT / 1.1
			                                                                     ELSE A.NORM_SALE_AMT
			                                          END)
			                               END  AS NORM_SALE_AMT_VAT
			                          FROM (
			                                SELECT A.STR_CD
			                                     , A.SALE_DT
			                                     , B.SALE_ORG_CD AS ORG_CD
			                                     , A.PUMBUN_CD                 /* 브랜드 코드 */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.SALE_QTY      ELSE 0 END BF_SALE_QTY       /* (대비)판매수량     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.TOT_SALE_AMT  ELSE 0 END BF_TOT_SALE_AMT   /* (대비)총매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.VAT_AMT       ELSE 0 END BF_VAT_AMT        /* (대비)부가세       */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.REDU_AMT      ELSE 0 END BF_REDU_AMT       /* (대비)할인금액     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NORM_SALE_AMT ELSE 0 END BF_NORM_SALE_AMT  /* (대비)정상매출금액 */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.DC_AMT        ELSE 0 END BF_DC_AMT         /* (대비)에누리금액   */             
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NET_SALE_AMT  ELSE 0 END BF_NET_SALE_AMT   /* (대비)순매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN ROUND(A.SALE_PROF_AMT/1.1,0) ELSE 0 END BF_SALE_PROF_AMT  /* (대비)매출이익액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.CUST_CNT      ELSE 0 END BF_CUST_CNT       /* (대비)객수         */             
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.SALE_QTY      ELSE 0 END SALE_QTY          /* (실적)판매수량     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.TOT_SALE_AMT  ELSE 0 END TOT_SALE_AMT      /* (실적)총매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.VAT_AMT       ELSE 0 END VAT_AMT           /* (실적)부가세       */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.REDU_AMT      ELSE 0 END REDU_AMT          /* (실적)할인금액     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NORM_SALE_AMT ELSE 0 END NORM_SALE_AMT     /* (실적)정상매출금액 */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.DC_AMT        ELSE 0 END DC_AMT            /* (실적)에누리금액   */             
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NET_SALE_AMT  ELSE 0 END NET_SALE_AMT      /* (실적)순매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN ROUND(A.SALE_PROF_AMT/1.1,0) ELSE 0 END SALE_PROF_AMT     /* (실적)매출이익액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.CUST_CNT      ELSE 0 END CUST_CNT          /* (실적)객수         */
			                                  FROM DPS.PS_DAYPBN A
                                                 , DPS.PC_STRPBN B
			                                 WHERE A.STR_CD    = ?
			                                   AND A.STR_CD    = B.STR_CD
			                                   AND A.PUMBUN_CD = B.PUMBUN_CD
			                                   AND B.SALE_ORG_CD  LIKE ? || ? || ? || ? || '%'
			                                   AND (  A.SALE_DT   BETWEEN ? AND ?     -- 대비
			                                       OR A.SALE_DT   BETWEEN ? AND ?     -- 실적
			                                       )
			                                   AND A.PUMBUN_CD LIKE ? || '%'
			                                   AND A.PUMBUN_CD IN ( 
			                                                        SELECT MYORG.PUMBUN_CD
			                                                          FROM COM.V_MYORG MYORG
			                                                         WHERE MYORG.USER_ID     = ?
			                                                           AND MYORG.ORG_FLAG    = ?
			                                                      )
			                               ) A
			                             , DPS.PC_PBNMST B
			                         WHERE A.PUMBUN_CD = B.PUMBUN_CD
			                        -- 실행계획(목표매출금액)  
			                         UNION ALL
			                        SELECT A.STR_CD
			                             , A.EXE_DT
			                             , B.SALE_ORG_CD  AS ORG_CD
			                             , A.PUMBUN_CD
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0   
			                             , CASE WHEN A.EXE_DT BETWEEN ? AND ? THEN A.ORIGIN_SALE_TAMT ELSE 0 END AS BF_ORIGIN_SALE_TAMT 
			                             , 0
			                             , 0 
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , CASE WHEN A.EXE_DT BETWEEN ? AND ? THEN A.ORIGIN_SALE_TAMT ELSE 0 END AS ORIGIN_SALE_TAMT
			                             , 0
			                          FROM DPS.PS_ACTPUMBUN A   -- 브랜드별 실행계획
			                             , DPS.PC_STRPBN B
			                         WHERE A.STR_CD    = B.STR_CD
			                           AND A.PUMBUN_CD = B.PUMBUN_CD
			                           AND A.STR_CD    = ?
			                           AND B.SALE_ORG_CD LIKE ? || ? || ? || ? || '%'
			                           AND (  A.EXE_YM   BETWEEN SUBSTR(?, 1, 6) AND SUBSTR(?, 1, 6)  -- 대비
			                               OR A.EXE_YM   BETWEEN SUBSTR(?, 1, 6) AND SUBSTR(?, 1, 6)  -- 실적
			                               )
			                           AND (  A.EXE_DT   BETWEEN ? AND ?     -- 대비
			                               OR A.EXE_DT   BETWEEN ? AND ?     -- 실적
			                               )
			                           AND A.PUMBUN_CD LIKE ? || '%'
			                           AND A.PUMBUN_CD IN ( 
			                                                SELECT MYORG.PUMBUN_CD
			                                                  FROM COM.V_MYORG MYORG
			                                                 WHERE MYORG.USER_ID     = ?
			                                                   AND MYORG.ORG_FLAG    = ?
			                                              )
			                       ) A
			                     , DPS.PC_STRPBN B             
			                     , DPS.PC_ORGMST C  /* 파트 */
			                     , DPS.PC_ORGMST D  /* PC   */
			                     , DPS.PC_ORGMST E  /* 코너 */
			                 WHERE A.STR_CD    = B.STR_CD
			                   AND A.PUMBUN_CD = B.PUMBUN_CD
			                   AND SUBSTR(A.ORG_CD, 1, 8)    = DECODE(?, '1', SUBSTR(B.SALE_ORG_CD, 1, 8), SUBSTR(B.BUY_ORG_CD, 1, 8))
			                   AND SUBSTR(A.ORG_CD, 1, 6) || '0000' = C.ORG_CD 
			                   AND SUBSTR(A.ORG_CD, 1, 8) || '00'   = D.ORG_CD
			                   AND A.ORG_CD    = E.ORG_CD
			               )   A
			        GROUP BY A.STR_CD
			               , A.ORDER_FLAG
			               
			        --점별 파트별
			         UNION ALL
			        SELECT A.STR_CD
			             , A.TEAM_CD                                                /* 팀코드             */
			             , A.PART_CD                                                /* 파트코드           */
			             , A.PART_NM                                                /* 파트명             */
			             , SUM(A.BF_ORIGIN_SALE_TAMT)   AS BF_ORIGIN_SALE_TAMT      /* (대비)목표매출     */
			             , SUM(A.BF_TOT_SALE_AMT)       AS BF_TOT_SALE_AMT          /* (대비)총매출금액   */
			             , DECODE(SUM(A.BF_ORIGIN_SALE_TAMT), 0, 0
			                    , ROUND(SUM(A.BF_TOT_SALE_AMT) 
			                          / SUM(A.BF_ORIGIN_SALE_TAMT)
			                          * 100, 2))        AS BF_ACHIEVE_RATE          /* (대비)달성율       */
			             , SUM(A.BF_REDU_AMT)           AS BF_REDU_AMT              /* (대비)할인금액     */
			             , SUM(A.BF_NORM_SALE_AMT)      AS BF_NORM_SALE_AMT         /* (대비)정상매출금액 */
			             , SUM(A.BF_DC_AMT)             AS BF_DC_AMT                /* (대비)에누리금액   */
			             , SUM(A.BF_NET_SALE_AMT)       AS BF_NET_SALE_AMT          /* (대비)순매출금액   */
			             , SUM(A.BF_SALE_PROF_AMT)      AS BF_SALE_PROF_AMT         /* (대비)매출이익액   */
			             , DECODE(SUM(A.BF_NORM_SALE_AMT_VAT), 0, 0
			                    , ROUND(SUM(A.BF_SALE_PROF_AMT) 
			                          / ROUND(SUM(A.BF_NORM_SALE_AMT_VAT), 0)
			                          * 100, 2))        AS BF_PROF_RATE             /* (대비)매출이익율   */
			             , SUM(A.BF_CUST_CNT)           AS BF_CUST_CNT              /* (대비)객수         */
			             , DECODE(SUM(A.BF_CUST_CNT), 0, 0
			                    , ROUND(SUM(A.BF_TOT_SALE_AMT) 
			                          / SUM(A.BF_CUST_CNT)
			                          , 2))             AS BF_CUST_DANGA            /* (대비)객단가       */
			             , SUM(A.BF_SALE_QTY)           AS BF_SALE_QTY              /* (대비)판매수량     */
			             , SUM(A.BF_VAT_AMT)            AS BF_VAT_AMT               /* (대비)부가세       */
			             , SUM(A.ORIGIN_SALE_TAMT)      AS ORIGIN_SALE_TAMT         /* (실적)목표매출     */
			             , SUM(A.TOT_SALE_AMT)          AS TOT_SALE_AMT             /* (실적)총매출금액   */
			             , DECODE(SUM(A.ORIGIN_SALE_TAMT), 0, 0
			                    , ROUND(SUM(A.TOT_SALE_AMT) 
			                          / SUM(A.ORIGIN_SALE_TAMT)
			                          * 100, 2))        AS ACHIEVE_RATE             /* (실적)달성율       */
			             , SUM(A.REDU_AMT)              AS REDU_AMT                 /* (실적)할인금액     */
			             , SUM(A.NORM_SALE_AMT)         AS NORM_SALE_AMT            /* (실적)정상매출금액 */
			             , SUM(A.DC_AMT)                AS DC_AMT                   /* (실적)에누리금액   */
			             , SUM(A.NET_SALE_AMT)          AS NET_SALE_AMT             /* (실적)순매출금액   */
			             , SUM(A.SALE_PROF_AMT)         AS SALE_PROF_AMT            /* (실적)매출이익액   */
			             , DECODE(SUM(A.NORM_SALE_AMT_VAT), 0, 0
			                    , ROUND(SUM(A.SALE_PROF_AMT) 
			                          / ROUND(SUM(A.NORM_SALE_AMT_VAT), 0)
			                          * 100, 2))        AS PROF_RATE                /* (실적)매출이익율   */
			             , SUM(A.CUST_CNT)              AS CUST_CNT                 /* (실적)객수         */
			             , DECODE(SUM(A.CUST_CNT), 0, 0
			                    , ROUND(SUM(A.TOT_SALE_AMT) 
			                          / SUM(A.CUST_CNT)
			                          , 2))             AS CUST_DANGA               /* (실적)객단가       */
			             , SUM(A.SALE_QTY)              AS SALE_QTY                 /* (실적)판매수량     */
			             , SUM(A.VAT_AMT)               AS VAT_AMT                  /* (실적)부가세       */
			             , A.ORDER_FLAG
			          FROM (
			                SELECT A.STR_CD
			                     , A.ORG_CD                             /* 조직코드     */
			                     , SUBSTR(A.ORG_CD, 3, 2) AS TEAM_CD    /* 팀코드       */
			                     , SUBSTR(A.ORG_CD, 5, 2) AS PART_CD    /* 파트코드     */
			                     , C.ORG_NAME             AS PART_NM    /* 파트명       */
			                     , SUBSTR(A.ORG_CD, 7, 2) AS PC_CD      /* PC코드       */
			                     , D.ORG_NAME             AS PC_NM      /* PC명         */
			                     , SUBSTR(A.ORG_CD, 9, 2) AS CORNER_CD  /* 코너코드     */
			                     , E.ORG_NAME             AS CORNER_NM  /* 코너명       */
			                     , A.PUMBUN_CD                          /* 브랜드 코드  */
			                     , B.PUMBUN_NAME                        /* 브랜드 명    */
			                     , A.BF_ORIGIN_SALE_TAMT                /* (대비)목표매출     */
			                     , A.BF_TOT_SALE_AMT                    /* (대비)총매출금액   */
			                     , A.BF_REDU_AMT                        /* (대비)할인금액     */
			                     , A.BF_NORM_SALE_AMT                   /* (대비)정상매출금액 */
			                     , A.BF_DC_AMT                          /* (대비)에누리금액   */
			                     , A.BF_NET_SALE_AMT                    /* (대비)순매출금액   */
			                     , A.BF_SALE_PROF_AMT                   /* (대비)매출이익액   */
			                     , A.BF_CUST_CNT                        /* (대비)객수         */
			                     , A.BF_SALE_QTY                        /* (대비)판매수량     */
			                     , A.BF_VAT_AMT                         /* (대비)부가세       */
			                     , A.BF_NORM_SALE_AMT_VAT               /* (대비)부가세 계산  */
			                     , A.ORIGIN_SALE_TAMT                   /* (실적)목표매출     */
			                     , A.TOT_SALE_AMT                       /* (실적)총매출금액   */
			                     , A.REDU_AMT                           /* (실적)할인금액     */
			                     , A.NORM_SALE_AMT                      /* (실적)정상매출금액 */
			                     , A.DC_AMT                             /* (실적)에누리금액   */
			                     , A.NET_SALE_AMT                       /* (실적)순매출금액   */
			                     , A.SALE_PROF_AMT                      /* (실적)매출이익액   */
			                     , A.CUST_CNT                           /* (실적)객수         */
			                     , A.SALE_QTY                           /* (실적)판매수량     */
			                     , A.VAT_AMT                            /* (실적)부가세       */
			                     , A.NORM_SALE_AMT_VAT                  /* (실적)부가세 계산  */             
			                     , '1'   AS ORDER_FLAG                  /* 정렬구분           */
			                  FROM (
			                        -- 매출  
			                        SELECT A.STR_CD
			                             , A.SALE_DT
			                             , A.ORG_CD
			                             , A.PUMBUN_CD                         /* 브랜드 코드        */
			                             , A.BF_SALE_QTY                       /* (대비)판매수량     */
			                             , A.BF_TOT_SALE_AMT                   /* (대비)총매출금액   */
			                             , A.BF_VAT_AMT                        /* (대비)부가세       */
			                             , A.BF_REDU_AMT                       /* (대비)할인금액     */
			                             , A.BF_NORM_SALE_AMT                  /* (대비)정상매출금액 */
			                             , A.BF_DC_AMT                         /* (대비)에누리금액   */
			                             , A.BF_NET_SALE_AMT                   /* (대비)순매출금액   */
			                             , A.BF_SALE_PROF_AMT                  /* (대비)매출이익액   */
			                             , A.BF_CUST_CNT                       /* (대비)객수         */
			                             , 0    AS BF_ORIGIN_SALE_TAMT         /* (대비)목표매출금액 */
			                             , CASE WHEN A.BF_NORM_SALE_AMT = 0 THEN 0
			                                    ELSE (CASE WHEN B.TAX_FLAG = '1' THEN A.BF_NORM_SALE_AMT / 1.1
			                                                                     ELSE A.BF_NORM_SALE_AMT
			                                          END)
			                               END  AS BF_NORM_SALE_AMT_VAT
			                             , A.SALE_QTY                          /* (실적)판매수량     */
			                             , A.TOT_SALE_AMT                      /* (실적)총매출금액   */
			                             , A.VAT_AMT                           /* (실적)부가세       */
			                             , A.REDU_AMT                          /* (실적)할인금액     */
			                             , A.NORM_SALE_AMT                     /* (실적)정상매출금액 */
			                             , A.DC_AMT                            /* (실적)에누리금액   */
			                             , A.NET_SALE_AMT                      /* (실적)순매출금액   */
			                             , A.SALE_PROF_AMT                     /* (실적)매출이익액   */
			                             , A.CUST_CNT                          /* (실적)객수         */
			                             , 0    AS ORIGIN_SALE_TAMT            /* (실적)목표매출금액 */
			                             , CASE WHEN A.NORM_SALE_AMT = 0 THEN 0
			                                    ELSE (CASE WHEN B.TAX_FLAG = '1' THEN A.NORM_SALE_AMT / 1.1
			                                                                     ELSE A.NORM_SALE_AMT
			                                          END)
			                               END  AS NORM_SALE_AMT_VAT
			                          FROM (
			                                SELECT A.STR_CD
			                                     , A.SALE_DT
			                                     , B.SALE_ORG_CD AS ORG_CD
			                                     , A.PUMBUN_CD                 /* 브랜드 코드 */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.SALE_QTY      ELSE 0 END BF_SALE_QTY       /* (대비)판매수량     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.TOT_SALE_AMT  ELSE 0 END BF_TOT_SALE_AMT   /* (대비)총매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.VAT_AMT       ELSE 0 END BF_VAT_AMT        /* (대비)부가세       */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.REDU_AMT      ELSE 0 END BF_REDU_AMT       /* (대비)할인금액     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NORM_SALE_AMT ELSE 0 END BF_NORM_SALE_AMT  /* (대비)정상매출금액 */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.DC_AMT        ELSE 0 END BF_DC_AMT         /* (대비)에누리금액   */             
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NET_SALE_AMT  ELSE 0 END BF_NET_SALE_AMT   /* (대비)순매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN ROUND(A.SALE_PROF_AMT/1.1,0) ELSE 0 END BF_SALE_PROF_AMT  /* (대비)매출이익액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.CUST_CNT      ELSE 0 END BF_CUST_CNT       /* (대비)객수         */             
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.SALE_QTY      ELSE 0 END SALE_QTY          /* (실적)판매수량     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.TOT_SALE_AMT  ELSE 0 END TOT_SALE_AMT      /* (실적)총매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.VAT_AMT       ELSE 0 END VAT_AMT           /* (실적)부가세       */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.REDU_AMT      ELSE 0 END REDU_AMT          /* (실적)할인금액     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NORM_SALE_AMT ELSE 0 END NORM_SALE_AMT     /* (실적)정상매출금액 */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.DC_AMT        ELSE 0 END DC_AMT            /* (실적)에누리금액   */             
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NET_SALE_AMT  ELSE 0 END NET_SALE_AMT      /* (실적)순매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN ROUND(A.SALE_PROF_AMT/1.1,0) ELSE 0 END SALE_PROF_AMT     /* (실적)매출이익액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.CUST_CNT      ELSE 0 END CUST_CNT          /* (실적)객수         */
			                                  FROM DPS.PS_DAYPBN A
                                                 , DPS.PC_STRPBN B
			                                 WHERE A.STR_CD    = ?
			                                   AND A.STR_CD    = B.STR_CD
			                                   AND A.PUMBUN_CD = B.PUMBUN_CD
			                                   AND B.SALE_ORG_CD  LIKE ? || ? || ? || ? || '%'
			                                   AND (  A.SALE_DT   BETWEEN ? AND ?     -- 대비
			                                       OR A.SALE_DT   BETWEEN ? AND ?     -- 실적
			                                       )
			                                   AND A.PUMBUN_CD LIKE ? || '%'
			                                   AND A.PUMBUN_CD IN ( 
			                                                        SELECT MYORG.PUMBUN_CD
			                                                          FROM COM.V_MYORG MYORG
			                                                         WHERE MYORG.USER_ID     = ?
			                                                           AND MYORG.ORG_FLAG    = ?
			                                                      )
			                               ) A
			                             , DPS.PC_PBNMST B
			                         WHERE A.PUMBUN_CD = B.PUMBUN_CD
			                        -- 실행계획(목표매출금액)  
			                         UNION ALL
			                        SELECT A.STR_CD
			                             , A.EXE_DT
			                             , B.SALE_ORG_CD  AS ORG_CD
			                             , A.PUMBUN_CD
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0   
			                             , CASE WHEN A.EXE_DT BETWEEN ? AND ? THEN A.ORIGIN_SALE_TAMT ELSE 0 END AS BF_ORIGIN_SALE_TAMT 
			                             , 0
			                             , 0 
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , CASE WHEN A.EXE_DT BETWEEN ? AND ? THEN A.ORIGIN_SALE_TAMT ELSE 0 END AS ORIGIN_SALE_TAMT
			                             , 0
			                          FROM DPS.PS_ACTPUMBUN A   -- 브랜드별 실행계획
			                             , DPS.PC_STRPBN B
			                         WHERE A.STR_CD    = B.STR_CD
			                           AND A.PUMBUN_CD = B.PUMBUN_CD
			                           AND A.STR_CD    = ?
			                           AND B.SALE_ORG_CD LIKE ? || ? || ? || ? || '%'
			                           AND (  A.EXE_YM   BETWEEN SUBSTR(?, 1, 6) AND SUBSTR(?, 1, 6)  -- 대비
			                               OR A.EXE_YM   BETWEEN SUBSTR(?, 1, 6) AND SUBSTR(?, 1, 6)  -- 실적
			                               )
			                           AND (  A.EXE_DT   BETWEEN ? AND ?     -- 대비
			                               OR A.EXE_DT   BETWEEN ? AND ?     -- 실적
			                               )
			                           AND A.PUMBUN_CD LIKE ? || '%'
			                           AND A.PUMBUN_CD IN ( 
			                                                SELECT MYORG.PUMBUN_CD
			                                                  FROM COM.V_MYORG MYORG
			                                                 WHERE MYORG.USER_ID     = ?
			                                                   AND MYORG.ORG_FLAG    = ?
			                                              )
			                       ) A
			                     , DPS.PC_STRPBN B             
			                     , DPS.PC_ORGMST C  /* 파트 */
			                     , DPS.PC_ORGMST D  /* PC   */
			                     , DPS.PC_ORGMST E  /* 코너 */
			                 WHERE A.STR_CD    = B.STR_CD
			                   AND A.PUMBUN_CD = B.PUMBUN_CD
			                   AND SUBSTR(A.ORG_CD, 1, 8)    = DECODE(?, '1', SUBSTR(B.SALE_ORG_CD, 1, 8), SUBSTR(B.BUY_ORG_CD, 1, 8))
			                   AND SUBSTR(A.ORG_CD, 1, 6) || '0000' = C.ORG_CD 
			                   AND SUBSTR(A.ORG_CD, 1, 8) || '00'   = D.ORG_CD
			                   AND A.ORG_CD    = E.ORG_CD
			               )   A
			        GROUP BY A.STR_CD
			               , A.TEAM_CD
			               , A.PART_CD
			               , A.PART_NM
			               , A.ORDER_FLAG
			       ) A
			 ORDER BY A.ORDER_FLAG
			        , A.STR_CD
			        , A.TEAM_CD
			        , A.PART_CD
        ]]>        
    </query>

        <!-- PC/코너/브랜드별 헤더 -->
     <gauce name="H_SEL_DETAIL">
    	<column colName="STOR_NAME"            colType="TB_STRING"   size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PART_NAME"            colType="TB_STRING"   size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PC_NAME"              colType="TB_STRING"   size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PUMBUN_CD"            colType="TB_STRING"   size="8"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PUMBUN_NAME"          colType="TB_STRING"   size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="GUBUN"                colType="TB_STRING"   size="6"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="TOT_AMT"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY01"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY02"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY03"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY04"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY05"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY06"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY07"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY08"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY09"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY10"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY11"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY12"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY13"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY14"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY15"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY16"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY17"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY18"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY19"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY20"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY21"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY22"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY23"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY24"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY25"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY26"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY27"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY28"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY29"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY30"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DAY31"  			   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="WEEKDAYS_AMT"  	   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="WEEKENDS_AMT"  	   colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>   
    
    <gauce name="H_SEL_DETAIL_OLD"> 
		<column colName="STR_CD"               colType="TB_STRING"   size="2"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="GRP_CD"               colType="TB_STRING"   size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="GRP_NM"               colType="TB_STRING"   size="50"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_ORIGIN_SALE_TAMT"  colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_TOT_SALE_AMT"      colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_ACHIEVE_RATE"      colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_REDU_AMT"          colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_NORM_SALE_AMT"     colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_DC_AMT"            colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_NET_SALE_AMT"      colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_SALE_PROF_AMT"     colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_PROF_RATE"         colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_CUST_CNT"          colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_CUST_DANGA"        colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_SALE_QTY"          colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="BF_VAT_AMT"           colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="ORIGIN_SALE_TAMT"     colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="TOT_SALE_AMT"         colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="ACHIEVE_RATE"         colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="REDU_AMT"             colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="NORM_SALE_AMT"        colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="DC_AMT"               colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="NET_SALE_AMT"         colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="SALE_PROF_AMT"        colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PROF_RATE"            colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="CUST_CNT"             colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="CUST_DANGA"           colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="SALE_QTY"             colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="VAT_AMT"              colType="TB_DECIMAL"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="SALE_ACHV_RATE"       colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="PROF_ACHV_RATE"       colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="CUST_CNT_ACHV_RATE"   colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
		<column colName="CUST_DANGA_ACHV_RATE" colType="TB_DECIMAL"  size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
     
    
    
    
    <!-- PC별 -->
    <query name="SEL_DETAIL_NEW">        
        <![CDATA[
			WITH SALE_DATA AS
			(
						-- 매출 데이터
						SELECT A.STR_CD
						     , A.SALE_DT
						     , SUBSTR(B.SALE_ORG_CD,1,2)||'00000000' STOR_CD
						     , SUBSTR(B.SALE_ORG_CD,1,6)||'0000' PART_CD
						     , SUBSTR(B.SALE_ORG_CD,1,8)||'00' PC_CD
						     , A.PUMBUN_CD
						     , B.PUMBUN_NAME
						     , A.NORM_SALE_AMT
						     , SUM(A.NORM_SALE_AMT) OVER (PARTITION BY A.STR_CD,A.SALE_DT,SUBSTR(B.SALE_ORG_CD,1,6)||'0000' , SUBSTR(B.SALE_ORG_CD,1,8)||'00'  ) OVERSUM
						     , A.NORM_SALE_AMT/1.1 PURE_AMT
						     , A.SALE_PROF_AMT/1.1 PROF_AMT
						     , 0 PRO_NORM_SALE_AMT
						     , 0 PRO_OVERSUM
						     , 0 PRO_PURE_AMT
						     , 0 PRO_PROF_AMT
						     , 0 BF_NORM_SALE_AMT
						     , 0 BF_OVERSUM
						     , 0 BF_PURE_AMT
						     , 0 BF_PROF_AMT
						 FROM DPS.PS_DAYPBN A
						    , DPS.PC_STRPBN B
						WHERE 1=1
						AND A.STR_CD = B.STR_CD
						AND A.PUMBUN_CD = B.PUMBUN_CD
						AND A.STR_CD= ?
						AND B.SALE_ORG_CD LIKE ?||'%'
						AND A.SALE_DT BETWEEN ? AND ?
						AND A.PUMBUN_CD LIKE ?||'%'
						UNION ALL
						-- 목표 데이터
						SELECT A.STR_CD
						     , A.EXE_DT
						     , SUBSTR(B.SALE_ORG_CD,1,2)||'00000000' STOR_CD
						     , SUBSTR(B.SALE_ORG_CD,1,6)||'0000' PART_CD
						     , SUBSTR(B.SALE_ORG_CD,1,8)||'00' PC_CD
						     , A.PUMBUN_CD
						     , B.PUMBUN_NAME
						     , 0 NORM_SALE_AMT
						     , 0 OVERSUM
						     , 0 PURE_AMT
						     , 0 PROF_AMT
						     , A.ORIGIN_SALE_TAMT PRO_NORM_SALE_AMT
						     , SUM(A.ORIGIN_SALE_TAMT) OVER (PARTITION BY A.STR_CD,A.EXE_DT,SUBSTR(B.SALE_ORG_CD,1,6)||'0000' , SUBSTR(B.SALE_ORG_CD,1,8)||'00'  ) PRO_OVERSUM
						     , A.ORIGIN_SALE_TAMT/1.1 PRO_PURE_AMT
						     , A.ORIGIN_PROF_TAMT/1.1 PRO_PROF_AMT
						     , 0 BF_NORM_SALE_AMT
						     , 0 BF_OVERSUM
						     , 0 BF_PURE_AMT
						     , 0 BF_PROF_AMT
						 FROM DPS.PS_ACTPUMBUN A
						    , DPS.PC_STRPBN B
						WHERE 1=1
						AND A.STR_CD = B.STR_CD
						AND A.PUMBUN_CD = B.PUMBUN_CD
						AND A.STR_CD=?
						AND B.SALE_ORG_CD LIKE ?||'%'
						AND A.EXE_DT BETWEEN ? AND ?
						AND A.PUMBUN_CD LIKE ?||'%'
						UNION ALL
						-- 대비 데이터
						SELECT A.STR_CD
						     , A.SALE_DT
						     , SUBSTR(B.SALE_ORG_CD,1,2)||'00000000' STOR_CD
						     , SUBSTR(B.SALE_ORG_CD,1,6)||'0000' PART_CD
						     , SUBSTR(B.SALE_ORG_CD,1,8)||'00' PC_CD
						     , A.PUMBUN_CD
						     , B.PUMBUN_NAME
						     , 0 NORM_SALE_AMT
						     , 0 OVERSUM
						     , 0 PURE_AMT
						     , 0 PROF_AMT
						     , 0 BF_NORM_SALE_AMT
						     , 0 BF_OVERSUM
						     , 0 BF_PURE_AMT
						     , 0 BF_PROF_AMT
						     , A.NORM_SALE_AMT BF_NORM_SALE_AMT
						     , SUM(A.NORM_SALE_AMT) OVER (PARTITION BY A.STR_CD,A.SALE_DT,SUBSTR(B.SALE_ORG_CD,1,6)||'0000' , SUBSTR(B.SALE_ORG_CD,1,8)||'00'  ) BF_OVERSUM
						     , A.NORM_SALE_AMT/1.1 BF_PURE_AMT
						     , A.SALE_PROF_AMT/1.1 BF_PROF_AMT
						 FROM DPS.PS_DAYPBN A
						    , DPS.PC_STRPBN B
						WHERE 1=1
						AND A.STR_CD = B.STR_CD
						AND A.PUMBUN_CD = B.PUMBUN_CD
						AND A.STR_CD= ?
						AND B.SALE_ORG_CD LIKE ?||'%'
						AND A.SALE_DT BETWEEN ? AND ?
						AND A.PUMBUN_CD LIKE ?||'%'
			)
			-- 본 쿼리
			SELECT MIN(STOR_NAME) STOR_NAME
			     , MIN(PART_NAME) PART_NAME
			     , MIN(PC_NAME) PC_NAME
			     , PUMBUN_CD
			     , MIN(PUMBUN_NAME) PUMBUN_NAME
			     , DECODE(ORD_GU,'0','매출','1','목표','대비') GUBUN
			     , SUM(TOT_AMT)/? TOT_AMT			     
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'01' ,TOT_AMT) ,0) )/? DAY01
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'02' ,TOT_AMT) ,0) )/? DAY02
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'03' ,TOT_AMT) ,0) )/? DAY03
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'04' ,TOT_AMT) ,0) )/? DAY04
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'05' ,TOT_AMT) ,0) )/? DAY05
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'06' ,TOT_AMT) ,0) )/? DAY06
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'07' ,TOT_AMT) ,0) )/? DAY07
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'08' ,TOT_AMT) ,0) )/? DAY08
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'09' ,TOT_AMT) ,0) )/? DAY09
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'10' ,TOT_AMT) ,0) )/? DAY10
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'11' ,TOT_AMT) ,0) )/? DAY11
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'12' ,TOT_AMT) ,0) )/? DAY12
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'13' ,TOT_AMT) ,0) )/? DAY13
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'14' ,TOT_AMT) ,0) )/? DAY14
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'15' ,TOT_AMT) ,0) )/? DAY15
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'16' ,TOT_AMT) ,0) )/? DAY16
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'17' ,TOT_AMT) ,0) )/? DAY17
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'18' ,TOT_AMT) ,0) )/? DAY18
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'19' ,TOT_AMT) ,0) )/? DAY19
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'20' ,TOT_AMT) ,0) )/? DAY20
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'21' ,TOT_AMT) ,0) )/? DAY21
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'22' ,TOT_AMT) ,0) )/? DAY22
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'23' ,TOT_AMT) ,0) )/? DAY23
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'24' ,TOT_AMT) ,0) )/? DAY24
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'25' ,TOT_AMT) ,0) )/? DAY25
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'26' ,TOT_AMT) ,0) )/? DAY26
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'27' ,TOT_AMT) ,0) )/? DAY27
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'28' ,TOT_AMT) ,0) )/? DAY28
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'29' ,TOT_AMT) ,0) )/? DAY29
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'30' ,TOT_AMT) ,0) )/? DAY30
			     , SUM(NVL(DECODE(SUBSTR(SALE_DT ,7 ,2) ,'31' ,TOT_AMT) ,0) )/? DAY31
			     , SUM(NVL(CASE WHEN TO_CHAR(TO_DATE(SALE_DT),'D') IN ('2','3','4','5','6') THEN TOT_AMT ELSE 0 END,0))/? WEEKDAYS_AMT
			     , SUM(NVL(CASE WHEN TO_CHAR(TO_DATE(SALE_DT),'D') IN ('1','7') THEN TOT_AMT ELSE 0 END,0))/? WEEKENDS_AMT
			     
			FROM
			    (
						    -- 매출
						    SELECT A.STR_CD
						         , A.SALE_DT
						         , A.STOR_CD
						         , A.PART_CD
						         , '0' ORD_GU
						         , MIN(B.ORG_NAME) PART_NAME
						         , A.PC_CD
						         , MIN(C.ORG_NAME) PC_NAME
						         , MIN(D.ORG_NAME) STOR_NAME
						         , A.PUMBUN_CD
						         , MIN(A.PUMBUN_NAME) PUMBUN_NAME
						         , SUM(NORM_SALE_AMT) TOT_AMT
						         , MIN(OVERSUM) OVERSUM
						    FROM 
						      SALE_DATA A
						    , DPS.PC_ORGMST B
						    , DPS.PC_ORGMST C
						    , DPS.PC_ORGMST D
						    WHERE 1=1
						      AND A.STR_CD = B.STR_CD
						      AND A.STR_CD = C.STR_CD
						      AND A.PART_CD = B.ORG_CD
						      AND A.PC_CD  = C.ORG_CD
						      AND A.STOR_CD = D.ORG_CD
						     GROUP BY A.STR_CD
						            , A.SALE_DT
						            , A.STOR_CD
						            , A.PART_CD
						            , A.PC_CD
						            , A.PUMBUN_CD
						    UNION ALL
						    -- 목표
						    SELECT A.STR_CD
						         , A.SALE_DT
						         , A.STOR_CD
						         , A.PART_CD
						         , '1' ORD_GU
						         , MIN(B.ORG_NAME) PART_NAME
						         , A.PC_CD
						         , MIN(C.ORG_NAME) PC_NAME
						         , MIN(D.ORG_NAME) STOR_NAME
						         , A.PUMBUN_CD
						         , MIN(A.PUMBUN_NAME) PUMBUN_NAME
						         , SUM(PRO_NORM_SALE_AMT) TOT_AMT
						         , MIN(PRO_OVERSUM) OVERSUM
						    FROM 
						      SALE_DATA A
						    , DPS.PC_ORGMST B
						    , DPS.PC_ORGMST C
						    , DPS.PC_ORGMST D
						    WHERE 1=1
						      AND A.STR_CD = B.STR_CD
						      AND A.STR_CD = C.STR_CD
						      AND A.PART_CD = B.ORG_CD
						      AND A.PC_CD  = C.ORG_CD
						      AND A.STOR_CD = D.ORG_CD
						     GROUP BY A.STR_CD
						            , A.SALE_DT
						            , A.STOR_CD
						            , A.PART_CD
						            , A.PC_CD
						            , A.PUMBUN_CD
						    UNION ALL
						    -- 대비
						    SELECT A.STR_CD
						         , A.SALE_DT
						         , A.STOR_CD
						         , A.PART_CD
						         , '2' ORD_GU
						         , MIN(B.ORG_NAME) PART_NAME
						         , A.PC_CD
						         , MIN(C.ORG_NAME) PC_NAME
						         , MIN(D.ORG_NAME) STOR_NAME
						         , A.PUMBUN_CD
						         , MIN(A.PUMBUN_NAME) PUMBUN_NAME
						         , SUM(BF_NORM_SALE_AMT) TOT_AMT
						         , MIN(BF_OVERSUM) OVERSUM
						    FROM 
						      SALE_DATA A
						    , DPS.PC_ORGMST B
						    , DPS.PC_ORGMST C
						    , DPS.PC_ORGMST D
						    WHERE 1=1
						      AND A.STR_CD = B.STR_CD
						      AND A.STR_CD = C.STR_CD
						      AND A.PART_CD = B.ORG_CD
						      AND A.PC_CD  = C.ORG_CD
						      AND A.STOR_CD = D.ORG_CD
						     GROUP BY A.STR_CD
						            , A.SALE_DT
						            , A.STOR_CD
						            , A.PART_CD
						            , A.PC_CD  
						            , A.PUMBUN_CD
			)
			 GROUP BY STR_CD
			        , PART_CD
			        , PC_CD
			        , PUMBUN_CD
			        , ORD_GU
			 ORDER BY STR_CD
			        , PART_CD
			        , PC_CD
			        , PUMBUN_CD
			        , ORD_GU
        ]]>        
    </query> 
    
    
    <!-- PC별 -->
    <query name="SEL_DETAIL1">        
        <![CDATA[
        	--디테일
			SELECT A.STR_CD
			     , A.GRP_CD                                           /* (파트, PC, 브랜드)코드 */
			     , A.GRP_NM                                           /* (파트, PC, 브랜드)명   */
			     , A.BF_ORIGIN_SALE_TAMT / ?  AS BF_ORIGIN_SALE_TAMT  /* (대비)목표매출     */
			     , A.BF_TOT_SALE_AMT     / ?  AS BF_TOT_SALE_AMT      /* (대비)총매출금액   */
			     , A.BF_ACHIEVE_RATE          AS BF_ACHIEVE_RATE      /* (대비)달성율       */
			     , A.BF_REDU_AMT         / ?  AS BF_REDU_AMT          /* (대비)할인금액     */
			     , A.BF_NORM_SALE_AMT    / ?  AS BF_NORM_SALE_AMT     /* (대비)정상매출금액 */
			     , A.BF_DC_AMT           / ?  AS BF_DC_AMT            /* (대비)에누리금액   */
			     , A.BF_NET_SALE_AMT     / ?  AS BF_NET_SALE_AMT      /* (대비)순매출금액   */
			     , A.BF_SALE_PROF_AMT    / ?  AS BF_SALE_PROF_AMT     /* (대비)매출이익액   */
			     , A.BF_PROF_RATE             AS BF_PROF_RATE         /* (대비)매출이익율   */
			     , A.BF_CUST_CNT              AS BF_CUST_CNT          /* (대비)객수         */
			     , A.BF_CUST_DANGA       / ?  AS BF_CUST_DANGA        /* (대비)객단가       */
			     , A.BF_SALE_QTY              AS BF_SALE_QTY          /* (대비)판매수량     */
			     , A.BF_VAT_AMT          / ?  AS BF_VAT_AMT           /* (대비)부가세       */
			     , A.ORIGIN_SALE_TAMT    / ?  AS ORIGIN_SALE_TAMT     /* (실적)목표매출     */
			     , A.TOT_SALE_AMT        / ?  AS TOT_SALE_AMT         /* (실적)총매출금액   */
			     , A.ACHIEVE_RATE             AS ACHIEVE_RATE         /* (실적)달성율       */
			     , A.REDU_AMT            / ?  AS REDU_AMT             /* (실적)할인금액     */
			     , A.NORM_SALE_AMT       / ?  AS NORM_SALE_AMT        /* (실적)정상매출금액 */
			     , A.DC_AMT              / ?  AS DC_AMT               /* (실적)에누리금액   */
			     , A.NET_SALE_AMT        / ?  AS NET_SALE_AMT         /* (실적)순매출금액   */
			     , A.SALE_PROF_AMT       / ?  AS SALE_PROF_AMT        /* (실적)매출이익액   */
			     , A.PROF_RATE                AS PROF_RATE            /* (실적)매출이익율   */
			     , A.CUST_CNT                 AS CUST_CNT             /* (실적)객수         */
			     , A.CUST_DANGA          / ?  AS CUST_DANGA           /* (실적)객단가       */
			     , A.SALE_QTY            / ?  AS SALE_QTY             /* (실적)판매수량     */
			     , A.VAT_AMT             / ?  AS VAT_AMT              /* (실적)부가세       */
			     , DECODE( A.BF_TOT_SALE_AMT, 0, 0
			             , (A.TOT_SALE_AMT  - A.BF_TOT_SALE_AMT)  / A.BF_TOT_SALE_AMT  * 100
			             ) AS SALE_ACHV_RATE              /* 매출액 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_SALE_PROF_AMT, 0, 0
			             , (A.SALE_PROF_AMT - A.BF_SALE_PROF_AMT) / A.BF_SALE_PROF_AMT * 100
			             ) AS PROF_ACHV_RATE              /* 이익액 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_CUST_CNT, 0, 0
			             , (A.CUST_CNT - A.BF_CUST_CNT) / A.BF_CUST_CNT * 100
			             ) AS CUST_CNT_ACHV_RATE          /* 고객수 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_CUST_DANGA, 0, 0
			             , (A.CUST_DANGA - A.BF_CUST_DANGA) / A.BF_CUST_DANGA * 100
			             ) AS CUST_DANGA_ACHV_RATE        /* 객단가 신장률 (실적 - 대비 / 대비 * 100) */
			  FROM ( 
			        --점별 PC별
			        SELECT A.STR_CD
			             , A.TEAM_CD                                                /* 팀코드           */
			             , A.PART_CD
			             , A.PC_CD                  AS GRP_CD                       /* 코너코드         */
			             , A.PC_NM                  AS GRP_NM                       /* 코너명           */
        ]]>        
    </query>       
    
    <!-- PC별 -->
    <query name="SEL_GRP_ORD1">        
        <![CDATA[
			        GROUP BY A.STR_CD
			               , A.TEAM_CD   
			               , A.PART_CD  
			               , A.PC_CD
			               , A.PC_NM
			       ) A
			 ORDER BY A.STR_CD
			        , A.TEAM_CD
			        , A.PART_CD
			        , A.GRP_CD
        ]]>        
    </query>  
		         
    
    <!-- 코너별 -->
    <query name="SEL_DETAIL2">        
        <![CDATA[
        	--디테일
			SELECT A.STR_CD
			     , A.GRP_CD                                           /* (파트, PC, 브랜드)코드 */
			     , A.GRP_NM                                           /* (파트, PC, 브랜드)명   */
			     , A.BF_ORIGIN_SALE_TAMT / ?  AS BF_ORIGIN_SALE_TAMT  /* (대비)목표매출     */
			     , A.BF_TOT_SALE_AMT     / ?  AS BF_TOT_SALE_AMT      /* (대비)총매출금액   */
			     , A.BF_ACHIEVE_RATE          AS BF_ACHIEVE_RATE      /* (대비)달성율       */
			     , A.BF_REDU_AMT         / ?  AS BF_REDU_AMT          /* (대비)할인금액     */
			     , A.BF_NORM_SALE_AMT    / ?  AS BF_NORM_SALE_AMT     /* (대비)정상매출금액 */
			     , A.BF_DC_AMT           / ?  AS BF_DC_AMT            /* (대비)에누리금액   */
			     , A.BF_NET_SALE_AMT     / ?  AS BF_NET_SALE_AMT      /* (대비)순매출금액   */
			     , A.BF_SALE_PROF_AMT    / ?  AS BF_SALE_PROF_AMT     /* (대비)매출이익액   */
			     , A.BF_PROF_RATE             AS BF_PROF_RATE         /* (대비)매출이익율   */
			     , A.BF_CUST_CNT              AS BF_CUST_CNT          /* (대비)객수         */
			     , A.BF_CUST_DANGA       / ?  AS BF_CUST_DANGA        /* (대비)객단가       */
			     , A.BF_SALE_QTY              AS BF_SALE_QTY          /* (대비)판매수량     */
			     , A.BF_VAT_AMT          / ?  AS BF_VAT_AMT           /* (대비)부가세       */
			     , A.ORIGIN_SALE_TAMT    / ?  AS ORIGIN_SALE_TAMT     /* (실적)목표매출     */
			     , A.TOT_SALE_AMT        / ?  AS TOT_SALE_AMT         /* (실적)총매출금액   */
			     , A.ACHIEVE_RATE             AS ACHIEVE_RATE         /* (실적)달성율       */
			     , A.REDU_AMT            / ?  AS REDU_AMT             /* (실적)할인금액     */
			     , A.NORM_SALE_AMT       / ?  AS NORM_SALE_AMT        /* (실적)정상매출금액 */
			     , A.DC_AMT              / ?  AS DC_AMT               /* (실적)에누리금액   */
			     , A.NET_SALE_AMT        / ?  AS NET_SALE_AMT         /* (실적)순매출금액   */
			     , A.SALE_PROF_AMT       / ?  AS SALE_PROF_AMT        /* (실적)매출이익액   */
			     , A.PROF_RATE                AS PROF_RATE            /* (실적)매출이익율   */
			     , A.CUST_CNT                 AS CUST_CNT             /* (실적)객수         */
			     , A.CUST_DANGA          / ?  AS CUST_DANGA           /* (실적)객단가       */
			     , A.SALE_QTY            / ?  AS SALE_QTY             /* (실적)판매수량     */
			     , A.VAT_AMT             / ?  AS VAT_AMT              /* (실적)부가세       */
			     , DECODE( A.BF_TOT_SALE_AMT, 0, 0
			             , (A.TOT_SALE_AMT  - A.BF_TOT_SALE_AMT)  / A.BF_TOT_SALE_AMT  * 100
			             ) AS SALE_ACHV_RATE              /* 매출액 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_SALE_PROF_AMT, 0, 0
			             , (A.SALE_PROF_AMT - A.BF_SALE_PROF_AMT) / A.BF_SALE_PROF_AMT * 100
			             ) AS PROF_ACHV_RATE              /* 이익액 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_CUST_CNT, 0, 0
			             , (A.CUST_CNT - A.BF_CUST_CNT) / A.BF_CUST_CNT * 100
			             ) AS CUST_CNT_ACHV_RATE          /* 고객수 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_CUST_DANGA, 0, 0
			             , (A.CUST_DANGA - A.BF_CUST_DANGA) / A.BF_CUST_DANGA * 100
			             ) AS CUST_DANGA_ACHV_RATE        /* 객단가 신장률 (실적 - 대비 / 대비 * 100) */
			  FROM ( 
			        --점별 코너별
			        SELECT A.STR_CD
			             , A.TEAM_CD                                                /* 팀코드           */
			             , A.PC_CD
			             , A.CORNER_CD                  AS GRP_CD                   /* 코너코드         */
			             , A.CORNER_NM                  AS GRP_NM                   /* 코너명           */
        ]]>        
    </query>       
    
    <!-- 코너별 -->
    <query name="SEL_GRP_ORD2">        
        <![CDATA[
			        GROUP BY A.STR_CD
			               , A.TEAM_CD
                           , A.PC_CD
			               , A.CORNER_CD
			               , A.CORNER_NM
			       ) A
			 ORDER BY A.STR_CD
			        , A.TEAM_CD
			        , A.PC_CD
			        , A.GRP_CD
        ]]>        
    </query>    
    
    <!-- 브랜드별 -->
    <query name="SEL_DETAIL3">        
        <![CDATA[
        	--디테일
			SELECT A.STR_CD
			     , A.GRP_CD                                           /* (파트, PC, 브랜드)코드 */
			     , A.GRP_NM                                           /* (파트, PC, 브랜드)명   */
			     , A.BF_ORIGIN_SALE_TAMT / ?  AS BF_ORIGIN_SALE_TAMT  /* (대비)목표매출     */
			     , A.BF_TOT_SALE_AMT     / ?  AS BF_TOT_SALE_AMT      /* (대비)총매출금액   */
			     , A.BF_ACHIEVE_RATE          AS BF_ACHIEVE_RATE      /* (대비)달성율       */
			     , A.BF_REDU_AMT         / ?  AS BF_REDU_AMT          /* (대비)할인금액     */
			     , A.BF_NORM_SALE_AMT    / ?  AS BF_NORM_SALE_AMT     /* (대비)정상매출금액 */
			     , A.BF_DC_AMT           / ?  AS BF_DC_AMT            /* (대비)에누리금액   */
			     , A.BF_NET_SALE_AMT     / ?  AS BF_NET_SALE_AMT      /* (대비)순매출금액   */
			     , A.BF_SALE_PROF_AMT    / ?  AS BF_SALE_PROF_AMT     /* (대비)매출이익액   */
			     , A.BF_PROF_RATE             AS BF_PROF_RATE         /* (대비)매출이익율   */
			     , A.BF_CUST_CNT              AS BF_CUST_CNT          /* (대비)객수         */
			     , A.BF_CUST_DANGA       / ?  AS BF_CUST_DANGA        /* (대비)객단가       */
			     , A.BF_SALE_QTY              AS BF_SALE_QTY          /* (대비)판매수량     */
			     , A.BF_VAT_AMT          / ?  AS BF_VAT_AMT           /* (대비)부가세       */
			     , A.ORIGIN_SALE_TAMT    / ?  AS ORIGIN_SALE_TAMT     /* (실적)목표매출     */
			     , A.TOT_SALE_AMT        / ?  AS TOT_SALE_AMT         /* (실적)총매출금액   */
			     , A.ACHIEVE_RATE             AS ACHIEVE_RATE         /* (실적)달성율       */
			     , A.REDU_AMT            / ?  AS REDU_AMT             /* (실적)할인금액     */
			     , A.NORM_SALE_AMT       / ?  AS NORM_SALE_AMT        /* (실적)정상매출금액 */
			     , A.DC_AMT              / ?  AS DC_AMT               /* (실적)에누리금액   */
			     , A.NET_SALE_AMT        / ?  AS NET_SALE_AMT         /* (실적)순매출금액   */
			     , A.SALE_PROF_AMT       / ?  AS SALE_PROF_AMT        /* (실적)매출이익액   */
			     , A.PROF_RATE                AS PROF_RATE            /* (실적)매출이익율   */
			     , A.CUST_CNT                 AS CUST_CNT             /* (실적)객수         */
			     , A.CUST_DANGA          / ?  AS CUST_DANGA           /* (실적)객단가       */
			     , A.SALE_QTY            / ?  AS SALE_QTY             /* (실적)판매수량     */
			     , A.VAT_AMT             / ?  AS VAT_AMT              /* (실적)부가세       */
			     , DECODE( A.BF_TOT_SALE_AMT, 0, 0
			             , (A.TOT_SALE_AMT  - A.BF_TOT_SALE_AMT)  / A.BF_TOT_SALE_AMT  * 100
			             ) AS SALE_ACHV_RATE              /* 매출액 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_SALE_PROF_AMT, 0, 0
			             , (A.SALE_PROF_AMT - A.BF_SALE_PROF_AMT) / A.BF_SALE_PROF_AMT * 100
			             ) AS PROF_ACHV_RATE              /* 이익액 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_CUST_CNT, 0, 0
			             , (A.CUST_CNT - A.BF_CUST_CNT) / A.BF_CUST_CNT * 100
			             ) AS CUST_CNT_ACHV_RATE          /* 고객수 신장률 (실적 - 대비 / 대비 * 100) */
			     , DECODE( A.BF_CUST_DANGA, 0, 0
			             , (A.CUST_DANGA - A.BF_CUST_DANGA) / A.BF_CUST_DANGA * 100
			             ) AS CUST_DANGA_ACHV_RATE        /* 객단가 신장률 (실적 - 대비 / 대비 * 100) */
			  FROM ( 
			        --점별 브랜드별
			        SELECT A.STR_CD
			             , A.TEAM_CD                                                /* 팀코드             */
			             , A.PUMBUN_CD                  AS GRP_CD                   /* 브랜드코드         */
			             , A.PUMBUN_NAME                AS GRP_NM                   /* 브랜드명           */
        ]]>        
    </query>       
    
    <!-- 브랜드별 -->
    <query name="SEL_GRP_ORD3">        
        <![CDATA[
			        GROUP BY A.STR_CD
			               , A.TEAM_CD    
			               , A.PUMBUN_CD      
			               , A.PUMBUN_NAME
			       ) A
			 ORDER BY A.STR_CD
			        , A.NORM_SALE_AMT DESC
        ]]>        
    </query>
    
    <!-- PC/코너/브랜드별 -->
    <query name="SEL_BODY">        
        <![CDATA[
			             , SUM(A.BF_ORIGIN_SALE_TAMT)   AS BF_ORIGIN_SALE_TAMT      /* (대비)목표매출     */
			             , SUM(A.BF_TOT_SALE_AMT)       AS BF_TOT_SALE_AMT          /* (대비)총매출금액   */
			             , DECODE(SUM(A.BF_ORIGIN_SALE_TAMT), 0, 0
			                    , ROUND(SUM(A.BF_TOT_SALE_AMT) 
			                          / SUM(A.BF_ORIGIN_SALE_TAMT)
			                          * 100, 2))        AS BF_ACHIEVE_RATE          /* (대비)달성율       */
			             , SUM(A.BF_REDU_AMT)           AS BF_REDU_AMT              /* (대비)할인금액     */
			             , SUM(A.BF_NORM_SALE_AMT)      AS BF_NORM_SALE_AMT         /* (대비)정상매출금액 */
			             , SUM(A.BF_DC_AMT)             AS BF_DC_AMT                /* (대비)에누리금액   */
			             , SUM(A.BF_NET_SALE_AMT)       AS BF_NET_SALE_AMT          /* (대비)순매출금액   */
			             , SUM(A.BF_SALE_PROF_AMT)      AS BF_SALE_PROF_AMT         /* (대비)매출이익액   */
			             , DECODE(SUM(A.BF_NORM_SALE_AMT_VAT), 0, 0
			                    , ROUND(SUM(A.BF_SALE_PROF_AMT) 
			                          / ROUND(SUM(A.BF_NORM_SALE_AMT_VAT), 0)
			                          * 100, 2))        AS BF_PROF_RATE             /* (대비)매출이익율   */
			             , SUM(A.BF_CUST_CNT)           AS BF_CUST_CNT              /* (대비)객수         */
			             , DECODE(SUM(A.BF_CUST_CNT), 0, 0
			                    , ROUND(SUM(A.BF_TOT_SALE_AMT) 
			                          / SUM(A.BF_CUST_CNT)
			                          , 2))             AS BF_CUST_DANGA            /* (대비)객단가       */
			             , SUM(A.BF_SALE_QTY)           AS BF_SALE_QTY              /* (대비)판매수량     */
			             , SUM(A.BF_VAT_AMT)            AS BF_VAT_AMT               /* (대비)부가세       */
			             , SUM(A.ORIGIN_SALE_TAMT)      AS ORIGIN_SALE_TAMT         /* (실적)목표매출     */
			             , SUM(A.TOT_SALE_AMT)          AS TOT_SALE_AMT             /* (실적)총매출금액   */
			             , DECODE(SUM(A.ORIGIN_SALE_TAMT), 0, 0
			                    , ROUND(SUM(A.TOT_SALE_AMT) 
			                          / SUM(A.ORIGIN_SALE_TAMT)
			                          * 100, 2))        AS ACHIEVE_RATE             /* (실적)달성율       */
			             , SUM(A.REDU_AMT)              AS REDU_AMT                 /* (실적)할인금액     */
			             , SUM(A.NORM_SALE_AMT)         AS NORM_SALE_AMT            /* (실적)정상매출금액 */
			             , SUM(A.DC_AMT)                AS DC_AMT                   /* (실적)에누리금액   */
			             , SUM(A.NET_SALE_AMT)          AS NET_SALE_AMT             /* (실적)순매출금액   */
			             , SUM(A.SALE_PROF_AMT)         AS SALE_PROF_AMT            /* (실적)매출이익액   */
			             , DECODE(SUM(A.NORM_SALE_AMT_VAT), 0, 0
			                    , ROUND(SUM(A.SALE_PROF_AMT) 
			                          / ROUND(SUM(A.NORM_SALE_AMT_VAT), 0)
			                          * 100, 2))        AS PROF_RATE                /* (실적)매출이익율   */
			             , SUM(A.CUST_CNT)              AS CUST_CNT                 /* (실적)객수         */
			             , DECODE(SUM(A.CUST_CNT), 0, 0
			                    , ROUND(SUM(A.TOT_SALE_AMT) 
			                          / SUM(A.CUST_CNT)
			                          , 2))             AS CUST_DANGA               /* (실적)객단가       */
			             , SUM(A.SALE_QTY)              AS SALE_QTY                 /* (실적)판매수량     */
			             , SUM(A.VAT_AMT)               AS VAT_AMT                  /* (실적)부가세       */
			          FROM (
			                SELECT A.STR_CD
			                     , A.ORG_CD                             /* 조직코드     */
			                     , SUBSTR(A.ORG_CD, 3, 2) AS TEAM_CD    /* 팀코드       */
			                     , SUBSTR(A.ORG_CD, 5, 2) AS PART_CD    /* 파트코드     */
			                     , C.ORG_NAME             AS PART_NM    /* 파트명       */
			                     , SUBSTR(A.ORG_CD, 7, 2) AS PC_CD      /* PC코드       */
			                     , D.ORG_NAME             AS PC_NM      /* PC명         */
			                     , SUBSTR(A.ORG_CD, 9, 2) AS CORNER_CD  /* 코너코드     */
			                     , E.ORG_NAME             AS CORNER_NM  /* 코너명       */
			                     , A.PUMBUN_CD                          /* 브랜드 코드  */
			                     , B.PUMBUN_NAME                        /* 브랜드 명    */
			                     , A.BF_ORIGIN_SALE_TAMT                /* (대비)목표매출     */
			                     , A.BF_TOT_SALE_AMT                    /* (대비)총매출금액   */
			                     , A.BF_REDU_AMT                        /* (대비)할인금액     */
			                     , A.BF_NORM_SALE_AMT                   /* (대비)정상매출금액 */
			                     , A.BF_DC_AMT                          /* (대비)에누리금액   */
			                     , A.BF_NET_SALE_AMT                    /* (대비)순매출금액   */
			                     , A.BF_SALE_PROF_AMT                   /* (대비)매출이익액   */
			                     , A.BF_CUST_CNT                        /* (대비)객수         */
			                     , A.BF_SALE_QTY                        /* (대비)판매수량     */
			                     , A.BF_VAT_AMT                         /* (대비)부가세       */
			                     , A.BF_NORM_SALE_AMT_VAT               /* (대비)부가세 계산  */
			                     , A.ORIGIN_SALE_TAMT                   /* (실적)목표매출     */
			                     , A.TOT_SALE_AMT                       /* (실적)총매출금액   */
			                     , A.REDU_AMT                           /* (실적)할인금액     */
			                     , A.NORM_SALE_AMT                      /* (실적)정상매출금액 */
			                     , A.DC_AMT                             /* (실적)에누리금액   */
			                     , A.NET_SALE_AMT                       /* (실적)순매출금액   */
			                     , A.SALE_PROF_AMT                      /* (실적)매출이익액   */
			                     , A.CUST_CNT                           /* (실적)객수         */
			                     , A.SALE_QTY                           /* (실적)판매수량     */
			                     , A.VAT_AMT                            /* (실적)부가세       */
			                     , A.NORM_SALE_AMT_VAT                  /* (실적)부가세 계산  */
			                  FROM (
			                        -- 매출  
			                        SELECT A.STR_CD
			                             , A.SALE_DT
			                             , A.ORG_CD
			                             , A.PUMBUN_CD                         /* 브랜드 코드        */
			                             , A.BF_SALE_QTY                       /* (대비)판매수량     */
			                             , A.BF_TOT_SALE_AMT                   /* (대비)총매출금액   */
			                             , A.BF_VAT_AMT                        /* (대비)부가세       */
			                             , A.BF_REDU_AMT                       /* (대비)할인금액     */
			                             , A.BF_NORM_SALE_AMT                  /* (대비)정상매출금액 */
			                             , A.BF_DC_AMT                         /* (대비)에누리금액   */
			                             , A.BF_NET_SALE_AMT                   /* (대비)순매출금액   */
			                             , A.BF_SALE_PROF_AMT                  /* (대비)매출이익액   */
			                             , A.BF_CUST_CNT                       /* (대비)객수         */
			                             , 0    AS BF_ORIGIN_SALE_TAMT         /* (대비)목표매출금액 */
			                             , CASE WHEN A.BF_NORM_SALE_AMT = 0 THEN 0
			                                    ELSE (CASE WHEN B.TAX_FLAG = '1' THEN A.BF_NORM_SALE_AMT / 1.1
			                                                                     ELSE A.BF_NORM_SALE_AMT
			                                          END)
			                               END  AS BF_NORM_SALE_AMT_VAT
			                             , A.SALE_QTY                          /* (실적)판매수량     */
			                             , A.TOT_SALE_AMT                      /* (실적)총매출금액   */
			                             , A.VAT_AMT                           /* (실적)부가세       */
			                             , A.REDU_AMT                          /* (실적)할인금액     */
			                             , A.NORM_SALE_AMT                     /* (실적)정상매출금액 */
			                             , A.DC_AMT                            /* (실적)에누리금액   */
			                             , A.NET_SALE_AMT                      /* (실적)순매출금액   */
			                             , A.SALE_PROF_AMT                     /* (실적)매출이익액   */
			                             , A.CUST_CNT                          /* (실적)객수         */
			                             , 0    AS ORIGIN_SALE_TAMT            /* (실적)목표매출금액 */
			                             , CASE WHEN A.NORM_SALE_AMT = 0 THEN 0
			                                    ELSE (CASE WHEN B.TAX_FLAG = '1' THEN A.NORM_SALE_AMT / 1.1
			                                                                     ELSE A.NORM_SALE_AMT
			                                          END)
			                               END  AS NORM_SALE_AMT_VAT
			                          FROM (
			                                SELECT A.STR_CD
			                                     , A.SALE_DT
			                                     , B.SALE_ORG_CD AS ORG_CD
			                                     , A.PUMBUN_CD                 /* 브랜드 코드 */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.SALE_QTY      ELSE 0 END BF_SALE_QTY       /* (대비)판매수량     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.TOT_SALE_AMT  ELSE 0 END BF_TOT_SALE_AMT   /* (대비)총매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.VAT_AMT       ELSE 0 END BF_VAT_AMT        /* (대비)부가세       */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.REDU_AMT      ELSE 0 END BF_REDU_AMT       /* (대비)할인금액     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NORM_SALE_AMT ELSE 0 END BF_NORM_SALE_AMT  /* (대비)정상매출금액 */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.DC_AMT        ELSE 0 END BF_DC_AMT         /* (대비)에누리금액   */             
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NET_SALE_AMT  ELSE 0 END BF_NET_SALE_AMT   /* (대비)순매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN ROUND(A.SALE_PROF_AMT/1.1,0) ELSE 0 END BF_SALE_PROF_AMT  /* (대비)매출이익액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.CUST_CNT      ELSE 0 END BF_CUST_CNT       /* (대비)객수         */             
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.SALE_QTY      ELSE 0 END SALE_QTY          /* (실적)판매수량     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.TOT_SALE_AMT  ELSE 0 END TOT_SALE_AMT      /* (실적)총매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.VAT_AMT       ELSE 0 END VAT_AMT           /* (실적)부가세       */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.REDU_AMT      ELSE 0 END REDU_AMT          /* (실적)할인금액     */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NORM_SALE_AMT ELSE 0 END NORM_SALE_AMT     /* (실적)정상매출금액 */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.DC_AMT        ELSE 0 END DC_AMT            /* (실적)에누리금액   */             
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.NET_SALE_AMT  ELSE 0 END NET_SALE_AMT      /* (실적)순매출금액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN ROUND(A.SALE_PROF_AMT/1.1,0) ELSE 0 END SALE_PROF_AMT     /* (실적)매출이익액   */
			                                     , CASE WHEN A.SALE_DT BETWEEN ? AND ? THEN A.CUST_CNT      ELSE 0 END CUST_CNT          /* (실적)객수         */
			                                  FROM DPS.PS_DAYPBN A
                                                 , DPS.PC_STRPBN B
			                                 WHERE A.STR_CD    = ?
			                                   AND A.STR_CD    = B.STR_CD
			                                   AND A.PUMBUN_CD = B.PUMBUN_CD
			                                   AND B.SALE_ORG_CD  LIKE  ? || '%'
			                                   AND (  A.SALE_DT   BETWEEN ? AND ?     -- 대비
			                                       OR A.SALE_DT   BETWEEN ? AND ?     -- 실적
			                                       )
			                                   AND A.PUMBUN_CD LIKE ? || '%'
			                                   AND A.PUMBUN_CD IN ( 
			                                                        SELECT MYORG.PUMBUN_CD
			                                                          FROM COM.V_MYORG MYORG
			                                                         WHERE MYORG.USER_ID     = ?
			                                                           AND MYORG.ORG_FLAG    = ?
			                                                      )
			                               ) A
			                             , DPS.PC_PBNMST B
			                         WHERE A.PUMBUN_CD = B.PUMBUN_CD
			                        -- 실행계획(목표매출금액)  
			                         UNION ALL
			                        SELECT A.STR_CD
			                             , A.EXE_DT
			                             , B.SALE_ORG_CD AS ORG_CD
			                             , A.PUMBUN_CD
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0   
			                             , CASE WHEN A.EXE_DT BETWEEN ? AND ? THEN A.ORIGIN_SALE_TAMT ELSE 0 END AS BF_ORIGIN_SALE_TAMT 
			                             , 0
			                             , 0 
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , 0
			                             , CASE WHEN A.EXE_DT BETWEEN ? AND ? THEN A.ORIGIN_SALE_TAMT ELSE 0 END AS ORIGIN_SALE_TAMT
			                             , 0
			                          FROM DPS.PS_ACTPUMBUN A   -- 브랜드별 실행계획
			                             , DPS.PC_STRPBN B
			                         WHERE A.STR_CD    = B.STR_CD
			                           AND A.PUMBUN_CD = B.PUMBUN_CD
			                           AND A.STR_CD    = ?
			                           AND B.SALE_ORG_CD LIKE ? || '%'
			                           AND (  A.EXE_YM   BETWEEN SUBSTR(?, 1, 6) AND SUBSTR(?, 1, 6)  -- 대비
			                               OR A.EXE_YM   BETWEEN SUBSTR(?, 1, 6) AND SUBSTR(?, 1, 6)  -- 실적
			                               )
			                           AND (  A.EXE_DT   BETWEEN ? AND ?    -- 대비
			                               OR A.EXE_DT   BETWEEN ? AND ?    -- 실적
			                               )
			                           AND A.PUMBUN_CD LIKE ? || '%'
			                           AND A.PUMBUN_CD IN ( 
			                                                SELECT MYORG.PUMBUN_CD
			                                                  FROM COM.V_MYORG MYORG
			                                                 WHERE MYORG.USER_ID     = ?
			                                                   AND MYORG.ORG_FLAG    = ?
			                                              )
			                       ) A
			                     , DPS.PC_STRPBN B             
			                     , DPS.PC_ORGMST C  /* 파트 */
			                     , DPS.PC_ORGMST D  /* PC   */
			                     , DPS.PC_ORGMST E  /* 코너 */
			                 WHERE A.STR_CD    = B.STR_CD
			                   AND A.PUMBUN_CD = B.PUMBUN_CD
			                   AND SUBSTR(A.ORG_CD, 1, 8)    = DECODE(?, '1', SUBSTR(B.SALE_ORG_CD, 1, 8), SUBSTR(B.BUY_ORG_CD, 1, 8))
			                   AND SUBSTR(A.ORG_CD, 1, 6) || '0000' = C.ORG_CD 
			                   AND SUBSTR(A.ORG_CD, 1, 8) || '00'   = D.ORG_CD
			                   AND A.ORG_CD    = E.ORG_CD
			               )   A
        ]]>        
    </query>
		        
</service>

