<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 박종은
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2010.04.08
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/psal402.ps">

    <gauce name="H_SEL_MASTER"> 
        <column colName="STR_CD"                  colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DEPT_CD"                 colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TEAM_CD"                 colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TEAM_ORG_NAME"           colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PC_CD"                   colType="TB_STRING"      size="2"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PC_ORG_NAME"             colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORIGIN_SALE_TAMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_QTY"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_SALE_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVERATE"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REDU_AMT"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DC_AMT"                  colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NET_SALE_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_PROF_AMT"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PROFRATE"                colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_DANGA"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALEDTS"                 colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALEDTE"                 colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    	<column colName="NORM_SALE_AMT_VAT"       colType="TB_DECIMAL"     size="15"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    	<column colName="UNIT"    	              colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_DETAIL"> 
        <column colName="ORG_CD"                  colType="TB_STRING"      size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_NAME"                colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORIGIN_SALE_TAMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_QTY"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_SALE_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVERATE"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REDU_AMT"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_AMT"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DC_AMT"                  colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NET_SALE_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_PROF_AMT"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PROFRATE"                colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_DANGA"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    	<column colName="NORM_SALE_AMT_VAT"       colType="TB_DECIMAL"     size="15"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    	<column colName="UNIT"    	              colType="TB_DECIMAL"     size="10"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_CMPRDT"> 
        <column colName="CMPR_DT"                 colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    
    <!-- 쿼리는 전부 대문자 -->
    <query name="SEL_SALE_PUMBUN-01">        
        <![CDATA[
             SELECT  X.ORG_CD
                  , X.ORG_NAME
                  , SUM(X.ORIGIN_SALE_TAMT) AS ORIGIN_SALE_TAMT
                  , SUM(X.SALE_QTY)         AS SALE_QTY
                  , SUM(X.TOT_SALE_AMT)     AS TOT_SALE_AMT
                  , CASE WHEN SUM(X.ORIGIN_SALE_TAMT) = 0 THEN 0 ELSE SUM(X.TOT_SALE_AMT) / SUM(X.ORIGIN_SALE_TAMT) * 100 END AS ACHIEVERATE
                  , SUM(X.REDU_AMT)         AS REDU_AMT
                  , SUM(X.SALE_AMT)         AS SALE_AMT
                  , SUM(X.DC_AMT)           AS DC_AMT
                  , SUM(X.NET_SALE_AMT)     AS NET_SALE_AMT
                  , SUM(X.SALE_PROF_AMT)    AS SALE_PROF_AMT
                  , SUM(X.PROFRATE)         AS PROFRATE
                  , SUM(X.CUST_CNT)         AS CUST_CNT
                  , SUM(X.CUST_DANGA)       AS CUST_DANGA
                  , SUM(NORM_SALE_AMT_VAT)  AS NORM_SALE_AMT_VAT
                  , ?                       AS UNIT
              FROM (
		             SELECT A.PUMBUN_CD                                                       AS ORG_CD
		                  , F.PUMBUN_NAME                                                     AS ORG_NAME
		                  , 0                                                                 AS ORIGIN_SALE_TAMT
		                  , SUM(A.SALE_QTY)                                                   AS SALE_QTY
		                  , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
		                  , 0                                                                 AS ACHIEVERATE
		                  , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
		                  , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS SALE_AMT
		                  , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
		                  , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
		                  , SUM(NVL(ROUND(A.SALE_PROF_AMT/1.1,0),0))                                       AS SALE_PROF_AMT
		                  
		                  , (CASE WHEN SUM(NVL(A.NORM_SALE_AMT,0)) = 0 THEN 0 
		                     ELSE 
		                     (CASE WHEN G.TAX_FLAG = '1' 
		                      THEN SUM(NVL(ROUND(A.SALE_PROF_AMT/1.1,0),0))/SUM(ROUND(A.NORM_SALE_AMT/1.1,0))*100
		                      ELSE SUM(NVL(A.SALE_PROF_AMT,0))/SUM(A.NORM_SALE_AMT)*100
		                      END)
		                     END)                                                             AS PROFRATE
		                  /*
		                  , (CASE WHEN SUM(NVL(A.NORM_SALE_AMT,0)) = 0 THEN 0 
		                          ELSE SUM(NVL(ROUND(A.SALE_PROF_AMT/1.1,0),0))/SUM(A.NORM_SALE_AMT)*100
		                     END)                                                             AS PROFRATE	
		                  */	                     
		                  , SUM(A.CUST_CNT)                                                   AS CUST_CNT
		                  , ( CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 
		                      ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                 AS CUST_DANGA
		                  , (CASE WHEN SUM(A.NORM_SALE_AMT) = 0 THEN 0 
                                  ELSE (CASE WHEN G.TAX_FLAG = '1' THEN SUM(ROUND(A.NORM_SALE_AMT/1.1,0))
                                             ELSE SUM(A.NORM_SALE_AMT)
                                        END)
                             END) AS NORM_SALE_AMT_VAT
		               FROM DPS.PS_DAYPBN      A
		                  , DPS.PC_ORGMST      B
		                  , DPS.PC_STRPBN      F
		                  , DPS.PC_PBNMST      G
		              WHERE F.SALE_ORG_CD                    = B.ORG_CD
		                AND A.STR_CD                         = F.STR_CD
		                AND A.PUMBUN_CD                      = F.PUMBUN_CD
		                AND A.PUMBUN_CD                      = G.PUMBUN_CD
		                AND B.STR_CD    = ?
        ]]>        
    </query>
		                

		                
    <query name="SEL_SALE_PUMBUN-02">        
        <![CDATA[
		                AND A.SALE_DT                        >= ?
		                AND A.SALE_DT                        <= ?
		                AND A.PUMBUN_CD IN ( SELECT MYORG.PUMBUN_CD
		                               FROM COM.V_MYORG MYORG
		                              WHERE MYORG.USER_ID     = ?
		                                AND MYORG.ORG_FLAG    = ?
		                           )
		              GROUP BY
		                    A.PUMBUN_CD
		                  , F.PUMBUN_NAME
		                  , LPAD(A.ORG_CD, 8) 
		                  , G.TAX_FLAG
		              UNION ALL
		             SELECT A.PUMBUN_CD                                                       AS ORG_CD
		                  , F.PUMBUN_NAME                                                     AS ORG_NAME
		                  , SUM(A.ORIGIN_SALE_TAMT)                                           AS ORIGIN_SALE_TAMT
		                  , 0                                                                 AS SALE_QTY
		                  , 0                                                                 AS TOT_SALE_AMT
		                  , 0                                                                 AS ACHIEVERATE
		                  , 0                                                                 AS REDU_AMT
		                  , 0                                                                 AS SALE_AMT
		                  , 0                                                                 AS DC_AMT
		                  , 0                                                                 AS NET_SALE_AMT
		                  , 0                                                                 AS SALE_PROF_AMT
		                  , 0                                                                 AS PROFRATE
		                  , 0                                                                 AS CUST_CNT
		                  , 0                                                                 AS CUST_DANGA
		                  , 0                                                                 AS NORM_SALE_AMT_VAT
		               FROM DPS.PS_ACTPUMBUN   A
		                  , DPS.PC_ORGMST      B
		                  , DPS.PS_SCHEDULE    D
		                  , DPS.PC_STRPBN      F
		              WHERE F.SALE_ORG_CD                    = B.ORG_CD
		                AND A.STR_CD                         = D.STR_CD(+)
		                AND A.EXE_DT                         = D.SALE_DT(+)
		                AND A.STR_CD                         = F.STR_CD
		                AND A.PUMBUN_CD                      = F.PUMBUN_CD
		                AND B.STR_CD    = ?
        ]]>        
    </query>
		                

		                
    <query name="SEL_SALE_PUMBUN-03">        
        <![CDATA[
		                AND A.EXE_DT                         >= ?
		                AND A.EXE_DT                         <= ?
		                AND A.PUMBUN_CD IN ( SELECT MYORG.PUMBUN_CD
		                               FROM COM.V_MYORG MYORG
		                              WHERE MYORG.USER_ID     = ?
		                                AND MYORG.ORG_FLAG    = ?
		                           )
		              GROUP BY
		                    A.PUMBUN_CD
		                  , F.PUMBUN_NAME
                   ) X
              GROUP BY
                    X.ORG_CD
                  , X.ORG_NAME
            
        ]]>        
    </query>
    
    <query name="SEL_SALE_PUMBUN2-01">        
        <![CDATA[
        	SELECT  X.ORG_CD
                  , X.ORG_NAME
                  , SUM(X.ORIGIN_SALE_TAMT) AS ORIGIN_SALE_TAMT
                  , SUM(X.SALE_QTY)         AS SALE_QTY
                  , SUM(X.TOT_SALE_AMT)     AS TOT_SALE_AMT
                  , CASE WHEN SUM(X.ORIGIN_SALE_TAMT) = 0 THEN 0 ELSE SUM(X.TOT_SALE_AMT) / SUM(X.ORIGIN_SALE_TAMT) * 100 END AS ACHIEVERATE
                  , SUM(X.REDU_AMT)         AS REDU_AMT
                  , SUM(X.SALE_AMT)         AS SALE_AMT
                  , SUM(X.DC_AMT)           AS DC_AMT
                  , SUM(X.NET_SALE_AMT)     AS NET_SALE_AMT
                  , SUM(X.SALE_PROF_AMT)    AS SALE_PROF_AMT
                  , SUM(X.PROFRATE)         AS PROFRATE
                  , SUM(X.CUST_CNT)         AS CUST_CNT
                  , SUM(X.CUST_DANGA)       AS CUST_DANGA
                  , SUM(NORM_SALE_AMT_VAT)  AS NORM_SALE_AMT_VAT
                  , ?                       AS UNIT
              FROM (
		             SELECT A.PUMBUN_CD                                                       AS ORG_CD
		                  , F.PUMBUN_NAME                                                     AS ORG_NAME
		                  , 0                                                                 AS ORIGIN_SALE_TAMT
		                  , SUM(A.SALE_QTY)                                                   AS SALE_QTY
		                  , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
		                  , 0                                                                 AS ACHIEVERATE
		                  , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
		                  , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS SALE_AMT
		                  , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
		                  , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
		                  , SUM(NVL(ROUND(A.SALE_PROF_AMT/1.1,0),0))                                       AS SALE_PROF_AMT
		                  , (CASE WHEN SUM(NVL(A.NORM_SALE_AMT,0)) = 0 THEN 0 
		                     ELSE 
		                     (CASE WHEN G.TAX_FLAG = '1' 
		                      THEN SUM(NVL(A.SALE_PROF_AMT,0))/SUM(ROUND(A.NORM_SALE_AMT/1.1,0))*100
		                      ELSE SUM(NVL(A.SALE_PROF_AMT,0))/SUM(A.NORM_SALE_AMT)*100
		                      END)
		                     END)                                                             AS PROFRATE
					     /*
		                  , (CASE WHEN SUM(NVL(A.NORM_SALE_AMT,0)) = 0 THEN 0 
		                          ELSE SUM(NVL(ROUND(A.SALE_PROF_AMT/1.1,0),0))/SUM(A.NORM_SALE_AMT)*100
		                      END)                                                             AS PROFRATE
						*/		                      
		                  , SUM(A.CUST_CNT)                                                   AS CUST_CNT
		                  , ( CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 
		                      ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                 AS CUST_DANGA
		                  , (CASE WHEN SUM(A.NORM_SALE_AMT) = 0 THEN 0 
                                  ELSE (CASE WHEN G.TAX_FLAG = '1' THEN SUM(ROUND(A.NORM_SALE_AMT/1.1,0))
                                             ELSE SUM(A.NORM_SALE_AMT)
                                        END)
                             END) AS NORM_SALE_AMT_VAT
		               FROM DPS.PS_DAYPBN      A
		                  , DPS.PC_ORGMST      B
		                  , DPS.PC_STRPBN      F
		                  , DPS.PC_PBNMST      G
		              WHERE F.BUY_ORG_CD                    = B.ORG_CD
		                AND A.STR_CD                         = F.STR_CD
		                AND A.PUMBUN_CD                      = F.PUMBUN_CD
		                AND A.PUMBUN_CD                      = G.PUMBUN_CD
		                AND B.STR_CD    = ?
		                
        ]]>        
    </query>

		                
    <query name="SEL_SALE_PUMBUN2-02">        
        <![CDATA[
		                AND A.SALE_DT                        >= ?
		                AND A.SALE_DT                        <= ?
		                AND A.PUMBUN_CD IN ( SELECT MYORG.PUMBUN_CD
		                               FROM COM.V_MYORG MYORG
		                              WHERE MYORG.USER_ID     = ?
		                                AND MYORG.ORG_FLAG    = ?
		                           )
		              GROUP BY
		                    A.PUMBUN_CD
		                  , F.PUMBUN_NAME
		                  , LPAD(A.ORG_CD, 8) 
		                  , G.TAX_FLAG
		              UNION ALL
		             SELECT A.PUMBUN_CD                                                       AS ORG_CD
		                  , F.PUMBUN_NAME                                                     AS ORG_NAME
		                  , SUM(A.ORIGIN_SALE_TAMT)                                           AS ORIGIN_SALE_TAMT
		                  , 0                                                                 AS SALE_QTY
		                  , 0                                                                 AS TOT_SALE_AMT
		                  , 0                                                                 AS ACHIEVERATE
		                  , 0                                                                 AS REDU_AMT
		                  , 0                                                                 AS SALE_AMT
		                  , 0                                                                 AS DC_AMT
		                  , 0                                                                 AS NET_SALE_AMT
		                  , 0                                                                 AS SALE_PROF_AMT
		                  , 0                                                                 AS PROFRATE
		                  , 0                                                                 AS CUST_CNT
		                  , 0                                                                 AS CUST_DANGA
		                  , 0                                                                 AS NORM_SALE_AMT_VAT
		               FROM DPS.PS_ACTPUMBUN   A
		                  , DPS.PC_ORGMST      B
		                  , DPS.PS_SCHEDULE    D
		                  , DPS.PC_STRPBN      F
		              WHERE F.BUY_ORG_CD                    = B.ORG_CD
		                AND A.STR_CD                         = D.STR_CD(+)
		                AND A.EXE_DT                         = D.SALE_DT(+)
		                AND A.STR_CD                         = F.STR_CD
		                AND A.PUMBUN_CD                      = F.PUMBUN_CD
		                AND B.STR_CD    = ?
        ]]>        
    </query>
		                
		                
    <query name="SEL_SALE_PUMBUN2-03">        
        <![CDATA[
		                AND A.EXE_DT                         >= ?
		                AND A.EXE_DT                         <= ?
		                AND A.PUMBUN_CD IN ( SELECT MYORG.PUMBUN_CD
		                               FROM COM.V_MYORG MYORG
		                              WHERE MYORG.USER_ID     = ?
		                                AND MYORG.ORG_FLAG    = ?
		                           )
		              GROUP BY
		                    A.PUMBUN_CD
		                  , F.PUMBUN_NAME
                   ) X
              GROUP BY
                    X.ORG_CD
                  , X.ORG_NAME
                  
                  
        	
        ]]>        
    </query>
    
    <query name="SEL_SALE_PC2-01">        
        <![CDATA[
        	SELECT  X.STR_CD                                                          AS STR_CD
                  , X.DEPT_CD                                                         AS DEPT_CD
                  , X.TEAM_CD                                                         AS TEAM_CD
                  , B.ORG_SHORT_NAME                                                  AS TEAM_ORG_NAME
                  , X.PC_CD                                                           AS PC_CD
                  , C.ORG_SHORT_NAME                                                  AS PC_ORG_NAME
                  , X.ORIGIN_SALE_TAMT                                                AS ORIGIN_SALE_TAMT
                  , X.SALE_QTY                                                        AS SALE_QTY
                  , X.TOT_SALE_AMT                                                    AS TOT_SALE_AMT
                  , X.ACHIEVERATE                                                     AS ACHIEVERATE
                  , X.REDU_AMT                                                        AS REDU_AMT
                  , X.SALE_AMT                                                        AS SALE_AMT
                  , X.DC_AMT                                                          AS DC_AMT
                  , X.NET_SALE_AMT                                                    AS NET_SALE_AMT
                  , X.SALE_PROF_AMT                                                   AS SALE_PROF_AMT
                  , X.PROFRATE                                                        AS PROFRATE
                  , X.CUST_CNT                                                        AS CUST_CNT
                  , X.CUST_DANGA                                                      AS CUST_DANGA
                  , X.SALEDTS                                                         AS SALEDTS
                  , X.SALEDTE                                                         AS SALEDTE
                  , X.NORM_SALE_AMT_VAT                                               AS NORM_SALE_AMT_VAT
                  , ?                                                  				  AS UNIT
               FROM (
		             SELECT A.STR_CD
		                  , B.DEPT_CD                                                           AS DEPT_CD
		                  , B.TEAM_CD                                                           AS TEAM_CD
		                  , B.PC_CD                                                             AS PC_CD
		                  , SUM(A.ORIGIN_SALE_TAMT)                                             AS ORIGIN_SALE_TAMT
		                  , SUM(A.SALE_QTY)                                                     AS SALE_QTY
		                  , SUM(A.TOT_SALE_AMT)                                                 AS TOT_SALE_AMT
		                  , CASE WHEN SUM(A.ORIGIN_SALE_TAMT) = 0 THEN 0
		                         ELSE SUM(A.TOT_SALE_AMT) / SUM(A.ORIGIN_SALE_TAMT) * 100 END   AS ACHIEVERATE
		                  , SUM(A.REDU_AMT)                                                     AS REDU_AMT
		                  , SUM(A.NORM_SALE_AMT)                                                AS SALE_AMT
		                  , SUM(A.DC_AMT)                                                       AS DC_AMT
		                  , SUM(A.NET_SALE_AMT)                                                 AS NET_SALE_AMT
		                  , SUM(A.SALE_PROF_AMT)                                                AS SALE_PROF_AMT
						  /*
						  , (CASE WHEN SUM(NVL(A.NORM_SALE_AMT,0)) = 0 THEN 0 
		                     ELSE 
		                     (CASE WHEN G.TAX_FLAG = '1' 
		                      THEN SUM(NVL(A.SALE_PROF_AMT,0))/SUM(ROUND(A.NORM_SALE_AMT/1.1,0))*100
		                      ELSE SUM(NVL(A.SALE_PROF_AMT,0))/SUM(A.NORM_SALE_AMT)*100
		                      END)
		                     END)                                                             AS PROFRATE
		                  */
		                  , CASE WHEN SUM(A.NORM_SALE_AMT_VAT) = 0 THEN 0
		                         ELSE SUM(A.SALE_PROF_AMT) / SUM(A.NORM_SALE_AMT_VAT) * 100 END AS PROFRATE
		                  
		                  , SUM(A.CUST_CNT)                                                     AS CUST_CNT
		                  , CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 
		                         ELSE SUM(A.TOT_SALE_AMT) / SUM(A.CUST_CNT) END                 AS CUST_DANGA
		                  , ?                                                                   AS SALEDTS
		                  , ?                                                                   AS SALEDTE
		                  , A.ORG_CD
		                  , SUM(A.NORM_SALE_AMT_VAT)  											    AS NORM_SALE_AMT_VAT
		               FROM (
		                     SELECT A.STR_CD
		                          , A.SALE_DT
		                          , A.ORG_CD                                  AS ORG_CD
		                          , SUM(A.SALE_QTY)                           AS SALE_QTY
		                          , SUM(A.TOT_SALE_AMT)                       AS TOT_SALE_AMT
		                          , SUM(A.VAT_AMT)                            AS VAT_AMT
		                          , SUM(A.REDU_AMT)                           AS REDU_AMT
		                          , SUM(A.NORM_SALE_AMT)                      AS NORM_SALE_AMT
		                          , SUM(A.DC_AMT)                             AS DC_AMT
		                          , SUM(A.NET_SALE_AMT)                       AS NET_SALE_AMT
		                          , SUM(A.SALE_PROF_AMT)                      AS SALE_PROF_AMT
		                          , SUM(A.CUST_CNT)                           AS CUST_CNT
		                          , SUM(A.SAL_COST_PRC)                       AS SAL_COST_PRC
		                          , SUM(A.NORM_SALE_AMT_VAT)                  AS NORM_SALE_AMT_VAT
		                          , 0                                         AS ORIGIN_SALE_TAMT
		                       FROM (
		                              SELECT A.STR_CD
		                                   , A.SALE_DT
		                                   , SUBSTR(D.BUY_ORG_CD, 1, 8) || '00'       AS ORG_CD
		                                   , SUM(A.SALE_QTY)                           AS SALE_QTY
		                                   , SUM(A.TOT_SALE_AMT)                       AS TOT_SALE_AMT
		                                   , SUM(A.VAT_AMT)                            AS VAT_AMT
		                                   , SUM(A.REDU_AMT)                           AS REDU_AMT
		                                   , SUM(A.NORM_SALE_AMT)                      AS NORM_SALE_AMT
		                                   , SUM(A.DC_AMT)                             AS DC_AMT
		                                   , SUM(A.NET_SALE_AMT)                       AS NET_SALE_AMT
		                                   , SUM(ROUND(A.SALE_PROF_AMT/1.1,0))                      AS SALE_PROF_AMT
		                                   , SUM(A.CUST_CNT)                           AS CUST_CNT
		                                   , SUM(A.SAL_COST_PRC*A.SALE_QTY)            AS SAL_COST_PRC
		                                   , (CASE WHEN SUM(A.NORM_SALE_AMT) = 0 THEN 0 
		                                           ELSE (CASE WHEN C.TAX_FLAG = '1' THEN SUM(ROUND(A.NORM_SALE_AMT/1.1,0))
		                                                      ELSE SUM(A.NORM_SALE_AMT)
		                                                 END)
		                                      END)                                     AS NORM_SALE_AMT_VAT
		                                FROM DPS.PS_DAYPBN    A
		                                   , DPS.PC_ORGMST    B
		                                   , DPS.PC_PBNMST    C
		                                   , DPS.PC_STRPBN    D
		                               WHERE D.BUY_ORG_CD   = B.ORG_CD
		                                 AND A.STR_CD    = D.STR_CD
		                                 AND A.PUMBUN_CD = D.PUMBUN_CD
		                                 AND A.PUMBUN_CD = C.PUMBUN_CD
		                                 AND B.STR_CD    = ?
		                                 
     ]]>        
    </query>
		                                 
    <query name="SEL_SALE_PC2-02">        
        <![CDATA[
		                                 AND A.SALE_DT  BETWEEN ? AND ?
		                                 AND A.PUMBUN_CD IN ( SELECT MYORG.PUMBUN_CD
									                               FROM COM.V_MYORG MYORG
									                              WHERE MYORG.USER_ID     = ?
									                                AND MYORG.ORG_FLAG    = ?
									                           )
		                               GROUP BY
		                                     A.STR_CD
		                                   , A.SALE_DT
		                                   , SUBSTR(D.BUY_ORG_CD, 1, 8)
		                                   , C.TAX_FLAG
		                            ) A
		                      GROUP BY
		                            A.STR_CD
		                          , A.SALE_DT
		                          , A.ORG_CD
		                       UNION ALL
		                     SELECT A.STR_CD
		                          , A.EXE_DT
		                          , SUBSTR(B.ORG_CD, 1, 8) || '00'            AS ORG_CD
		                          , 0                                         AS SALE_QTY
		                          , 0                                         AS TOT_SALE_AMT
		                          , 0                                         AS VAT_AMT
		                          , 0                                         AS REDU_AMT
		                          , 0                                         AS NORM_SALE_AMT
		                          , 0                                         AS DC_AMT
		                          , 0                                         AS NET_SALE_AMT
		                          , 0                                         AS SALE_PROF_AMT
		                          , 0                                         AS CUST_CNT
		                          , 0                                         AS SAL_COST_PRC
		                          , 0                                         AS NORM_SALE_AMT_VAT
		                          , SUM(A.ORIGIN_SALE_TAMT)                    AS ORIGIN_SALE_TAMT
			                   FROM DPS.PS_ACTPUMBUN  A
			                      , DPS.PC_ORGMST B
			                      , DPS.PC_STRPBN C
			                  WHERE A.STR_CD    = C.STR_CD
			                    AND A.PUMBUN_CD = C.PUMBUN_CD
			                    AND B.ORG_CD    = C.SALE_ORG_CD
		                        AND B.STR_CD    = ?
		                        AND B.DEPT_CD   = ? 
		                        AND B.TEAM_CD   = ? 
		                        AND B.PC_CD     = ?
     ]]>        
    </query>
		                        
		                        
    <query name="SEL_SALE_PC2-03">        
        <![CDATA[
		                        AND A.EXE_DT  BETWEEN ? AND ?
                                AND EXISTS ( SELECT MYORG.USER_ID
		                                       FROM COM.V_MYORG MYORG
		                                      WHERE MYORG.STR_CD      = B.STR_CD
		                                        AND MYORG.DEPT_CD     = B.DEPT_CD
		                                        AND MYORG.TEAM_CD     = B.TEAM_CD
		                                        AND MYORG.PC_CD       = B.PC_CD
		                                        AND MYORG.USER_ID     = ?
		                                		AND MYORG.ORG_FLAG    = ?
		                                   )
		                      GROUP BY
		                            A.STR_CD
		                          , A.EXE_DT
		                          , SUBSTR(B.ORG_CD, 1, 8)                           
		                    ) A
		                  , DPS.PC_ORGMST      B
		                  , DPS.PS_SCHEDULE    D
		              WHERE A.ORG_CD                         = B.ORG_CD
		                AND A.STR_CD                         = D.STR_CD(+)
		                AND A.SALE_DT                        = D.SALE_DT(+)
		              GROUP BY
		                    A.STR_CD
		                  , B.DEPT_CD
		                  , B.TEAM_CD
		                  , B.PC_CD
                          , A.ORG_CD 
                    ) X
                  , DPS.PC_ORGMST      B
                  , DPS.PC_ORGMST      C
              WHERE B.ORG_CD = LPAD(X.ORG_CD, 6) || '0000'
                AND C.ORG_CD = LPAD(X.ORG_CD, 8) || '00'
              ORDER BY
                    X.STR_CD
                  , X.DEPT_CD
                  , X.TEAM_CD
                  , X.PC_CD
             
     ]]>        
    </query>
    
    <query name="SEL_SALE_PC-01">        
        <![CDATA[
             SELECT  X.STR_CD                                                          AS STR_CD
                  , X.DEPT_CD                                                         AS DEPT_CD
                  , X.TEAM_CD                                                         AS TEAM_CD
                  , B.ORG_SHORT_NAME                                                  AS TEAM_ORG_NAME
                  , X.PC_CD                                                           AS PC_CD
                  , C.ORG_SHORT_NAME                                                  AS PC_ORG_NAME
                  , X.ORIGIN_SALE_TAMT                                                AS ORIGIN_SALE_TAMT
                  , X.SALE_QTY                                                        AS SALE_QTY
                  , X.TOT_SALE_AMT                                                    AS TOT_SALE_AMT
                  , X.ACHIEVERATE                                                     AS ACHIEVERATE
                  , X.REDU_AMT                                                        AS REDU_AMT
                  , X.SALE_AMT                                                        AS SALE_AMT
                  , X.DC_AMT                                                          AS DC_AMT
                  , X.NET_SALE_AMT                                                    AS NET_SALE_AMT
                  , X.SALE_PROF_AMT                                                   AS SALE_PROF_AMT
                  , X.PROFRATE                                                        AS PROFRATE
                  , X.CUST_CNT                                                        AS CUST_CNT
                  , X.CUST_DANGA                                                      AS CUST_DANGA
                  , X.SALEDTS                                                         AS SALEDTS
                  , X.SALEDTE                                                         AS SALEDTE
                  , X.NORM_SALE_AMT_VAT                                               AS NORM_SALE_AMT_VAT
                  , ?                                                  				  AS UNIT
               FROM (
                     SELECT A.STR_CD
                          , B.DEPT_CD                                                           AS DEPT_CD
                          , B.TEAM_CD                                                           AS TEAM_CD
                          , B.PC_CD                                                             AS PC_CD
                          , SUM(A.ORIGIN_SALE_TAMT)                                             AS ORIGIN_SALE_TAMT
                          , SUM(A.SALE_QTY)                                                     AS SALE_QTY
                          , SUM(A.TOT_SALE_AMT)                                                 AS TOT_SALE_AMT
                          , CASE WHEN SUM(A.ORIGIN_SALE_TAMT) = 0 THEN 0
                                 ELSE SUM(A.TOT_SALE_AMT) / SUM(A.ORIGIN_SALE_TAMT) * 100 END   AS ACHIEVERATE
                          , SUM(A.REDU_AMT)                                                     AS REDU_AMT
                          , SUM(A.NORM_SALE_AMT)                                                AS SALE_AMT
                          , SUM(A.DC_AMT)                                                       AS DC_AMT
                          , SUM(A.NET_SALE_AMT)                                                 AS NET_SALE_AMT
                          , SUM(A.SALE_PROF_AMT)                                                AS SALE_PROF_AMT
                          /*
                          , (CASE WHEN SUM(NVL(A.NORM_SALE_AMT,0)) = 0 THEN 0 
		                     ELSE 
		                     (CASE WHEN G.TAX_FLAG = '1' 
		                      THEN SUM(NVL(A.SALE_PROF_AMT,0))/SUM(ROUND(A.NORM_SALE_AMT/1.1,0))*100
		                      ELSE SUM(NVL(A.SALE_PROF_AMT,0))/SUM(A.NORM_SALE_AMT)*100
		                      END)
		                     END)                                                             AS PROFRATE
                          */
                          , CASE WHEN SUM(A.NORM_SALE_AMT_VAT) = 0 THEN 0
                                 ELSE SUM(A.SALE_PROF_AMT) / SUM(A.NORM_SALE_AMT_VAT) * 100 END AS PROFRATE
                          , SUM(A.CUST_CNT)                                                     AS CUST_CNT
                          , CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 
                                 ELSE SUM(A.TOT_SALE_AMT) / SUM(A.CUST_CNT) END                 AS CUST_DANGA
                          , ?                                                                   AS SALEDTS
                          , ?                                                                   AS SALEDTE
                          , A.ORG_CD
                          , SUM(A.NORM_SALE_AMT_VAT)                                                  AS NORM_SALE_AMT_VAT
                       FROM (
                             SELECT A.STR_CD
                                  , A.SALE_DT
                                  , A.ORG_CD                                  AS ORG_CD
                                  , SUM(A.SALE_QTY)                           AS SALE_QTY
                                  , SUM(A.TOT_SALE_AMT)                       AS TOT_SALE_AMT
                                  , SUM(A.VAT_AMT)                            AS VAT_AMT
                                  , SUM(A.REDU_AMT)                           AS REDU_AMT
                                  , SUM(A.NORM_SALE_AMT)                      AS NORM_SALE_AMT
                                  , SUM(A.DC_AMT)                             AS DC_AMT
                                  , SUM(A.NET_SALE_AMT)                       AS NET_SALE_AMT
                                  , SUM(A.SALE_PROF_AMT)                      AS SALE_PROF_AMT
                                  , SUM(A.CUST_CNT)                           AS CUST_CNT
                                  , SUM(A.SAL_COST_PRC)                       AS SAL_COST_PRC
                                  , SUM(A.NORM_SALE_AMT_VAT)                  AS NORM_SALE_AMT_VAT
                                  , 0                                         AS ORIGIN_SALE_TAMT
                               FROM (
                                      SELECT A.STR_CD
                                           , A.SALE_DT
                                           , SUBSTR(D.SALE_ORG_CD, 1, 8) || '00'       AS ORG_CD
                                           , SUM(A.SALE_QTY)                           AS SALE_QTY
                                           , SUM(A.TOT_SALE_AMT)                       AS TOT_SALE_AMT
                                           , SUM(A.VAT_AMT)                            AS VAT_AMT
                                           , SUM(A.REDU_AMT)                           AS REDU_AMT
                                           , SUM(A.NORM_SALE_AMT)                      AS NORM_SALE_AMT
                                           , SUM(A.DC_AMT)                             AS DC_AMT
                                           , SUM(A.NET_SALE_AMT)                       AS NET_SALE_AMT
                                           , SUM(ROUND(A.SALE_PROF_AMT/1.1,0))                      AS SALE_PROF_AMT
                                           , SUM(A.CUST_CNT)                           AS CUST_CNT
                                           , SUM(A.SAL_COST_PRC*A.SALE_QTY)            AS SAL_COST_PRC
                                           , (CASE WHEN SUM(A.NORM_SALE_AMT) = 0 THEN 0
                                                   ELSE (CASE WHEN C.TAX_FLAG = '1' THEN SUM(ROUND(A.NORM_SALE_AMT/1.1,0))
                                                              ELSE SUM(A.NORM_SALE_AMT)
                                                         END)
                                              END)                                     AS NORM_SALE_AMT_VAT
                                        FROM DPS.PS_DAYPBN    A
                                           , DPS.PC_PBNMST    C
                                           , DPS.PC_STRPBN    D
                                           , DPS.PC_ORGMST    B
                                       WHERE A.STR_CD    = D.STR_CD
                                         AND A.PUMBUN_CD = D.PUMBUN_CD
                                         AND A.PUMBUN_CD = C.PUMBUN_CD
                                         AND D.STR_CD = B.STR_CD
                                         AND D.SALE_ORG_CD = B.ORG_CD
                                         AND A.STR_CD = ?
        ]]>        
    </query>
                                         

                                         
    <query name="SEL_SALE_PC-02">        
        <![CDATA[
                                         AND A.SALE_DT   BETWEEN ? AND ?
                                         AND A.PUMBUN_CD IN ( SELECT MYORG.PUMBUN_CD
							                               FROM COM.V_MYORG MYORG
							                              WHERE MYORG.USER_ID     = ?
							                                AND MYORG.ORG_FLAG    = ?
							                           )
                                       GROUP BY
                                             A.STR_CD
                                           , A.SALE_DT
                                           , SUBSTR(D.SALE_ORG_CD, 1, 8)
                                           , C.TAX_FLAG
                                    ) A
                              GROUP BY
                                    A.STR_CD
                                  , A.SALE_DT
                                  , A.ORG_CD
                               UNION ALL
                             SELECT A.STR_CD
                                  , A.EXE_DT
                                  , SUBSTR(B.ORG_CD, 1, 8) || '00'            AS ORG_CD
                                  , 0                                         AS SALE_QTY
                                  , 0                                         AS TOT_SALE_AMT
                                  , 0                                         AS VAT_AMT
                                  , 0                                         AS REDU_AMT
                                  , 0                                         AS NORM_SALE_AMT
                                  , 0                                         AS DC_AMT
                                  , 0                                         AS NET_SALE_AMT
                                  , 0                                         AS SALE_PROF_AMT
                                  , 0                                         AS CUST_CNT
                                  , 0                                         AS SAL_COST_PRC
                                  , 0                                         AS NORM_SALE_AMT_VAT
                                  , SUM(A.ORIGIN_SALE_TAMT)                    AS ORIGIN_SALE_TAMT
			                   FROM DPS.PS_ACTPUMBUN  A
			                      , DPS.PC_ORGMST B
			                      , DPS.PC_STRPBN C
			                  WHERE A.STR_CD    = C.STR_CD
			                    AND A.PUMBUN_CD = C.PUMBUN_CD
			                    AND B.ORG_CD    = C.SALE_ORG_CD
                                AND B.STR_CD    = ?
        ]]>        
    </query>
                               
                                
    <query name="SEL_SALE_PC-03">        
        <![CDATA[
                                AND A.EXE_DT  BETWEEN ? AND ?
                                AND SUBSTR(A.ORG_CD,1,8) IN ( SELECT SUBSTR(MYORG.ORG_CD,1,8)
							                               FROM COM.V_MYORG MYORG
							                              WHERE MYORG.USER_ID     = ?
							                                AND MYORG.ORG_FLAG    = ?
							                           )
                              GROUP BY
                                    A.STR_CD
                                  , A.EXE_DT
                                  , SUBSTR(B.ORG_CD, 1, 8)                           
                            ) A
                          , DPS.PC_ORGMST      B
                          , DPS.PS_SCHEDULE    D
                      WHERE A.ORG_CD                         = B.ORG_CD
                        AND A.STR_CD                         = D.STR_CD(+)
                        AND A.SALE_DT                        = D.SALE_DT(+)
                      GROUP BY
                            A.STR_CD
                          , B.DEPT_CD
                          , B.TEAM_CD
                          , B.PC_CD
                          , A.ORG_CD 
                    ) X
                  , DPS.PC_ORGMST      B
                  , DPS.PC_ORGMST      C
              WHERE B.ORG_CD = LPAD(X.ORG_CD, 6) || '0000'
                AND C.ORG_CD = LPAD(X.ORG_CD, 8) || '00'
              ORDER BY
                    X.STR_CD
                  , X.DEPT_CD
                  , X.TEAM_CD
                  , X.PC_CD
                  
        ]]>        
    </query>
    
    <query name="SEL_CMPRDT">        
        <![CDATA[
            SELECT CMPR_DT
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD    = ?
               AND SALE_DT = ?
        ]]>        
    </query>
    
    <query name="WHERE_DEPT_CD">        
        <![CDATA[
        				AND B.DEPT_CD  = ?
        ]]>
	</query>
	
	<query name="WHERE_TEAM_CD">        
        <![CDATA[
        				AND B.TEAM_CD  = ?
        ]]>
	</query>
	
	<query name="WHERE_PC_CD">        
        <![CDATA[
        				AND B.PC_CD    = ?
        ]]>
	</query>
    
</service>