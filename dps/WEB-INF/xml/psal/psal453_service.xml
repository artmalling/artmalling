<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 박종은
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2010.04.08
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/psal301.ps">

    
    
    <gauce name="H_SEL_MASTER"> 
        <column colName="ORG_CD"                  colType="TB_STRING"      size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_NAME"                colType="TB_STRING"      size="40"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORIGIN_SALE_TAMT"        colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_SALE_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ACHIEVERATE"             colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        
        <column colName="TOT_COMP_RATE"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REDU_AMT"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_SALE_AMT"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DC_AMT"                  colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NET_SALE_AMT"            colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_PROF_AMT"           colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PROFRATE"                colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_CNT"                colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CUST_DANGA"              colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        
        <column colName="TOT_SALE_AMT_CMPR1"      colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_COMP_RATE_CMPR1"     colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALEIRATE1"              colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_SALE_AMT_CMPR2"      colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TOT_COMP_RATE_CMPR2"     colType="TB_DECIMAL"     size="13"       dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALEIRATE2"              colType="TB_DECIMAL"     size="5"        dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_FLAG"                colType="TB_STRING"      size="1"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    
    <gauce name="H_SEL_CMPRDT"> 
        <column colName="CMPR_DT"                 colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <gauce name="H_SEL_CMPRDT2"> 
        <column colName="CMPR_DT"                 colType="TB_STRING"      size="8"        dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>

    
    <!-- 쿼리는 전부 대문자 -->
     
    <!-- 마스터 조회 쿼리  -->
    <query name="SEL_SALE_DEPT">        
        <![CDATA[
             SELECT X.ORG_CD             -- 조직코드 
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD)      AS ORG_NAME     -- 조직명
                  , X.ORIGIN_SALE_TAMT   -- 실행목표
                  , X.TOT_SALE_AMT       -- 총매출
                  , X.ACHIEVERATE        -- 달성율
                  , X.TOT_COMP_RATE      -- 구성비
                  , X.REDU_AMT           -- 할인액
                  , X.NORM_SALE_AMT      -- 매출
                  , X.DC_AMT             -- 에누리
                  , X.NET_SALE_AMT       -- 순매출
                  , X.SALE_PROF_AMT      -- 이익액
                  , X.PROFRATE           -- 이익율
                  , X.CUST_CNT           -- 객수
                  , X.CUST_DANGA         -- 객단가
                  , X.TOT_SALE_AMT_CMPR1      -- 대비실적1
                  , X.TOT_COMP_RATE_CMPR1     -- 대비구성비1
                  , X.SALEIRATE1              -- 신장율1
                  , 0                     AS TOT_SALE_AMT_CMPR2      -- 대비실적2
                  , 0                     AS TOT_COMP_RATE_CMPR2     -- 대비구성비2
                  , 0                     AS SALEIRATE2              -- 신자율2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 4) || '000000'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                        AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                           AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'D'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.ORG_CD,1,8) || '00'        AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                               , DPS.PS_SCHEDULE    D
                           WHERE D.STR_CD      = ?   -- 점 
                             AND D.SALE_DT     >= ?  -- 매출기간(시작)
                             AND D.SALE_DT     <= ?  -- 매출기간(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                             AND F.STR_CD      = D.STR_CD
                             AND F.SALE_DT     = D.CMPR_DT
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 4)
                   ) X
              ORDER BY
                    X.ORG_CD
    ]]>        
    </query>
     <query name="SEL_SALE_DEPT2">        
        <![CDATA[
             SELECT X.ORG_CD             -- 조직코드 
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD)      AS ORG_NAME     -- 조직명
                  , X.ORIGIN_SALE_TAMT   -- 실행목표
                  , X.TOT_SALE_AMT       -- 총매출
                  , X.ACHIEVERATE        -- 달성율
                  , X.TOT_COMP_RATE      -- 구성비
                  , X.REDU_AMT           -- 할인액
                  , X.NORM_SALE_AMT      -- 매출
                  , X.DC_AMT             -- 에누리
                  , X.NET_SALE_AMT       -- 순매출
                  , X.SALE_PROF_AMT      -- 이익액
                  , X.PROFRATE           -- 이익율
                  , X.CUST_CNT           -- 객수
                  , X.CUST_DANGA         -- 객단가
                  , X.TOT_SALE_AMT_CMPR1      -- 대비실적1
                  , X.TOT_COMP_RATE_CMPR1     -- 대비구성비1
                  , X.SALEIRATE1              -- 신장율1
                  , 0                     AS TOT_SALE_AMT_CMPR2      -- 대비실적2
                  , 0                     AS TOT_COMP_RATE_CMPR2     -- 대비구성비2
                  , 0                     AS SALEIRATE2              -- 신자율2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 4) || '000000'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                        AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                           AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'D'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.BUY_ORG_CD,1,8) || '00'        AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.BUY_ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.BUY_ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                               , DPS.PS_SCHEDULE    D
                           WHERE D.STR_CD      = ?   -- 점 
                             AND D.SALE_DT     >= ?  -- 매출기간(시작)
                             AND D.SALE_DT     <= ?  -- 매출기간(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                             AND F.STR_CD      = D.STR_CD
                             AND F.SALE_DT     = D.CMPR_DT
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.BUY_ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.BUY_ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.BUY_ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 4)
                   ) X
              ORDER BY
                    X.ORG_CD
                          
        ]]>        
    </query>
       <query name="SEL_SALE_DEPT3">        
        <![CDATA[
             SELECT X.ORG_CD
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD) AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 4) || '000000'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'D'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.ORG_CD,1,8) || '00'        AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간1(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간1(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.ORG_CD,1,8)||'00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , 0                             AS TOT_SALE_AMT_CMPR1 
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간2(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간2(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 4)
                   ) X
              ORDER BY
                    X.ORG_CD 
        ]]>        
    </query>
   <query name="SEL_SALE_DEPT4">        
        <![CDATA[        	
             SELECT X.ORG_CD
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD) AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 4) || '000000'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'D'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.BUY_ORG_CD,1,8) || '00'        AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.BUY_ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.BUY_ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간1(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간1(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.BUY_ORG_CD,1,8)||'00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.BUY_ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , 0                             AS TOT_SALE_AMT_CMPR1 
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간2(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간2(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.BUY_ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.BUY_ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.BUY_ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 4)
                   ) X
              ORDER BY
                    X.ORG_CD
        
        ]]>        
    </query>
    
     <query name="SEL_SALE_TEAM4">        
        <![CDATA[
        	 
        	 SELECT X.ORG_CD
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD) AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 6) || '0000'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'T'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.BUY_ORG_CD,1,8) || '00'        AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.BUY_ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.BUY_ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.BUY_ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간1(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간1(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.BUY_ORG_CD,1,8)||'00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.BUY_ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , 0                             AS TOT_SALE_AMT_CMPR1 
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간2(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간2(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.BUY_ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.BUY_ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.BUY_ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 6)
                   ) X
              ORDER BY
                    X.ORG_CD
         ]]>        
     </query>
    
     <query name="SEL_SALE_TEAM3">        
        <![CDATA[
        	 
             SELECT X.ORG_CD
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD) AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 6) || '0000'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'T'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.ORG_CD,1,8) || '00'        AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간1(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간1(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.ORG_CD,1,8)||'00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , 0                             AS TOT_SALE_AMT_CMPR1 
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간2(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간2(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 6)
                   ) X
              ORDER BY
                    X.ORG_CD
         ]]>        
    </query>
   
    <query name="SEL_SALE_TEAM2">        
        <![CDATA[
             SELECT X.ORG_CD             -- 조직코드 
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD)      AS ORG_NAME     -- 조직명
                  , X.ORIGIN_SALE_TAMT   -- 실행목표
                  , X.TOT_SALE_AMT       -- 총매출
                  , X.ACHIEVERATE        -- 달성율
                  , X.TOT_COMP_RATE      -- 구성비
                  , X.REDU_AMT           -- 할인액
                  , X.NORM_SALE_AMT      -- 매출
                  , X.DC_AMT             -- 에누리
                  , X.NET_SALE_AMT       -- 순매출
                  , X.SALE_PROF_AMT      -- 이익액
                  , X.PROFRATE           -- 이익율
                  , X.CUST_CNT           -- 객수
                  , X.CUST_DANGA         -- 객단가
                  , X.TOT_SALE_AMT_CMPR1      -- 대비실적1
                  , X.TOT_COMP_RATE_CMPR1     -- 대비구성비1
                  , X.SALEIRATE1              -- 신장율1
                  , 0                     AS TOT_SALE_AMT_CMPR2      -- 대비실적2
                  , 0                     AS TOT_COMP_RATE_CMPR2     -- 대비구성비2
                  , 0                     AS SALEIRATE2              -- 신자율2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 6) || '0000'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                        AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                           AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'T'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.BUY_ORG_CD,1,8) || '00'    AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.BUY_ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.BUY_ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.BUY_ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                               , DPS.PS_SCHEDULE    D
                           WHERE D.STR_CD      = ?   -- 점 
                             AND D.SALE_DT     >= ?  -- 매출기간(시작)
                             AND D.SALE_DT     <= ?  -- 매출기간(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                             AND F.STR_CD      = D.STR_CD
                             AND F.SALE_DT     = D.CMPR_DT
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.BUY_ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.BUY_ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.BUY_ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 6)
                   ) X
              ORDER BY
                    X.ORG_CD
         ]]>        
    </query>
    <query name="SEL_SALE_TEAM">        
        <![CDATA[
             SELECT X.ORG_CD             -- 조직코드 
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD)      AS ORG_NAME     -- 조직명
                  , X.ORIGIN_SALE_TAMT   -- 실행목표
                  , X.TOT_SALE_AMT       -- 총매출
                  , X.ACHIEVERATE        -- 달성율
                  , X.TOT_COMP_RATE      -- 구성비
                  , X.REDU_AMT           -- 할인액
                  , X.NORM_SALE_AMT      -- 매출
                  , X.DC_AMT             -- 에누리
                  , X.NET_SALE_AMT       -- 순매출
                  , X.SALE_PROF_AMT      -- 이익액
                  , X.PROFRATE           -- 이익율
                  , X.CUST_CNT           -- 객수
                  , X.CUST_DANGA         -- 객단가
                  , X.TOT_SALE_AMT_CMPR1      -- 대비실적1
                  , X.TOT_COMP_RATE_CMPR1     -- 대비구성비1
                  , X.SALEIRATE1              -- 신장율1
                  , 0                     AS TOT_SALE_AMT_CMPR2      -- 대비실적2
                  , 0                     AS TOT_COMP_RATE_CMPR2     -- 대비구성비2
                  , 0                     AS SALEIRATE2              -- 신자율2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 6) || '0000'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                        AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                           AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'T'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.ORG_CD,1,8) || '00'        AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                               , DPS.PS_SCHEDULE    D
                           WHERE D.STR_CD      = ?   -- 점 
                             AND D.SALE_DT     >= ?  -- 매출기간(시작)
                             AND D.SALE_DT     <= ?  -- 매출기간(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                             AND F.STR_CD      = D.STR_CD
                             AND F.SALE_DT     = D.CMPR_DT
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 6)
                   ) X
              ORDER BY
                    X.ORG_CD
        ]]>        
    </query>
    
 	
 	
 	    
    <query name="SEL_SALE_PC4">        
        <![CDATA[
        	 SELECT X.ORG_CD
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD) AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 8) || '00'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'P'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.BUY_ORG_CD,1,8) || '00'        AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.BUY_ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.BUY_ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.BUY_ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간1(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간1(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.BUY_ORG_CD,1,8)||'00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.BUY_ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , 0                             AS TOT_SALE_AMT_CMPR1 
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간2(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간2(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.BUY_ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.BUY_ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.BUY_ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 8)
                   ) X
              ORDER BY
                    X.ORG_CD
          
        ]]>        
    </query>
    
    
    <query name="SEL_SALE_PC3">        
        <![CDATA[
             SELECT X.ORG_CD
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD) AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 8) || '00'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'P'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.ORG_CD,1,8) || '00'        AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간1(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간1(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.ORG_CD,1,8)||'00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , 0                             AS TOT_SALE_AMT_CMPR1 
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간2(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간2(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 8)
                   ) X
              ORDER BY
                    X.ORG_CD
		    
        ]]>        
    </query>
    
    <query name="SEL_SALE_PC2">        
        <![CDATA[
             SELECT X.ORG_CD             -- 조직코드 
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD)      AS ORG_NAME     -- 조직명
                  , X.ORIGIN_SALE_TAMT   -- 실행목표
                  , X.TOT_SALE_AMT       -- 총매출
                  , X.ACHIEVERATE        -- 달성율
                  , X.TOT_COMP_RATE      -- 구성비
                  , X.REDU_AMT           -- 할인액
                  , X.NORM_SALE_AMT      -- 매출
                  , X.DC_AMT             -- 에누리
                  , X.NET_SALE_AMT       -- 순매출
                  , X.SALE_PROF_AMT      -- 이익액
                  , X.PROFRATE           -- 이익율
                  , X.CUST_CNT           -- 객수
                  , X.CUST_DANGA         -- 객단가
                  , X.TOT_SALE_AMT_CMPR1      -- 대비실적1
                  , X.TOT_COMP_RATE_CMPR1     -- 대비구성비1
                  , X.SALEIRATE1              -- 신장율1
                  , 0                     AS TOT_SALE_AMT_CMPR2      -- 대비실적2
                  , 0                     AS TOT_COMP_RATE_CMPR2     -- 대비구성비2
                  , 0                     AS SALEIRATE2              -- 신자율2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 8) || '00'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                        AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                           AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'P'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.BUY_ORG_CD,1,8) || '00'    AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.BUY_ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.BUY_ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.BUY_ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                               , DPS.PS_SCHEDULE    D
                           WHERE D.STR_CD      = ?   -- 점 
                             AND D.SALE_DT     >= ?  -- 매출기간(시작)
                             AND D.SALE_DT     <= ?  -- 매출기간(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                             AND F.STR_CD      = D.STR_CD
                             AND F.SALE_DT     = D.CMPR_DT
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.BUY_ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.BUY_ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.BUY_ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 8)
                   ) X
              ORDER BY
                    X.ORG_CD   
        ]]>        
    </query>
    
    <query name="SEL_SALE_PC">        
        <![CDATA[
             SELECT X.ORG_CD             -- 조직코드 
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD)      AS ORG_NAME     -- 조직명
                  , X.ORIGIN_SALE_TAMT   -- 실행목표
                  , X.TOT_SALE_AMT       -- 총매출
                  , X.ACHIEVERATE        -- 달성율
                  , X.TOT_COMP_RATE      -- 구성비
                  , X.REDU_AMT           -- 할인액
                  , X.NORM_SALE_AMT      -- 매출
                  , X.DC_AMT             -- 에누리
                  , X.NET_SALE_AMT       -- 순매출
                  , X.SALE_PROF_AMT      -- 이익액
                  , X.PROFRATE           -- 이익율
                  , X.CUST_CNT           -- 객수
                  , X.CUST_DANGA         -- 객단가
                  , X.TOT_SALE_AMT_CMPR1      -- 대비실적1
                  , X.TOT_COMP_RATE_CMPR1     -- 대비구성비1
                  , X.SALEIRATE1              -- 신장율1
                  , 0                     AS TOT_SALE_AMT_CMPR2      -- 대비실적2
                  , 0                     AS TOT_COMP_RATE_CMPR2     -- 대비구성비2
                  , 0                     AS SALEIRATE2              -- 신자율2
                  , X.SKU_FLAG
              FROM ( SELECT SUBSTR(A.ORG_CD, 1, 8) || '00'                                     AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                        AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                           AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'P'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , SUBSTR(A.ORG_CD,1,8) || '00'        AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , SUBSTR(A.ORG_CD,1,8) || '00'
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , SUBSTR(F.ORG_CD, 1, 8)||'00'  AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                               , DPS.PS_SCHEDULE    D
                           WHERE D.STR_CD      = ?   -- 점 
                             AND D.SALE_DT     >= ?  -- 매출기간(시작)
                             AND D.SALE_DT     <= ?  -- 매출기간(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                             AND F.STR_CD      = D.STR_CD
                             AND F.SALE_DT     = D.CMPR_DT
                           GROUP BY F.STR_CD
                                  , SUBSTR(F.ORG_CD,1,8)||'00'
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , SUBSTR(C.ORG_CD,1,8)           AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , SUBSTR(C.ORG_CD,1,8)
                          )                    A
                      GROUP BY SUBSTR(A.ORG_CD, 1, 8)
                   ) X
              ORDER BY
                    X.ORG_CD
        ]]>        
    </query>
    
    
    
    <query name="SEL_SALE_SKU4">        
        <![CDATA[
    		 SELECT A.SKU_CD                                                          AS ORG_CD
                  , F.SKU_NAME                                                        AS ORG_NAME
                  , 0                                                                 AS ORIGIN_SALE_TAMT
                  , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                  , 0                                                                 AS ACHIEVERATE
                  , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                          ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                     END)                                                             AS TOT_COMP_RATE
                  , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                  , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                  , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                  , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                  , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                      , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                AS PROFRATE
                              , SUM(A.CUST_CNT)                                                                    AS CUST_CNT
                  , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)          AS CUST_DANGA
                  , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                        AS TOT_SALE_AMT_CMPR1
                  , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                          ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                     END)                                                             AS TOT_COMP_RATE_CMPR1
                  , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                     ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                  , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                  AS TOT_SALE_AMT_CMPR2
                  , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                          ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                     END)                                                             AS TOT_COMP_RATE_CMPR2
                  , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                     ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                  , 'E' AS SKU_FLAG
               FROM (SELECT A.STR_CD                 AS STR_CD
                          , A.SKU_CD                 AS SKU_CD
                          , SUM(A.SALE_QTY         ) AS SALE_QTY           
                          , SUM(A.TOT_SALE_AMT     ) AS TOT_SALE_AMT     
                          , SUM(A.VAT_AMT          ) AS VAT_AMT          
                          , SUM(A.REDU_AMT         ) AS REDU_AMT         
                          , SUM(A.NORM_SALE_AMT    ) AS NORM_SALE_AMT    
                          , SUM(A.DC_AMT           ) AS DC_AMT           
                          , SUM(A.NET_SALE_AMT     ) AS NET_SALE_AMT     
                          , SUM(A.SALE_PROF_AMT    ) AS SALE_PROF_AMT    
                          , SUM(A.SALE_QTY         ) AS CUST_CNT
                          , SUM(A.SAL_COST_PRC     ) AS SAL_COST_PRC     
                          , 0                        AS TOT_SALE_AMT_CMPR1
                          , 0                        AS TOT_SALE_AMT_CMPR2
                       FROM DPS.PS_DAYSKU    A
                          , DPS.PC_ORGMST    B
                      WHERE A.STR_CD        = B.STR_CD
                        AND A.BUY_ORG_CD        = B.ORG_CD
                        AND B.STR_CD    = ?
                        AND B.DEPT_CD   = ?
                        AND B.TEAM_CD   = ?
                        AND B.PC_CD     = ?
                        AND B.CORNER_CD LIKE ? || '%'
                        AND A.PUMBUN_CD = ?
                        AND A.SALE_DT   >= ?
                        AND A.SALE_DT   <= ?
                      GROUP BY A.STR_CD, A.SKU_CD
                     UNION ALL
                     SELECT F.STR_CD                AS STR_CD
                          , F.SKU_CD                AS SKU_CD
                          , 0                       AS SALE_QTY           
                          , 0                       AS TOT_SALE_AMT     
                          , 0                       AS VAT_AMT          
                          , 0                       AS REDU_AMT         
                          , 0                       AS NORM_SALE_AMT    
                          , 0                       AS DC_AMT           
                          , 0                       AS NET_SALE_AMT     
                          , 0                       AS SALE_PROF_AMT    
                          , 0                       AS CUST_CNT
                          , 0                       AS SAL_COST_PRC 
                          , SUM(F.TOT_SALE_AMT)     AS TOT_SALE_AMT_CMPR1
                          , 0                       AS TOT_SALE_AMT_CMPR2
                       FROM DPS.PS_DAYSKU F
                          , DPS.PC_ORGMST G
                      WHERE F.STR_CD        = G.STR_CD
                        AND F.BUY_ORG_CD        = G.ORG_CD
                        AND F.STR_CD      = ?
                        AND F.SALE_DT     >= ?
                        AND F.SALE_DT     <= ?
                        AND G.DEPT_CD    = ?
                        AND G.TEAM_CD    = ?
                        AND G.PC_CD      = ?
                        AND G.CORNER_CD LIKE ? || '%'
                        AND F.PUMBUN_CD = ?
                      GROUP BY F.STR_CD, F.SKU_CD
                     UNION ALL
                     SELECT F.STR_CD                AS STR_CD
                          , F.SKU_CD                AS SKU_CD
                          , 0                       AS SALE_QTY           
                          , 0                       AS TOT_SALE_AMT     
                          , 0                       AS VAT_AMT          
                          , 0                       AS REDU_AMT         
                          , 0                       AS NORM_SALE_AMT    
                          , 0                       AS DC_AMT           
                          , 0                       AS NET_SALE_AMT     
                          , 0                       AS SALE_PROF_AMT    
                          , 0                       AS CUST_CNT
                          , 0                       AS SAL_COST_PRC 
                          , 0                       AS TOT_SALE_AMT_CMPR1
                          , SUM(F.TOT_SALE_AMT)     AS TOT_SALE_AMT_CMPR2
                       FROM DPS.PS_DAYSKU F
                          , DPS.PC_ORGMST G
                      WHERE F.STR_CD        = G.STR_CD
                        AND F.BUY_ORG_CD        = G.ORG_CD
                        AND F.STR_CD      = ?
                        AND F.SALE_DT     >= ?
                        AND F.SALE_DT     <= ?
                        AND G.DEPT_CD    = ?
                        AND G.TEAM_CD    = ?
                        AND G.PC_CD      = ?
                        AND G.CORNER_CD LIKE ? || '%'
                        AND F.PUMBUN_CD = ?
                      GROUP BY F.STR_CD, F.SKU_CD
                    ) A
                  , DPS.PC_STRSKUMST    F
              WHERE A.STR_CD     = F.STR_CD
                AND A.SKU_CD     = F.SKU_CD
              GROUP BY
                    A.SKU_CD
                  , F.SKU_NAME
              ORDER BY
                    A.SKU_CD
    ]]>        
    </query>
    
     <query name="SEL_SALE_SKU3">        
        <![CDATA[
             SELECT A.SKU_CD                                                          AS ORG_CD
                  , F.SKU_NAME                                                        AS ORG_NAME
                  , 0                                                                 AS ORIGIN_SALE_TAMT
                  , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                  , 0                                                                 AS ACHIEVERATE
                  , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                          ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                     END)                                                             AS TOT_COMP_RATE
                  , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                  , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                  , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                  , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                  , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                      , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                AS PROFRATE
                              , SUM(A.CUST_CNT)                                                                    AS CUST_CNT
                  , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)          AS CUST_DANGA
                  , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                        AS TOT_SALE_AMT_CMPR1
                  , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                          ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                     END)                                                             AS TOT_COMP_RATE_CMPR1
                  , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                     ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                  , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                  AS TOT_SALE_AMT_CMPR2
                  , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                          ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                     END)                                                             AS TOT_COMP_RATE_CMPR2
                  , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                     ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                  , 'E' AS SKU_FLAG
               FROM (SELECT A.STR_CD                 AS STR_CD
                          , A.SKU_CD                 AS SKU_CD
                          , SUM(A.SALE_QTY         ) AS SALE_QTY           
                          , SUM(A.TOT_SALE_AMT     ) AS TOT_SALE_AMT     
                          , SUM(A.VAT_AMT          ) AS VAT_AMT          
                          , SUM(A.REDU_AMT         ) AS REDU_AMT         
                          , SUM(A.NORM_SALE_AMT    ) AS NORM_SALE_AMT    
                          , SUM(A.DC_AMT           ) AS DC_AMT           
                          , SUM(A.NET_SALE_AMT     ) AS NET_SALE_AMT     
                          , SUM(A.SALE_PROF_AMT    ) AS SALE_PROF_AMT    
                          , SUM(A.SALE_QTY         ) AS CUST_CNT
                          , SUM(A.SAL_COST_PRC     ) AS SAL_COST_PRC     
                          , 0                        AS TOT_SALE_AMT_CMPR1
                          , 0                        AS TOT_SALE_AMT_CMPR2
                       FROM DPS.PS_DAYSKU    A
                          , DPS.PC_ORGMST    B
                      WHERE A.STR_CD        = B.STR_CD
                        AND A.ORG_CD        = B.ORG_CD
                        AND B.STR_CD    = ?
                        AND B.DEPT_CD   = ?
                        AND B.TEAM_CD   = ?
                        AND B.PC_CD     = ?
                        AND B.CORNER_CD LIKE ? || '%'
                        AND A.PUMBUN_CD = ?
                        AND A.SALE_DT   >= ?
                        AND A.SALE_DT   <= ?
                      GROUP BY A.STR_CD, A.SKU_CD
                     UNION ALL
                     SELECT F.STR_CD                AS STR_CD
                          , F.SKU_CD                AS SKU_CD
                          , 0                       AS SALE_QTY           
                          , 0                       AS TOT_SALE_AMT     
                          , 0                       AS VAT_AMT          
                          , 0                       AS REDU_AMT         
                          , 0                       AS NORM_SALE_AMT    
                          , 0                       AS DC_AMT           
                          , 0                       AS NET_SALE_AMT     
                          , 0                       AS SALE_PROF_AMT    
                          , 0                       AS CUST_CNT
                          , 0                       AS SAL_COST_PRC 
                          , SUM(F.TOT_SALE_AMT)     AS TOT_SALE_AMT_CMPR1
                          , 0                       AS TOT_SALE_AMT_CMPR2
                       FROM DPS.PS_DAYSKU F
                          , DPS.PC_ORGMST G
                      WHERE F.STR_CD        = G.STR_CD
                        AND F.ORG_CD        = G.ORG_CD
                        AND F.STR_CD      = ?
                        AND F.SALE_DT     >= ?
                        AND F.SALE_DT     <= ?
                        AND G.DEPT_CD    = ?
                        AND G.TEAM_CD    = ?
                        AND G.PC_CD      = ?
                        AND G.CORNER_CD LIKE ? || '%'
                        AND F.PUMBUN_CD = ?
                      GROUP BY F.STR_CD, F.SKU_CD
                     UNION ALL
                     SELECT F.STR_CD                AS STR_CD
                          , F.SKU_CD                AS SKU_CD
                          , 0                       AS SALE_QTY           
                          , 0                       AS TOT_SALE_AMT     
                          , 0                       AS VAT_AMT          
                          , 0                       AS REDU_AMT         
                          , 0                       AS NORM_SALE_AMT    
                          , 0                       AS DC_AMT           
                          , 0                       AS NET_SALE_AMT     
                          , 0                       AS SALE_PROF_AMT    
                          , 0                       AS CUST_CNT
                          , 0                       AS SAL_COST_PRC 
                          , 0                       AS TOT_SALE_AMT_CMPR1
                          , SUM(F.TOT_SALE_AMT)     AS TOT_SALE_AMT_CMPR2
                       FROM DPS.PS_DAYSKU F
                          , DPS.PC_ORGMST G
                      WHERE F.STR_CD        = G.STR_CD
                        AND F.ORG_CD        = G.ORG_CD
                        AND F.STR_CD      = ?
                        AND F.SALE_DT     >= ?
                        AND F.SALE_DT     <= ?
                        AND G.DEPT_CD    = ?
                        AND G.TEAM_CD    = ?
                        AND G.PC_CD      = ?
                        AND G.CORNER_CD LIKE ? || '%'
                        AND F.PUMBUN_CD = ?
                      GROUP BY F.STR_CD, F.SKU_CD
                    ) A
                  , DPS.PC_STRSKUMST    F
              WHERE A.STR_CD     = F.STR_CD
                AND A.SKU_CD     = F.SKU_CD
              GROUP BY
                    A.SKU_CD
                  , F.SKU_NAME
              ORDER BY
                    A.SKU_CD
     ]]>        
     
    </query>
    <query name="SEL_SALE_SKU2">        
        <![CDATA[
        	 SELECT A.SKU_CD                                                          AS ORG_CD
                  , F.SKU_NAME                                                        AS ORG_NAME
                  , 0                                                                 AS ORIGIN_SALE_TAMT
                  , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                  , 0                                                                 AS ACHIEVERATE
                  , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                          ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                     END)                                                             AS TOT_COMP_RATE
                  , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                  , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                  , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                  , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                  , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                      , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                AS PROFRATE
                              , SUM(A.CUST_CNT)                                                                    AS CUST_CNT
                  , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)          AS CUST_DANGA
                  , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                        AS TOT_SALE_AMT_CMPR1
                  , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                          ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                     END)                                                             AS TOT_COMP_RATE_CMPR1
                  , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                     ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                  , 0                                                                 AS TOT_SALE_AMT_CMPR2
                  , 0                                                                 AS TOT_COMP_RATE_CMPR2
                  , 0                                                                 AS SALEIRATE2
                  , 'E' AS SKU_FLAG
               FROM (SELECT A.STR_CD                 AS STR_CD
                          , A.SKU_CD                 AS SKU_CD
                          , SUM(A.SALE_QTY         ) AS SALE_QTY           
                          , SUM(A.TOT_SALE_AMT     ) AS TOT_SALE_AMT     
                          , SUM(A.VAT_AMT          ) AS VAT_AMT          
                          , SUM(A.REDU_AMT         ) AS REDU_AMT         
                          , SUM(A.NORM_SALE_AMT    ) AS NORM_SALE_AMT    
                          , SUM(A.DC_AMT           ) AS DC_AMT           
                          , SUM(A.NET_SALE_AMT     ) AS NET_SALE_AMT     
                          , SUM(A.SALE_PROF_AMT    ) AS SALE_PROF_AMT    
                          , SUM(A.SALE_QTY         ) AS CUST_CNT
                          , SUM(A.SAL_COST_PRC     ) AS SAL_COST_PRC     
                          , 0                        AS TOT_SALE_AMT_CMPR1
                          , 0                        AS TOT_SALE_AMT_CMPR2
                       FROM DPS.PS_DAYSKU    A
                          , DPS.PC_ORGMST    B
                      WHERE A.STR_CD        = B.STR_CD
                        AND A.BUY_ORG_CD        = B.ORG_CD
                        AND B.STR_CD    = ?
                        AND B.DEPT_CD   = ?
                        AND B.TEAM_CD   = ?
                        AND B.PC_CD     = ?
                        AND B.CORNER_CD LIKE ?|| '%'
                        AND A.PUMBUN_CD = ?
                        AND A.SALE_DT   >= ?
                        AND A.SALE_DT   <= ?
                      GROUP BY A.STR_CD, A.SKU_CD
                     UNION ALL
                     SELECT F.STR_CD                AS STR_CD
                          , F.SKU_CD                AS SKU_CD
                          , 0                       AS SALE_QTY           
                          , 0                       AS TOT_SALE_AMT     
                          , 0                       AS VAT_AMT          
                          , 0                       AS REDU_AMT         
                          , 0                       AS NORM_SALE_AMT    
                          , 0                       AS DC_AMT           
                          , 0                       AS NET_SALE_AMT     
                          , 0                       AS SALE_PROF_AMT    
                          , 0                       AS CUST_CNT
                          , 0                       AS SAL_COST_PRC 
                          , SUM(F.TOT_SALE_AMT)     AS TOT_SALE_AMT_CMPR1
                          , 0                       AS TOT_SALE_AMT_CMPR2
                       FROM DPS.PS_DAYSKU F
                          , DPS.PC_ORGMST G
                          , DPS.PS_SCHEDULE    D
                      WHERE F.STR_CD        = G.STR_CD
                        AND F.BUY_ORG_CD        = G.ORG_CD
                        AND D.STR_CD      = ?
                        AND D.SALE_DT     >= ?
                        AND D.SALE_DT     <= ?
                        AND G.DEPT_CD    = ?
                        AND G.TEAM_CD    = ?
                        AND G.PC_CD      = ?
                        AND G.CORNER_CD LIKE ? || '%'
                        AND F.STR_CD    = D.STR_CD
                        AND F.SALE_DT   = D.CMPR_DT
                        AND F.PUMBUN_CD = ?
                      GROUP BY F.STR_CD, F.SKU_CD
                    ) A
                  , DPS.PC_STRSKUMST    F
              WHERE A.STR_CD     = F.STR_CD
                AND A.SKU_CD     = F.SKU_CD
              GROUP BY
                    A.SKU_CD
                  , F.SKU_NAME
              ORDER BY
                    A.SKU_CD
        
    	 ]]>        
    </query>
    
    <query name="SEL_SALE_SKU">        
        <![CDATA[
    		 SELECT A.SKU_CD                                                          AS ORG_CD
                  , F.SKU_NAME                                                        AS ORG_NAME
                  , 0                                                                 AS ORIGIN_SALE_TAMT
                  , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                  , 0                                                                 AS ACHIEVERATE
                  , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                          ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                     END)                                                             AS TOT_COMP_RATE
                  , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                  , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                  , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                  , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                  , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                      , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0 
                             ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                AS PROFRATE
                              , SUM(A.CUST_CNT)                                                                    AS CUST_CNT
                  , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)          AS CUST_DANGA
                  , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                        AS TOT_SALE_AMT_CMPR1
                  , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                          ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                     END)                                                             AS TOT_COMP_RATE_CMPR1
                  , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                     ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                  , 0                                                                 AS TOT_SALE_AMT_CMPR2
                  , 0                                                                 AS TOT_COMP_RATE_CMPR2
                  , 0                                                                 AS SALEIRATE2
                  , 'E' AS SKU_FLAG
               FROM (SELECT A.STR_CD                 AS STR_CD
                          , A.SKU_CD                 AS SKU_CD
                          , SUM(A.SALE_QTY         ) AS SALE_QTY           
                          , SUM(A.TOT_SALE_AMT     ) AS TOT_SALE_AMT     
                          , SUM(A.VAT_AMT          ) AS VAT_AMT          
                          , SUM(A.REDU_AMT         ) AS REDU_AMT         
                          , SUM(A.NORM_SALE_AMT    ) AS NORM_SALE_AMT    
                          , SUM(A.DC_AMT           ) AS DC_AMT           
                          , SUM(A.NET_SALE_AMT     ) AS NET_SALE_AMT     
                          , SUM(A.SALE_PROF_AMT    ) AS SALE_PROF_AMT    
                          , SUM(A.SALE_QTY         ) AS CUST_CNT
                          , SUM(A.SAL_COST_PRC     ) AS SAL_COST_PRC     
                          , 0                        AS TOT_SALE_AMT_CMPR1
                          , 0                        AS TOT_SALE_AMT_CMPR2
                       FROM DPS.PS_DAYSKU    A
                          , DPS.PC_ORGMST    B
                      WHERE A.STR_CD        = B.STR_CD
                        AND A.ORG_CD        = B.ORG_CD
                        AND B.STR_CD    = ?
                        AND B.DEPT_CD   = ?
                        AND B.TEAM_CD   = ?
                        AND B.PC_CD     = ?
                        AND B.CORNER_CD LIKE ?|| '%'
                        AND A.PUMBUN_CD = ?
                        AND A.SALE_DT   >= ?
                        AND A.SALE_DT   <= ?
                      GROUP BY A.STR_CD, A.SKU_CD
                     UNION ALL
                     SELECT F.STR_CD                AS STR_CD
                          , F.SKU_CD                AS SKU_CD
                          , 0                       AS SALE_QTY           
                          , 0                       AS TOT_SALE_AMT     
                          , 0                       AS VAT_AMT          
                          , 0                       AS REDU_AMT         
                          , 0                       AS NORM_SALE_AMT    
                          , 0                       AS DC_AMT           
                          , 0                       AS NET_SALE_AMT     
                          , 0                       AS SALE_PROF_AMT    
                          , 0                       AS CUST_CNT
                          , 0                       AS SAL_COST_PRC 
                          , SUM(F.TOT_SALE_AMT)     AS TOT_SALE_AMT_CMPR1
                          , 0                       AS TOT_SALE_AMT_CMPR2
                       FROM DPS.PS_DAYSKU F
                          , DPS.PC_ORGMST G
                          , DPS.PS_SCHEDULE    D
                      WHERE F.STR_CD        = G.STR_CD
                        AND F.ORG_CD        = G.ORG_CD
                        AND D.STR_CD      = ?
                        AND D.SALE_DT     >= ?
                        AND D.SALE_DT     <= ?
                        AND G.DEPT_CD    = ?
                        AND G.TEAM_CD    = ?
                        AND G.PC_CD      = ?
                        AND G.CORNER_CD LIKE ? || '%'
                        AND F.STR_CD    = D.STR_CD
                        AND F.SALE_DT   = D.CMPR_DT
                        AND F.PUMBUN_CD = ?
                      GROUP BY F.STR_CD, F.SKU_CD
                    ) A
                  , DPS.PC_STRSKUMST    F
              WHERE A.STR_CD     = F.STR_CD
                AND A.SKU_CD     = F.SKU_CD
              GROUP BY
                    A.SKU_CD
                  , F.SKU_NAME
              ORDER BY
                    A.SKU_CD
     ]]>        
    </query>
    
  
        
    
    <query name="SEL_SALE_BRAND4">  
    	 <![CDATA[
    		 SELECT X.ORG_CD
                  , X.ORG_NAME  AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT A.ORG_CD                                                          AS ORG_CD
                          , MAX(A.ORG_NAME)                                                   AS ORG_NAME
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'C'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , A.PUMBUN_CD                         AS ORG_CD
                                , MAX(H.PUMBUN_NAME)                  AS ORG_NAME
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                                , DPS.PC_STRPBN    H
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.BUY_ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND B.CORNER_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                              AND H.STR_CD      = A.STR_CD
                              AND H.PUMBUN_CD   = A.PUMBUN_CD
                            GROUP BY A.STR_CD
                                   , A.PUMBUN_CD
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , F.PUMBUN_CD                   AS ORG_CD  
                                , MAX(H.PUMBUN_NAME)            AS ORG_NAME           
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC    
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG   
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                               FROM DPS.PS_DAYPBN F
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN H 
                              WHERE F.STR_CD      = ?
                                AND F.SALE_DT     >= ?
                                AND F.SALE_DT     <= ?
                                AND G.DEPT_CD      LIKE ? || '%'
                                AND G.TEAM_CD      LIKE ? || '%'
                                AND G.PC_CD        LIKE ? || '%'
                                AND G.CORNER_CD    LIKE ? || '%'
                                AND F.STR_CD      = G.STR_CD
                                AND F.BUY_ORG_CD      = G.ORG_CD
                                AND H.STR_CD      = F.STR_CD
                                AND H.PUMBUN_CD   = F.PUMBUN_CD
                              GROUP BY F.STR_CD 
                                     , F.PUMBUN_CD
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , F.PUMBUN_CD                   AS ORG_CD  
                                , MAX(H.PUMBUN_NAME)            AS ORG_NAME           
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC    
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG   
                                , 0                             AS TOT_SALE_AMT_CMPR1 
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                               FROM DPS.PS_DAYPBN F
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN H 
                              WHERE F.STR_CD      = ?
                                AND F.SALE_DT     >= ?
                                AND F.SALE_DT     <= ?
                                AND G.DEPT_CD      LIKE ? || '%'
                                AND G.TEAM_CD      LIKE ? || '%'
                                AND G.PC_CD        LIKE ? || '%'
                                AND G.CORNER_CD    LIKE ? || '%'
                                AND F.STR_CD      = G.STR_CD
                                AND F.BUY_ORG_CD      = G.ORG_CD
                                AND H.STR_CD      = F.STR_CD
                                AND H.PUMBUN_CD   = F.PUMBUN_CD
                              GROUP BY F.STR_CD 
                                     , F.PUMBUN_CD
                           UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , C.PUMBUN_CD                    AS ORG_CD  
                               , MAX(H.PUMBUN_NAME)             AS ORG_NAME           
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                               , DPS.PC_ORGMST G
                               , DPS.PC_STRPBN H
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                             AND G.DEPT_CD      LIKE ? || '%'
                             AND G.TEAM_CD      LIKE ? || '%'
                             AND G.PC_CD        LIKE ? || '%'
                             AND G.CORNER_CD    LIKE ? || '%'
                             AND C.BUY_ORG_CD   = G.ORG_CD
                             AND H.STR_CD      = C.STR_CD
                             AND H.PUMBUN_CD   = C.PUMBUN_CD
                           GROUP BY C.STR_CD
                                  , C.PUMBUN_CD
                          )                    A
                      GROUP BY A.ORG_CD
                   ) X
              ORDER BY
                    X.ORG_CD 
     	]]>        
    </query>
    
    <query name="SEL_SALE_BRAND3">        
        <![CDATA[
    		 SELECT X.ORG_CD
                  , X.ORG_NAME  AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT A.ORG_CD                                                          AS ORG_CD
                          , MAX(A.ORG_NAME)                                                   AS ORG_NAME
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'C'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , A.PUMBUN_CD                         AS ORG_CD
                                , MAX(H.PUMBUN_NAME)                  AS ORG_NAME
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                                , DPS.PC_STRPBN    H
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND B.CORNER_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                              AND H.STR_CD      = A.STR_CD
                              AND H.PUMBUN_CD   = A.PUMBUN_CD
                            GROUP BY A.STR_CD
                                   , A.PUMBUN_CD
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , F.PUMBUN_CD                   AS ORG_CD  
                                , MAX(H.PUMBUN_NAME)            AS ORG_NAME           
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC    
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG   
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                               FROM DPS.PS_DAYPBN F
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN H 
                              WHERE F.STR_CD      = ?
                                AND F.SALE_DT     >= ?
                                AND F.SALE_DT     <= ?
                                AND G.DEPT_CD      LIKE ? || '%'
                                AND G.TEAM_CD      LIKE ? || '%'
                                AND G.PC_CD        LIKE ? || '%'
                                AND G.CORNER_CD    LIKE ? || '%'
                                AND F.STR_CD      = G.STR_CD
                                AND F.ORG_CD      = G.ORG_CD
                                AND H.STR_CD      = F.STR_CD
                                AND H.PUMBUN_CD   = F.PUMBUN_CD
                              GROUP BY F.STR_CD 
                                     , F.PUMBUN_CD
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , F.PUMBUN_CD                   AS ORG_CD  
                                , MAX(H.PUMBUN_NAME)            AS ORG_NAME           
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC    
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG   
                                , 0                             AS TOT_SALE_AMT_CMPR1 
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                               FROM DPS.PS_DAYPBN F
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN H 
                              WHERE F.STR_CD      = ?
                                AND F.SALE_DT     >= ?
                                AND F.SALE_DT     <= ?
                                AND G.DEPT_CD      LIKE ? || '%'
                                AND G.TEAM_CD      LIKE ? || '%'
                                AND G.PC_CD        LIKE ? || '%'
                                AND G.CORNER_CD    LIKE ? || '%'
                                AND F.STR_CD      = G.STR_CD
                                AND F.ORG_CD      = G.ORG_CD
                                AND H.STR_CD      = F.STR_CD
                                AND H.PUMBUN_CD   = F.PUMBUN_CD
                              GROUP BY F.STR_CD 
                                     , F.PUMBUN_CD
                           UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , C.PUMBUN_CD                    AS ORG_CD  
                               , MAX(H.PUMBUN_NAME)             AS ORG_NAME           
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                               , DPS.PC_ORGMST G
                               , DPS.PC_STRPBN H
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                             AND G.DEPT_CD      LIKE ? || '%'
                             AND G.TEAM_CD      LIKE ? || '%'
                             AND G.PC_CD        LIKE ? || '%'
                             AND G.CORNER_CD    LIKE ? || '%'
                             AND C.SALE_ORG_CD   = G.ORG_CD
                             AND H.STR_CD      = C.STR_CD
                             AND H.PUMBUN_CD   = C.PUMBUN_CD
                           GROUP BY C.STR_CD
                                  , C.PUMBUN_CD
                          )                    A
                      GROUP BY A.ORG_CD
                   ) X
              ORDER BY
                    X.ORG_CD 
        ]]>        
    </query>
    
    <query name="SEL_SALE_BRAND2">        
        <![CDATA[
    		 SELECT X.ORG_CD
                  , X.ORG_NAME  AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT A.ORG_CD                                                          AS ORG_CD
                          , MAX(A.ORG_NAME)                                                   AS ORG_NAME
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'C'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , A.PUMBUN_CD                         AS ORG_CD
                                , MAX(H.PUMBUN_NAME)                  AS ORG_NAME
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                                , DPS.PC_STRPBN    H
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.BUY_ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND B.CORNER_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                              AND H.STR_CD      = A.STR_CD
                              AND H.PUMBUN_CD   = A.PUMBUN_CD
                            GROUP BY A.STR_CD
                                   , A.PUMBUN_CD
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , F.PUMBUN_CD                   AS ORG_CD  
                                , MAX(H.PUMBUN_NAME)            AS ORG_NAME           
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC    
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG   
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                               FROM DPS.PS_DAYPBN F
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN H 
                                  , DPS.PS_SCHEDULE    D
                              WHERE D.STR_CD      = ?
                                AND D.SALE_DT     >= ?
                                AND D.SALE_DT     <= ?
                                AND G.DEPT_CD      LIKE ? || '%'
                                AND G.TEAM_CD      LIKE ? || '%'
                                AND G.PC_CD        LIKE ? || '%'
                                AND G.CORNER_CD    LIKE ? || '%'
                                AND F.STR_CD      = G.STR_CD
                                AND F.BUY_ORG_CD      = G.ORG_CD
                                AND F.STR_CD      = D.STR_CD
                                AND F.SALE_DT     = D.CMPR_DT
                                AND H.STR_CD      = F.STR_CD
                                AND H.PUMBUN_CD   = F.PUMBUN_CD
                              GROUP BY F.STR_CD 
                                     , F.PUMBUN_CD
                           UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , C.PUMBUN_CD                    AS ORG_CD  
                               , MAX(H.PUMBUN_NAME)             AS ORG_NAME           
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                               , DPS.PC_ORGMST G
                               , DPS.PC_STRPBN H
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                             AND G.DEPT_CD      LIKE ? || '%'
                             AND G.TEAM_CD      LIKE ? || '%'
                             AND G.PC_CD        LIKE ? || '%'
                             AND G.CORNER_CD    LIKE ? || '%'
                             AND C.BUY_ORG_CD   = G.ORG_CD
                             AND H.STR_CD      = C.STR_CD
                             AND H.PUMBUN_CD   = C.PUMBUN_CD
                           GROUP BY C.STR_CD
                                  , C.PUMBUN_CD
                          )                    A
                      GROUP BY A.ORG_CD
                   ) X
              ORDER BY
                    X.ORG_CD
    ]]>        
    </query>
    <query name="SEL_SALE_BRAND">        
        <![CDATA[
        	 SELECT X.ORG_CD
                  , X.ORG_NAME  AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT A.ORG_CD                                                          AS ORG_CD
                          , MAX(A.ORG_NAME)                                                   AS ORG_NAME
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'C'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , A.PUMBUN_CD                         AS ORG_CD
                                , MAX(H.PUMBUN_NAME)                  AS ORG_NAME
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                                , DPS.PC_STRPBN    H
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND B.CORNER_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                              AND H.STR_CD      = A.STR_CD
                              AND H.PUMBUN_CD   = A.PUMBUN_CD
                            GROUP BY A.STR_CD
                                   , A.PUMBUN_CD
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , F.PUMBUN_CD                   AS ORG_CD  
                                , MAX(H.PUMBUN_NAME)            AS ORG_NAME           
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC    
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG   
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                               FROM DPS.PS_DAYPBN F
                                  , DPS.PC_ORGMST G
                                  , DPS.PC_STRPBN H 
                                  , DPS.PS_SCHEDULE    D
                              WHERE D.STR_CD      = ?
                                AND D.SALE_DT     >= ?
                                AND D.SALE_DT     <= ?
                                AND G.DEPT_CD      LIKE ? || '%'
                                AND G.TEAM_CD      LIKE ? || '%'
                                AND G.PC_CD        LIKE ? || '%'
                                AND G.CORNER_CD    LIKE ? || '%'
                                AND F.STR_CD      = G.STR_CD
                                AND F.ORG_CD      = G.ORG_CD
                                AND F.STR_CD      = D.STR_CD
                                AND F.SALE_DT     = D.CMPR_DT
                                AND H.STR_CD      = F.STR_CD
                                AND H.PUMBUN_CD   = F.PUMBUN_CD
                              GROUP BY F.STR_CD 
                                     , F.PUMBUN_CD
                           UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , C.PUMBUN_CD                    AS ORG_CD  
                               , MAX(H.PUMBUN_NAME)             AS ORG_NAME           
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                                , MAX(H.SKU_FLAG)                     AS SKU_FLAG
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                               , DPS.PC_ORGMST G
                               , DPS.PC_STRPBN H
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                             AND G.DEPT_CD      LIKE ? || '%'
                             AND G.TEAM_CD      LIKE ? || '%'
                             AND G.PC_CD        LIKE ? || '%'
                             AND G.CORNER_CD    LIKE ? || '%'
                             AND C.SALE_ORG_CD   = G.ORG_CD
                             AND H.STR_CD      = C.STR_CD
                             AND H.PUMBUN_CD   = C.PUMBUN_CD
                           GROUP BY C.STR_CD
                                  , C.PUMBUN_CD
                          )                    A
                      GROUP BY A.ORG_CD
                   ) X
              ORDER BY
                    X.ORG_CD
         ]]>        
    </query>
 
    
    <query name="SEL_SALE_CORNER4">        
        <![CDATA[
    		
        ]]>        
    </query>
    
    
    
    
    
    <query name="SEL_SALE_CORNER3">        
        <![CDATA[
    		  SELECT X.ORG_CD
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD) AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT A.ORG_CD                                                          AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'C'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , A.ORG_CD                            AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , A.ORG_CD
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , F.ORG_CD                      AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간1(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간1(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , F.ORG_CD
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , F.ORG_CD                      AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , 0                             AS TOT_SALE_AMT_CMPR1 
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                            FROM DPS.PS_DAYPBN F
                               , DPS.PC_ORGMST G
                           WHERE F.STR_CD      = ?   -- 점 
                             AND F.SALE_DT     >= ?  -- 대비기간2(시작)
                             AND F.SALE_DT     <= ?  -- 대비기간2(종료)
                             AND G.DEPT_CD  LIKE ? || '%'
                             AND G.TEAM_CD  LIKE ? || '%'
                             AND G.PC_CD    LIKE ? || '%'
                             AND F.STR_CD      = G.STR_CD
                             AND F.ORG_CD      = G.ORG_CD
                           GROUP BY F.STR_CD
                                  , F.ORG_CD
                          UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , C.SALE_ORG_CD                  AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , C.SALE_ORG_CD
                          )                    A
                      GROUP BY A.ORG_CD
                   ) X
              ORDER BY
                    X.ORG_CD
        ]]>        
    </query>
    
    
     <query name="SEL_SALE_CORNER2">        
        <![CDATA[
    		
        ]]>        
    </query>
    
    
    
    
    <query name="SEL_SALE_CORNER">        
        <![CDATA[
             SELECT X.ORG_CD
                  , (SELECT ORG_SHORT_NAME FROM DPS.PC_ORGMST WHERE ORG_CD =  X.ORG_CD) AS ORG_NAME
                  , X.ORIGIN_SALE_TAMT
                  , X.TOT_SALE_AMT
                  , X.ACHIEVERATE
                  , X.TOT_COMP_RATE
                  , X.REDU_AMT
                  , X.NORM_SALE_AMT
                  , X.DC_AMT
                  , X.NET_SALE_AMT
                  , X.SALE_PROF_AMT
                  , X.PROFRATE
                  , X.CUST_CNT
                  , X.CUST_DANGA
                  , X.TOT_SALE_AMT_CMPR1
                  , X.TOT_COMP_RATE_CMPR1
                  , X.SALEIRATE1
                  , X.TOT_SALE_AMT_CMPR2
                  , X.TOT_COMP_RATE_CMPR2
                  , X.SALEIRATE2
                  , X.SKU_FLAG
              FROM ( SELECT A.ORG_CD                                                          AS ORG_CD
                          , SUM(NVL(A.ORIGIN_SALE_TAMT,0))                                    AS ORIGIN_SALE_TAMT
                          , SUM(NVL(A.TOT_SALE_AMT,0))                                        AS TOT_SALE_AMT
                          , SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()                           AS SUM_TOT_SALE_AMT
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))                                  AS TOT_SALE_AMT_CMPR1
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()                     AS SUM_TOT_SALE_AMT_CMPR1
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR1,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR1
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR1,0)))*100 END)   AS SALEIRATE1
                          , SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))                                               AS TOT_SALE_AMT_CMPR2
                          , SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()                                  AS SUM_TOT_SALE_AMT_CMPR2
                          , (CASE WHEN (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ()) = 0 THEN 0
                                  ELSE (SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) / (SUM(SUM(NVL(A.TOT_SALE_AMT_CMPR2,0))) OVER ())*100)
                             END)                                                             AS TOT_COMP_RATE_CMPR2
                          , (CASE WHEN  SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)) = 0 THEN 0
                             ELSE  ((SUM(NVL(A.TOT_SALE_AMT,0))- SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))/SUM(NVL(A.TOT_SALE_AMT_CMPR2,0)))*100 END)   AS SALEIRATE2
                          , (CASE WHEN SUM(NVL(A.ORIGIN_SALE_TAMT,0))  = 0 THEN 0
                             ELSE    ( SUM(NVL(A.TOT_SALE_AMT,0))/SUM(NVL(A.ORIGIN_SALE_TAMT,0)))*100 END)                          AS ACHIEVERATE
                          , SUM(NVL(A.REDU_AMT,0))                                            AS REDU_AMT
                          , SUM(NVL(A.NORM_SALE_AMT,0))                                       AS NORM_SALE_AMT
                          , SUM(NVL(A.DC_AMT,0))                                              AS DC_AMT
                          , SUM(NVL(A.NET_SALE_AMT,0))                                        AS NET_SALE_AMT
                          , SUM(NVL(A.SALE_PROF_AMT,0))                                       AS SALE_PROF_AMT
                          , (CASE WHEN SUM(NVL(A.TOT_SALE_AMT,0)) = 0 THEN 0
                                  ELSE (SUM(NVL(A.SALE_PROF_AMT,0))/SUM(NVL(A.TOT_SALE_AMT,0)))*100 END)                            AS PROFRATE
                          , SUM(A.CUST_CNT)                                                   AS CUST_CNT
                          , (CASE WHEN SUM(A.CUST_CNT) = 0 THEN 0 ELSE (SUM(A.TOT_SALE_AMT)/SUM(A.CUST_CNT)) END)                   AS CUST_DANGA
                          , 'C'   AS SKU_FLAG
                     FROM (SELECT 
                                  A.STR_CD                            AS STR_CD
                                , A.ORG_CD                            AS ORG_CD
                                , SUM(A.SALE_QTY)                     AS SALE_QTY
                                , SUM(A.TOT_SALE_AMT)                 AS TOT_SALE_AMT
                                , SUM(A.VAT_AMT)                      AS VAT_AMT
                                , SUM(A.REDU_AMT)                     AS REDU_AMT
                                , SUM(A.NORM_SALE_AMT)                AS NORM_SALE_AMT
                                , SUM(A.DC_AMT)                       AS DC_AMT
                                , SUM(A.NET_SALE_AMT)                 AS NET_SALE_AMT
                                , SUM(A.SALE_PROF_AMT)                AS SALE_PROF_AMT
                                , SUM(A.CUST_CNT)                     AS CUST_CNT
                                , SUM(A.SAL_COST_PRC)                 AS SAL_COST_PRC
                                , 0                                   AS TOT_SALE_AMT_CMPR1
                                , 0                                   AS TOT_SALE_AMT_CMPR2
                                , 0                                   AS ORIGIN_SALE_TAMT
                             FROM DPS.PS_DAYPBN    A
                                , DPS.PC_ORGMST    B
                            WHERE A.STR_CD      = B.STR_CD
                              AND A.ORG_CD      = B.ORG_CD
                              AND B.STR_CD      = ?    -- 점 
                              AND B.DEPT_CD  LIKE ? || '%'
                              AND B.TEAM_CD  LIKE ? || '%'
                              AND B.PC_CD    LIKE ? || '%'
                              AND A.SALE_DT     >= ?  -- 매출기간(시작)
                              AND A.SALE_DT     <= ?  -- 매출기간(종료)
                            GROUP BY A.STR_CD
                                   , A.ORG_CD
                           UNION ALL
                           SELECT 
                                  F.STR_CD                      AS STR_CD             
                                , F.ORG_CD                      AS ORG_CD             
                                , 0                             AS SALE_QTY           
                                , 0                             AS TOT_SALE_AMT       
                                , 0                             AS VAT_AMT            
                                , 0                             AS REDU_AMT           
                                , 0                             AS NORM_SALE_AMT      
                                , 0                             AS DC_AMT             
                                , 0                             AS NET_SALE_AMT       
                                , 0                             AS SALE_PROF_AMT      
                                , 0                             AS CUST_CNT           
                                , 0                             AS SAL_COST_PRC       
                                , SUM(NVL(F.TOT_SALE_AMT,0))    AS TOT_SALE_AMT_CMPR1 
                                , 0                             AS TOT_SALE_AMT_CMPR2 
                                , 0                             AS ORIGIN_SALE_TAMT   
                               FROM DPS.PS_DAYPBN F
                                  , DPS.PC_ORGMST G
                                  , DPS.PS_SCHEDULE    D
                              WHERE D.STR_CD      = ?
                                AND D.SALE_DT     >= ?
                                AND D.SALE_DT     <= ?
                                AND G.STR_CD      = ?
                                AND G.DEPT_CD  LIKE ? || '%'
                                AND G.TEAM_CD  LIKE ? || '%'
                                AND G.PC_CD    LIKE ? || '%'
                                AND F.STR_CD      = G.STR_CD
                                AND F.ORG_CD      = G.ORG_CD
                                AND F.STR_CD      = D.STR_CD
                                AND F.SALE_DT     = D.CMPR_DT
                              GROUP BY F.STR_CD 
                                     , F.ORG_CD
                           UNION ALL
                          SELECT 
                                 C.STR_CD                       AS STR_CD            
                               , C.SALE_ORG_CD                  AS ORG_CD            
                               , 0                              AS SALE_QTY          
                               , 0                              AS TOT_SALE_AMT      
                               , 0                              AS VAT_AMT           
                               , 0                              AS REDU_AMT          
                               , 0                              AS NORM_SALE_AMT     
                               , 0                              AS DC_AMT            
                               , 0                              AS NET_SALE_AMT      
                               , 0                              AS SALE_PROF_AMT     
                               , 0                              AS CUST_CNT          
                               , 0                              AS SAL_COST_PRC      
                               , 0                              AS TOT_SALE_AMT_CMPR1
                               , 0                              AS TOT_SALE_AMT_CMPR2
                               , SUM(NVL(C.ORIGIN_SALE_TAMT,0)) AS ORIGIN_SALE_TAMT  
                            FROM DPS.PS_ACTPUMBUN C
                           WHERE C.STR_CD = ?
                             AND C.EXE_DT >= ?  -- 매출기간(시작)
                             AND C.EXE_DT >= ?  -- 매출기간(종료)
                           GROUP BY C.STR_CD
                                  , C.SALE_ORG_CD
                          )                    A
                      GROUP BY A.ORG_CD
                   ) X
              ORDER BY
                    X.ORG_CD
        ]]>        
    </query>

    <query name="SEL_CMPRDT">       
        <![CDATA[
            SELECT CMPR_DT                
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>        
    </query>
    
     <query name="SEARCH_CMPR_DATE">
        <![CDATA[
          SELECT NVL(MAX(CMPR_DT), TO_CHAR(ADD_MONTHS(TO_DATE(?, 'YYYYMMDD'),-12), 'YYYYMMDD'))
              FROM DPS.PS_SCHEDULE
             WHERE STR_CD  = ?
               AND SALE_DT = ?
        ]]>    
    </query>
    
</service>