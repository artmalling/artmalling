<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 정진영
 * 회 사 명 : FKSS
 * 작 성 일 : 2010.02.08
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  조직/바이어(SM)를 관리한다.
 -->
<service name="/pcod002.pc">

    <!-- 조직 트리 -->  
    <gauce name="H_SEL_MASTER">
        <column colName="TXT"            colType="TB_STRING"  size="42"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TMP_ORG_CD"     colType="TB_STRING"  size="11"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="LVL"            colType="TB_DECIMAL" size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EDIT_YN"        colType="TB_DECIMAL" size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_CD"         colType="TB_STRING"  size="10"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_NAME"       colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_SHORT_NAME" colType="TB_STRING"  size="20"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_FLAG"       colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_FLAG_NM"    colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_LEVEL"      colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STR_CD"         colType="TB_STRING"  size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DEPT_CD"        colType="TB_STRING"  size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TEAM_CD"        colType="TB_STRING"  size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PC_CD"          colType="TB_STRING"  size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CORNER_CD"      colType="TB_STRING"  size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="P_ORG_CD"       colType="TB_STRING"  size="10"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="FRST_ORG_CD"    colType="TB_STRING"  size="10"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SAP_ORG_CD"     colType="TB_STRING"  size="10"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BF_ORG_CD"      colType="TB_STRING"  size="10"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MNG_ORG_YN"     colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EMP_CNT"        colType="TB_DECIMAL" size="3"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AREA_SIZE"      colType="TB_DECIMAL" size="7"    dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="APP_S_DT"       colType="TB_STRING"  size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="APP_E_DT"       colType="TB_STRING"  size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="USE_YN"         colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BF_ORG_NAME"    colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SAP_ORG_NAME"   colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SORT_ORDER"     colType="TB_DECIMAL" size="5"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUDGET_YN"      colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="KOSTL_CD"       colType="TB_STRING"  size="10"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="KOSTL_NAME"     colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    <!-- 바이어 정보 그리드 -->  
    <gauce name="H_SEL_BUYER_MASTER">
        <column colName="BUYER_CD"    colType="TB_STRING" size="6"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_NAME"  colType="TB_STRING" size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EMP_NO"      colType="TB_STRING" size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EMP_NM"      colType="TB_STRING" size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MAIN_FLAG"   colType="TB_STRING" size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_FLAG"  colType="TB_STRING" size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_FLAG"    colType="TB_STRING" size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STR_CD"      colType="TB_STRING" size="2"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TEAM_CD"     colType="TB_STRING" size="2"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PC_ORG_CD"   colType="TB_STRING" size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="USE_YN"      colType="TB_STRING" size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    <!-- 바이어 담당자 정보 그리드 -->  
    <gauce name="H_SEL_BUYER_DETAIL">
        <column colName="BUYER_CD"      colType="TB_STRING" size="6"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_NAME"    colType="TB_STRING" size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EMP_NO"        colType="TB_STRING" size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EMP_NM"        colType="TB_STRING" size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="APP_S_DT"      colType="TB_STRING" size="8"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="APP_E_DT"      colType="TB_STRING" size="8"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STR_CD"        colType="TB_STRING" size="2"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TEAM_CD"       colType="TB_STRING" size="2"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PC_ORG_CD"     colType="TB_STRING" size="10"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="USE_YN"        colType="TB_STRING" size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="OLD_APP_S_DT"  colType="TB_STRING" size="8"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    <!-- 쿼리는 전부 대문자 -->
    <!-- 조직 마스터 트리 조회 -->    
    <query name="SEL_TREE_ORGMST">
        <![CDATA[
            SELECT DISTINCT                   
                   '('||DECODE(ORG.LVL,0,ORG.STR_CD,1,ORG.ORG_FLAG,2,ORG.DEPT_CD,3,ORG.TEAM_CD,4,ORG.PC_CD,5,ORG.CORNER_CD)||') '||ORG.ORG_SHORT_NAME  AS TXT
                 , ORG.TMP_ORG_CD     , ORG.LVL         , ORG.EDIT_YN     , ORG.ORG_CD     , ORG.ORG_NAME
                 , ORG.ORG_SHORT_NAME , ORG.ORG_FLAG    , ORG.ORG_FLAG_NM , ORG.ORG_LEVEL  , ORG.STR_CD
                 , ORG.DEPT_CD        , ORG.TEAM_CD     , ORG.PC_CD       , ORG.CORNER_CD  , ORG.P_ORG_CD
                 , ORG.FRST_ORG_CD    , ORG.SAP_ORG_CD  , ORG.BF_ORG_CD   , ORG.MNG_ORG_YN
                 , ORG.EMP_CNT        , ORG.AREA_SIZE   , ORG.APP_S_DT    , ORG.APP_E_DT   , ORG.USE_YN 
                 , BFORG.ORG_NAME AS BF_ORG_NAME        , COM.FN_GET_COMM_NAME('D', 'P043', ORG.SAP_ORG_CD) AS SAP_ORG_NAME
                 , ORG.SORT_ORDER     , ORG.BUDGET_YN
                 , ORG.KOSTL_CD       , COM.FN_GET_COMM_NAME('D', 'P096', ORG.KOSTL_CD)  AS KOSTL_NAME
              FROM (
        ]]>
    </query>
    <query name="SEL_TREE_ORGMST_UP_S">
        <![CDATA[
                    SELECT TMP_ORG_CD     , LVL         , EDIT_YN     , ORG_CD     , ORG_NAME
                         , ORG_SHORT_NAME , ORG_FLAG    , ORG_FLAG_NM , ORG_LEVEL  , STR_CD
                         , DEPT_CD        , TEAM_CD     , PC_CD       , CORNER_CD  , P_ORG_CD
                         , FRST_ORG_CD    , SAP_ORG_CD  , BF_ORG_CD   , MNG_ORG_YN
                         , EMP_CNT        , AREA_SIZE   , APP_S_DT    , APP_E_DT   , USE_YN 
                         , SORT_ORDER     , BUDGET_YN   , KOSTL_CD  
                      FROM (
                            SELECT ORG.STR_CD||0||ORG.DEPT_CD||ORG.TEAM_CD||ORG.PC_CD||ORG.CORNER_CD  AS TMP_ORG_CD
                                 , SUBSTR(ORG.ORG_CD,0,2)||'0'||SUBSTR(ORG.ORG_CD,3)                  AS LVL_ORG_CD
                                 , ORG.P_ORG_CD                                                       AS LVL_P_ORG_CD
                                 , 0               AS LVL
                                 , 0               AS EDIT_YN
                                 , ''              AS ORG_FLAG_NM
                                 , ORG.ORG_CD    , ORG.ORG_NAME    , ORG.ORG_SHORT_NAME    , '0' AS ORG_FLAG , ORG.ORG_LEVEL
                                 , ORG.STR_CD    , ORG.DEPT_CD     , ORG.TEAM_CD           , ORG.PC_CD       , ORG.CORNER_CD
                                 , ORG.P_ORG_CD  , ORG.FRST_ORG_CD , ORG.SAP_ORG_CD        , ORG.BF_ORG_CD   , ORG.MNG_ORG_YN
                                                 , ORG.EMP_CNT     , ORG.AREA_SIZE         , ORG.APP_S_DT    , ORG.APP_E_DT
                                 , ORG.USE_YN    , ORG.SORT_ORDER  , ORG.BUDGET_YN         , ORG.KOSTL_CD
                              FROM DPS.PC_ORGMST ORG
                             WHERE ORG.ORG_LEVEL <= 1
                             UNION ALL
                            SELECT ORG.STR_CD||COMN.COMM_CODE||ORG.DEPT_CD||ORG.TEAM_CD||ORG.PC_CD||ORG.CORNER_CD  AS TMP_ORG_CD
                                 , SUBSTR(ORG.ORG_CD,0,2)||COMN.COMM_CODE||SUBSTR(ORG.ORG_CD,3)                    AS LVL_ORG_CD
                                 , SUBSTR(ORG.ORG_CD,0,2)||'0'||SUBSTR(ORG.ORG_CD,3)                               AS LVL_P_ORG_CD
                                 , 1 AS LVL
                                 , 0               AS EDIT_YN
                                 , COMN.COMM_NAME1 AS ORG_FLAG_NM
                                 , ORG.ORG_CD    , COMN.COMM_NAME1  AS ORG_NAME  , COMN.COMM_NAME1 AS ORG_SHORT_NAME    , COMN.COMM_CODE  , ORG.ORG_LEVEL
                                 , ORG.STR_CD    , ORG.DEPT_CD                   , ORG.TEAM_CD                          , ORG.PC_CD       , ORG.CORNER_CD
                                 , ORG.P_ORG_CD  , ORG.FRST_ORG_CD               , ORG.SAP_ORG_CD                       , ORG.BF_ORG_CD   , ORG.MNG_ORG_YN
                                                 , ORG.EMP_CNT                   , ORG.AREA_SIZE                        , ORG.APP_S_DT    , ORG.APP_E_DT
                                 , ORG.USE_YN    , ORG.SORT_ORDER                , ORG.BUDGET_YN                        , ORG.KOSTL_CD
                              FROM DPS.PC_ORGMST ORG
                                 , COM.TC_COMMCODE COMN
                             WHERE ORG.ORG_LEVEL <= 1
                               AND COMN.SYS_PART = 'D'
                               AND COMN.COMM_PART = 'P047'
                               AND COMN.USE_YN = 'Y'
                             UNION ALL
                            SELECT ORG.STR_CD||ORG.ORG_FLAG||ORG.DEPT_CD||ORG.TEAM_CD||ORG.PC_CD||ORG.CORNER_CD       AS TMP_ORG_CD
                                 , SUBSTR(ORG.ORG_CD,0,2)||ORG.ORG_FLAG||SUBSTR(ORG.ORG_CD,3)                         AS LVL_ORG_CD 
                                 , SUBSTR(ORG.P_ORG_CD,0,2)||ORG.ORG_FLAG||SUBSTR(ORG.P_ORG_CD,3)                     AS LVL_P_ORG_CD
                                 , DECODE(ORG.TEAM_CD,'00',2,DECODE(ORG.PC_CD,'00',3,DECODE(ORG.CORNER_CD,'00',4,5))) AS LVL
                                 , 1               AS EDIT_YN
                                 , COMN.COMM_NAME1 AS ORG_FLAG_NM
                                 , ORG.ORG_CD    , ORG.ORG_NAME    , ORG.ORG_SHORT_NAME    , ORG.ORG_FLAG    , ORG.ORG_LEVEL
                                 , ORG.STR_CD    , ORG.DEPT_CD     , ORG.TEAM_CD           , ORG.PC_CD       , ORG.CORNER_CD
                                 , ORG.P_ORG_CD  , ORG.FRST_ORG_CD , ORG.SAP_ORG_CD        , ORG.BF_ORG_CD   , ORG.MNG_ORG_YN
                                                 , ORG.EMP_CNT     , ORG.AREA_SIZE         , ORG.APP_S_DT    , ORG.APP_E_DT
                                 , ORG.USE_YN    , ORG.SORT_ORDER  , ORG.BUDGET_YN         , ORG.KOSTL_CD
                              FROM DPS.PC_ORGMST ORG
                                 , COM.TC_COMMCODE COMN
                             WHERE ORG_LEVEL > 1
                               AND ORG.ORG_FLAG = COMN.COMM_CODE
                               AND COMN.SYS_PART = 'D'
                               AND COMN.COMM_PART = 'P047'
                               AND COMN.USE_YN = 'Y'
                           )
                     START WITH STR_CD   = ?
        ]]>
    </query>
    <query name="SEL_TREE_ORGMST_UP_E">
        <![CDATA[
                   CONNECT BY PRIOR LVL_P_ORG_CD = LVL_ORG_CD
        ]]>                  
    </query>
    <query name="SEL_TREE_ORGMST_DOWN_S">
        <![CDATA[
                     UNION ALL
                    SELECT TMP_ORG_CD     , LVL         , EDIT_YN     , ORG_CD     , ORG_NAME
                         , ORG_SHORT_NAME , ORG_FLAG    , ORG_FLAG_NM , ORG_LEVEL  , STR_CD
                         , DEPT_CD        , TEAM_CD     , PC_CD       , CORNER_CD  , P_ORG_CD
                         , FRST_ORG_CD    , SAP_ORG_CD  , BF_ORG_CD   , MNG_ORG_YN
                         , EMP_CNT        , AREA_SIZE   , APP_S_DT    , APP_E_DT   , USE_YN 
                         , SORT_ORDER     , BUDGET_YN   , KOSTL_CD  
                      FROM (
                            SELECT ORG.STR_CD||0||ORG.DEPT_CD||ORG.TEAM_CD||ORG.PC_CD||ORG.CORNER_CD  AS TMP_ORG_CD
                                 , SUBSTR(ORG.ORG_CD,0,2)||'0'||SUBSTR(ORG.ORG_CD,3)                  AS LVL_ORG_CD
                                 , ORG.P_ORG_CD                                                       AS LVL_P_ORG_CD
                                 , 0               AS LVL
                                 , 0               AS EDIT_YN
                                 , ''              AS ORG_FLAG_NM
                                 , ORG.ORG_CD    , ORG.ORG_NAME    , ORG.ORG_SHORT_NAME    , '0' AS ORG_FLAG , ORG.ORG_LEVEL
                                 , ORG.STR_CD    , ORG.DEPT_CD     , ORG.TEAM_CD           , ORG.PC_CD       , ORG.CORNER_CD
                                 , ORG.P_ORG_CD  , ORG.FRST_ORG_CD , ORG.SAP_ORG_CD        , ORG.BF_ORG_CD   , ORG.MNG_ORG_YN
                                                 , ORG.EMP_CNT     , ORG.AREA_SIZE         , ORG.APP_S_DT    , ORG.APP_E_DT
                                 , ORG.USE_YN    , ORG.SORT_ORDER  , ORG.BUDGET_YN         , ORG.KOSTL_CD
                              FROM DPS.PC_ORGMST ORG
                             WHERE ORG.ORG_LEVEL <= 1
                             UNION ALL
                            SELECT ORG.STR_CD||COMN.COMM_CODE||ORG.DEPT_CD||ORG.TEAM_CD||ORG.PC_CD||ORG.CORNER_CD  AS TMP_ORG_CD
                                 , SUBSTR(ORG.ORG_CD,0,2)||COMN.COMM_CODE||SUBSTR(ORG.ORG_CD,3)                    AS LVL_ORG_CD
                                 , SUBSTR(ORG.ORG_CD,0,2)||'0'||SUBSTR(ORG.ORG_CD,3)                               AS LVL_P_ORG_CD
                                 , 1 AS LVL
                                 , 0               AS EDIT_YN
                                 , COMN.COMM_NAME1 AS ORG_FLAG_NM
                                 , ORG.ORG_CD    , COMN.COMM_NAME1  AS ORG_NAME  , COMN.COMM_NAME1 AS ORG_SHORT_NAME    , COMN.COMM_CODE  , ORG.ORG_LEVEL
                                 , ORG.STR_CD    , ORG.DEPT_CD                   , ORG.TEAM_CD                          , ORG.PC_CD       , ORG.CORNER_CD
                                 , ORG.P_ORG_CD  , ORG.FRST_ORG_CD               , ORG.SAP_ORG_CD                       , ORG.BF_ORG_CD   , ORG.MNG_ORG_YN
                                                 , ORG.EMP_CNT                   , ORG.AREA_SIZE                        , ORG.APP_S_DT    , ORG.APP_E_DT
                                 , ORG.USE_YN    , ORG.SORT_ORDER                , ORG.BUDGET_YN                        , ORG.KOSTL_CD
                              FROM DPS.PC_ORGMST ORG
                                 , COM.TC_COMMCODE COMN
                             WHERE ORG.ORG_LEVEL <= 1
                               AND COMN.SYS_PART = 'D'
                               AND COMN.COMM_PART = 'P047'
                               AND COMN.USE_YN = 'Y'
                             UNION ALL
                            SELECT ORG.STR_CD||ORG.ORG_FLAG||ORG.DEPT_CD||ORG.TEAM_CD||ORG.PC_CD||ORG.CORNER_CD       AS TMP_ORG_CD
                                 , SUBSTR(ORG.ORG_CD,0,2)||ORG.ORG_FLAG||SUBSTR(ORG.ORG_CD,3)                         AS LVL_ORG_CD 
                                 , SUBSTR(ORG.P_ORG_CD,0,2)||ORG.ORG_FLAG||SUBSTR(ORG.P_ORG_CD,3)                     AS LVL_P_ORG_CD
                                 , DECODE(ORG.TEAM_CD,'00',2,DECODE(ORG.PC_CD,'00',3,DECODE(ORG.CORNER_CD,'00',4,5))) AS LVL
                                 , 1               AS EDIT_YN
                                 , COMN.COMM_NAME1 AS ORG_FLAG_NM
                                 , ORG.ORG_CD    , ORG.ORG_NAME    , ORG.ORG_SHORT_NAME    , ORG.ORG_FLAG    , ORG.ORG_LEVEL
                                 , ORG.STR_CD    , ORG.DEPT_CD     , ORG.TEAM_CD           , ORG.PC_CD       , ORG.CORNER_CD
                                 , ORG.P_ORG_CD  , ORG.FRST_ORG_CD , ORG.SAP_ORG_CD        , ORG.BF_ORG_CD   , ORG.MNG_ORG_YN
                                                 , ORG.EMP_CNT     , ORG.AREA_SIZE         , ORG.APP_S_DT    , ORG.APP_E_DT
                                 , ORG.USE_YN    , ORG.SORT_ORDER  , ORG.BUDGET_YN         , ORG.KOSTL_CD
                              FROM DPS.PC_ORGMST ORG
                                 , COM.TC_COMMCODE COMN
                             WHERE ORG_LEVEL > 1
                               AND ORG.ORG_FLAG = COMN.COMM_CODE
                               AND COMN.SYS_PART = 'D'
                               AND COMN.COMM_PART = 'P047'
                               AND COMN.USE_YN = 'Y'
                           )
                     START WITH STR_CD   = ?
        ]]>
    </query>
    <query name="SEL_TREE_ORGMST_DOWN_E">
        <![CDATA[
                   CONNECT BY PRIOR LVL_ORG_CD = LVL_P_ORG_CD
        ]]>
    </query>
    <query name="SEL_TREE_ORGMST_WHERE_ORG_FLAG">
        <![CDATA[
                            AND ORG_FLAG = ?
        ]]>
    </query>
    <query name="SEL_TREE_ORGMST_WHERE_USE_YN">
        <![CDATA[
                            AND USE_YN   = ? 
        ]]>
    </query>
    <query name="SEL_TREE_ORGMST_WHERE_ORG_CD">
        <![CDATA[
                            AND ORG_CD   LIKE ?||'%'
        ]]>
    </query>
    <query name="SEL_TREE_ORGMST_WHERE_ORG_NAME">
        <![CDATA[
                            AND ORG_NAME LIKE '%'||?||'%'
        ]]>
    </query>
    
    <query name="SEL_TREE_ORGMST_ORDER">
        <![CDATA[
                   ) ORG
                   , DPS.PC_ORGMST BFORG
               WHERE ORG.BF_ORG_CD  = BFORG.ORG_CD(+)
             --ORDER BY TMP_ORG_CD
             ORDER BY ORG_FLAG,(SELECT SORT_ORDER FROM DPS.PC_ORGMST WHERE ORG_CD = SUBSTR(TMP_ORG_CD,1,2)||SUBSTR(TMP_ORG_CD,4))
        ]]>
    </query>
    <query name="SEL_BUYERMST">
        <![CDATA[
            SELECT MST.BUYER_CD
                 , MST.BUYER_NAME
                 , ORG.EMP_NO
                 , USR.USER_NAME
                 , MST.MAIN_FLAG
                 , MST.BUYER_FLAG
                 , MST.ORG_FLAG
                 , MST.STR_CD
                 , MST.TEAM_CD
                 , MST.PC_ORG_CD
                 , MST.USE_YN
              FROM DPS.PC_BUYERMST MST
                 , DPS.PC_BUYERORG ORG
                 , COM.TC_USRMST USR
             WHERE MST.BUYER_CD  = ORG.BUYER_CD(+)
               AND ORG.EMP_NO    = USR.USER_ID(+)
               AND ORG.APP_E_DT(+)  >= TO_CHAR(SYSDATE,'YYYYMMDD')
               AND ORG.APP_S_DT(+)  <= TO_CHAR(SYSDATE,'YYYYMMDD')
        ]]>
    </query>
    <query name="SEL_BUYERMST_WHERE_PC_ORG_CD">
        <![CDATA[
               AND MST.PC_ORG_CD = ?
        ]]>
    </query>
    <query name="SEL_BUYERMST_WHERE_LIKE_PC_ORG_CD">
        <![CDATA[
               AND MST.PC_ORG_CD LIKE ? || '%'
        ]]>
    </query>
    <query name="SEL_BUYERMST_WHERE_ORG_FLAG">
        <![CDATA[
               AND MST.ORG_FLAG = ?
        ]]>
    </query>
    <query name="SEL_BUYERMST_ORDER">
        <![CDATA[
             ORDER BY MST.BUYER_CD
        ]]>
    </query>
    <query name="SEL_BUYERORG">
        <![CDATA[
            SELECT ORG.BUYER_CD
                 , MST.BUYER_NAME
                 , ORG.EMP_NO
                 , USR.USER_NAME
                 , ORG.APP_S_DT
                 , ORG.APP_E_DT
                 , ORG.STR_CD
                 , ORG.TEAM_CD
                 , ORG.PC_ORG_CD
                 , ORG.USE_YN
                 , ORG.APP_S_DT   AS OLD_APP_S_DT
              FROM DPS.PC_BUYERORG ORG
                 , DPS.PC_BUYERMST MST
                 , COM.TC_USRMST USR
             WHERE ORG.BUYER_CD  = MST.BUYER_CD 
               AND ORG.EMP_NO    = USR.USER_ID
               AND ORG.BUYER_CD  = ?
        ]]>
    </query>
    <query name="SEL_BUYERORG_ORDER">
        <![CDATA[
             ORDER BY ORG.APP_S_DT
        ]]>
    </query>
    
    <!-- 조직코드 중복 체크  -->
    <query name="SEL_ORGMST_ORGCD_CNT">
        <![CDATA[
            SELECT COUNT(*) AS CNT
              FROM DPS.PC_ORGMST
             WHERE ORG_CD = ?
        ]]>
    </query>
    
    <!-- 새로운 바이어 코드 조회 쿼리  -->
    <query name="SEL_BUYERMST_NEW_CD">        
        <![CDATA[
            SELECT ? || ? || LPAD( NVL( MAX( TO_NUMBER( SUBSTR(BUYER_CD,5) ) ) + 1, 1 ), 2, '0') AS NEW_BUYER_CD
              FROM DPS.PC_BUYERMST
             WHERE STR_CD  = ?
               AND TEAM_CD = ?
        ]]>        
    </query>
    
    <!-- 바이어 조직 중복 체크  -->
    <query name="SEL_BUYERORG_KEY_CNT">
        <![CDATA[
            SELECT COUNT(*) AS CNT
              FROM DPS.PC_BUYERORG
             WHERE BUYER_CD = ?
               AND APP_S_DT = ?
        ]]>        
    </query>
    
    <!-- 변경 저장될 하위 조직 항목 조회 -->
    <query name="SEL_ORGMST_USE_YN">
        <![CDATA[
            SELECT ORG_CD
              FROM DPS.PC_ORGMST
             START WITH ORG_CD     = ?
           CONNECT BY PRIOR ORG_CD = P_ORG_CD
        ]]>        
    </query>
    
    
    <!-- 변경 저장될 하위 바이어 조직 항목 조회 -->
    <query name="SEL_BUYERORG_USE_YN">
        <![CDATA[
            SELECT BUYER_CD
                 , APP_S_DT
              FROM DPS.PC_BUYERORG
             WHERE PC_ORG_CD IN (
                                 SELECT ORG_CD
                                   FROM DPS.PC_ORGMST
                                  START WITH ORG_CD     = ?
                                CONNECT BY PRIOR ORG_CD = P_ORG_CD
                                )
        ]]>        
    </query>
    
    
    <!-- 바이어 조직 종료일자 변경될 바어어 조회  -->
    <query name="SEL_BUYERORG_UPD_APP_E_DT">
        <![CDATA[
            SELECT ORG.BUYER_CD
                 , ORG.APP_S_DT
              FROM DPS.PC_BUYERORG ORG
             WHERE ORG.BUYER_CD =  ?
               AND (( ORG.APP_S_DT     <  ?
                      AND ORG.APP_E_DT >= ?
                     )
                     OR( ORG.APP_E_DT=(
                                       SELECT MAX(APP_E_DT)
                                         FROM DPS.PC_BUYERORG
                                        WHERE BUYER_CD =  ORG.BUYER_CD
                                          AND APP_S_DT < ?
                                      )
                       )
                   )
        ]]>        
    </query>
    
    <!-- 바이어 조직 종료일자  조회  -->
    <query name="SEL_BUYERORG_APP_E_DT">
        <![CDATA[
            SELECT NVL( TO_CHAR( TO_DATE( MIN( APP_S_DT ) , 'YYYYMMDD') -1, 'YYYYMMDD' ), '99991231') AS APP_E_DT
              FROM DPS.PC_BUYERORG 
             WHERE BUYER_CD = ?
               AND APP_S_DT > ?
               AND APP_S_DT <> ?
        ]]>        
    </query>
    
    <!-- 조직  마스터 신규 입력  -->
    <query name="INS_ORGMST">
        <![CDATA[
            INSERT INTO DPS.PC_ORGMST(ORG_CD   , ORG_NAME    , ORG_SHORT_NAME    , ORG_FLAG    , ORG_LEVEL
                                    , STR_CD   , DEPT_CD     , TEAM_CD           , PC_CD       , CORNER_CD
                                    , P_ORG_CD , FRST_ORG_CD , SAP_ORG_CD        , BF_ORG_CD   , MNG_ORG_YN
                                               , EMP_CNT     , AREA_SIZE         , APP_S_DT    , APP_E_DT
                                    , USE_YN   , REG_DATE    , REG_ID            , MOD_DATE    , MOD_ID
                                    , SORT_ORDER, BUDGET_YN   , KOSTL_CD
                                     )
                               VALUES(?       , ?       , ?       , ?       , ?
                                    , ?       , ?       , ?       , ?       , ?
                                    , ?       , ?       , ?       , ?       , ?
                                              , ?       , ?       , ?       , ?
                                    , ?       , SYSDATE , ?       , SYSDATE , ?
                                    , ?       , ?       , ?
                                     ) 
        ]]>        
    </query>
    
    <!-- 조직  마스터 수정 입력  -->
    <query name="UPD_ORGMST">
        <![CDATA[
            UPDATE DPS.PC_ORGMST
               SET ORG_NAME       = ?
                 , ORG_SHORT_NAME = ?  
                 , STR_CD         = ?
                 , DEPT_CD        = ?
                 , TEAM_CD        = ?
                 , PC_CD          = ?
                 , CORNER_CD      = ?
                 , P_ORG_CD       = ?
                 , SAP_ORG_CD     = ?
                 , BF_ORG_CD      = ?
                 , MNG_ORG_YN     = ?
                 
                 , EMP_CNT        = ?
                 , AREA_SIZE      = ?
                 , APP_S_DT       = ?
                 , APP_E_DT       = ?
                 , USE_YN         = ?
                 , MOD_DATE       = SYSDATE
                 , MOD_ID         = ?
                 , SORT_ORDER     = ?
                 , BUDGET_YN      = ?
                 , KOSTL_CD       = ?
             WHERE ORG_CD   = ?
        ]]>        
    </query>   
    
    <!-- 바이어  마스터 신규 입력  -->
    <query name="INS_BUYERMST">
        <![CDATA[
            INSERT INTO DPS.PC_BUYERMST(BUYER_CD
                                      , STR_CD
                                      , TEAM_CD
                                      , BUYER_NAME
                                      , PC_ORG_CD
                                      , ORG_FLAG
                                      , MAIN_FLAG
                                      , BUYER_FLAG
                                      , USE_YN
                                      , REG_DATE
                                      , REG_ID
                                      , MOD_DATE
                                      , MOD_ID
                                       )
                                 VALUES(?
                                      , ?
                                      , ?
                                      , ?
                                      , ?
                                      , ?
                                      , ?
                                      , ?
                                      , ?
                                      , SYSDATE
                                      , ?
                                      , SYSDATE
                                      , ?
                                       )
        ]]>        
    </query>
    
    <!-- 바이어  마스터 수정 입력  -->
    <query name="UPD_BUYERMST">
        <![CDATA[
            UPDATE DPS.PC_BUYERMST
               SET STR_CD       = ?
                 , TEAM_CD      = ?
                 , BUYER_NAME   = ?
                 , PC_ORG_CD    = ?
                 , ORG_FLAG     = ?
                 , MAIN_FLAG    = ?
                 , BUYER_FLAG   = ?
                 , USE_YN       = ?
                 , MOD_DATE     = SYSDATE
                 , MOD_ID       = ?
             WHERE BUYER_CD     = ?
        ]]>        
    </query>
    
    <!-- 바이어 조직  신규 입력  -->
    <query name="INS_BUYERORG">
        <![CDATA[
            INSERT INTO DPS.PC_BUYERORG(BUYER_CD
                                      , APP_S_DT
                                      , STR_CD
                                      , TEAM_CD
                                      , APP_E_DT
                                      , EMP_NO
                                      , PC_ORG_CD
                                      , USE_YN
                                      , REG_DATE
                                      , REG_ID
                                      , MOD_DATE
                                      , MOD_ID
                                       )
                                 VALUES(?
                                      , ?
                                      , ?
                                      , ?
                                      , ?
                                      , ?
                                      , ?
                                      , ?
                                      , SYSDATE
                                      , ?
                                      , SYSDATE
                                      , ?
                                       )
        ]]>        
    </query>
    
    <!-- 바이어 조직   수정 입력  -->
    <query name="UPD_BUYERORG">
        <![CDATA[
            UPDATE DPS.PC_BUYERORG
               SET APP_S_DT     = ?
                 , STR_CD       = ?
                 , TEAM_CD      = ?
                 , APP_E_DT     = ?
                 , EMP_NO       = ?
                 , PC_ORG_CD    = ?
                 , USE_YN       = ?
                 , MOD_DATE     = SYSDATE
                 , MOD_ID       = ?
             WHERE BUYER_CD     = ?
               AND APP_S_DT     = ?
        ]]>        
    </query>
    
    <!-- 바이어 조직 종료일자 수정 입력  -->
    <query name="UPD_BUYERORG_APP_E_DT">
        <![CDATA[
            UPDATE DPS.PC_BUYERORG BF
               SET BF.APP_E_DT = (SELECT NVL( TO_CHAR( TO_DATE( MIN( AF.APP_S_DT ) , 'YYYYMMDD' ) -1, 'YYYYMMDD' ), '99991231')
                                    FROM DPS.PC_BUYERORG AF
                                   WHERE AF.BUYER_CD = BF.BUYER_CD
                                     AND AF.APP_S_DT > BF.APP_S_DT 
                                 )
             WHERE BF.BUYER_CD =  ?
               AND (( APP_S_DT     <  ?
                      AND APP_E_DT >= ?
                     )
                     OR( APP_E_DT=(SELECT MAX(APP_E_DT)
                                     FROM DPS.PC_BUYERORG
                                    WHERE BUYER_CD =  BF.BUYER_CD
                                      AND APP_S_DT < ?
                                  )
                       )
                   )
        ]]>        
    </query>
    
    <!-- 조직  마스터 하위 항목 사용여부 수정  -->
    <query name="UPD_ORGMST_USE_YN">
        <![CDATA[
            UPDATE DPS.PC_ORGMST
               SET USE_YN         = ?
                 , MOD_DATE       = SYSDATE
                 , MOD_ID         = ?
             WHERE ORG_CD        IN (
                                     SELECT ORG_CD
                                       FROM DPS.PC_ORGMST
                                      START WITH ORG_CD     = ?
                                    CONNECT BY PRIOR ORG_CD = P_ORG_CD
                                    )
        ]]>        
    </query>   
    
    
    <!-- 바이어  마스터 하위 항목 사용여부 수정  -->
    <query name="UPD_BUYERMST_USE_YN">
        <![CDATA[
            UPDATE DPS.PC_BUYERMST
               SET USE_YN         = ?
                 , MOD_DATE       = SYSDATE
                 , MOD_ID         = ?
             WHERE PC_ORG_CD     IN (
                                     SELECT ORG_CD
                                       FROM DPS.PC_ORGMST
                                      WHERE PC_CD NOT IN ('00')
                                        AND CORNER_CD = '00'
                                      START WITH ORG_CD     = ?
                                    CONNECT BY PRIOR ORG_CD = P_ORG_CD
                                    )
        ]]>        
    </query>   
    
    <!-- 바이어 조직 하위 항목 사용여부 수정  -->
    <query name="UPD_BUYERORG_USE_YN">
        <![CDATA[
            UPDATE DPS.PC_BUYERORG
               SET USE_YN         = ?
                 , MOD_DATE       = SYSDATE
                 , MOD_ID         = ?
             WHERE PC_ORG_CD     IN (
                                     SELECT ORG_CD
                                       FROM DPS.PC_ORGMST
                                      WHERE PC_CD NOT IN ('00')
                                        AND CORNER_CD = '00'
                                      START WITH ORG_CD     = ?
                                    CONNECT BY PRIOR ORG_CD = P_ORG_CD
                                    )
        ]]>        
    </query>   
</service>