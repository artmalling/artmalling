<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 정진영
 * 회 사 명 : FKSS
 * 작 성 일 : 2010.03.11
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  규격담품코드를 관리한다.
 -->
<service name="/pcod609.pc">
    <!-- 규격단품 그리드 -->
    <gauce name="H_SEL_MASTER">
        <column colName="STR_CD"           colType="TB_STRING"  size="2"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD"        colType="TB_STRING"  size="6"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NAME"      colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REP_PUMBUN_NAME"  colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_NAME"         colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_CD"           colType="TB_STRING"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PLU_FLAG"         colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_NAME"         colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="INPUT_PLU_CD"     colType="TB_STRING"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="RECP_NAME"        colType="TB_STRING"  size="20"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_CD"        colType="TB_STRING"  size="8"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_NAME"      colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORIGIN_AREA_CD"   colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORIGIN_AREA_NAME" colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_UNIT_CD"     colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BOTTLE_CD"        colType="TB_STRING"  size="13"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BOTTLE_NAME"      colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MODEL_NO"         colType="TB_STRING"  size="24"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMP_SPEC_CD"      colType="TB_DECIMAL" size="5"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CMP_SPEC_UNIT"    colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BAS_SPEC_CD"      colType="TB_DECIMAL" size="8"   dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BAS_SPEC_UNIT"    colType="TB_STRING"  size="3"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REMARK"           colType="TB_STRING"  size="100" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SET_YN"           colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="GIFT_FLAG"        colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="GIFT_TYPE_CD"     colType="TB_STRING"  size="4"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="GIFT_AMT_TYPE"    colType="TB_STRING"  size="2"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MAKER_CD"         colType="TB_STRING"  size="6"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MAKER_NAME"       colType="TB_STRING"  size="40"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="USE_YN"           colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_TYPE"      colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_TYPE"         colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STYLE_TYPE"       colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BIZ_TYPE"         colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TAX_FLAG"         colType="TB_STRING"  size="1"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_CD"           colType="TB_STRING"  size="6"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    <!-- 전별단품 그리드 -->
    <gauce name="H_SEL_DETAIL">
        <column colName="STR_CD"          colType="TB_STRING"  size="2"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_CD"          colType="TB_STRING"  size="13" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_CD"        colType="TB_STRING"  size="11" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="EVENT_NAME"      colType="TB_STRING"  size="40" dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="APP_S_DT"        colType="TB_STRING"  size="8"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="APP_E_DT"        colType="TB_STRING"  size="8"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REU_RATE"        colType="TB_INT"     size="2"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_COST_PRC"   colType="TB_INT"     size="9"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_SALE_PRC"   colType="TB_INT"     size="9"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NORM_MG_RATE"    colType="TB_DECIMAL" size="5"  dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SAL_COST_PRC"    colType="TB_INT"     size="9"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_PRC"        colType="TB_INT"     size="9"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_MG_RATE"    colType="TB_DECIMAL" size="5"  dec="2" keyType="TB_NORMAL" roundMode="ROUND" />

    </gauce> 
    <!-- 쿼리는 전부 대문자 -->
    <!-- 규격단품코드 마스터 조회 -->
    <query name="SEL_SKUMST">    
        <![CDATA[
            SELECT SSKU.STR_CD
                 , SSKU.PUMBUN_CD
                 , PBN.PUMBUN_NAME
                 , REP.NAME      AS REP_PUMBUN_NAME
                 , VEN.VEN_NAME
                 , SSKU.SKU_CD
                 , SKU.PLU_FLAG
                 , SSKU.SKU_NAME
                 , SKU.INPUT_PLU_CD
                 , SSKU.RECP_NAME
                 , SKU.PUMMOK_CD
                 , PMK.PUMMOK_NAME
                 , SKU.ORIGIN_AREA_CD
                 , ORIGIN.NAME   AS ORIGIN_AREA_NAME
                 , SKU.SALE_UNIT_CD
                 , SSKU.BOTTLE_CD
                 , BOTTLE.NAME   AS BOTTLE_NAME
                 , SKU.MODEL_NO
                 , SKU.CMP_SPEC_CD
                 , SKU.CMP_SPEC_UNIT
                 , SKU.BAS_SPEC_CD
                 , SKU.BAS_SPEC_UNIT
                 , SKU.REMARK
                 , SKU.SET_YN
                 , SKU.GIFT_FLAG
                 , SKU.GIFT_TYPE_CD
                 , SKU.GIFT_AMT_TYPE
                 , SKU.MAKER_CD
                 , MAKER.NAME   AS MAKER_NAME
                 , SSKU.USE_YN
                 , SSKU.PUMBUN_TYPE                   
                 , SSKU.SKU_TYPE
                 , SSKU.STYLE_TYPE
                 , PBN.BIZ_TYPE
                 , PBN.TAX_FLAG
                 , SSKU.VEN_CD
              FROM DPS.PC_SKUMST SKU
                 , DPS.PC_PBNMST PBN
                 , DPS.PC_VENMST VEN
                 , DPS.PC_PMKMST PMK
                 , (SELECT COMM_CODE    AS CODE
                         , COMM_NAME1   AS NAME
                      FROM COM.TC_COMMCODE
                     WHERE SYS_PART  = 'D'
                       AND COMM_PART = 'P040'
                       AND USE_YN = 'Y'
                   ) ORIGIN
                 , (SELECT SKU_CD       AS CODE
                         , SKU_NAME     AS NAME
                      FROM DPS.PC_SKUMST
                     WHERE PUMBUN_TYPE   = '2'
                   ) BOTTLE
                 , (SELECT COMM_CODE    AS CODE
                         , COMM_NAME1   AS NAME
                      FROM COM.TC_COMMCODE
                     WHERE SYS_PART  = 'D'
                       AND COMM_PART = 'P019'
                       AND USE_YN = 'Y'
                   ) MAKER
                 , (SELECT PUMBUN_CD     AS CODE
                         , PUMBUN_NAME   AS NAME
                      FROM DPS.PC_PBNMST
                     WHERE PUMBUN_CD = REP_PUMBUN_CD
                   ) REP
                 , DPS.PC_STRSKUMST SSKU
             WHERE SSKU.STR_CD        = ?
               AND SSKU.PUMBUN_CD  LIKE ? || '%'
               AND PBN.PUMBUN_CD      = SSKU.PUMBUN_CD
               AND VEN.VEN_CD         = SSKU.VEN_CD
               AND SKU.SKU_CD         = SSKU.SKU_CD               
               
               AND PMK.PUMMOK_CD      = SKU.PUMMOK_CD               
               AND REP.CODE           = PBN.REP_PUMBUN_CD
               
               AND ORIGIN.CODE(+)     = SKU.ORIGIN_AREA_CD
               AND BOTTLE.CODE(+)     = SKU.BOTTLE_CD
               AND MAKER.CODE(+)      = SKU.MAKER_CD
        ]]>
    </query>
    <query name="SEL_SKUMST_WHERE_PUMMOK_CD">
        <![CDATA[
               AND SKU.PUMMOK_CD      = ?
        ]]>
    </query>
    <query name="SEL_SKUMST_WHERE_SKU_CD">
        <![CDATA[
               AND SKU.SKU_CD      LIKE ?||'%' 
        ]]>
    </query>
    <query name="SEL_SKUMST_WHERE_SKU_NAME">
        <![CDATA[
               AND SKU.SKU_NAME    LIKE '%'||?||'%'    
        ]]>    
    </query>
    <query name="SEL_SKUMST_ORDER">
        <![CDATA[
             ORDER BY SKU.SKU_CD
        ]]>
    </query>
        
    <!-- 점별 단품 가격 이력 조회   -->
    <query name="SEL_STRSKUMST">
        <![CDATA[
           SELECT  PRC.STR_CD
                 , PRC.SKU_CD
                 , PRC.EVENT_CD
                 , EVT.EVENT_NAME
                 , PRC.APP_S_DT
                 , PRC.APP_E_DT
                 , PRC.REDU_RATE
                 , PRC.NORM_COST_PRC
                 , PRC.NORM_SALE_PRC
                 , PRC.NORM_MG_RATE
                 , PRC.SAL_COST_PRC
                 , PRC.SALE_PRC
                 , PRC.SALE_MG_RATE
              FROM DPS.PC_STRSKUPRCMST PRC
                 , DPS.PC_EVTMST          EVT
             WHERE PRC.STR_CD = ?
               AND PRC.SKU_CD = ?
               AND EVT.EVENT_CD = PRC.EVENT_CD
             ORDER BY 
                   PRC.EVENT_CD
                 , PRC.APP_S_DT DESC
        ]]>
    </query>    
</service>