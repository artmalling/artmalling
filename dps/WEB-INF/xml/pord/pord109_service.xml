<?xml version="1.0" encoding="euc-kr"?>
<!-- XML 버전 1.0을 사용하며 encoding 타입은 ‘euc-kr’로 한다.-->
<!--
 * 작 성 자 : 김경은
 * 회 사 명 : 한국후지쯔
 * 작 성 일 : 2010.03.11
 * 변 경 일 : 
 * 변경내용 : 
 * 개    요 :  
 -->
<service name="/pord109.po">

    <!-- 점출입  리스트 -->
        <gauce name="H_LIST"> 
        <column colName="SLIP_NO"             colType="TB_STRING"  size="12"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="STR_CD"              colType="TB_STRING"  size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="STR_NM"              colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="SLIP_FLAG"           colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="SLIP_FLAG_NM"        colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_DT"              colType="TB_STRING"  size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="SLIP_PROC_STAT"      colType="TB_STRING"  size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="SLIP_PROC_STAT_NM"   colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="P_STR_CD"            colType="TB_STRING"  size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="P_SLIP_NO"           colType="TB_STRING"  size="12"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_NM"           colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REJ_CAN_FLAG"        colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
    </gauce> 
    
    <!-- 점출입  Master -->
        <gauce name="H_MASTER"> 
        <column colName="SLIP_NO"             colType="TB_STRING"  size="12"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="STR_CD"              colType="TB_STRING"  size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="STR_NM"              colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="PUMBUN_CD"           colType="TB_STRING"  size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="PUMBUN_NM"           colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="VEN_CD"              colType="TB_STRING"  size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="VEN_NM"              colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="NEW_PRC_APP_DT"      colType="TB_STRING"  size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="NEW_EVENT_CD"        colType="TB_STRING"  size="11"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="SLIP_FLAG"           colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="SLIP_FLAG_NM"        colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_OWN_FLAG"        colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="ORD_OWN_FLAG_NM"     colType="TB_STRING"  size="30"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_FLAG"            colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="ORD_FLAG_NM"         colType="TB_STRING"  size="30"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="AUTO_SLIP_FLAG"      colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="INC_FLAG"            colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="AFT_ORD_FLAG"        colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="INOUT_FLAG"          colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="ORD_DT"              colType="TB_STRING"  size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="DELI_DT"             colType="TB_STRING"  size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="P_DELI_DT"           colType="TB_STRING"  size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SM_CONF_DT"          colType="TB_STRING"  size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="SM_ID"               colType="TB_STRING"  size="10"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_CONF_ID"       colType="TB_STRING"  size="10"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_CONF_DT"         colType="TB_STRING"  size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BUYER_CD"            colType="TB_STRING"  size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="BUYER_NM"            colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="SLIP_PROC_STAT"      colType="TB_STRING"  size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="SLIP_PROC_STAT_NM"   colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DTL_CNT"             colType="TB_INT"     size="3"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="ORD_TOT_QTY"         colType="TB_DECIMAL" size="8"    dec="1" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="NEW_COST_TAMT"       colType="TB_DECIMAL" size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="NEW_SALE_TAMT"       colType="TB_DECIMAL" size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="GAP_TOT_AMT"         colType="TB_DECIMAL" size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="NEW_GAP_RATE"        colType="TB_DECIMAL" size="5"    dec="2" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="REMARK"              colType="TB_STRING"  size="100"  dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="BIZ_TYPE"            colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="BIZ_TYPE_NM"         colType="TB_STRING"  size="30"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="TAX_FLAG"            colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />  
        <column colName="TAX_FLAG_NM"         colType="TB_STRING"  size="30"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="DEL_FLAG"            colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="REG_DATE"            colType="TB_STRING"  size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="P_STR_CD"            colType="TB_STRING"  size="11"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="P_SLIP_NO"           colType="TB_STRING"  size="12"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="P_PUMBUN_CD"         colType="TB_STRING"  size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="P_PUMBUN_NM"         colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" /> 
        <column colName="P_TAX_FLAG"          colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />  
        <column colName="P_TAX_FLAG_NM"       colType="TB_STRING"  size="30"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="STYLE_TYPE"          colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="E_SLIP_NO"           colType="TB_STRING"  size="12"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="F_SLIP_NO"           colType="TB_STRING"  size="12"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="E_SLIP_PROC_STAT_NM" colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="F_SLIP_PROC_STAT_NM" colType="TB_STRING"  size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VAT_TAMT"            colType="TB_DECIMAL" size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BOTTLE_SLIP_YN"      colType="TB_STRING"  size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="CHK_DT"              colType="TB_STRING"  size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <!-- 점출입 Detail -->   
    <gauce name="H_DETAIL"> 
        <column colName="STR_CD"             colType="TB_STRING"   size="2"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SLIP_NO"            colType="TB_STRING"   size="12"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_SEQ_NO"         colType="TB_INT"      size="3"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_CD"          colType="TB_STRING"   size="8"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_CD"             colType="TB_STRING"   size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_NM"             colType="TB_STRING"   size="40"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_UNIT_CD"        colType="TB_STRING"   size="3"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_UNIT_NM"        colType="TB_STRING"   size="30"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_GAP_AMT"        colType="TB_DECIMAL"  size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_GAP_RATE"       colType="TB_DECIMAL"  size="5"    dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORD_QTY"            colType="TB_DECIMAL"  size="8"    dec="1" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_COST_PRC"       colType="TB_DECIMAL"  size="9"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_COST_AMT"       colType="TB_DECIMAL"  size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_SALE_PRC"       colType="TB_DECIMAL"  size="9"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="NEW_SALE_AMT"       colType="TB_DECIMAL"  size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD"          colType="TB_STRING"   size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VEN_CD"             colType="TB_STRING"   size="6"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SLIP_FLAG"          colType="TB_STRING"   size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="MG_RATE"            colType="TB_DECIMAL"  size="5"    dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="ORG_SKU_CD"         colType="TB_STRING"   size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="VAT_AMT"            colType="TB_DECIMAL"  size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BOTTLE_CD"          colType="TB_STRING"   size="13"   dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="RATE"               colType="TB_DECIMAL"  size="5"    dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SEL"                colType="TB_STRING"   size="1"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <!-- 단품상세정보  -->   
    <gauce name="H_SKU_INFO"> 
        <column colName="STR_CD"             colType="TB_STRING"    size="2"     dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_CD"             colType="TB_STRING"    size="13"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SKU_NAME"           colType="TB_STRING"    size="40"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMMOK_CD"          colType="TB_STRING"    size="8"     dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="PUMBUN_CD"          colType="TB_STRING"    size="6"     dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_UNIT_CD"       colType="TB_STRING"    size="3"     dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_UNIT_NM"       colType="TB_STRING"    size="30"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SAL_COST_PRC"       colType="TB_DECIMAL"   size="9"     dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_PRC"           colType="TB_DECIMAL"   size="9"     dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="SALE_MG_RATE"       colType="TB_DECIMAL"   size="5"     dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="GOAL_PROF_RATE"     colType="TB_DECIMAL"   size="5"     dec="2" keyType="TB_NORMAL" roundMode="ROUND" />
        <column colName="BOTTLE_CD"          colType="TB_STRING"    size="13"    dec="0" keyType="TB_NORMAL" roundMode="ROUND" />
    </gauce>
    
    <!-- 점출입 매입발주  리스트 조회 -->
    <query name="SEL_LIST">
        <![CDATA[
            SELECT A.SLIP_NO                                                                         /* 전표번호 */
                 , A.STR_CD                                                                          /* 점코드 */
                 , DPS.FN_GET_STORE_NAME(A.STR_CD) AS STR_NM                                         /* 점명 */
                 , A.SLIP_FLAG                                                                       /* 전표구분 */
                 , COM.FN_GET_COMM_NAME('D', 'P201', A.SLIP_FLAG) AS  SLIP_FLAG_NM                   /* 전표구분명 */
                 , A.ORD_DT                                                                          /* 발주일자(점출일, 시행일) */
                 , A.SLIP_PROC_STAT                                                                  /* 전표진행상태 */
                 , COM.FN_GET_COMM_NAME('D', 'P207', A.SLIP_PROC_STAT) AS  SLIP_PROC_STAT_NM         /* 전표진행상태명 */
                 , PAIR_STR_CD  AS P_STR_CD                                                          /* 점출입상대매장 */
                 , PAIR_SLIP_NO AS P_SLIP_NO                                                         /* 점출입상대전표 */
                 , DPS.FN_GET_PUMBUN_NAME(PUMBUN_CD) AS PUMBUN_NM                                    /* 품번명 */
                 , A.REJ_CAN_FLAG                                                                    /* 반려취소구 분 1:반려, 2:취소 */
            FROM (    
                  SELECT SLP.SLIP_NO                                                                        
                       , SLP.STR_CD                                                                          
                       , SLP.SLIP_FLAG                                                                      
                       , SLP.ORD_DT                          
                       , SLP.DELI_DT                          
                       , SLP.CHK_DT                         
                       , SLP.SLIP_PROC_STAT                                                                  
                       , SLP.ORD_CF_DT AS CONF_DT
                       , PBN.SALE_ORG_CD
                       , PBN.BUY_ORG_CD
                       , SLP.PAIR_STR_CD
                       , SLP.PAIR_SLIP_NO
                       , SLP.PUMBUN_CD
                       , SLP.REJ_CAN_FLAG
                    FROM  DPS.PO_SLPMST SLP, DPS.PC_STRPBN PBN
                   WHERE SLP.SLIP_FLAG      IN ('E','F')
                     AND SLP.DEL_FLAG       = 'N'
                     AND SLP.STR_CD         = ?
                     AND PBN.SKU_FLAG       = ?
                     AND PBN.SKU_TYPE       = ?
                     AND SLP.STR_CD         = PBN.STR_CD
                     AND SLP.PUMBUN_CD      = PBN.PUMBUN_CD
                     AND SLP.AUTO_SLIP_FLAG = '0'                /* 자동전표여부 */
                     
                     AND EXISTS ( SELECT MYORG.USER_ID
                                    FROM COM.V_MYORG MYORG
                                   WHERE MYORG.STR_CD      = SLP.STR_CD
                                     AND MYORG.PUMBUN_CD   = SLP.PUMBUN_CD
                                     AND MYORG.USER_ID     = ?
                                     AND MYORG.ORG_FLAG    = ?
                                     AND ROWNUM            = 1
                                 )
        ]]>
    </query> 
    <query name="SEL_BUY_ORG_CD">
        <![CDATA[
                     AND SLP.SLIP_PROC_STAT LIKE  ? || '%'
                     AND SLP.PUMBUN_CD      LIKE  ? || '%'
                     AND PBN.BIZ_TYPE       =  ?
               )A
               WHERE  A.BUY_ORG_CD   LIKE ? || '%'
        ]]>
    </query>
    <query name="SEL_SALE_ORG_CD">
        <![CDATA[
                     AND SLP.SLIP_PROC_STAT LIKE  ? || '%'
                     AND SLP.PUMBUN_CD      LIKE  ? || '%'
                     AND PBN.BIZ_TYPE       =  ?
               )A
               WHERE A.SALE_ORG_CD   LIKE ? || '%'
        ]]>
    </query>
    <query name="SEL_ORD_DT">
        <![CDATA[
               AND A.ORD_DT BETWEEN ? AND ?
        ]]>
    </query>
    <query name="SEL_ORD_CONF">
        <![CDATA[
               AND A.ORD_CF_DT BETWEEN ? AND ?
        ]]>
    </query>
    <query name="SEL_DELI_DT">
        <![CDATA[
               AND A.DELI_DT BETWEEN ? AND ?
        ]]>
    </query>
    <query name="SEL_CHK_DT">
        <![CDATA[
               AND A.CHK_DT BETWEEN ? AND ?
        ]]>
    </query>
    <query name="WHERE_SLIP_NO">
        <![CDATA[
            )A
          WHERE A.SLIP_NO = ?
        ]]>
    </query>
    <query name="SEL_ORDERBY">
        <![CDATA[
               ORDER BY A.STR_CD, A.SLIP_NO DESC
        ]]>
    </query>
    
    <!-- 점출입 매입발주  마스터 조회 -->
    <query name="SEL_MASTER">
        <![CDATA[
            SELECT A.SLIP_NO                                                                             /* 전표번호 */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN A.STR_CD                                               
                   ELSE B.STR_CD END                      AS STR_CD                                      /* 점코드 */
                 , DPS.FN_GET_STORE_NAME(A.STR_CD) AS STR_NM                                             /* 점명 */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN A.PUMBUN_CD                                            
                   ELSE B.PUMBUN_CD END AS PUMBUN_CD                                                     /* 품번코드 */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN DPS.FN_GET_PUMBUN_NAME(A.PUMBUN_CD)                    
                   ELSE DPS.FN_GET_PUMBUN_NAME(B.PUMBUN_CD) END AS PUMBUN_NM                             /* 품번명 */
                 , A.VEN_CD                                                                              /* 협력사코드 */
                 , DPS.FN_GET_VENDOR_NAME(A.VEN_CD) AS VEN_NM                                            /* 협력사명 */
                 , A.NEW_PRC_APP_DT                                                                      /* 신가격적용일 */
                 , A.NEW_EVENT_CD                                                                        /* 신행사코드 */
                 , A.SLIP_FLAG                                                                           /* 전표구분 */
                 , COM.FN_GET_COMM_NAME('D', 'P201', A.SLIP_FLAG) AS  SLIP_FLAG_NM                       /* 전표구분명 */
                 , A.ORD_OWN_FLAG                                                                        /* 발주주체구분 */
                 , COM.FN_GET_COMM_NAME('D', 'P202', A.ORD_OWN_FLAG) AS ORD_OWN_FLAG_NM                  /* 발주주체구분명 */
                 , A.ORD_FLAG                                                                            /* 발주구분 */
                 , COM.FN_GET_COMM_NAME('D', 'P203', A.ORD_FLAG) AS ORD_FLAG_NM                          /* 발주구분명 */
                 , A.AUTO_SLIP_FLAG                                                                      /* 자동전표구분 */
                 , A.INC_FLAG                                                                            /* 인상하구분 */
                 , A.AFT_ORD_FLAG                                                                        /* 사전사후구분 */
                 , A.INOUT_FLAG                                                                          /* 출입구분 */
                 , A.ORD_DT                                                                              /* 발주일자 */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN A.DELI_DT   
                   ELSE B.DELI_DT END                           AS DELI_DT                               /* 납품예정일(점출일) */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN B.DELI_DT   
                   ELSE A.DELI_DT END                           AS P_DELI_DT                             /* 납품예정일(점입일) */
                 , A.SM_CONF_DT                                                                          /* SM확정일자 */
                 , A.SM_ID                                                                               /* SM ID */   
                 , A.BUYER_CONF_ID                                                                       /* 바이어ID */
                 , A.ORD_CONF_DT                                                                         /* 바이어확정일자(발주확정일자) */ 
                 , A.BUYER_CD                                                                            /* 바이어코드 */
                 , DPS.FN_GET_BUYER_NAME(A.BUYER_CD) AS BUYER_NM                                         /* 바이어코드명 */
                 , A.SLIP_PROC_STAT                                                                      /* 전표진행상태 */
                 , COM.FN_GET_COMM_NAME('D', 'P207', A.SLIP_PROC_STAT) AS  SLIP_PROC_STAT_NM             /* 전표진행상태명 */
                 , A.DTL_CNT                                                                             /* 명세건수 */
                 , DECODE(A.SLIP_PROC_STAT, '09', A.CHK_TOT_QTY, A.ORD_TOT_QTY) AS ORD_TOT_QTY           /* 발주수량합(검품확정'09'일경우 검품수량합) */
                 , DECODE(A.SLIP_PROC_STAT, '09', A.CHK_COST_TAMT, A.NEW_COST_TAMT) AS NEW_COST_TAMT     /* 신원가금액합(검품확정'09'일경우 검품원가금액합) */
                 , DECODE(A.SLIP_PROC_STAT, '09', A.CHK_SALE_TAMT, A.NEW_SALE_TAMT) AS NEW_SALE_TAMT     /* 신매가금액합(검품확정'09'일경우 검품매가금액합) */
                 , DECODE(A.SLIP_PROC_STAT, '09', A.CHK_GAP_AMT, A.GAP_TOT_AMT) AS GAP_TOT_AMT           /* 차익액합(검품확정'09'일경우 검품차익액합) */
                 , DECODE(A.SLIP_PROC_STAT, '09', A.CHK_GAP_RATE, A.NEW_GAP_RATE) AS NEW_GAP_RATE        /* 신차익율(검품확정'09'일경우 검품차익율) */
                 , A.REMARK                                                                              /* 비고 */
                 , A.BIZ_TYPE                                                                            /* 거래형태 */
                 , COM.FN_GET_COMM_NAME('D', 'P002', A.BIZ_TYPE) AS BIZ_TYPE_NM                          /* 거래형태명 */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN A.TAX_FLAG                                            
                   ELSE B.TAX_FLAG END AS TAX_FLAG                                                       /* 과세구분 */
                 , COM.FN_GET_COMM_NAME('D', 'P004', 
                        CASE A.SLIP_FLAG WHEN 'E' THEN A.TAX_FLAG                                            
                        ELSE B.TAX_FLAG END) AS TAX_FLAG_NM                                              /* 과세구분명 */
                 , A.DEL_FLAG                                                                            /* 삭제구분 */
                 , TO_CHAR(A.REG_DATE, 'YYYYMMDD') AS REG_DATE                                           /* 등록일자 */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN A.PAIR_STR_CD                                              
                   ELSE B.PAIR_STR_CD END AS P_STR_CD                                                    /* 점출입상대점코드 */
                 , A.PAIR_SLIP_NO AS P_SLIP_NO                                                           /* 점출입상대전표 */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN B.PUMBUN_CD                                            
                   ELSE A.PUMBUN_CD END AS P_PUMBUN_CD                                                   /* 점입품번코드 */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN DPS.FN_GET_PUMBUN_NAME(B.PUMBUN_CD)                    
                   ELSE DPS.FN_GET_PUMBUN_NAME(A.PUMBUN_CD) END AS P_PUMBUN_NM                           /* 점입품번명 */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN B.TAX_FLAG                                            
                   ELSE A.TAX_FLAG END AS P_TAX_FLAG
                 , COM.FN_GET_COMM_NAME('D', 'P004', 
                        CASE A.SLIP_FLAG WHEN 'E' THEN B.TAX_FLAG                                            
                        ELSE A.TAX_FLAG END) AS P_TAX_FLAG_NM                                            /* 점입과세구분명 */
                 , C.STYLE_TYPE                                                                          
                 , CASE A.SLIP_FLAG WHEN 'E' THEN A.SLIP_NO 
                   ELSE B.SLIP_NO END AS E_SLIP_NO                                                       /* 점출전표번호 */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN B.SLIP_NO 
                   ELSE A.SLIP_NO END AS F_SLIP_NO                                                       /* 점입전표번호 */  
                 , CASE A.SLIP_FLAG WHEN 'E' THEN COM.FN_GET_COMM_NAME('D', 'P207', A.SLIP_PROC_STAT) 
                   ELSE COM.FN_GET_COMM_NAME('D', 'P207', B.SLIP_PROC_STAT) END AS E_SLIP_PROC_STAT_NM   /* 점출상태 */
                 , CASE A.SLIP_FLAG WHEN 'E' THEN COM.FN_GET_COMM_NAME('D', 'P207', B.SLIP_PROC_STAT) 
                   ELSE COM.FN_GET_COMM_NAME('D', 'P207', A.SLIP_PROC_STAT) END AS F_SLIP_PROC_STAT_NM   /* 점입상태 */
                 , A.VAT_TAMT                                                                            /* 부가세  */  
                 , A.BOTTLE_SLIP_YN                                                                      /* 공병전표여부 */
                 , A.CHK_DT                                                                              /* 검품확정일 */
               FROM DPS.PO_SLPMST A
                  , DPS.PO_SLPMST B
                  , DPS.PC_STRPBN C
               WHERE A.STR_CD    = B.PAIR_STR_CD(+)
                 AND A.SLIP_NO   = B.PAIR_SLIP_NO(+)
                 AND A.STR_CD    = C.STR_CD
                 AND A.PUMBUN_CD = C.PUMBUN_CD
                 AND A.STR_CD    = ?
                 AND A.SLIP_NO   = ?
            ORDER BY A.STR_CD
               
               
        ]]>
    </query>
    
    <!-- 점출입 매입발주  상세 조회 -->
    <query name="SEL_DETAIL">
        <![CDATA[
            SELECT DTL.STR_CD                                                                                  /* 점 */
                 , DTL.SLIP_NO                                                                                 /* 전표번호 */
                 , DTL.ORD_SEQ_NO                                                                              /* 전표상세번호 */
                 , DTL.PUMMOK_CD                                                                               /* 품목코드 */
                 , DTL.SKU_CD                                                                                  /* 단품코드 */
                 , DPS.FN_GET_SKU_NAME(SKU_CD) AS SKU_NM                                                       /* 단품명 */
                 , DTL.ORD_UNIT_CD                                                                             /* 발주단위 */
                 , COM.FN_GET_COMM_NAME('D', 'P013', DTL.ORD_UNIT_CD) AS ORD_UNIT_NM                           /* 발주단위명 */
                 , DECODE(MST.SLIP_PROC_STAT, '09', DTL.CHK_GAP_AMT, DTL.NEW_GAP_AMT) AS NEW_GAP_AMT           /* 신차익액 */
                 , DECODE(MST.SLIP_PROC_STAT, '09', DTL.CHK_GAP_RATE, DTL.NEW_GAP_RATE) AS NEW_GAP_RATE        /* 신차익율 */
                 , DECODE(MST.SLIP_PROC_STAT, '09', DTL.CHK_QTY, DTL.ORD_QTY) AS ORD_QTY                       /* 발주수량 */
                 , DTL.NEW_COST_PRC                                                                            /* 신원가단가 */
                 , DECODE(MST.SLIP_PROC_STAT, '09', DTL.CHK_COST_AMT, DTL.NEW_COST_AMT) AS NEW_COST_AMT        /* 신원가금액 */
                 , DTL.NEW_SALE_PRC                                                                            /* 신매가단가 */
                 , DECODE(MST.SLIP_PROC_STAT, '09', DTL.CHK_SALE_AMT, DTL.NEW_SALE_AMT) AS NEW_SALE_AMT        /* 신매가금액 */
                 , DTL.PUMBUN_CD                                                                               /* 품번코드 */
                 , DTL.VEN_CD                                                                                  /* 협력사코드 */
                 , DTL.SLIP_FLAG                                                                               /* 전표구분 */
                 , DTL.MG_RATE                                                                                 /* 마진율 */
                 , DTL.SKU_CD AS ORG_SKU_CD                                                                    /* 이전단품코드  */
                 , DTL.VAT_AMT                                                                                 /* 부가세  */
                 , '' AS BOTTLE_CD                                                                             /* 공병단품번호 */
                 , DPS.FN_GET_PMKPRFRT(DTL.STR_CD
                                     , MST.NEW_PRC_APP_DT
                                     , MST.BIZ_TYPE
                                     , DTL.PUMMOK_CD
                                     , DTL.SKU_CD)                                       AS RATE          
                 , 'F' AS SEL
              FROM DPS.PO_SLPDTL DTL
                 , DPS.PO_SLPMST MST
             WHERE DTL.STR_CD  = MST.STR_CD
               AND DTL.SLIP_NO = MST.SLIP_NO
               AND DTL.STR_CD  = ?
               AND DTL.SLIP_NO = ?
        ]]>
    </query> 
    
    <!-- 규격단품 상세정보 조회 -->
    <query name="SEL_SKU_INFO">
        <![CDATA[
			SELECT STS.STR_CD                                                                 /* 점 */            
	           , STS.SKU_CD                                                                 /* 단품코드 */         
	           , STS.SKU_NAME                                                               /* 단품명 */          
	           , SKU.PUMMOK_CD                                                              /* 품목코드 */         
	           , STS.PUMBUN_CD                                                              /* 품번코드 */         
	           , SKU.SALE_UNIT_CD                                                           /* 기본규격단위 */       
	           , COM.FN_GET_COMM_NAME('D', 'P013', SKU.SALE_UNIT_CD) AS SALE_UNIT_NM        /* 기본규격단위 */       
	           , 0                                                   AS SAL_COST_PRC        /* 판매원가 */         
	           , 0                                                   AS SALE_PRC            /* 판매매가 */         
	           , 0                                                   AS SALE_MG_RATE        /* 판매마진율 */        
	           , NVL(PRT.GOAL_PROF_RATE,0)                           AS GOAL_PROF_RATE      /* 목표이익율 */ 
	           , STS.BOTTLE_CD                                                              /* 공병단품코드 */   
	        FROM DPS.PC_STRSKUMST STS,
	             DPS.PC_SKUMST    SKU,
	             DPS.PC_STRPBN    STP,
	             (
	              SELECT B.STR_CD          AS STR_CD
	                   , B.PUMMOK_CD       AS PUMMOK_CD
	                   , B.GOAL_PROF_RATE  AS GOAL_PROF_RATE
	                FROM DPS.PC_SKUMST A,
	                     DPS.PC_STRPMKPRFRT B
	               WHERE A.SKU_CD    = ?
	                 AND B.PUMMOK_CD = A.PUMMOK_CD
	                 AND B.STR_CD    = ?
	                 AND ? BETWEEN B.APP_S_DT AND B.APP_E_DT
	             ) PRT
	       WHERE STS.STR_CD       = ?
	         AND STS.SKU_CD       = ? 
	         AND STS.USE_YN       = 'Y'
	         AND SKU.SKU_CD       = STS.SKU_CD
	         AND STP.STR_CD       = STS.STR_CD
	         AND STP.PUMBUN_CD    = STS.PUMBUN_CD
	         AND PRT.PUMMOK_CD (+)= SKU.PUMMOK_CD

        ]]>
    </query> 
    
    <!-- 전표번호 생성 -->
    <query name="SEL_SLIP_NO">
        <![CDATA[
            SELECT DPS.FN_GET_SLIPNO(?, ?, ?) AS SLIP_NO
              FROM DUAL         
          
        ]]>
    </query> 
    
    <!-- 전표번호상세번호 생성 -->
    <query name="SEL_ORD_SEQ_NO">
        <![CDATA[
           SELECT LPAD(NVL(MAX(ORD_SEQ_NO),0)+1,3,'0') ORD_SEQ_NO
              FROM DPS.PO_SLPDTL
             WHERE STR_CD = ?
               AND SLIP_NO = ?
        ]]>
    </query>
    
    <!-- 점출입 매입발주 MASTER 등록 -->
    <query name="INS_MASTER">
        <![CDATA[
            INSERT INTO DPS.PO_SLPMST ( 
                                     SLIP_NO                                     /* 전표번호 */
                                   , STR_CD                                      /* 점코드 */                                                   
                                   , PUMBUN_CD                                   /* 품번코드 */                          
                                   , VEN_CD                                      /* 협력사코드 */                         
                                   , NEW_PRC_APP_DT                              /* 신가격적용일 */                        
                                   , NEW_EVENT_CD                                /* 신행사코드 */                         
                                   , SLIP_FLAG                                   /* 전표구분 */                          
                                   , ORD_OWN_FLAG                                /* 발주주체구분 */                        
                                   , ORD_FLAG                                    /* 발주구분 */                          
                                   , AUTO_SLIP_FLAG                              /* 자동전표구분 */                        
                                   , INC_FLAG                                    /* 인상하구분 */                         
                                   , AFT_ORD_FLAG                                /* 사전사후구분 */                        
                                   , INOUT_FLAG                                  /* 출입구분 */                          
                                   , ORD_DT                                      /* 발주일자(점출일, 시행일) */                
                                   , DELI_DT                                     /* 납품(반품)예정일(점입일, 시행일) */
                                   , SM_CONF_DT                                  /* SM확정일자 */
                                   , SM_ID                                       /* SM ID */  
                                   , BUYER_CONF_ID                               /* 바이어ID */
                                   , ORD_CONF_DT                                 /* 바이어확정일자(발주확정일자) */          
                                   , BUYER_CD                                    /* 바이어코드 */                                                 
                                   , SLIP_PROC_STAT                              /* 전표진행상태 */                        
                                   , DTL_CNT                                     /* 명세건수 */                          
                                   , ORD_TOT_QTY                                 /* 발주수량합 */                         
                                   , NEW_COST_TAMT                               /* 신원가금액합 */                        
                                   , NEW_SALE_TAMT                               /* 신매가금액합 */                        
                                   , GAP_TOT_AMT                                 /* 차익액합 */                          
                                   , NEW_GAP_RATE                                /* 신차익율 */  
                                   , VAT_TAMT                                    /* 부가세 */   
                                   , BOTTLE_SLIP_YN                              /* 공병전표여부 */                                                    
                                   , REMARK                                      /* 비고 */                            
                                   , BIZ_TYPE                                    /* 거래형태 */                          
                                   , TAX_FLAG                                    /* 과세구분 */
                                   , IMPORT_FLAG                                 /* 수입발주구분 */
                                   , DEL_FLAG                                    /* 삭제구분 */   
                                   , ORD_CF_DT                                   /* 발주확정일 */ 
                                   , REG_DATE                                    /* 등록일시 */
                                   , REG_ID                                      /* 등록자 */
                                   , MOD_DATE                                    /* 수정일시 */
                                   , MOD_ID                                      /* 수정자 */                
                                    )
                             VALUES (
                                       ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , DECODE('00', DPS.FN_GET_ORDCONF_CHK(?,?), TO_CHAR(SYSDATE, 'YYYYMMDD'), '        ')
                                     , SYSDATE
                                     , ?
                                     , SYSDATE
                                     , ?
                                     )

        ]]>
    </query>  
    
    <!-- 발주매입 MASTER LOG 등록 -->
    <query name="INS_MASTER_LOG">
        <![CDATA[
            MERGE INTO DPS.PO_SLPMSTLG
               USING DUAL
               ON (STR_CD = ? AND SLIP_NO = ?)
               WHEN MATCHED THEN 
                UPDATE SET SLIP_FLAG         = ?                          /* 전표구분 */                          
                         , SLIP_PROC_STAT    = ?                          /* 전표진행상태 */  
               WHEN NOT MATCHED THEN 
                INSERT ( 
                       STR_CD                                      /* 점코드 */ 
                     , SLIP_NO                                     /* 전표번호 */                                                  
                     , SLIP_FLAG                                   /* 전표구분 */                          
                     , SLIP_PROC_STAT                              /* 전표진행상태 */                                     
                      )
               VALUES (
                        ?
                      , ? 
                      , ?
                      , ?
                      )

        ]]>
    </query>
    
     <!-- 점출입 매입발주 상대전표번호 업데이트 -->
    <query name="UPD_P_MASTER">
        <![CDATA[
        
        UPDATE  DPS.PO_SLPMST AA
        SET     (NEW_COST_TAMT, NEW_SALE_TAMT, ORD_TOT_QTY, DTL_CNT, NEW_GAP_RATE, GAP_TOT_AMT, VAT_TAMT, PAIR_STR_CD, PAIR_SLIP_NO)=(
                SELECT    NEW_COST_TAMT
                        , NEW_SALE_TAMT
                        , ORD_TOT_QTY
                        , DTL_CNT
                        , CASE WHEN NEW_GAP_RATE < 0 THEN 0 
                            ELSE NEW_GAP_RATE END NEW_GAP_RATE 
                        , DPS.FN_GET_ROUND_PROC(RUND_FLAG, GAP_TOT_AMT, 0) GAP_TOT_AMT
                        , VAT_AMT
                        , PAIR_STR_CD
                        , PAIR_SLIP_NO
                  FROM  (
                        SELECT    A.STR_CD
                                , A.SLIP_NO
                                , SUM(A.NEW_COST_AMT) AS NEW_COST_TAMT 
                                , SUM(A.NEW_SALE_AMT) AS NEW_SALE_TAMT 
                                , SUM(A.ORD_QTY)      AS ORD_TOT_QTY
                                , COUNT(A.STR_CD)     AS DTL_CNT
                                , CASE B.TAX_FLAG WHEN '1' THEN ROUND((((SUM(A.NEW_SALE_AMT)/1.1) - SUM(A.NEW_COST_AMT)) / (SUM(A.NEW_SALE_AMT)/1.1)) * 100, 2)
                                                ELSE          ROUND(((SUM(A.NEW_SALE_AMT)-SUM(A.NEW_COST_AMT))/SUM(A.NEW_SALE_AMT)) * 100, 2) END AS NEW_GAP_RATE
                                /*, CASE B.TAX_FLAG WHEN '1' THEN (SUM(A.NEW_SALE_AMT)/1.1) - SUM(A.NEW_COST_AMT) 
                                                ELSE          (SUM(A.NEW_SALE_AMT) - SUM(A.NEW_COST_AMT)) END AS GAP_TOT_AMT*/
                                , SUM(NEW_GAP_AMT) AS GAP_TOT_AMT
                                , SUM(A.VAT_AMT)   AS VAT_AMT
                                , ? AS PAIR_STR_CD
                                , ? AS PAIR_SLIP_NO
                                , DPS.FN_GET_ROUND_FLAG(B.STR_CD, B.VEN_CD) AS RUND_FLAG
                          FROM   DPS.PO_SLPDTL A, DPS.PO_SLPMST B
                         WHERE   A.STR_CD = ?
                           AND   A.SLIP_NO = ?
                           AND   A.STR_CD = B.STR_CD AND A.SLIP_NO = B.SLIP_NO
                         GROUP BY A.STR_CD
                                , A.SLIP_NO
                                , B.TAX_FLAG
                                , DPS.FN_GET_ROUND_FLAG(B.STR_CD, B.VEN_CD)
                         ) BB
                )
        WHERE   AA.STR_CD = ?
        AND     AA.SLIP_NO = ?

        ]]>
    </query>
    
    <!-- 점출입 매입발주 MASTER 수정 -->
    <query name="UPD_MASTER">
        <![CDATA[
            UPDATE DPS.PO_SLPMST
              SET REMARK = ?                                      /* 비고 */
                , AFT_ORD_FLAG = ?                                /* 사전사후구분 */    
                , BOTTLE_SLIP_YN = ?                              /* 공병전표여부 */                          
                , MOD_DATE = SYSDATE                              /* 수정일시 */
                , MOD_ID = ?                                      /* 수정자 */ 
            WHERE STR_CD = ?
              AND SLIP_NO = ?
        ]]>
    </query>
    
    <!-- 점출입 매입발주 MASTER 삭제 -->
    <query name="DEL_MASTER">
        <![CDATA[
         DELETE FROM DPS.PO_SLPMST
           WHERE STR_CD IN (?,?)
             AND SLIP_NO IN (?,?)
        ]]>
    </query>  
    
    <!-- 점출입 매입발주 DETAIL 전체삭제 -->
    <query name="DEL_DETAIL_ALL">
        <![CDATA[
         DELETE FROM DPS.PO_SLPDTL
           WHERE STR_CD IN (?,?)
             AND SLIP_NO IN (?,?)
        ]]>
    </query> 
    
     <!-- 점출입 매입발주 LOG 삭제 -->
    <query name="DEL_DETAIL_LOG">
        <![CDATA[
         DELETE FROM DPS.PO_SLPMSTLG
           WHERE STR_CD IN (?,?)
             AND SLIP_NO IN (?,?)
        ]]>
    </query> 
    
    <!-- 점출입 매입발주 DETAIL 등록 -->
    <query name="INS_DETAIL">
        <![CDATA[
            INSERT INTO DPS.PO_SLPDTL ( 
                                     STR_CD                  /* 점 */                
                                   , SLIP_NO                 /* 전표번호  */                        
                                   , ORD_SEQ_NO              /* 전표상세번호 */  
                                   , PUMMOK_CD               /* 품목코드  */  
                                   , SKU_CD                  /* 단품코드  */        
                                   , ORD_UNIT_CD             /* 발주단위  */ 
                                   , MG_RATE                 /* 마진율 */   
                                   , NEW_GAP_AMT             /* 신차익액  */    
                                   , NEW_GAP_RATE            /* 신차익율  */      
                                   , ORD_QTY                 /* 발주수량 */    
                                   , NEW_COST_PRC            /* 신원가단가 */     
                                   , NEW_COST_AMT            /* 신원가금액 */     
                                   , NEW_SALE_PRC            /* 신매가단가 */     
                                   , NEW_SALE_AMT            /* 신매가금액 */   
                                   , VAT_AMT                 /* 부가세 */      
                                   , PUMBUN_CD               /* 품번코드 */    
                                   , VEN_CD                  /* 협력사코드 */     
                                   , SLIP_FLAG               /* 전표구분 */     
                                   , REG_DATE                /* 등록일시 */                     
                                   , REG_ID                  /* 등록자 */   
                                   , MOD_DATE                /* 수정일시 */  
                                   , MOD_ID                  /* 수정자 */   
                                    )
                             VALUES (
                                       ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , ?
                                     , SYSDATE
                                     , ?
                                     , SYSDATE
                                     , ?
                                     )

        ]]>
    </query>  
    
    <!-- 점출입 매입발주 DETAIL 수정 -->
    <query name="UPD_DETAIL">
        <![CDATA[
            UPDATE DPS.PO_SLPDTL
              SET PUMMOK_CD = ?                                   /* 품목코드  */  
                , SKU_CD = ?                                      /* 단품코드  */        
                , ORD_UNIT_CD = ?                                 /* 발주단위  */   
                , MG_RATE = ?                                     /* 마진율 */ 
                , NEW_GAP_AMT = ?                                 /* 신차익액  */    
                , NEW_GAP_RATE = ?                                /* 신차익율  */         
                , ORD_QTY = ?                                     /* 발주수량 */    
                , NEW_COST_PRC = ?                                /* 신원가단가 */     
                , NEW_COST_AMT = ?                                /* 신원가금액 */     
                , NEW_SALE_PRC = ?                                /* 신매가단가 */     
                , NEW_SALE_AMT = ?                                /* 신매가금액 */ 
                , VAT_AMT      = ?                                /* 부가세 */        
                , PUMBUN_CD = ?                                   /* 품번코드 */    
                , VEN_CD = ?                                      /* 협력사코드 */          
                , MOD_DATE = SYSDATE                              /* 수정일시 */
                , MOD_ID = ?                                      /* 수정자 */ 
            WHERE STR_CD = ?
              AND SLIP_NO = ?
              AND ORD_SEQ_NO = ?
        ]]>
    </query>
    
    <!-- 점출입 매입발주 상대전표번호 업데이트 -->
    <query name="UPD_P_DETAIL">
        <![CDATA[
            UPDATE  DPS.PO_SLPDTL
            SET  ( PUMMOK_CD    
                 , SKU_CD           
                 , ORD_UNIT_CD  
                 , MG_RATE      
                 , NEW_GAP_AMT  
                 , NEW_GAP_RATE 
                 , ORD_QTY          
                 , NEW_COST_PRC 
                 , NEW_COST_AMT 
                 , NEW_SALE_PRC 
                 , NEW_SALE_AMT 
                 , VAT_AMT
                 , PUMBUN_CD    
                 , VEN_CD               
                 , REG_DATE     
                 , REG_ID       
                 , MOD_DATE     
                 , MOD_ID )=(
                            SELECT PUMMOK_CD    
                                 , SKU_CD           
                                 , ORD_UNIT_CD  
                                 , MG_RATE      
                                 , NEW_GAP_AMT  
                                 , NEW_GAP_RATE 
                                 , ORD_QTY          
                                 , NEW_COST_PRC 
                                 , NEW_COST_AMT 
                                 , NEW_SALE_PRC 
                                 , NEW_SALE_AMT 
                                 , VAT_AMT
                                 , PUMBUN_CD    
                                 , VEN_CD               
                                 , REG_DATE     
                                 , REG_ID       
                                 , MOD_DATE     
                                 , MOD_ID    
                              FROM  DPS.PO_SLPDTL
                             WHERE  STR_CD     = ?
                               AND  SLIP_NO    = ?
                               AND  ORD_SEQ_NO = ?
                    )
            WHERE   STR_CD     = ?
            AND     SLIP_NO    = ?
            AND     ORD_SEQ_NO = ?

        ]]>
    </query>
    
    <!-- 점출입 매입발주 DETAIL 삭제 -->
    <query name="DEL_DETAIL">
        <![CDATA[
         DELETE FROM DPS.PO_SLPDTL
           WHERE STR_CD = ?
             AND SLIP_NO = ?
             AND ORD_SEQ_NO = ?
        ]]>
    </query> 
    
</service>